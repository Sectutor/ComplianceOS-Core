import{t as d,r as c,i as r,j as e,D as f,ap as O,c as o,o as N,p as C,q as D,I as m,C as R,d as G,e as U,F as M,k as A,m as k}from"./index-DOc7Nwb7.js";import{T as w}from"./textarea-BtxBxzdY.js";import{A as L,a as z,b as F,c as q,d as H,e as B,f as V,g as J}from"./alert-dialog-V7xGXdVc.js";import{P as $}from"./PageGuide-CPKKXXS6.js";import{P as K}from"./plus-BaQ35Jcx.js";import{S as Q}from"./sparkles-CoQ80pK2.js";import{E as W}from"./external-link-C3PXjBR9.js";import{S as Y}from"./square-pen-ClRv15cM.js";import{T as X}from"./trash-2-CFEfisbM.js";import"./scroll-area-DPaNxEJD.js";import"./separator-BWuYil37.js";import"./book-open-BffBrdze.js";import"./link-FmUqdGRG.js";import"./info-By5wLOUH.js";function he(){const{data:h,refetch:p}=d.dpaTemplates.list.useQuery(),[y,b]=c.useState(!1),[n,l]=c.useState({name:"",content:"",jurisdiction:"Global"}),[a,i]=c.useState(null),[u,x]=c.useState(null),[t,P]=c.useState(null),g=d.dpaTemplates.create.useMutation({onSuccess:()=>{r.success("Template created"),b(!1),l({name:"",content:"",jurisdiction:"Global"}),p()},onError:s=>r.error("Failed to create template: "+s.message)}),j=d.dpaTemplates.update.useMutation({onSuccess:()=>{r.success("Template updated"),i(null),p()},onError:s=>r.error("Failed to update template: "+s.message)}),v=d.dpaTemplates.delete.useMutation({onSuccess:()=>{r.success("Template deleted"),x(null),p()},onError:s=>r.error("Failed to delete template: "+s.message)}),S=()=>{if(!n.name||!n.content)return r.error("Name and Content are required");g.mutate(n)},E=()=>{if(!(a!=null&&a.name)||!(a!=null&&a.content))return r.error("Name and Content are required");j.mutate({id:a.id,name:a.name,content:a.content,jurisdiction:a.jurisdiction})},T=()=>{u&&v.mutate({id:u})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx($,{title:"DPA Templates",description:"Manage standard Data Processing Agreements.",rationale:"Mandatory for GDPR compliance when sharing personal data with processors.",howToUse:[{step:"Create",description:"Draft new DPA templates for different regions."},{step:"Customize",description:"Set jurisdictions (EU, UK, CA) and clauses."},{step:"Deploy",description:"Use templates for vendor contract negotiation."}]}),e.jsxs(f,{open:y,onOpenChange:b,children:[e.jsx(O,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(K,{className:"mr-2 h-4 w-4"})," New Template"]})}),e.jsxs(N,{className:"max-w-2xl",children:[e.jsx(C,{children:e.jsx(D,{children:"Create New DPA Template"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Template Name"}),e.jsx(m,{value:n.name,onChange:s=>l({...n,name:s.target.value}),placeholder:"e.g. Standard EU DPA 2026"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Jurisdiction"}),e.jsx(m,{value:n.jurisdiction,onChange:s=>l({...n,jurisdiction:s.target.value}),placeholder:"e.g. Global, EU, CA"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium",children:"Content (Markdown/HTML)"}),e.jsxs(o,{variant:"outline",size:"sm",className:"h-7 text-xs text-purple-600 border-purple-200 hover:bg-purple-50",onClick:()=>{if(!n.name)return r.error("Enter a name first for context");r.promise(new Promise(s=>setTimeout(()=>s(`
**DATA PROCESSING REQUIREMENTS (DPA)**

**THIS AGREEMENT** is made on ${new Date().toLocaleDateString()}

**BETWEEN:**
(1) **[Company Name]** (the "Controller"); and
(2) **${n.name}** (the "Processor").

---

**1. DEFINITIONS**
1.1 "Data Protection Laws" means all applicable laws relating to the processing of Personal Data, including but not limited to the GDPR, UK GDPR, and CCPA/CPRA where applicable.
1.2 "Personal Data", "Processing", "Controller", "Processor", and "Data Subject" shall have the meanings given to them in the Data Protection Laws.

**2. SCOPE AND PURPOSE**
2.1 The Processor shall process Personal Data only on documented instructions from the Controller, unless required to do so by applicable law.
2.2 The subject matter, duration, nature, and purpose of the processing are described in **Annex A** of this agreement.

**3. OBLIGATIONS OF THE PROCESSOR**
The Processor shall:
(a) Ensure that persons authorized to process the personal data have committed themselves to confidentiality;
(b) Implement appropriate technical and organizational measures to ensure a level of security appropriate to the risk, including encryption and pseudonymization where appropriate;
(c) Assist the Controller in fulfilling its obligation to respond to requests for exercising the data subject's rights;
(d) Assist the Controller in ensuring compliance with security, data breach notification, and data protection impact assessment obligations;
(e) At the choice of the Controller, delete or return all Personal Data to the Controller after the end of the provision of services.

**4. SUBPROCESSING**
4.1 The Processor shall not engage another processor without prior specific or general written authorization of the Controller.
4.2 Where the Processor engages another processor, same data protection obligations shall be imposed on that other processor.

**5. INTERNATIONAL TRANSFERS**
5.1 Any transfer of Personal Data to a third country or an international organization shall only be performed in compliance with Chapter V of the GDPR or equivalent provisions of applicable Data Protection Laws.

**6. JURISDICTION**
This agreement is governed by the laws of **${n.jurisdiction||"New York"}**.

---
*Generated by ComplianceOS AI*
                                                `),1500)),{loading:"Generating legal text with AI...",success:s=>(l(I=>({...I,content:s})),"Draft generated!"),error:"Failed to generate"})},children:[e.jsx(Q,{className:"h-3 w-3 mr-1"})," Generate with AI"]})]}),e.jsx(w,{className:"min-h-[200px]",value:n.content,onChange:s=>l({...n,content:s.target.value}),placeholder:"# Data Processing Agreement..."})]}),e.jsx(o,{onClick:S,disabled:g.isPending,children:g.isPending?"Creating...":"Save Template"})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h==null?void 0:h.map(s=>e.jsxs(R,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(G,{className:"flex flex-row items-start justify-between space-y-0 pb-2",children:[e.jsxs(U,{className:"text-lg font-bold flex items-center",children:[e.jsx(M,{className:"mr-2 h-5 w-5 text-blue-500"}),s.name]}),e.jsx(A,{variant:"outline",children:s.jurisdiction})]}),e.jsxs(k,{children:[e.jsxs("p",{className:"text-sm text-slate-500 line-clamp-3 mb-4",children:[s.content.substring(0,150),"..."]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[e.jsxs("span",{children:["v",s.version]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>P(s),children:[e.jsx(W,{className:"h-3 w-3 mr-1"})," View"]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>i(s),children:[e.jsx(Y,{className:"h-3 w-3 mr-1"})," Edit"]}),e.jsxs(o,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>x(s.id),children:[e.jsx(X,{className:"h-3 w-3 mr-1"})," Delete"]})]})]})]})]},s.id))}),e.jsx(f,{open:!!t,onOpenChange:s=>!s&&P(null),children:e.jsxs(N,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(C,{children:e.jsxs(D,{className:"flex items-center justify-between",children:[e.jsx("span",{children:t==null?void 0:t.name}),e.jsx(A,{variant:"outline",children:t==null?void 0:t.jurisdiction})]})}),e.jsxs("div",{className:"prose prose-sm max-w-none py-4",children:[e.jsx("div",{className:"bg-slate-50 p-6 rounded-lg border",children:e.jsx("pre",{className:"whitespace-pre-wrap font-sans text-sm",children:t==null?void 0:t.content})}),e.jsxs("div",{className:"mt-4 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Version: ",t==null?void 0:t.version," â€¢ Created: ",t!=null&&t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"]}),e.jsx("p",{className:"mt-2 text-blue-600",children:'ðŸ’¡ This template can be selected during vendor onboarding in the "Legal" step.'})]})]})]})}),e.jsx(f,{open:!!a,onOpenChange:s=>!s&&i(null),children:e.jsxs(N,{className:"max-w-2xl",children:[e.jsx(C,{children:e.jsx(D,{children:"Edit DPA Template"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Template Name"}),e.jsx(m,{value:(a==null?void 0:a.name)||"",onChange:s=>i({...a,name:s.target.value}),placeholder:"e.g. Standard EU DPA 2026"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Jurisdiction"}),e.jsx(m,{value:(a==null?void 0:a.jurisdiction)||"",onChange:s=>i({...a,jurisdiction:s.target.value}),placeholder:"e.g. Global, EU, CA"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Content (Markdown/HTML)"}),e.jsx(w,{className:"min-h-[200px]",value:(a==null?void 0:a.content)||"",onChange:s=>i({...a,content:s.target.value}),placeholder:"# Data Processing Agreement..."})]}),e.jsx(o,{onClick:E,disabled:j.isPending,children:j.isPending?"Updating...":"Update Template"})]})]})}),e.jsx(L,{open:!!u,onOpenChange:s=>!s&&x(null),children:e.jsxs(z,{children:[e.jsxs(F,{children:[e.jsx(q,{children:"Are you sure?"}),e.jsx(H,{children:"This will permanently delete this DPA template. This action cannot be undone."})]}),e.jsxs(B,{children:[e.jsx(V,{children:"Cancel"}),e.jsx(J,{onClick:T,className:"bg-red-600 hover:bg-red-700",children:v.isPending?"Deleting...":"Delete"})]})]})})]})}export{he as default};
