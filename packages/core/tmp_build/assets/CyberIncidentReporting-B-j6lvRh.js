import{r as n,ac as U,b as V,t as W,i as h,j as e,c as t,T as q,C as m,d as p,e as x,f as j,m as u,L as i,I as H,E as N,G as S,H as b,J as C,K as s,ay as f,x as $}from"./index-DOc7Nwb7.js";import{C as z}from"./CyberLayout-B8x_G-rt.js";import{T as c}from"./textarea-BtxBxzdY.js";import{A as k,a as L,b as T}from"./alert-BudCfM-X.js";import{P as G}from"./PageGuide-CPKKXXS6.js";import{A as O}from"./arrow-left-CpuUojG-.js";import{C as Y}from"./clock-osbacZli.js";import{S as J}from"./send-FW7-3cjH.js";import"./DashboardLayout-aHnUqq57.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./utils-BC5CVi_C.js";import"./bar-chart-3-BCngNY6H.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";function Ve(){const[o,a]=n.useState(1),{selectedClientId:w}=U(),[K,I]=V(),[D,A]=n.useState(new Date().toISOString().slice(0,16)),[g,E]=n.useState(""),[l,B]=n.useState(""),[v,F]=n.useState(""),[R,M]=n.useState("no"),y=W.cyber.reportIncident.useMutation({onSuccess:()=>{h.success("Incident Reported",{description:"The CSIRT has been notified. You can update this report later."}),I("/cyber")},onError:r=>{h.error("Error",{description:r.message||"Failed to submit report"})}}),P=()=>{if(!w){h.error("Error",{description:"No client selected"});return}if(!g||!l||!v){h.error("Validation Error",{description:"Please fill in all required fields"});return}y.mutate({clientId:w,detectedAt:new Date(D).toISOString(),severity:g,cause:l,description:v,crossBorderImpact:R==="yes",title:`Incident: ${l} (${new Date().toLocaleDateString()})`})};return e.jsx(z,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4 animate-slide-down",children:[e.jsx(t,{variant:"ghost",size:"icon",onClick:()=>I("/cyber/incidents"),className:"mt-1",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(G,{title:"Report New Incident",description:"Step-by-step wizard for reporting significant incidents.",rationale:"NIS2 mandates strict reporting timelines (24h/72h) for significant incidents.",howToUse:[{step:"24h Warning",description:" Submit early warning within 24 hours of detection."},{step:"72h Details",description:"Provide detailed assessment within 72 hours."},{step:"Final Report",description:"Submit full analysis within 1 month."}]})]}),e.jsxs(k,{variant:"destructive",className:"bg-red-50 text-red-900 border-red-200",children:[e.jsx(q,{className:"h-4 w-4 text-red-600"}),e.jsx(L,{children:"Early Warning Required"}),e.jsxs(T,{children:["Significant incidents must be reported to the CSIRT within ",e.jsx("strong",{children:"24 hours"})," of becoming aware of the incident."]})]}),e.jsx("div",{className:"flex gap-4 mb-8",children:["Initial Report (24h)","Detailed Notification (72h)","Intermediate Report","Final Report (1 Month)"].map((r,d)=>e.jsxs("div",{onClick:()=>a(d+1),className:`flex-1 border-b-2 pb-2 text-sm font-medium cursor-pointer transition-colors ${o===d+1?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-slate-700"}`,children:[d+1,". ",r]},d))}),o===1&&e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(x,{children:"Submit Early Warning Report"}),e.jsx(j,{children:"This report is strictly for the CSIRT to assess if the incident is ongoing and significant."})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Date & Time Detected"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(H,{type:"datetime-local",value:D,onChange:r=>A(r.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Severity Level"}),e.jsxs(N,{value:g,onValueChange:E,children:[e.jsx(S,{children:e.jsx(b,{placeholder:"Select severity"})}),e.jsxs(C,{children:[e.jsx(s,{value:"low",children:"Low - No Service Disruption"}),e.jsx(s,{value:"medium",children:"Medium - Limited Disruption"}),e.jsx(s,{value:"high",children:"High - Significant Disruption/Data Loss"}),e.jsx(s,{value:"critical",children:"Critical - Public Safety/Systemic Risk"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Suspected Cause"}),e.jsxs(N,{value:l,onValueChange:B,children:[e.jsx(S,{children:e.jsx(b,{placeholder:"Select cause"})}),e.jsxs(C,{children:[e.jsx(s,{value:"malware",children:"Malware / Ransomware"}),e.jsx(s,{value:"phishing",children:"Phishing / Social Engineering"}),e.jsx(s,{value:"dos",children:"DDoS"}),e.jsx(s,{value:"vulnerability",children:"Exploited Vulnerability"}),e.jsx(s,{value:"insider",children:"Insider Threat"}),e.jsx(s,{value:"unknown",children:"Unknown"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Brief Description of Incident"}),e.jsx(c,{placeholder:"Describe what happened, systems affected, and current status...",className:"h-32",value:v,onChange:r=>F(r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Cross-border Impact?"}),e.jsxs(N,{value:R,onValueChange:M,children:[e.jsx(S,{children:e.jsx(b,{placeholder:"Does this affect other EU member states?"})}),e.jsxs(C,{children:[e.jsx(s,{value:"no",children:"No"}),e.jsx(s,{value:"yes",children:"Yes"}),e.jsx(s,{value:"unknown",children:"Unknown"})]})]})]})]}),e.jsxs(f,{className:"flex justify-between",children:[e.jsx(t,{variant:"ghost",children:"Save Draft"}),e.jsxs(t,{className:"bg-red-600 hover:bg-red-700",onClick:P,disabled:y.isLoading,children:[y.isLoading?e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(J,{className:"mr-2 h-4 w-4"}),"Submit Report"]})]})]}),o===2&&e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(x,{children:"Detailed Notification (72h)"}),e.jsx(j,{children:"A comprehensive assessment of the incident, including indicators of compromise (IoCs) and root cause analysis."})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Initial Mitigation Steps Taken"}),e.jsx(c,{placeholder:"Describe actions taken to contain the incident...",className:"h-24"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Indicators of Compromise (IoCs)"}),e.jsx(c,{placeholder:"IP addresses, file hashes, domains, etc.",className:"h-24 font-mono text-xs"})]})]}),e.jsxs(f,{className:"flex justify-between",children:[e.jsx(t,{variant:"outline",onClick:()=>a(1),children:"Back"}),e.jsx(t,{onClick:()=>a(3),children:"Next: Intermediate Report"})]})]}),o===3&&e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(x,{children:"Intermediate Report"}),e.jsx(j,{children:"Updates on the status of the incident if it is not yet resolved."})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs(k,{children:[e.jsx(L,{children:"Report Status"}),e.jsx(T,{children:"Required only if the incident is ongoing beyond 72 hours."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Current Status Update"}),e.jsx(c,{placeholder:"What has changed since the last report?",className:"h-32"})]})]}),e.jsxs(f,{className:"flex justify-between",children:[e.jsx(t,{variant:"outline",onClick:()=>a(2),children:"Back"}),e.jsx(t,{onClick:()=>a(4),children:"Next: Final Report"})]})]}),o===4&&e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(x,{children:"Final Report (1 Month)"}),e.jsx(j,{children:"A complete report on the incident, including its root cause, applied mitigation measures, and cross-border impact."})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Root Cause Analysis (Final)"}),e.jsx(c,{placeholder:"Detailed explanation of how the incident occurred...",className:"h-24"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Lessons Learned"}),e.jsx(c,{placeholder:"What improvements will be made to prevent recurrence?",className:"h-24"})]})]}),e.jsxs(f,{className:"flex justify-between",children:[e.jsx(t,{variant:"outline",onClick:()=>a(3),children:"Back"}),e.jsx(t,{className:"bg-green-600 hover:bg-green-700",children:"Close Incident"})]})]})]})})}export{Ve as default};
