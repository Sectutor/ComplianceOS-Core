import{ac as z,ab as V,b as F,r as m,t as o,j as e,D as E,ap as U,c as v,o as G,p as Q,q as W,s as $,L as n,I as S,E as b,G as f,H as N,J as w,K as a,w as q,S as T,C as J,d as K,e as X,k as d,f as Y,m as Z,ay as _,aa as ee}from"./index-DOc7Nwb7.js";import{A as se,a as te,b as ae,c as ie,d as re,e as le,f as ce,g as oe}from"./alert-dialog-V7xGXdVc.js";import{D as ne}from"./DashboardLayout-aHnUqq57.js";import{B as de}from"./Breadcrumb-CRi3LAxS.js";import{P as pe}from"./PageGuide-CPKKXXS6.js";import{T as me}from"./textarea-BtxBxzdY.js";import{P as xe}from"./plus-BaQ35Jcx.js";import{S as he}from"./search-CwuIBBPE.js";import{T as ue}from"./trash-2-CFEfisbM.js";import{L as je}from"./lock-czWF3qbC.js";import{S as ge}from"./server-Dvm2PAz3.js";import{B as ye}from"./brain-C-Zi22rJ.js";import{f as ve}from"./format-H2tx8_vS.js";import"./index--2vFva6Y.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./link-FmUqdGRG.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";import"./differenceInCalendarDays-nctqlg7V.js";const ds=()=>{const{selectedClientId:P}=z(),C=V(),[,A]=F(),i=C.id?parseInt(C.id):P,[I,x]=m.useState(!1),[h,L]=m.useState(""),[u,j]=m.useState(null),[t,r]=m.useState({name:"",description:"",projectType:"it",owner:"",securityCriticality:"medium"}),D=o.useContext(),{data:g,isLoading:M}=o.projects.list.useQuery({clientId:i},{enabled:!!i}),{data:c}=o.users.listWorkspaceMembers.useQuery({clientId:i},{enabled:!!i}),y=o.projects.create.useMutation({onSuccess:()=>{D.projects.list.invalidate(),x(!1),r({name:"",description:"",projectType:"it",owner:"",securityCriticality:"medium"})}}),k=o.projects.delete.useMutation({onSuccess:()=>{D.projects.list.invalidate(),j(null)}}),B=async()=>{i&&await y.mutateAsync({clientId:i,...t})},H=async()=>{!u||!i||await k.mutateAsync({id:u,clientId:i})},O=s=>{switch(s){case"ai":return e.jsx(ye,{className:"h-5 w-5 text-purple-500"});case"infra":return e.jsx(ge,{className:"h-5 w-5 text-blue-500"});case"privacy":return e.jsx(je,{className:"h-5 w-5 text-emerald-500"});default:return e.jsx(T,{className:"h-5 w-5 text-slate-500"})}},R=s=>{switch(s){case"critical":return e.jsx(d,{className:"bg-red-600",children:"Critical"});case"high":return e.jsx(d,{className:"bg-orange-500",children:"High"});case"medium":return e.jsx(d,{className:"bg-yellow-500",children:"Medium"});default:return e.jsx(d,{variant:"secondary",children:"Low"})}},l=g==null?void 0:g.filter(s=>{var p;return s.name.toLowerCase().includes(h.toLowerCase())||((p=s.description)==null?void 0:p.toLowerCase().includes(h.toLowerCase()))});return e.jsx(ne,{children:e.jsxs("div",{className:"space-y-6 page-transition",children:[e.jsx(de,{items:[{label:"Dashboard",href:"/dashboard"},{label:"Projects"}]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-extrabold tracking-tight bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Security Projects"}),e.jsx("p",{className:"text-slate-500 mt-2 text-lg",children:"Track the security posture of your IT, AI, and Infrastructure projects."})]}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx(pe,{title:"Security Projects",description:"Manage and track security initiatives across IT, AI, and Infrastructure.",rationale:"Projects group related assets and risks, allowing for focused assessment and remediation.",howToUse:[{step:"Create Project",description:"Define clear scope and criticality for new initiatives."},{step:"Assign Owner",description:"Designate a responsible lead for accountability."},{step:"Assess Risks",description:"Use the project view to identify and treat specific risks."}],integrations:[{name:"Risk Register",description:"Aggregates project risks into the global register."},{name:"Threat Modeling",description:"Links technical threat models to the project."}]}),e.jsxs(E,{open:I,onOpenChange:x,children:[e.jsx(U,{asChild:!0,children:e.jsxs(v,{className:"bg-blue-600 hover:bg-blue-700 shadow-lg shadow-blue-200",children:[e.jsx(xe,{className:"mr-2 h-5 w-5"})," New Project"]})}),e.jsxs(G,{className:"sm:max-w-[500px]",children:[e.jsxs(Q,{children:[e.jsx(W,{className:"text-2xl",children:"Initialize Security Project"}),e.jsx($,{children:"Define the scope and criticality to start tracking its security posture."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Project Name"}),e.jsx(S,{value:t.name,onChange:s=>r({...t,name:s.target.value}),placeholder:"e.g. Migration to AWS"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Project Type"}),e.jsxs(b,{value:t.projectType,onValueChange:s=>r({...t,projectType:s}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select type"})}),e.jsxs(w,{children:[e.jsx(a,{value:"it",children:"IT Project"}),e.jsx(a,{value:"ai",children:"AI / LLM Project"}),e.jsx(a,{value:"infra",children:"Infrastructure"}),e.jsx(a,{value:"privacy",children:"Privacy / Personal Data"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Criticality"}),e.jsxs(b,{value:t.securityCriticality,onValueChange:s=>r({...t,securityCriticality:s}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select level"})}),e.jsxs(w,{children:[e.jsx(a,{value:"low",children:"Low Impact"}),e.jsx(a,{value:"medium",children:"Medium"}),e.jsx(a,{value:"high",children:"High"}),e.jsx(a,{value:"critical",children:"Critical"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx(me,{value:t.description,onChange:s=>r({...t,description:s.target.value}),placeholder:"Briefly describe the security scope...",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Owner / Lead"}),e.jsxs(b,{value:t.owner,onValueChange:s=>r({...t,owner:s}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select responsible person"})}),e.jsxs(w,{children:[c==null?void 0:c.map(s=>e.jsx(a,{value:s.name||s.email,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.name||s.email}),e.jsx("span",{className:"text-[10px] text-slate-400 capitalize",children:s.role})]})},s.id)),(!c||c.length===0)&&e.jsx(a,{value:"unassigned",disabled:!0,children:"No members found"})]})]})]})]}),e.jsxs(q,{children:[e.jsx(v,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(v,{onClick:B,className:"bg-blue-600 hover:bg-blue-700",disabled:!t.name||y.isLoading,children:y.isLoading?"Initializing...":"Create Project"})]})]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-4 bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(he,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(S,{placeholder:"Filter projects...",className:"pl-10 border-slate-200 focus:ring-blue-500",value:h,onChange:s=>L(s.target.value)})]})}),M?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(l==null?void 0:l.length)===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center border-2 border-dashed border-slate-200 rounded-2xl bg-slate-50",children:[e.jsx("div",{className:"bg-white p-4 rounded-full shadow-sm mb-4",children:e.jsx(T,{className:"h-10 w-10 text-slate-300"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"No projects started"}),e.jsx("p",{className:"text-slate-500 max-w-md mt-2",children:"Initialize your first project to begin tracking its risks and compliance posture."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l==null?void 0:l.map(s=>e.jsxs(J,{className:"group relative overflow-hidden hover:shadow-xl transition-all duration-300 border-slate-200 cursor-pointer",onClick:()=>A(`/clients/${i}/projects/${s.id}`),children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-blue-500 opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs(K,{className:"pb-3",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-slate-50 rounded-lg group-hover:bg-blue-50 transition-colors",children:O(s.projectType)}),e.jsxs("div",{children:[e.jsx(X,{className:"text-lg font-bold group-hover:text-blue-600 transition-colors",children:s.name}),e.jsxs("div",{className:"flex items-center mt-1 space-x-2",children:[e.jsx(d,{variant:"outline",className:"capitalize text-[10px] px-2 py-0",children:s.projectType}),R(s.securityCriticality)]})]})]})}),e.jsx(Y,{className:"line-clamp-2 mt-2 h-10",children:s.description||"No description provided."})]}),e.jsx(Z,{className:"pb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-3 border-t border-slate-100",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider",children:"Identified Risks"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:s.riskCount||0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wider",children:"Threat Models"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:s.threatModelCount||0})]})]})}),e.jsxs(_,{className:"pt-0 flex justify-between items-center bg-slate-50/50 py-3 px-6",children:[e.jsxs("span",{className:"text-xs text-slate-400",children:["Updated ",ve(new Date(s.updatedAt),"MMM d, yyyy")]}),e.jsxs("div",{className:"flex items-center text-blue-600 text-sm font-semibold opacity-0 group-hover:opacity-100 transform translate-x-2 group-hover:translate-x-0 transition-all",children:["View Posture ",e.jsx(ee,{className:"h-4 w-4 ml-1"})]})]}),e.jsx("button",{onClick:p=>{p.stopPropagation(),j(s.id)},className:"absolute top-4 right-4 p-2 text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ue,{className:"h-4 w-4"})})]},s.id))}),e.jsx(se,{open:!!u,onOpenChange:s=>!s&&j(null),children:e.jsxs(te,{children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Archive Security Project?"}),e.jsx(re,{children:"This will remove the project from your active dashboard. Associated risk assessments and threat models will remain in the database but will be unlinked."})]}),e.jsxs(le,{children:[e.jsx(ce,{children:"Cancel"}),e.jsx(oe,{onClick:H,className:"bg-red-600 hover:bg-red-700",children:k.isLoading?"Deleting...":"Archived Project"})]})]})})]})})};export{ds as ProjectsDashboard};
