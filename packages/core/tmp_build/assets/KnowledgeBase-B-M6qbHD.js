import{ab as H,r as a,t as r,i as S,j as e,c as l,I as C,N as K,O as R,P as p,Q as i,V as z,W as t,x as T,k as G,Z as U,_ as V,$ as W,a1 as M,D as Y,o as Z,p as _,q as $,L as b,w as J}from"./index-DOc7Nwb7.js";import{T as X}from"./textarea-BtxBxzdY.js";import{D as ee}from"./DashboardLayout-aHnUqq57.js";import{P as se}from"./PageGuide-CPKKXXS6.js";import{P as ae}from"./plus-BaQ35Jcx.js";import{S as te}from"./search-CwuIBBPE.js";import{F as ne}from"./filter-Ceo--4mb.js";import{E as ie}from"./ellipsis-BXWwt8ER.js";import{S as re}from"./square-pen-ClRv15cM.js";import{T as le}from"./trash-Dn_qaYuR.js";import"./index--2vFva6Y.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";function Ze(){const q=H(),A=parseInt(q.id||"0"),[E,P]=a.useState(""),[F,o]=a.useState(!1),[x,c]=a.useState(!1),[D,k]=a.useState(null),[d,h]=a.useState(""),[m,j]=a.useState(""),[g,w]=a.useState(""),[B,y]=a.useState("internal"),f=r.useContext(),{data:n,isLoading:I}=r.knowledgeBase.list.useQuery({clientId:A,search:E||void 0}),v=r.knowledgeBase.create.useMutation({onSuccess:()=>{f.knowledgeBase.list.invalidate(),o(!1),u(),S.success("Entry added successfully")}}),N=r.knowledgeBase.update.useMutation({onSuccess:()=>{f.knowledgeBase.list.invalidate(),c(!1),u(),S.success("Entry updated successfully")}}),L=r.knowledgeBase.delete.useMutation({onSuccess:()=>{f.knowledgeBase.list.invalidate(),S.success("Entry deleted successfully")}}),u=()=>{h(""),j(""),w(""),y("internal"),k(null)},O=s=>{k(s),h(s.question),j(s.answer),w(s.comments||""),y(s.access||"internal"),c(!0)},Q=()=>{!d||!m||(x&&D?N.mutate({id:D.id,question:d,answer:m,comments:g,access:B}):v.mutate({clientId:A,question:d,answer:m,comments:g,access:B}))};return e.jsx(ee,{children:e.jsxs("div",{className:"p-8 w-full max-w-full",children:[e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Knowledge Base (FAQ)"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage standard answers for compliance questionnaires."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{title:"Knowledge Base",description:"Answer library for security questionnaires.",rationale:"Speeds up vendor reviews by storing standard security responses.",howToUse:[{step:"Search Answers",description:"Find approved responses for common security questions."},{step:"Add Entries",description:"Document new security controls and procedures."},{step:"Manage Access",description:"Control internal vs. external visibility."}],integrations:[{name:"AI Questionnaires",description:"Auto-fill source."},{name:"Sales Enablement",description:"Shareable security facts."}]}),e.jsxs(l,{onClick:()=>o(!0),children:[e.jsx(ae,{className:"mr-2 h-4 w-4"})," Add entries"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(te,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(C,{placeholder:"Search questions or answers...",className:"pl-9",value:E,onChange:s=>P(s.target.value)})]}),e.jsxs(l,{variant:"outline",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"})," Filter"]})]}),e.jsx("div",{className:"border rounded-lg bg-card shadow-sm",children:e.jsxs(K,{children:[e.jsx(R,{children:e.jsxs(p,{children:[e.jsx(i,{className:"w-[40%]",children:"Question"}),e.jsx(i,{className:"w-[30%]",children:"Answer"}),e.jsx(i,{children:"Comment"}),e.jsx(i,{children:"Access"}),e.jsx(i,{children:"Date Added"}),e.jsx(i,{className:"w-[50px]"})]})}),e.jsx(z,{children:I?e.jsx(p,{children:e.jsx(t,{colSpan:6,className:"h-24 text-center",children:e.jsx(T,{className:"h-6 w-6 animate-spin mx-auto text-muted-foreground"})})}):(n==null?void 0:n.length)===0?e.jsx(p,{children:e.jsx(t,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"No entries found. Add one to get started."})}):n==null?void 0:n.map(s=>e.jsxs(p,{children:[e.jsx(t,{className:"font-medium",children:s.question}),e.jsx(t,{className:"truncate max-w-[300px]",title:s.answer,children:s.answer}),e.jsx(t,{children:s.comments}),e.jsx(t,{children:e.jsx(G,{variant:"outline",className:"capitalize",children:s.access})}),e.jsx(t,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(t,{children:e.jsxs(U,{children:[e.jsx(V,{asChild:!0,children:e.jsx(l,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(W,{align:"end",children:[e.jsxs(M,{onClick:()=>O(s),children:[e.jsx(re,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(M,{className:"text-destructive focus:text-destructive",onClick:()=>L.mutate({id:s.id}),children:[e.jsx(le,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},s.id))})]})})]}),e.jsx(Y,{open:F||x,onOpenChange:s=>{s||(o(!1),c(!1),u())},children:e.jsxs(Z,{className:"sm:max-w-[600px]",children:[e.jsx(_,{children:e.jsx($,{children:x?"Edit Entry":"Add Entry"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"question",children:"Question"}),e.jsx(C,{id:"question",value:d,onChange:s=>h(s.target.value),placeholder:"e.g. Are employee endpoints encrypted?"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"answer",children:"Answer"}),e.jsx(X,{id:"answer",value:m,onChange:s=>j(s.target.value),placeholder:"Yes, we use BitLocker...",className:"min-h-[100px]"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"comments",children:"Internal Comments"}),e.jsx(C,{id:"comments",value:g,onChange:s=>w(s.target.value),placeholder:"Optional notes"})]})]}),e.jsxs(J,{children:[e.jsx(l,{variant:"outline",onClick:()=>{o(!1),c(!1),u()},children:"Cancel"}),e.jsxs(l,{onClick:Q,disabled:v.isPending||N.isPending,children:[v.isPending||N.isPending?e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save"]})]})]})})]})})}export{Ze as default};
