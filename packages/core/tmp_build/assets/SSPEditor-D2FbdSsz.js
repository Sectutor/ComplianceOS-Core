import{ab as $e,t as b,r as j,j as e,x as y,S as R,aq as Ue,c as d,C as u,d as f,e as N,f as w,m as p,k as U,I as C,i as c}from"./index-DOc7Nwb7.js";import{D as B}from"./DashboardLayout-aHnUqq57.js";import{B as Be}from"./Breadcrumb-CRi3LAxS.js";import{T as v}from"./textarea-BtxBxzdY.js";import{T as Me,a as ze,b as E,c as P}from"./tabs-CBDTXbEn.js";import{A as qe}from"./arrow-left-CpuUojG-.js";import{P as M}from"./plus-BaQ35Jcx.js";import{P as Qe}from"./printer-B-Q0xXOk.js";import{S as Je}from"./share-2-d-nm3TwF.js";import{S as k}from"./save-CvVmWchr.js";import{S as He}from"./scroll-text-CmmtRUs3.js";import{I as he}from"./info-By5wLOUH.js";import{L as ue}from"./lock-czWF3qbC.js";import{C as pe}from"./circle-check-C5kiwRoG.js";import{C as be}from"./clock-osbacZli.js";import{L as Ge}from"./link-FmUqdGRG.js";import{E as Ve}from"./external-link-C3PXjBR9.js";import{T as Ye}from"./trash-2-CFEfisbM.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function zs(){var se,ae,te,le,re,ie,ne,ce,oe,de,me,xe;const ve=$e(),n=Number(ve.id),Y=window.location.pathname.split("/"),A=Y[Y.length-1],T=A==="ssp-171"?"NIST 800-171 Rev 2":"NIST 800-172 Enhanced",{data:z,isLoading:je,error:_}=b.federal.listSSPs.useQuery({clientId:n}),t=z==null?void 0:z.find(s=>s.framework===A),{data:q,isLoading:ge}=b.federal.getControlsByFramework.useQuery({clientId:n,framework:"NIST 800-172"},{enabled:!!t&&A==="ssp-172"}),{data:g,isLoading:ye}=b.federal.getSspControls.useQuery({clientId:n,sspId:(t==null?void 0:t.id)||0},{enabled:!!(t!=null&&t.id)}),O=b.federal.saveSspControl.useMutation(),fe=b.federal.deleteSspControl.useMutation(),Q=b.federal.createControl.useMutation(),Ne=b.federal.createSSP.useMutation(),we=b.federal.saveFipsCategorization.useMutation(),Ce=b.useUtils(),{data:S}=b.federal.getFipsCategorization.useQuery({clientId:n,sspId:(t==null?void 0:t.id)||0},{enabled:!!(t!=null&&t.id)}),[K,W]=j.useState("overview"),[i,F]=j.useState({}),[x,$]=j.useState(!1),[J,H]=j.useState(!1),[I,X]=j.useState({name:"",description:"",category:"",controlId:`CUSTOM-${Date.now()}`}),[Se,Ie]=j.useState(""),[ke,Ae]=j.useState(""),[De,Ee]=j.useState("");j.useEffect(()=>{if(t)try{const s=t.content&&t.content.trim()!==""?JSON.parse(t.content):{};F(s)}catch(s){console.error("Error parsing SSP content:",s),F({})}},[t]),j.useEffect(()=>{S&&F(s=>({...s,overview:{...s.overview,securityObjectiveConfidentiality:S.securityObjectiveConfidentiality||"low",securityObjectiveIntegrity:S.securityObjectiveIntegrity||"low",securityObjectiveAvailability:S.securityObjectiveAvailability||"low",rationaleConfidentiality:S.rationaleConfidentiality||"",rationaleIntegrity:S.rationaleIntegrity||"",rationaleAvailability:S.rationaleAvailability||""}}))},[S]);const o=(s,a,r)=>{F(l=>({...l,[s]:{...l[s],[a]:r,lastUpdated:new Date().toISOString()}}))},Pe=async(s,a)=>{if(t!=null&&t.id)try{a?(await O.mutateAsync({clientId:n,sspId:t.id,controlId:s,implementationStatus:"planned"}),c.success("Control added to SSP")):(await fe.mutateAsync({clientId:n,sspId:t.id,controlId:s}),c.success("Control removed from SSP"))}catch(r){console.error("Error toggling control:",r),c.error("Failed to update control")}},Oe=async(s,a)=>{if(t!=null&&t.id)try{await O.mutateAsync({clientId:n,sspId:t.id,controlId:s,implementationStatus:a})}catch(r){console.error("Error updating control status:",r),c.error("Failed to update control status")}},Z=async(s,a,r)=>{if(t!=null&&t.id)try{await O.mutateAsync({clientId:n,sspId:t.id,controlId:s,[a]:r})}catch(l){console.error("Error updating control details:",l),c.error("Failed to update control details")}},Le=async(s,a,r)=>{if(!(t!=null&&t.id))return;const l=g==null?void 0:g.find(D=>D.controlId===s),h=[...(l==null?void 0:l.evidenceLinks)||[],{id:`ev-${Date.now()}`,name:a,url:r,type:"link"}];try{await O.mutateAsync({clientId:n,sspId:t.id,controlId:s,evidenceLinks:h}),c.success("Evidence added")}catch(D){console.error("Error adding evidence:",D),c.error("Failed to add evidence")}},Re=async(s,a)=>{if(!(t!=null&&t.id))return;const r=g==null?void 0:g.find(h=>h.controlId===s),m=((r==null?void 0:r.evidenceLinks)||[]).filter(h=>h.id!==a);try{await O.mutateAsync({clientId:n,sspId:t.id,controlId:s,evidenceLinks:m}),c.success("Evidence removed")}catch(h){console.error("Error removing evidence:",h),c.error("Failed to remove evidence")}},G=(s,a)=>{X(r=>({...r,[s]:a}))},Te=async()=>{if(!I.name.trim()){c.error("Control name is required");return}try{await Q.mutateAsync({controlId:I.controlId,name:I.name,description:I.description,framework:"CUSTOM",category:I.category||"Custom",clientId:n}),c.success("Custom control created successfully"),X({name:"",description:"",category:"",controlId:`CUSTOM-${Date.now()}`}),H(!1)}catch(s){console.error("Error creating custom control:",s),c.error("Failed to create custom control")}},Fe=async()=>{$(!0);try{await Ne.mutateAsync({clientId:n,title:`${T} - Initial Draft`,framework:A,systemName:"New System",systemType:"Internal"}),c.success("SSP created successfully"),Ce.federal.listSSPs.invalidate({clientId:n})}catch(s){console.error("Error creating SSP:",s),c.error("Failed to create SSP")}finally{$(!1)}},ee=s=>{const a=i[s];if(!a)return"empty";if(s==="controls")return Object.keys(a).some(h=>h!=="lastUpdated")?"in-progress":"empty";const r={overview:["systemName","systemId","systemPurpose","securityLevel"],boundary:["boundaryDescription","diagramUrl"],environment:["environmentDescription"],roles:["rolesDescription"],attachments:["attachmentsNotes"]}[s]||[],l=r.filter(m=>a[m]&&a[m].trim().length>0).length;return l===0?"empty":l===r.length?"complete":"in-progress"},L=async s=>{var a,r,l,m,h,D;if(!t){c.error("No SSP found to update");return}$(!0);try{const V={...i,[s]:{...i[s],lastUpdated:new Date().toISOString()}};await b.federal.updateSSP.mutate({clientId:n,id:t.id,content:JSON.stringify(V)}),s==="overview"&&await we.mutateAsync({clientId:n,sspId:t.id,securityObjectiveConfidentiality:(a=i.overview)==null?void 0:a.securityObjectiveConfidentiality,securityObjectiveIntegrity:(r=i.overview)==null?void 0:r.securityObjectiveIntegrity,securityObjectiveAvailability:(l=i.overview)==null?void 0:l.securityObjectiveAvailability,rationaleConfidentiality:(m=i.overview)==null?void 0:m.rationaleConfidentiality,rationaleIntegrity:(h=i.overview)==null?void 0:h.rationaleIntegrity,rationaleAvailability:(D=i.overview)==null?void 0:D.rationaleAvailability}),c.success(`${s.charAt(0).toUpperCase()+s.slice(1)} section saved successfully`)}catch(V){console.error("Error saving section:",V),c.error("Failed to save section")}finally{$(!1)}};return je?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(y,{className:"h-8 w-8 animate-spin text-blue-600"})})}):_?e.jsx(B,{children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-red-900 mb-2",children:"Backend Connection Error"}),e.jsx("p",{className:"text-red-700 mb-4",children:"Unable to connect to the backend server. Please check if the server is running."}),e.jsxs("div",{className:"text-sm text-red-600 bg-red-100 p-3 rounded",children:[e.jsxs("p",{children:["Error details: ",_.message]}),e.jsx("p",{className:"mt-2",children:"Make sure the TRPC server is running on port 3001"})]})]})})}):t?e.jsx(B,{children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(Be,{items:[{label:"Clients",href:"/clients"},{label:`Client ${n}`,href:`/clients/${n}`},{label:"Federal Compliance",href:`/clients/${n}/federal`},{label:T,href:`/clients/${n}/federal/${A}`}]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black text-slate-900 tracking-tight",children:"System Security Plan Editor"}),e.jsxs("p",{className:"text-slate-600 mt-2",children:[T," - ",t.systemName||"Unnamed System"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(d,{variant:"outline",className:"border-slate-300",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Print"]}),e.jsxs(d,{variant:"outline",className:"border-slate-300",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsxs(d,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Save All"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs(u,{className:"border-slate-200 shadow-sm sticky top-8",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"Sections"}),e.jsx(w,{children:"Complete all sections for a comprehensive SSP"})]}),e.jsx(p,{className:"p-0",children:e.jsx("div",{className:"space-y-1",children:[{id:"overview",label:"1. System Overview",icon:He},{id:"boundary",label:"2. System Boundary",icon:R},{id:"environment",label:"3. Operational Environment",icon:he},{id:"controls",label:"4. Security Requirements",icon:ue},{id:"roles",label:"5. Roles & Responsibilities",icon:pe},{id:"attachments",label:"6. Attachments & References",icon:be}].map(s=>{const a=ee(s.id),r=s.icon;return e.jsxs("button",{onClick:()=>W(s.id),className:`w-full text-left px-4 py-3 flex items-center gap-3 transition-colors ${K===s.id?"bg-blue-50 text-blue-700 border-l-4 border-l-blue-600":"hover:bg-slate-50 text-slate-700"}`,children:[e.jsx(r,{className:"h-5 w-5"}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"font-medium",children:s.label})}),a==="complete"&&e.jsx(U,{className:"bg-green-100 text-green-800 border-green-200",children:"Complete"}),a==="in-progress"&&e.jsx(U,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"In Progress"}),a==="empty"&&e.jsx(U,{variant:"outline",className:"text-slate-500",children:"Empty"})]},s.id)})})})]}),e.jsx(u,{className:"border-slate-200 shadow-sm mt-6",children:e.jsxs(p,{className:"p-6",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-4",children:"Progress Summary"}),e.jsx("div",{className:"space-y-3",children:["overview","boundary","environment","controls","roles","attachments"].map(s=>{const a=ee(s),r={overview:"System Overview",boundary:"System Boundary",environment:"Operational Environment",controls:"Security Requirements",roles:"Roles & Responsibilities",attachments:"Attachments & References"};return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-700",children:r[s]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a==="complete"&&e.jsx(pe,{className:"h-4 w-4 text-green-600"}),a==="in-progress"&&e.jsx("div",{className:"h-2 w-2 rounded-full bg-yellow-500 animate-pulse"}),a==="empty"&&e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"})]})]},s)})})]})})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(Me,{value:K,onValueChange:W,className:"w-full",children:[e.jsxs(ze,{className:"grid grid-cols-6 mb-8",children:[e.jsx(E,{value:"overview",children:"Overview"}),e.jsx(E,{value:"boundary",children:"Boundary"}),e.jsx(E,{value:"environment",children:"Environment"}),e.jsx(E,{value:"controls",children:"Controls"}),e.jsx(E,{value:"roles",children:"Roles"}),e.jsx(E,{value:"attachments",children:"Attachments"})]}),e.jsxs(P,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2 mb-8",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"1. System Overview"}),e.jsx("p",{className:"text-slate-500",children:"Basic information about the system and its purpose."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"System Identification"}),e.jsx(w,{children:"Unique identifiers for the system"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"System Name"}),e.jsx(C,{placeholder:"Enter system name (e.g., 'Enterprise Resource Planning System')",value:((se=i.overview)==null?void 0:se.systemName)||"",onChange:s=>o("overview","systemName",s.target.value),className:"border-slate-200 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"System Identifier"}),e.jsx(C,{placeholder:"Enter system ID (e.g., 'ERP-001')",value:((ae=i.overview)==null?void 0:ae.systemId)||"",onChange:s=>o("overview","systemId",s.target.value),className:"border-slate-200 focus:ring-blue-500"})]})]})]}),e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"System Purpose & Classification"}),e.jsx(w,{children:"Mission and security classification"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"System Purpose"}),e.jsx(v,{placeholder:"Describe the system's mission, functions, and business value...",value:((te=i.overview)==null?void 0:te.systemPurpose)||"",onChange:s=>o("overview","systemPurpose",s.target.value),className:"min-h-[120px] border-slate-200 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Security Impact Level"}),e.jsxs("select",{value:((le=i.overview)==null?void 0:le.securityLevel)||"",onChange:s=>o("overview","securityLevel",s.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select impact level"}),e.jsx("option",{value:"low",children:"Low Impact"}),e.jsx("option",{value:"moderate",children:"Moderate Impact"}),e.jsx("option",{value:"high",children:"High Impact"})]})]})]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"FIPS 199 Security Categorization"}),e.jsx("p",{className:"text-slate-500",children:"Determine the security category of the system based on the potential impact of loss."})]}),e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"Security Objectives"}),e.jsx(w,{children:"Select the potential impact level for each security objective."})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-start pb-6 border-b border-slate-100 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsxs("h4",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4 text-blue-600"}),"Confidentiality"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Preserving authorized restrictions on information access and disclosure."})]}),e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsx("div",{className:"flex gap-4",children:["low","moderate","high"].map(s=>{var a,r;return e.jsxs("label",{className:`flex-1 border rounded-lg p-3 cursor-pointer transition-all ${((a=i.overview)==null?void 0:a.securityObjectiveConfidentiality)===s?"bg-blue-50 border-blue-500 ring-1 ring-blue-500":"hover:bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("input",{type:"radio",name:"confidentiality",value:s,checked:((r=i.overview)==null?void 0:r.securityObjectiveConfidentiality)===s,onChange:l=>o("overview","securityObjectiveConfidentiality",l.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"font-bold text-slate-900 capitalize",children:s})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s==="low"&&"Limited adverse effect",s==="moderate"&&"Serious adverse effect",s==="high"&&"Severe/catastrophic adverse effect"]})]},s)})}),e.jsx(v,{placeholder:"Justification for Confidentiality impact level...",value:((re=i.overview)==null?void 0:re.rationaleConfidentiality)||"",onChange:s=>o("overview","rationaleConfidentiality",s.target.value),className:"min-h-[80px] border-slate-200 focus:ring-blue-500 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-start pb-6 border-b border-slate-100 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsxs("h4",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),"Integrity"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Guarding against improper information modification or destruction."})]}),e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsx("div",{className:"flex gap-4",children:["low","moderate","high"].map(s=>{var a,r;return e.jsxs("label",{className:`flex-1 border rounded-lg p-3 cursor-pointer transition-all ${((a=i.overview)==null?void 0:a.securityObjectiveIntegrity)===s?"bg-green-50 border-green-500 ring-1 ring-green-500":"hover:bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("input",{type:"radio",name:"integrity",value:s,checked:((r=i.overview)==null?void 0:r.securityObjectiveIntegrity)===s,onChange:l=>o("overview","securityObjectiveIntegrity",l.target.value),className:"h-4 w-4 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"font-bold text-slate-900 capitalize",children:s})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s==="low"&&"Limited adverse effect",s==="moderate"&&"Serious adverse effect",s==="high"&&"Severe/catastrophic adverse effect"]})]},s)})}),e.jsx(v,{placeholder:"Justification for Integrity impact level...",value:((ie=i.overview)==null?void 0:ie.rationaleIntegrity)||"",onChange:s=>o("overview","rationaleIntegrity",s.target.value),className:"min-h-[80px] border-slate-200 focus:ring-green-500 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-start pb-6 border-b border-slate-100 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsxs("h4",{className:"font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-orange-600"}),"Availability"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Ensuring timely and reliable access to and use of information."})]}),e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsx("div",{className:"flex gap-4",children:["low","moderate","high"].map(s=>{var a,r;return e.jsxs("label",{className:`flex-1 border rounded-lg p-3 cursor-pointer transition-all ${((a=i.overview)==null?void 0:a.securityObjectiveAvailability)===s?"bg-orange-50 border-orange-500 ring-1 ring-orange-500":"hover:bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("input",{type:"radio",name:"availability",value:s,checked:((r=i.overview)==null?void 0:r.securityObjectiveAvailability)===s,onChange:l=>o("overview","securityObjectiveAvailability",l.target.value),className:"h-4 w-4 text-orange-600 focus:ring-orange-500"}),e.jsx("span",{className:"font-bold text-slate-900 capitalize",children:s})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s==="low"&&"Limited adverse effect",s==="moderate"&&"Serious adverse effect",s==="high"&&"Severe/catastrophic adverse effect"]})]},s)})}),e.jsx(v,{placeholder:"Justification for Availability impact level...",value:((ne=i.overview)==null?void 0:ne.rationaleAvailability)||"",onChange:s=>o("overview","rationaleAvailability",s.target.value),className:"min-h-[80px] border-slate-200 focus:ring-orange-500 text-sm"})]})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{onClick:()=>L("overview"),disabled:x,className:"bg-blue-600 hover:bg-blue-700",children:[x?e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(k,{className:"h-4 w-4 mr-2"}),"Save Overview"]})})]}),e.jsxs(P,{value:"boundary",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2 mb-8",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"2. System Boundary"}),e.jsx("p",{className:"text-slate-500",children:"Define what's included in and excluded from the system."})]}),e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"Boundary Description"}),e.jsx(w,{children:"Components, interfaces, and data flows within the system boundary"})]}),e.jsx(p,{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Boundary Definition"}),e.jsx(v,{placeholder:"Describe system components, hardware, software, interfaces, and data flows...",value:((ce=i.boundary)==null?void 0:ce.boundaryDescription)||"",onChange:s=>o("boundary","boundaryDescription",s.target.value),className:"min-h-[200px] border-slate-200 focus:ring-blue-500 leading-relaxed py-4"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Architecture Diagram URL"}),e.jsx(C,{placeholder:"Enter URL to system architecture diagram (e.g., Lucidchart, Draw.io)",value:((oe=i.boundary)==null?void 0:oe.diagramUrl)||"",onChange:s=>o("boundary","diagramUrl",s.target.value),className:"border-slate-200 focus:ring-blue-500"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Provide a link to your system architecture diagram for visual reference"})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{onClick:()=>L("boundary"),disabled:x,className:"bg-blue-600 hover:bg-blue-700",children:[x?e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(k,{className:"h-4 w-4 mr-2"}),"Save Boundary"]})})]}),e.jsxs(P,{value:"environment",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2 mb-8",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"3. Operational Environment"}),e.jsx("p",{className:"text-slate-500",children:"Describe where and how the system operates."})]}),e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"Environment Details"}),e.jsx(w,{children:"Physical, technical, and personnel environment"})]}),e.jsx(p,{className:"space-y-6",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Environment Description"}),e.jsx(v,{placeholder:"Describe cloud providers, data centers, personnel access controls...",value:((de=i.environment)==null?void 0:de.environmentDescription)||"",onChange:s=>o("environment","environmentDescription",s.target.value),className:"min-h-[200px] border-slate-200 focus:ring-blue-500 leading-relaxed py-4"})]})})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{onClick:()=>L("environment"),disabled:x,className:"bg-blue-600 hover:bg-blue-700",children:[x?e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(k,{className:"h-4 w-4 mr-2"}),"Save Environment"]})})]}),e.jsxs(P,{value:"controls",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2 mb-8",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"4. Security Requirements"}),e.jsx("p",{className:"text-slate-500",children:"Document the implementation status of NIST 800-172 Enhanced security controls."})]}),e.jsx("div",{className:"space-y-8",children:e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-6 w-6 text-blue-600"}),e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"NIST 800-172 Controls"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(d,{variant:"outline",className:"border-slate-300",onClick:()=>H(!J),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),J?"Cancel":"Add Custom Control"]}),e.jsxs(d,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Save Controls"]})]})]}),e.jsx(w,{children:"Select and document implementation of enhanced security controls"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(C,{placeholder:"Search controls by ID or name...",value:Se,onChange:s=>Ie(s.target.value),className:"border-slate-200 focus:ring-blue-500"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:ke,onChange:s=>Ae(s.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"apt",children:"APT Protection"}),e.jsx("option",{value:"crypto",children:"Cryptographic Protection"}),e.jsx("option",{value:"access",children:"Access Controls"}),e.jsx("option",{value:"integrity",children:"System Integrity"})]}),e.jsxs("select",{value:De,onChange:s=>Ee(s.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"implemented",children:"Implemented"}),e.jsx("option",{value:"partial",children:"Partially Implemented"}),e.jsx("option",{value:"planned",children:"Planned"}),e.jsx("option",{value:"not-applicable",children:"Not Applicable"})]})]})]}),J&&e.jsx(u,{className:"border-blue-200 bg-blue-50/50 mb-6",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(M,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-bold text-blue-900",children:"Create Custom Control"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Control Name *"}),e.jsx(C,{value:I.name,onChange:s=>G("name",s.target.value),placeholder:"Enter control name",className:"border-slate-200 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Category"}),e.jsx(C,{value:I.category,onChange:s=>G("category",s.target.value),placeholder:"e.g., Custom, APT Protection, etc.",className:"border-slate-200 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Description"}),e.jsx(v,{value:I.description,onChange:s=>G("description",s.target.value),placeholder:"Describe the control requirements and purpose...",className:"min-h-[100px] border-slate-200 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(d,{variant:"outline",onClick:()=>H(!1),className:"border-slate-300",children:"Cancel"}),e.jsxs(d,{onClick:Te,className:"bg-blue-600 hover:bg-blue-700",disabled:Q.isPending,children:[Q.isPending?e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(M,{className:"h-4 w-4 mr-2"}),"Create Custom Control"]})]})]})})}),e.jsx("div",{className:"space-y-4",children:ge||ye?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Loading controls..."})]}):q&&q.length>0?q.map(s=>{const a=g==null?void 0:g.find(l=>l.controlId===s.controlId),r=!!a;return e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:l=>Pe(s.controlId,l.target.checked),className:"h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500"}),e.jsxs("label",{className:"font-bold text-slate-900 cursor-pointer",children:[s.controlId," - ",s.name]}),s.category&&e.jsx(U,{className:"bg-blue-100 text-blue-800 border-blue-200 text-xs",children:s.category})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:s.description||"No description available."})]}),e.jsxs("select",{value:(a==null?void 0:a.implementationStatus)||"",onChange:l=>Oe(s.controlId,l.target.value),className:"border border-slate-200 rounded-lg px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select status"}),e.jsx("option",{value:"implemented",children:"Implemented"}),e.jsx("option",{value:"partial",children:"Partially Implemented"}),e.jsx("option",{value:"planned",children:"Planned"}),e.jsx("option",{value:"not-applicable",children:"Not Applicable"})]})]}),r&&e.jsxs("div",{className:"ml-6 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Implementation Details"}),e.jsx(v,{value:(a==null?void 0:a.implementationDescription)||"",onChange:l=>Z(s.controlId,"implementationDescription",l.target.value),placeholder:"Describe how this control is implemented, including tools, processes, and configuration details...",className:"min-h-[100px] border-slate-200 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Responsible Role"}),e.jsx(C,{value:(a==null?void 0:a.responsibleRole)||"",onChange:l=>Z(s.controlId,"responsibleRole",l.target.value),placeholder:"e.g., Security Operations Team, System Administrator",className:"border-slate-200 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-slate-100",children:[e.jsxs("label",{className:"text-sm font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4 text-slate-500"}),"Evidence & Artifacts"]}),(a==null?void 0:a.evidenceLinks)&&a.evidenceLinks.length>0&&e.jsx("div",{className:"space-y-2 mb-3",children:a.evidenceLinks.map(l=>e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 px-3 py-2 rounded text-sm group",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx(Ve,{className:"h-3 w-3 text-blue-500 flex-shrink-0"}),e.jsx("a",{href:l.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline truncate",children:l.name})]}),e.jsx("button",{onClick:()=>Re(s.controlId,l.id),className:"text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ye,{className:"h-4 w-4"})})]},l.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{id:`evidence-name-${s.controlId}`,placeholder:"Description (e.g. Policy Doc)",className:"flex-1 h-8 text-sm"}),e.jsx(C,{id:`evidence-url-${s.controlId}`,placeholder:"URL",className:"flex-1 h-8 text-sm"}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>{const l=document.getElementById(`evidence-name-${s.controlId}`),m=document.getElementById(`evidence-url-${s.controlId}`);l.value&&m.value?(Le(s.controlId,l.value,m.value),l.value="",m.value=""):c.error("Please provide both description and URL")},children:"Add Link"})]})]})]})]},s.id)}):e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-slate-200 rounded-lg",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-full w-fit mx-auto mb-4",children:e.jsx(R,{className:"h-10 w-10 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:"No Controls Found"}),e.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No NIST 800-172 controls found in the database. You can add custom controls using the button above."})]})}),e.jsx(u,{className:"border-slate-200 bg-blue-50/50 border-l-4 border-l-blue-600",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-bold text-blue-900",children:"Implementation Summary"})]}),e.jsx(v,{placeholder:"Provide an overall summary of security controls implementation, including any gaps, compensating controls, or future enhancement plans...",className:"min-h-[120px] border-blue-200 focus:ring-blue-500 bg-white"})]})})})]})]})})]}),e.jsxs(P,{value:"roles",className:"space-y-8 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e.jsxs("div",{className:"space-y-2 mb-8",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"5. Roles & Responsibilities"}),e.jsx("p",{className:"text-slate-500",children:"Define who is responsible for system security."})]}),e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"Security Roles"}),e.jsx(w,{children:"Personnel responsible for system security"})]}),e.jsx(p,{className:"space-y-6",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Roles Description"}),e.jsx(v,{placeholder:"Describe system owner, ISSO, administrators, users, and their responsibilities...",value:((me=i.roles)==null?void 0:me.rolesDescription)||"",onChange:s=>o("roles","rolesDescription",s.target.value),className:"min-h-[200px] border-slate-200 focus:ring-blue-500 leading-relaxed py-4"})]})})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{onClick:()=>L("roles"),disabled:x,className:"bg-blue-600 hover:bg-blue-700",children:[x?e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(k,{className:"h-4 w-4 mr-2"}),"Save Roles"]})})]}),e.jsxs(P,{value:"attachments",className:"space-y-8 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e.jsxs("div",{className:"space-y-2 mb-8",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"6. Attachments & References"}),e.jsx("p",{className:"text-slate-500",children:"Supporting documentation and references."})]}),e.jsxs(u,{className:"border-slate-200 shadow-sm",children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(N,{className:"text-lg font-bold text-slate-900",children:"Supporting Documentation"}),e.jsx(w,{children:"References, policies, and additional documentation"})]}),e.jsx(p,{className:"space-y-6",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Attachments & Notes"}),e.jsx(v,{placeholder:"List supporting documents, policies, procedures, and any additional notes...",value:((xe=i.attachments)==null?void 0:xe.attachmentsNotes)||"",onChange:s=>o("attachments","attachmentsNotes",s.target.value),className:"min-h-[200px] border-slate-200 focus:ring-blue-500 leading-relaxed py-4"})]})})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{onClick:()=>L("attachments"),disabled:x,className:"bg-blue-600 hover:bg-blue-700",children:[x?e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(k,{className:"h-4 w-4 mr-2"}),"Save Attachments"]})})]})]})})]})]})]})}):e.jsx(B,{children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-8 text-center",children:[e.jsx(R,{className:"h-12 w-12 text-yellow-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-yellow-900 mb-2",children:"No SSP Found"}),e.jsxs("p",{className:"text-yellow-700 mb-6",children:["No System Security Plan found for ",T,". Please create an SSP first."]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(Ue,{href:`/clients/${n}/federal`,children:e.jsxs(d,{variant:"outline",className:"border-yellow-600 text-yellow-700 hover:bg-yellow-50",children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Back to Hub"]})}),e.jsxs(d,{onClick:Fe,disabled:x,className:"bg-yellow-600 hover:bg-yellow-700 font-bold",children:[x?e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(M,{className:"h-4 w-4 mr-2"}),"Initialize ",A.toUpperCase()]})]})]})})})}export{zs as default};
