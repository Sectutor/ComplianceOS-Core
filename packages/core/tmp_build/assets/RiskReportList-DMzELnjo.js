import{ab as k,t as o,i as n,j as e,C as R,d as b,e as N,f as w,m as y,N as S,O as T,P as d,Q as i,V as A,W as r,aq as u,E as C,G as D,H as L,J as M,K as a,c as x,F as E}from"./index-DOc7Nwb7.js";import{D as V}from"./DashboardLayout-aHnUqq57.js";import{P}from"./PageGuide-CPKKXXS6.js";import{T as F}from"./trash-Dn_qaYuR.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";function ke(){const p=k(),t=p.id?Number(p.id):0,{data:l,isLoading:j}=o.risks.listReports.useQuery({clientId:t}),m=o.useUtils(),h=o.risks.deleteReport.useMutation({onSuccess:()=>{n.success("Report deleted"),m.risks.listReports.invalidate({clientId:t})},onError:()=>n.error("Failed to delete report")}),g=o.risks.updateReportStatus.useMutation({onSuccess:()=>{n.success("Status updated"),m.risks.listReports.invalidate({clientId:t})},onError:()=>n.error("Failed to update status")}),v=(s,c)=>{g.mutate({clientId:t,reportId:s,status:c})},f=async s=>{confirm("Are you sure you want to delete this report?")&&await h.mutateAsync({clientId:t,reportId:s})};return e.jsx(V,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Risk Reports"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and archive risk management reports."})]}),e.jsx(P,{title:"Risk Reports",description:"Archive and manage generated risk management reports.",rationale:"Maintaining a history of risk reports is crucial for demonstrating compliance over time and tracking improvements.",howToUse:[{step:"View Reports",description:"Access past reports to compare risk postures."},{step:"Manage Status",description:"Track reports through Draft, Review, and Approval stages."},{step:"Export",description:"Download reports for board meetings or audits."}],integrations:[{name:"Risk Assessments",description:"Reports are generated directly from your live assessment data."}]})]}),e.jsxs(R,{children:[e.jsxs(b,{children:[e.jsx(N,{children:"Saved Reports"}),e.jsx(w,{children:"A history of AI-generated and saved risk management reports."})]}),e.jsx(y,{children:e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(d,{children:[e.jsx(i,{children:"Title"}),e.jsx(i,{children:"Version"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Created At"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsx(A,{children:j?e.jsx(d,{children:e.jsx(r,{colSpan:5,className:"text-center py-4",children:"Loading reports..."})}):!l||l.length===0?e.jsx(d,{children:e.jsxs(r,{colSpan:5,className:"text-center py-4 text-muted-foreground",children:["No saved reports found.",e.jsx("br",{}),"Go to the ",e.jsx(u,{href:`/clients/${t}/risks/report/new`,className:"text-primary hover:underline",children:"Draft Editor"})," to create one."]})}):l.map(s=>e.jsxs(d,{children:[e.jsx(r,{className:"font-medium",children:s.title||"Untitled Report"}),e.jsxs(r,{children:["v",s.version]}),e.jsx(r,{children:e.jsxs(C,{defaultValue:s.status||"draft",onValueChange:c=>v(s.id,c),children:[e.jsx(D,{className:"w-[130px] h-8",children:e.jsx(L,{})}),e.jsxs(M,{children:[e.jsx(a,{value:"draft",children:"Draft"}),e.jsx(a,{value:"review",children:"In Review"}),e.jsx(a,{value:"approved",children:"Approved"}),e.jsx(a,{value:"published",children:"Published"}),e.jsx(a,{value:"archived",children:"Archived"})]})]})}),e.jsx(r,{children:new Date(s.createdAt||new Date).toLocaleDateString()}),e.jsxs(r,{className:"text-right",children:[e.jsx(u,{href:`/clients/${t}/risks/report/${s.id}`,children:e.jsxs(x,{variant:"ghost",size:"sm",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Open"]})}),e.jsx(x,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>f(s.id),disabled:h.isLoading,children:e.jsx(F,{className:"w-4 h-4"})})]})]},s.id))})]})})]})]})})}export{ke as default};
