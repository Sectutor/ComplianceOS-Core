import{r as n,b as S,u as M,t as Z,j as e,x as A,C as f,d as b,e as j,f as p,m as w,ay as v,c as l,L as N,I as y,i as C}from"./index-DOc7Nwb7.js";function z(){const[x,u]=n.useState(""),[h,I]=n.useState(""),[g,o]=n.useState(!1),[,i]=S(),{user:t,signIn:P,signOut:L}=M();n.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("email");s&&u(decodeURIComponent(s))},[]);const{data:c,isLoading:d,isError:m,error:r}=Z.users.me.useQuery(void 0,{enabled:!!t,retry:!1});n.useEffect(()=>{if(t&&!d){if(m){console.error("Profile fetch failed:",r);return}const s=new URLSearchParams(window.location.search).get("invite");c&&!c.hasSeenTour?i(s?`/auth/redeem-link?token=${s}`:"/start-here"):i(s?`/auth/redeem-link?token=${s}`:"/dashboard")}},[t,c,d,i,m,r]);const k=async a=>{a.preventDefault(),o(!0);try{await P(x,h),C.success("Logged in successfully")}catch(s){C.error(s.message||"Failed to login"),o(!1)}};return t&&d?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#002a40]",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-emerald-500"})}):t&&m?e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-[#002a40] p-4",children:e.jsxs(f,{className:"w-full max-w-md bg-[#001e2b] border-red-900/50 shadow-2xl",children:[e.jsxs(b,{children:[e.jsx(j,{className:"text-red-500",children:"Authentication Error"}),e.jsx(p,{className:"text-slate-400",children:"We verified your credentials, but could not load your profile."})]}),e.jsx(w,{children:e.jsx("div",{className:"p-3 bg-red-950/30 rounded border border-red-900/50 text-red-200 text-sm font-mono break-all",children:(r==null?void 0:r.message)||"Unknown error occurred"})}),e.jsx(v,{children:e.jsx(l,{onClick:()=>{L(),o(!1)},variant:"destructive",className:"w-full",children:"Sign Out & Try Again"})})]})}):e.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-[#002a40]",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyI+PGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iMiIvPjwvZz48L2c+PC9zdmc+')] opacity-20"}),e.jsxs(f,{className:"w-full max-w-md relative z-10 bg-[#001e2b] border-slate-700 shadow-2xl",children:[e.jsxs(b,{className:"text-center space-y-1",children:[e.jsx("div",{className:"mx-auto h-12 w-12 rounded-xl bg-[#0ea5e9] flex items-center justify-center text-white mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-7 w-7",children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})})}),e.jsx(j,{className:"text-2xl font-bold text-white",children:"Welcome Back"}),e.jsx(p,{className:"text-slate-400",children:"Sign in to your GRCompliance account"})]}),e.jsxs("form",{onSubmit:k,children:[e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"email",className:"text-slate-300",children:"Email"}),e.jsx(y,{id:"email",type:"email",placeholder:"name@company.com",value:x,onChange:a=>u(a.target.value),required:!0,className:"bg-[#002a40] border-slate-600 text-white placeholder:text-slate-500 focus:border-[#0ea5e9] hover:bg-[#003554] transition-colors"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{htmlFor:"password",className:"text-slate-300",children:"Password"}),e.jsx(l,{variant:"link",className:"px-0 font-normal h-auto text-[#0ea5e9] hover:text-[#0284c7]",type:"button",children:"Forgot password?"})]}),e.jsx(y,{id:"password",type:"password",value:h,onChange:a=>I(a.target.value),required:!0,className:"bg-[#002a40] border-slate-600 text-white placeholder:text-slate-500 focus:border-[#0ea5e9] hover:bg-[#003554] transition-colors"})]})]}),e.jsxs(v,{className:"flex flex-col space-y-4 pb-8",children:[e.jsx(l,{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white h-11 font-medium text-lg border-none",disabled:g,children:g?"Signing in...":"Sign In"}),e.jsxs("div",{className:"text-center text-sm text-slate-400",children:["Don't have an account?"," ",e.jsx(l,{variant:"link",type:"button",className:"px-0 font-semibold text-[#0ea5e9] hover:text-[#0284c7]",onClick:()=>i("/signup"),children:"Sign up"})]})]})]})]})]})}export{z as default};
