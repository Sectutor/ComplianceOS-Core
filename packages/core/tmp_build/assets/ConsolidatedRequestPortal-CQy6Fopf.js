import{ab as C,t as n,i as m,j as e,S as o,C as h,m as p,z as k,c as l,d as S,e as U,F as u,k as q,l as D}from"./index-DOc7Nwb7.js";import{P as A}from"./progress-B-1k4ZZX.js";import{c as r}from"./utils-BC5CVi_C.js";import{L as R}from"./lock-czWF3qbC.js";import{C as P}from"./clock-osbacZli.js";import{C as g}from"./circle-check-big-BSqJVrgh.js";import{U as j}from"./upload-BBmUECj8.js";import{E as F}from"./external-link-C3PXjBR9.js";function $(){const{token:a}=C(),f=n.useContext(),{data:c,isLoading:b,error:N}=n.vendorAssessments.getConsolidatedRequest.useQuery({token:a||""},{enabled:!!a,retry:!1}),w=n.vendorAssessments.submitConsolidatedDocument.useMutation({onSuccess:()=>{m.success("Document uploaded successfully"),f.vendorAssessments.getConsolidatedRequest.invalidate({token:a})},onError:s=>m.error("Upload failed: "+s.message)});if(b)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-50 gap-4",children:[e.jsx(o,{className:"w-12 h-12 text-indigo-600 animate-pulse"}),e.jsx("p",{className:"text-slate-500 font-medium animate-pulse",children:"Loading secure portal..."})]});if(N||!c)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:e.jsx(h,{className:"max-w-md w-full border-red-100 shadow-xl",children:e.jsxs(p,{className:"pt-8 text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-red-50 rounded-full flex items-center justify-center",children:e.jsx(k,{className:"w-8 h-8 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Access Denied"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"This link is invalid, expired, or has already been used."})]}),e.jsx(l,{variant:"outline",className:"w-full",onClick:()=>window.location.reload(),children:"Retry"})]})})});const{request:t,vendorName:v}=c,x=t.items.filter(s=>s.status==="completed").length,i=x/t.items.length*100,y=s=>{const d=`https://storage.grcompliance.com/files/${Math.random().toString(36).substring(7)}.pdf`;w.mutate({token:a,itemName:s,fileUrl:d})};return e.jsxs("div",{className:"min-h-screen bg-slate-50/50 selection:bg-indigo-100 selection:text-indigo-900",children:[e.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-10 backdrop-blur-md bg-white/80",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 h-20 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-200",children:e.jsx(o,{className:"text-white w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-slate-900 to-slate-600",children:"ComplianceOS"}),e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-slate-100 text-slate-500 text-[10px] uppercase font-bold tracking-widest rounded-md",children:"Secure Portal"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Recipient"}),e.jsx("p",{className:"text-sm font-semibold text-slate-700",children:t.recipientEmail})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center",children:e.jsx(R,{className:"w-4 h-4 text-slate-400"})})]})]})}),e.jsx("main",{className:"max-w-5xl mx-auto px-6 py-12",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm space-y-4 text-left",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Data Request"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"From the compliance team at Your Organization"})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-600",children:[e.jsx(P,{className:"w-4 h-4 text-indigo-500"}),e.jsxs("span",{children:["Due: ",t.expiresAt?new Date(t.expiresAt).toLocaleDateString():"No deadline"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-600",children:[e.jsx(o,{className:"w-4 h-4 text-indigo-500"}),e.jsxs("span",{children:["Vendor: ",v]})]})]}),t.message&&e.jsxs("div",{className:"mt-4 p-4 bg-indigo-50 rounded-xl border border-indigo-100 italic text-sm text-indigo-700 leading-relaxed",children:['"',t.message,'"']})]}),e.jsxs(h,{className:"rounded-2xl border-indigo-100 bg-gradient-to-br from-white to-indigo-50/30 overflow-hidden text-left",children:[e.jsx(S,{className:"p-6 pb-2",children:e.jsx(U,{className:"text-sm font-bold uppercase tracking-wider text-slate-400",children:"Total Completion"})}),e.jsxs(p,{className:"p-6 pt-0 space-y-4",children:[e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("span",{className:"text-4xl font-extrabold text-indigo-600",children:[Math.round(i),"%"]}),e.jsxs("span",{className:"text-sm font-semibold text-slate-500 mb-1",children:[x," of ",t.items.length," items"]})]}),e.jsx(A,{value:i,className:"h-3 bg-indigo-100 rounded-full overflow-hidden"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4 text-left",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2 mb-4 px-2",children:[e.jsx(g,{className:"w-5 h-5 text-emerald-500"}),"Required Items (",t.items.length,")"]}),t.items.map((s,d)=>e.jsxs("div",{className:r("group relative bg-white p-6 rounded-2xl border transition-all duration-300 hover:shadow-lg hover:shadow-slate-200/50",s.status==="completed"?"border-emerald-100 bg-emerald-50/10":"border-slate-200"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:r("w-12 h-12 rounded-xl flex items-center justify-center shrink-0 transition-transform duration-300 group-hover:scale-110",s.status==="completed"?"bg-emerald-100":"bg-slate-100"),children:s.type==="questionnaire"?e.jsx(u,{className:r("w-6 h-6",s.status==="completed"?"text-emerald-600":"text-slate-500")}):e.jsx(j,{className:r("w-6 h-6",s.status==="completed"?"text-emerald-600":"text-slate-500")})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:s.name}),s.status==="completed"&&e.jsx(q,{className:"bg-emerald-500 text-white border-none text-[10px]",children:"Submitted"})]}),e.jsx("p",{className:"text-sm text-slate-500",children:s.type==="questionnaire"?"Complete the online security assessment form.":"Upload a PDF or document version of this evidence."})]})]}),s.status==="completed"?e.jsx("div",{className:"bg-emerald-100 text-emerald-600 p-2 rounded-full",children:e.jsx(D,{className:"w-5 h-5"})}):s.type==="questionnaire"?e.jsxs(l,{onClick:()=>window.open(`/portal/assessment/${s.token||""}`,"_blank"),className:"bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-lg shadow-indigo-100",children:["Start ",e.jsx(F,{className:"w-4 h-4 ml-2"})]}):e.jsxs(l,{variant:"outline",onClick:()=>y(s.name),className:"rounded-xl border-slate-200 hover:border-indigo-500 hover:bg-indigo-50 hover:text-indigo-600",children:["Upload ",e.jsx(j,{className:"w-4 h-4 ml-2"})]})]}),s.fileUrl&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs text-slate-400 bg-slate-50 p-2 rounded-lg",children:[e.jsx(u,{className:"w-3 h-3"}),"Uploaded: ",s.fileUrl.split("/").pop()]})]},d)),i===100&&e.jsxs("div",{className:"mt-8 p-12 bg-white rounded-3xl border-2 border-dashed border-emerald-200 flex flex-col items-center justify-center text-center space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(g,{className:"w-10 h-10 text-emerald-600"})}),e.jsxs("div",{className:"max-w-xs",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"All Done!"}),e.jsx("p",{className:"text-slate-500 mt-2 text-sm leading-relaxed",children:"Thank you for providing the requested information. The compliance team has been notified."})]}),e.jsx(l,{className:"bg-slate-900 text-white rounded-xl px-8",onClick:()=>window.close(),children:"Close Portal"})]})]})]})}),e.jsxs("footer",{className:"mt-20 border-t border-slate-200 pt-8 pb-12 text-center text-slate-400 text-xs",children:["Â© ",new Date().getFullYear()," ComplianceOS Security. All rights reserved. ",e.jsx("br",{}),"Secure end-to-end encryption active."]})]})}export{$ as default};
