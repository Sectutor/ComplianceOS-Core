import{r as b,t as h,i as l,j as e,l as D,C as I,d as P,e as k,f as F,m as V,L as n,I as N,E as u,G as p,H as j,J as g,K as r,F as M,c as m,ay as T,aa as E,b as L,ab as U}from"./index-DOc7Nwb7.js";import{T as q}from"./textarea-BtxBxzdY.js";import{B as z}from"./brain-C-Zi22rJ.js";import{S as B}from"./shield-alert-iAruRy4W.js";import{S as R}from"./send-FW7-3cjH.js";import{P as $}from"./PageGuide-CPKKXXS6.js";import"./scroll-area-DPaNxEJD.js";import"./separator-BWuYil37.js";import"./book-open-BffBrdze.js";import"./link-FmUqdGRG.js";import"./info-By5wLOUH.js";function H({clientId:c,onComplete:x,onCancel:d}){const[t,o]=b.useState(1),[a,i]=b.useState({name:"",website:"",category:"SaaS",description:"",criticality:"Low",contactEmail:"",dataCategories:[],transferMechanism:"None",dpaStatus:"Needed",templateId:null,usesAi:!1,isAiService:!1,aiDataUsage:""}),[v,S]=b.useState(null),y=h.vendors.create.useMutation({onSuccess:s=>{S(s.id),o(2),l.success("Vendor profile created")},onError:s=>l.error("Failed to create vendor: "+s.message)}),C=h.vendorAuthorizations.initiate.useMutation({onSuccess:()=>{o(4),l.success("Authorization workflow started")},onError:s=>l.error("Failed to start workflow: "+s.message)}),w=h.vendorDpas.createFromTemplate.useMutation({onSuccess:()=>{l.success("DPA generated from template")},onError:s=>l.error("Failed to generate DPA: "+s.message)}),{data:f}=h.dpaTemplates.list.useQuery(),A=()=>{if(t===1){if(!a.name)return l.error("Name is required");y.mutate({clientId:c,name:a.name,website:a.website,category:a.category,description:a.description,criticality:a.criticality,status:"Onboarding",usesAi:a.usesAi,isAiService:a.isAiService,aiDataUsage:a.aiDataUsage})}else t===2?o(3):t===3?v?(a.templateId&&w.mutate({clientId:c,vendorId:v,templateId:a.templateId,name:`${a.name} DPA - ${new Date().toLocaleDateString()}`}),C.mutate({vendorId:v,clientId:c})):o(4):x()};return e.jsxs("div",{className:"w-full !p-6 max-w-none",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsx("div",{className:"absolute left-0 top-1/2 w-full h-0.5 bg-slate-200 -z-10"}),[1,2,3,4].map(s=>e.jsxs("div",{className:`flex flex-col items-center gap-2 bg-white px-2 ${t>=s?"text-blue-600":"text-slate-400"}`,children:[e.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center border-2 ${t>=s?"bg-blue-50 border-blue-600 font-bold":"bg-white border-slate-300"}`,children:t>s?e.jsx(D,{className:"h-4 w-4"}):s}),e.jsx("span",{className:"text-xs font-medium",children:s===1?"Profile":s===2?"Data Impact":s===3?"Legal":"Finish"})]},s))]})}),e.jsxs(I,{className:"w-full max-w-none",children:[e.jsxs(P,{children:[e.jsxs(k,{children:[t===1&&"Vendor Profile",t===2&&"Data Impact Assessment",t===3&&"Legal & Compliance",t===4&&"Authorization Sent"]}),e.jsxs(F,{children:[t===1&&"Basic information to identify the subprocessor.",t===2&&"Map the data flows and categories processed.",t===3&&"Ensure necessary agreements like DPAs are in place.",t===4&&"The onboarding request is now pending approval."]})]}),e.jsxs(V,{className:"space-y-4",children:[t===1&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Vendor Name"}),e.jsx(N,{value:a.name,onChange:s=>i({...a,name:s.target.value}),placeholder:"e.g. AWS"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Website"}),e.jsx(N,{value:a.website,onChange:s=>i({...a,website:s.target.value}),placeholder:"https://..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx(q,{value:a.description,onChange:s=>i({...a,description:s.target.value}),placeholder:"What service do they provide?"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Category"}),e.jsxs(u,{value:a.category,onValueChange:s=>i({...a,category:s}),children:[e.jsx(p,{children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(r,{value:"SaaS",children:"SaaS"}),e.jsx(r,{value:"IaaS",children:"IaaS"}),e.jsx(r,{value:"Service",children:"Service Provider"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Criticality"}),e.jsxs(u,{value:a.criticality,onValueChange:s=>i({...a,criticality:s}),children:[e.jsx(p,{children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(r,{value:"Low",children:"Low"}),e.jsx(r,{value:"Medium",children:"Medium"}),e.jsx(r,{value:"High",children:"High"})]})]})]})]}),e.jsxs("div",{className:"p-4 bg-primary/5 border border-primary/20 rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(z,{className:"h-5 w-5 text-primary"}),e.jsx("h4",{className:"font-bold text-primary",children:"AI-Specific Governance"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.usesAi,onChange:s=>i({...a,usesAi:s.target.checked}),className:"rounded border-slate-300"}),e.jsx("span",{className:"text-sm font-medium",children:"Uses AI in Service"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.isAiService,onChange:s=>i({...a,isAiService:s.target.checked}),className:"rounded border-slate-300"}),e.jsx("span",{className:"text-sm font-medium",children:"Core AI Service Provider"})]})]}),(a.usesAi||a.isAiService)&&e.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-1",children:[e.jsx(n,{children:"AI Data Usage (MAP 1.5)"}),e.jsx(N,{value:a.aiDataUsage,onChange:s=>i({...a,aiDataUsage:s.target.value}),placeholder:"e.g. Inputs used for training, Zero retention, etc."})]})]})]}),t===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-slate-50 border rounded-lg",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-2"})," Data Categories"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Contact Info","Financial Data","Health Data","Employee Data","Customer Content","Technical Logs"].map(s=>e.jsxs("label",{className:"flex items-center space-x-2 border p-2 rounded bg-white cursor-pointer hover:bg-slate-50",children:[e.jsx("input",{type:"checkbox",className:"rounded border-slate-300"}),e.jsx("span",{className:"text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Data Transfer Mechanism (Cross-Border)"}),e.jsxs(u,{value:a.transferMechanism,onValueChange:s=>i({...a,transferMechanism:s}),children:[e.jsx(p,{children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(r,{value:"None",children:"None (In-Region)"}),e.jsx(r,{value:"SCCs",children:"Standard Contractual Clauses (SCCs)"}),e.jsx(r,{value:"DPF",children:"Data Privacy Framework (DPF)"}),e.jsx(r,{value:"Adequacy",children:"Adequacy Decision"})]})]})]})]}),t===3&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border border-dashed border-slate-300 rounded-lg p-8 text-center bg-slate-50",children:[e.jsx(M,{className:"h-10 w-10 text-slate-400 mx-auto mb-2"}),e.jsx("h4",{className:"font-medium text-slate-900",children:"Data Processing Agreement (DPA)"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Upload the signed DPA or select a standard template to generate one."}),e.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[e.jsx(n,{children:"Select Template"}),e.jsxs(u,{value:String(a.templateId||""),onValueChange:s=>i({...a,templateId:Number(s)}),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Standard Templates"})}),e.jsx(g,{children:f==null?void 0:f.map(s=>e.jsxs(r,{value:String(s.id),children:[s.name," (",s.jurisdiction,")"]},s.id))})]})]}),e.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[e.jsx(m,{variant:"outline",size:"sm",children:"Upload PDF"}),e.jsx(m,{variant:"outline",size:"sm",children:"Preview Selected"})]})]})}),t===4&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"h-16 w-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(R,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Request Initiated!"}),e.jsxs("p",{className:"text-slate-500 max-w-md mx-auto mt-2",children:["The new subprocessor ",e.jsx("strong",{children:a.name}),' has been added in "Onboarding" status. An authorization request has been logged.']})]})]}),e.jsx(T,{className:"flex justify-between",children:t<4?e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"outline",onClick:t===1?d:()=>o(t-1),children:t===1?"Cancel":"Back"}),e.jsxs(m,{onClick:A,children:[t===3?"Submit Request":"Next"," ",e.jsx(E,{className:"ml-2 h-4 w-4"})]})]}):e.jsx(m,{className:"w-full",onClick:x,children:"Return to Vendors"})})]})]})}function se(){const[,c]=L(),{id:x}=U(),d=parseInt(x||"0");return d?e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"!p-0 space-y-6",children:[e.jsx("div",{className:"p-6 pb-0",children:e.jsx($,{title:"Vendor Onboarding",description:"Step-by-step qualification for new vendors.",rationale:"Ensure compliance and security due diligence before data is shared.",howToUse:[{step:"Profile",description:"Enter business details and contact info."},{step:"Screening",description:"Check against sanctions and watchlists."},{step:"Assessment",description:"Send security questionnaires (SIG/CAIQ)."}]})}),e.jsx(H,{clientId:d,onComplete:()=>c(`/clients/${d}/vendors/overview`),onCancel:()=>c(`/clients/${d}/vendors/overview`)})]})}):e.jsx("div",{children:"Invalid Client ID"})}export{se as default};
