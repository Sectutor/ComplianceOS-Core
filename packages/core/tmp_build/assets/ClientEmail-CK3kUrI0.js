import{M,R as G,j as e,c as j,F as O,t as h,I as K,r as y,D as X,o as Z,q as J,s as W,a4 as F,k as U,au as Y}from"./index-DOc7Nwb7.js";import{c as v}from"./utils-BC5CVi_C.js";import{P as ee}from"./plus-BaQ35Jcx.js";import{T}from"./trash-2-CFEfisbM.js";import{A as B}from"./archive-D1rnNb-W.js";import{S as te}from"./send-FW7-3cjH.js";import{I as R,k as se,a as ae,c as le,e as re,f as ie,D as ne}from"./DashboardLayout-aHnUqq57.js";import{M as oe}from"./mail-xRDvl6QK.js";import{S as H}from"./star-BTvaCCU4.js";import{S as ce}from"./search-CwuIBBPE.js";import{A as de}from"./arrow-left-CpuUojG-.js";import{f as xe}from"./format-H2tx8_vS.js";import{u as me}from"./index.esm-BxsGsA2t.js";import{L as ue}from"./list-BZOuFwEg.js";import{L as he}from"./link-FmUqdGRG.js";import"./index--2vFva6Y.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./differenceInCalendarDays-nctqlg7V.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=M("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=M("CornerUpRight",[["polyline",{points:"15 14 20 9 15 4",key:"1tbx3s"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=M("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=M("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=M("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=M("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]),ye={inbox:R,send:te,file:O,archive:B,trash:T};function Ne({currentFolder:r,categories:m,onFolderChange:u,onCompose:x,children:l,onDropEmail:p}){const[s,a]=G.useState(null);return e.jsxs("div",{className:"flex h-full bg-[#f5f5f7]",children:[" ",e.jsxs("div",{className:"w-60 flex-shrink-0 bg-[#f5f5f7] flex flex-col h-full pt-3",children:[e.jsx("div",{className:"px-4 mb-6",children:e.jsxs(j,{onClick:x,className:"w-full bg-blue-600 hover:bg-blue-700 text-white gap-2 shadow-sm rounded-lg",children:[e.jsx(ee,{size:18}),"New Email"]})}),e.jsxs("nav",{className:"flex-1 px-3 space-y-6 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Mailboxes"}),e.jsx("div",{className:"space-y-0.5",children:m.map(i=>{const f=ye[i.icon]||oe,n=r===i.id,g=s===i.id;return e.jsx("button",{onClick:()=>u(i.id),onDragOver:o=>{o.preventDefault(),o.dataTransfer.dropEffect="move",s!==i.id&&a(i.id)},onDragLeave:()=>a(null),onDrop:o=>{o.preventDefault(),a(null);const b=o.dataTransfer.getData("text/plain");b&&p&&p(b,i.id)},className:v("w-full flex items-center justify-between px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200",n?"bg-gray-200/60 text-gray-900":"text-gray-600 hover:bg-gray-200/40",g&&"bg-blue-100 ring-2 ring-blue-500 ring-inset z-10 scale-[1.02]"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{size:16,className:v(n?"text-blue-600":"text-gray-500")}),i.label]})},i.id)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Favorites"}),e.jsxs("div",{className:"space-y-0.5 opacity-60",children:[e.jsxs("div",{className:"px-3 py-1.5 text-sm text-gray-600 flex items-center gap-3 cursor-not-allowed",children:[e.jsx(H,{size:16})," VIPs"]}),e.jsxs("div",{className:"px-3 py-1.5 text-sm text-gray-600 flex items-center gap-3 cursor-not-allowed",children:[e.jsx(O,{size:16})," Flagged"]})]})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0 h-full overflow-hidden",children:l})]})}function we({emails:r,selectedId:m,onSelect:u,onSearch:x}){const l=h.useUtils(),p=h.email.toggleStar.useMutation({onSuccess:()=>l.email.list.invalidate()});return e.jsxs("div",{className:"flex flex-col h-full bg-white",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(K,{placeholder:"Search emails...",className:"pl-9 bg-gray-50 border-gray-200 focus:bg-white transition-colors",onChange:s=>x(s.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-2 space-y-1",children:r.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500 text-sm",children:"No emails found"}):r.map(s=>{const a=m===s.id,i=!s.isRead,f=(s.from||"?").slice(0,2).toUpperCase();return e.jsxs("div",{draggable:!0,onDragStart:n=>{n.dataTransfer.setData("text/plain",s.id.toString()),n.dataTransfer.effectAllowed="move"},onClick:()=>u(s.id),className:v("relative group cursor-pointer p-3 rounded-lg transition-all duration-200 border border-transparent select-none",a?"bg-blue-600 shadow-md text-white border-blue-500/50":"bg-white hover:bg-gray-50 border-gray-100 hover:border-gray-200 hover:shadow-sm text-gray-900 active:scale-[0.99] transition-transform"),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:v("flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold",a?"bg-white/20 text-white":"bg-gray-100 text-gray-600"),children:f}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-0.5",children:[e.jsx("span",{className:v("text-sm truncate pr-2",a?"font-semibold text-white":i?"font-bold text-gray-900":"font-medium text-gray-900"),children:s.from||"(No Sender)"}),e.jsx("span",{className:v("text-[10px] whitespace-nowrap",a?"text-blue-100":"text-gray-400"),children:s.createdAt?se(new Date(s.createdAt),{addSuffix:!0}):""})]}),e.jsx("div",{className:v("text-xs mb-1 truncate",a?"text-blue-50 font-medium":i?"font-semibold text-gray-800":"text-gray-600"),children:s.subject||"(No Subject)"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:v("text-xs truncate max-w-[90%]",a?"text-blue-100":"text-gray-400"),children:s.snippet||"No preview available"}),e.jsx("button",{onClick:n=>{n.stopPropagation(),p.mutate({clientId:s.clientId,id:s.id})},className:v("transition-colors",s.isStarred?"text-yellow-400":a?"text-blue-400 hover:text-white":"text-gray-200 hover:text-yellow-400"),children:e.jsx(H,{size:14,fill:s.isStarred?"currentColor":"none"})})]})]})]}),i&&!a&&e.jsx("div",{className:"absolute left-2 top-1/2 -ml-3 w-1.5 h-1.5 bg-blue-600 rounded-full"})]},s.id)})})]})}function ke({emailId:r,clientId:m,onBack:u,onDelete:x}){const{data:l,isLoading:p}=h.email.get.useQuery({clientId:m,id:r}),s=h.email.move.useMutation({onSuccess:x}),a=h.email.permanentDelete.useMutation({onSuccess:x}),i=h.email.restore.useMutation({onSuccess:x});if(p)return e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"Loading..."});if(!l)return e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"Select an email to read"});const f=()=>s.mutate({clientId:m,id:r,folder:"archive"}),n=()=>s.mutate({clientId:m,id:r,folder:"inbox"}),g=()=>s.mutate({clientId:m,id:r,folder:"trash"}),o=()=>{confirm("Are you sure you want to permanently delete this email? This cannot be undone.")&&a.mutate({clientId:m,id:r})};return e.jsxs("div",{className:"flex flex-col h-full w-full bg-[#f5f5f7]",children:[e.jsxs("div",{className:"px-6 py-3 border-b border-gray-200/50 flex justify-between items-center bg-[#f5f5f7] sticky top-0 z-10 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{variant:"ghost",size:"icon",className:"md:hidden",onClick:u,children:e.jsx(de,{size:18})}),e.jsx("div",{className:"flex gap-2",children:l.folder==="trash"?e.jsxs(e.Fragment,{children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>i.mutate({clientId:m,id:r}),className:"gap-2",children:[e.jsx(R,{size:16})," Restore"]}),e.jsxs(j,{variant:"ghost",size:"sm",onClick:o,className:"gap-2 text-red-600 hover:bg-red-50 hover:text-red-700",children:[e.jsx(T,{size:16})," Delete Forever"]})]}):l.folder==="archive"?e.jsxs(e.Fragment,{children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:n,className:"gap-2",children:[e.jsx(R,{size:16})," Move to Inbox"]}),e.jsx(j,{variant:"ghost",size:"icon",title:"Trash",onClick:g,className:"hover:bg-white/60 hover:text-red-600",children:e.jsx(T,{size:18})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(j,{variant:"ghost",size:"sm",className:"gap-2 hover:bg-white/60",children:[e.jsx(je,{size:16})," Reply"]}),e.jsx(j,{variant:"ghost",size:"icon",title:"Archive",onClick:f,className:"hover:bg-white/60",children:e.jsx(B,{size:18})}),e.jsx(j,{variant:"ghost",size:"icon",title:"Delete",onClick:g,className:"hover:bg-white/60 hover:text-red-600",children:e.jsx(T,{size:18})})]})})]}),e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:l.createdAt?xe(new Date(l.createdAt),"MMM d, h:mm a"):""})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-8 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-4xl bg-white rounded-xl shadow-sm border border-gray-100 min-h-[500px] flex flex-col relative overflow-hidden",children:[e.jsx("div",{className:"h-1 bg-gradient-to-r from-blue-500 to-indigo-500 w-full"}),e.jsxs("div",{className:"p-8 md:p-10",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-8 leading-tight tracking-tight",children:l.subject}),e.jsxs("div",{className:"flex items-center gap-4 mb-10",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold text-lg shadow-sm",children:(l.from||"?")[0].toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-baseline justify-between",children:e.jsx("div",{className:"font-semibold text-gray-900 text-lg",children:l.from})}),e.jsxs("div",{className:"text-sm text-gray-500 truncate",children:["To: ",e.jsx("span",{className:"text-gray-700",children:(l.to||[]).join(", ")})]})]})]}),e.jsx("div",{className:"h-px bg-gray-100 w-full mb-10"}),e.jsx("div",{className:"prose prose-gray max-w-none text-gray-800 leading-relaxed",dangerouslySetInnerHTML:{__html:l.body||""}})]}),e.jsx("div",{className:"mt-auto p-8 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-xs text-gray-400 bg-gray-50 px-3 py-1 rounded-full",children:[e.jsx(fe,{size:12}),"End of message"]})})]})})]})}function Ce({clientId:r,isOpen:m,onClose:u}){const{register:x,handleSubmit:l,reset:p,setValue:s,watch:a,formState:{errors:i}}=me(),f=h.useUtils(),n=y.useRef(null),g=y.useRef(null),[o,b]=y.useState([]),[c,D]=y.useState(""),[w,N]=y.useState(!1),{data:k=[]}=h.communication.searchRecipients.useQuery({clientId:r,query:c},{enabled:w}),P=h.email.createDraft.useMutation(),Q=h.email.send.useMutation({onSuccess:()=>{f.email.list.invalidate(),z()}}),C=(t,d=void 0)=>{document.execCommand(t,!1,d),n.current&&(n.current.focus(),s("body",n.current.innerHTML))},q=()=>{const t=prompt("Enter the URL:","https://");t&&t!=="https://"&&C("createLink",t)},z=()=>{u(),setTimeout(()=>{b([]),p(),D(""),n.current&&(n.current.innerHTML="")},200)},V=async t=>{var I;const d=o.map(_=>_.email);if(c&&c.includes("@")&&!d.includes(c)&&d.push(c),d.length===0){alert("Please select at least one recipient");return}const $=((I=n.current)==null?void 0:I.innerHTML)||"",A=await P.mutateAsync({clientId:r,subject:t.subject,to:d,body:$});A&&await Q.mutateAsync({clientId:r,id:A.id})},L=t=>{o.find(d=>d.email===t.email)||b([...o,t]),D(""),N(!1)},E=t=>{b(o.filter(d=>d.email!==t))};return e.jsx(X,{open:m,onOpenChange:t=>!t&&z(),children:e.jsxs(Z,{className:"max-w-2xl bg-white p-0 gap-0 rounded-[10px] shadow-2xl border-none overflow-hidden font-sans [&>button]:hidden",children:[e.jsx(J,{className:"sr-only",children:"New Message"}),e.jsx(W,{className:"sr-only",children:"Compose a new email message to internal users, employees, or contacts."}),e.jsxs("div",{className:"px-6 py-4.5 bg-slate-50 border-b border-slate-200 flex justify-between items-center h-16",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 m-0",children:"New Message"}),e.jsx("button",{onClick:z,className:"text-slate-500 hover:bg-slate-200 hover:text-slate-800 p-1.5 rounded transition-colors","aria-label":"Close",children:e.jsx(F,{size:20})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:l(V),children:[e.jsxs("div",{className:"mb-5 relative z-20",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"To:"}),e.jsxs("div",{className:"w-full min-h-[42px] px-3 py-2 border border-slate-300 rounded-md bg-white focus-within:ring-2 focus-within:ring-blue-500/20 focus-within:border-blue-500 transition-colors flex flex-wrap gap-2 items-center shadow-sm cursor-text",onClick:()=>{var t;return(t=g.current)==null?void 0:t.focus()},children:[o.map(t=>e.jsxs(U,{variant:"secondary",className:"pl-2 pr-1 h-6 flex items-center gap-1 bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200",children:[e.jsx("span",{children:t.name}),e.jsx("button",{type:"button",onClick:d=>{d.stopPropagation(),E(t.email)},className:"ml-0.5 hover:bg-slate-300 rounded-full p-0.5",children:e.jsx(F,{className:"h-3 w-3"})})]},t.email)),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{ref:g,type:"text",className:"w-full bg-transparent min-w-[150px] outline-none text-sm text-slate-800 placeholder:text-slate-400",placeholder:o.length===0?"Type email or search contacts...":"Add more...",value:c,onChange:t=>{D(t.target.value),t.target.value.length>0&&N(!0)},onFocus:()=>{(c.length>0||k.length>0)&&N(!0)},onBlur:()=>{setTimeout(()=>N(!1),200)},onKeyDown:t=>{if((t.key==="Enter"||t.key===",")&&c.trim()){t.preventDefault();const d=c.trim().replace(/,$/,"");d.includes("@")?L({name:d,email:d,type:"contact"}):d.length>0&&alert("Please enter a valid email address (e.g., user@example.com)")}t.key==="Backspace"&&!c&&o.length>0&&E(o[o.length-1].email),t.key==="Escape"&&N(!1)},autoComplete:"off"}),w&&(c.length>0||k.length>0)&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-[400px] z-50 max-h-[300px] overflow-auto shadow-xl border border-slate-200 bg-white rounded-md",children:e.jsx(ae,{shouldFilter:!1,children:e.jsxs(le,{children:[k.length===0&&c.length>0&&c.includes("@")?e.jsxs("div",{className:"py-3 px-4 text-sm text-slate-600 cursor-pointer hover:bg-slate-50",onClick:()=>{L({name:c,email:c,type:"contact"})},children:["Press ",e.jsx("kbd",{className:"px-1.5 py-0.5 bg-slate-100 rounded text-slate-600 font-mono text-xs",children:"Enter"})," to add ",e.jsx("strong",{children:c})]}):k.length===0&&c.length>0?e.jsx("div",{className:"py-3 px-4 text-sm text-slate-500 text-center",children:"No contacts found. Type a full email address to add."}):null,k.length>0&&e.jsx(re,{heading:"Suggestions",children:k.map(t=>e.jsxs(ie,{onSelect:()=>L({name:t.name,email:t.email,type:t.type}),className:"flex flex-col items-start gap-1 py-2 px-3 cursor-pointer aria-selected:bg-blue-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-slate-900",children:t.name}),e.jsx(U,{variant:"outline",className:"text-[10px] h-4 px-1 rounded bg-slate-50 text-slate-500 border-slate-200",children:t.type})]}),e.jsx("span",{className:"text-xs text-slate-500",children:t.email})]},t.email))})]})})})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1.5 ml-1",children:["Type any email address and press ",e.jsx("kbd",{className:"px-1.5 py-0.5 bg-slate-100 rounded text-slate-600 font-mono",children:"Enter"})," to add"]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Subject:"}),e.jsx("input",{className:"w-full px-3 py-2.5 border border-slate-300 rounded-md text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200",placeholder:"Enter subject",...x("subject",{required:!0})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Message:"}),e.jsxs("div",{className:"border border-slate-300 rounded-md overflow-hidden bg-white focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all duration-200",children:[e.jsxs("div",{className:"bg-slate-50 px-2.5 py-1.5 border-b border-slate-200 flex gap-1",children:[e.jsx(S,{onClick:()=>C("bold"),icon:e.jsx(pe,{size:14}),title:"Bold"}),e.jsx(S,{onClick:()=>C("italic"),icon:e.jsx(be,{size:14}),title:"Italic"}),e.jsx(S,{onClick:()=>C("underline"),icon:e.jsx(ve,{size:14}),title:"Underline"}),e.jsx("div",{className:"w-px h-5 bg-slate-300 mx-1 self-center"}),e.jsx(S,{onClick:()=>C("insertUnorderedList"),icon:e.jsx(ue,{size:14}),title:"Bullet List"}),e.jsx(S,{onClick:()=>C("insertOrderedList"),icon:e.jsx(ge,{size:14}),title:"Numbered List"}),e.jsx(S,{onClick:()=>q(),icon:e.jsx(he,{size:14}),title:"Link"})]}),e.jsx("div",{ref:n,contentEditable:!0,className:"min-h-[180px] p-3 text-sm text-slate-800 focus:outline-none leading-relaxed prose prose-sm max-w-none",onInput:t=>s("body",t.currentTarget.innerHTML)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-5",children:[e.jsx("button",{type:"button",onClick:z,className:"px-4.5 py-2.5 rounded-md text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 transition-colors",children:"Discard"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 rounded-md text-sm font-semibold text-white bg-slate-900 hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-900 shadow-md transition-all flex items-center gap-2",children:"Send Message"})]})]})})]})})}function S({onClick:r,icon:m,title:u}){return e.jsx("button",{type:"button",onClick:x=>{x.preventDefault(),r()},title:u,className:"w-8 h-8 flex items-center justify-center rounded bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 hover:text-slate-900 hover:border-slate-300 transition-all active:scale-95",children:m})}function pt({clientId:r}){const[m,u]=Y("/clients/:id/communication"),x=r||parseInt((u==null?void 0:u.id)||"0"),[l,p]=y.useState("inbox"),[s,a]=y.useState(null),[i,f]=y.useState(!1),[n,g]=y.useState(""),{data:o,refetch:b}=h.email.list.useQuery({clientId:x,folder:l,search:n}),c=h.email.move.useMutation({onSuccess:()=>{b()}}),D=(w,N)=>{c.mutate({clientId:x,id:parseInt(w),folder:N}),s&&s.toString()===w&&N!==l&&a(null)};return e.jsx(ne,{children:e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col relative",children:[e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(Ne,{currentFolder:l,categories:[{id:"inbox",label:"Inbox",icon:"inbox"},{id:"sent",label:"Sent",icon:"send"},{id:"drafts",label:"Drafts",icon:"file"},{id:"archive",label:"Archive",icon:"archive"},{id:"trash",label:"Trash",icon:"trash"}],onFolderChange:w=>{p(w),a(null)},onCompose:()=>f(!0),onDropEmail:D,children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:`${s?"hidden md:block w-80 lg:w-96":"w-full"} flex-shrink-0 border-r border-gray-200 h-full bg-white`,children:e.jsx(we,{emails:o||[],selectedId:s,onSelect:a,onSearch:g})}),e.jsx("div",{className:`${s?"flex":"hidden md:flex items-center justify-center"} flex-1 h-full bg-white`,children:s?e.jsx(ke,{emailId:s,clientId:x,onBack:()=>a(null),onDelete:()=>{b(),a(null)}}):e.jsxs("div",{className:"text-gray-400 text-center",children:[e.jsx("span",{className:"block text-4xl mb-4",children:"✉️"}),e.jsx("p",{children:"Select an email to read"})]})})]})})}),i&&e.jsx(Ce,{clientId:x,isOpen:i,onClose:()=>{f(!1),b()}})]})})}export{pt as ClientEmail};
