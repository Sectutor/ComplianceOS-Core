import{r as o,j as e,D as ye,o as we,p as ve,q as je,s as Se,l as Ne,T as be,L,E as te,G as re,H as ae,J as oe,K as ie,I as R,w as ke,c as S,aa as B,x as Ce,b as Ie,ac as Ae,t as q,i as Pe,C as _e,k as Fe}from"./index-DOc7Nwb7.js";import{D as Te}from"./DashboardLayout-aHnUqq57.js";import{B as De}from"./Breadcrumb-CRi3LAxS.js";import{C as Me}from"./circular-progress-DYaMZs5I.js";import{u as V,F as Oe,r as Le,a as Re}from"./xlsx-DM7iXGTE.js";import{P as Ee}from"./PageGuide-CPKKXXS6.js";import{A as We,b as Be}from"./alert-BudCfM-X.js";import{U as le}from"./upload-BBmUECj8.js";import{S as qe}from"./settings-CIu9FFiX.js";import{A as z}from"./arrow-right-M96iV-v9.js";import{C as Ve}from"./chevron-left-DZH-lUm7.js";import{S as ze}from"./search-CwuIBBPE.js";import{S as Ke}from"./sparkles-CoQ80pK2.js";import{L as Ue}from"./lock-czWF3qbC.js";import{B as He}from"./book-open-BffBrdze.js";import"./index--2vFva6Y.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";const Ge=[{id:"iso-27001",name:"ISO 27001:2022",description:"The leading international standard for information security management systems (ISMS).",type:"Security",logo:"/frameworks/iso27001.svg"},{id:"iso-22301",name:"ISO 22301:2019",description:"International standard for Business Continuity Management Systems (BCMS).",type:"Business Continuity",logo:"/frameworks/iso27001.svg"},{id:"hitrust",name:"HITRUST-Aligned (Representative)",description:"Representative control set aligned with HITRUST domains (e1, i1, r2) for readiness and simulation. Not the official licensed CSF text.",type:"Security",logo:"/frameworks/hitrust.svg"},{id:"soc-2",name:"SOC 2 Type II",description:"Service Organization Control 2 - Trust Services Criteria for security, availability, processing integrity, confidentiality and privacy.",type:"Security",logo:"/frameworks/soc2.svg"},{id:"nist-csf",name:"NIST CSF 2.0",description:"National Institute of Standards and Technology Cybersecurity Framework. Voluntary guidance based on existing standards.",type:"Security",logo:"/frameworks/nist.svg"},{id:"nist-800-171",name:"NIST SP 800-171 r2",description:"Protecting Controlled Unclassified Information in Nonfederal Systems and Organizations.",type:"Security",logo:"/frameworks/nist.svg"},{id:"pci-dss-v4",name:"PCI DSS v4.0",description:"Payment Card Industry Data Security Standard v4.0.",type:"Security",logo:"/frameworks/pci.svg"},{id:"cis-controls",name:"CIS Controls v8",description:"Center for Internet Security Critical Security Controls. Prioritized set of actions to protect from cyber attacks.",type:"Security",logo:"/frameworks/cis.svg"},{id:"csa-ccm",name:"CSA CCM v4",description:"Cloud Security Alliance Cloud Controls Matrix. Fundamental security principles to guide cloud vendors and to assist prospective cloud customers.",type:"Security",logo:"/frameworks/csa.svg"},{id:"nist-800-53",name:"NIST SP 800-53 Rev 5",description:"Security and Privacy Controls for Information Systems and Organizations.",type:"Security",logo:"/frameworks/nist.svg"},{id:"fedramp-moderate",name:"FedRAMP Moderate",description:"Federal Risk and Authorization Management Program - Moderate Baseline (Representative).",type:"Security",logo:"/frameworks/fedramp.svg"},{id:"cyber-essentials",name:"Cyber Essentials / Plus",description:"UK Government-backed scheme focusing on 5 technical control themes.",type:"Security",logo:"/frameworks/cyber_essentials.svg"},{id:"nist-ai-rmf",name:"NIST AI RMF",description:"NIST AI Risk Management Framework (1.0) for trustworthy and responsible AI.",type:"AI & Data",logo:"/frameworks/nist.svg"},{id:"owasp-aisvs",name:"OWASP AISVS (AI Security)",description:"OWASP Artificial Intelligence Security Verification Standard (1.0). structured checklist to evaluate AI-driven applications.",type:"AI & Data",logo:"/frameworks/owasp.svg"},{id:"owasp-asvs",name:"OWASP ASVS (App Security)",description:"OWASP Application Security Verification Standard (4.0.3). Basis for testing technical security controls.",type:"Security",logo:"/frameworks/owasp.svg"},{id:"owasp_masvs",name:"OWASP MASVS (Mobile Security)",description:"OWASP Mobile Application Security Verification Standard (2.0). The industry standard for mobile app security.",type:"Security",logo:"/frameworks/owasp.svg"},{id:"owasp_samm",name:"OWASP SAMM (Maturity Model)",description:"OWASP Software Assurance Maturity Model. An effective and measurable way for all types of organizations to analyze and improve their software security posture.",type:"Governance",logo:"/frameworks/owasp.svg"},{id:"owasp_api_top10",name:"OWASP API Security Top 10",description:"The most critical API security risks. Focuses on strategies and solutions to understand and mitigate the unique vulnerabilities and security risks of APIs.",type:"Security",logo:"/frameworks/owasp.svg"},{id:"owasp_top10",name:"OWASP Web Top 10",description:"The standard awareness document for developers and web application security (2025 Draft/Pre-release).",version:"2025",type:"Security",logo:"/frameworks/owasp.svg"},{id:"owasp_top10_2021",name:"OWASP Web Top 10 (2021)",description:"The standard awareness document for developers and web application security (2021).",version:"2021",type:"Security",logo:"/frameworks/owasp.svg"},{id:"essential-eight",name:"Australian Essential Eight",description:"Eight prioritized mitigation strategies for cyber resilience with maturity levels 0–3.",type:"Security",logo:"/frameworks/australia.svg"},{id:"owasp_ml_top10",name:"OWASP ML Security Top 10",description:"Vulnerabilities in machine learning models and systems through the ML lifecycle (0.3).",version:"2023",type:"AI & Data",logo:"/frameworks/owasp.svg"}],ne=[{key:"__SKIP__",label:"-- Skip (don't import) --",required:!1},{key:"controlCode",label:"Control Code *",required:!0},{key:"title",label:"Title *",required:!0},{key:"description",label:"Description",required:!1},{key:"grouping",label:"Grouping/Domain",required:!1},{key:"owner",label:"Owner",required:!1},{key:"status",label:"Status",required:!1},{key:"implementationNotes",label:"Implementation Notes",required:!1},{key:"evidenceLocation",label:"Evidence Location",required:!1},{key:"justification",label:"Justification",required:!1}];function $e({open:c,onOpenChange:p,clientId:T,onImport:C}){const[l,f]=o.useState("upload"),[w,v]=o.useState(null),[N,b]=o.useState(""),[u,k]=o.useState(null),[I,D]=o.useState([]),[r,g]=o.useState(""),[x,E]=o.useState(1),[j,K]=o.useState([]),[A,U]=o.useState([]),[P,H]=o.useState([]),[M,G]=o.useState(""),[$,Q]=o.useState(""),[d,W]=o.useState({}),[J,X]=o.useState(!1),[Y,y]=o.useState(null),Z=o.useRef(null);o.useEffect(()=>{c||(f("upload"),v(null),b(""),k(null),D([]),g(""),E(1),K([]),U([]),H([]),G(""),Q(""),W({}),y(null))},[c]),o.useEffect(()=>{u&&r&&x>0&&de()},[u,r,x]);const ce=async s=>{if(s.target.files&&s.target.files[0]){const t=s.target.files[0];v(t),y(null);try{const a=await t.arrayBuffer(),i=Le(a,{type:"array"});console.log("[CustomFrameworkImport] Sheet names:",i.SheetNames),k(i),D(i.SheetNames),g(i.SheetNames[0]),E(1);const m=new FileReader;m.onload=()=>{const h=m.result.split(",")[1];b(h)},m.readAsDataURL(t)}catch(a){y("Failed to parse file: "+a.message)}}},de=()=>{if(!(!u||!r))try{const s=u.Sheets[r],t=s["!ref"];if(!t){y("Sheet appears to be empty");return}const a=V.decode_range(t),i=x-1,m=[];for(let O=a.s.c;O<=a.e.c;O++){const ge=V.encode_cell({r:i,c:O}),F=s[ge];F&&F.v!==void 0&&F.v!==null&&F.v!==""?m.push(String(F.v)):m.push(`Column ${O+1}`)}console.log("[CustomFrameworkImport] Headers from row",x,":",m);const n=V.sheet_to_json(s,{header:m,range:i}).slice(1);if(console.log("[CustomFrameworkImport] Data rows:",n.length),n.length===0){y("No data found after header row");return}K(m),U(n.slice(0,5)),H(n),y(null),me(m)}catch(s){y("Failed to parse sheet: "+s.message)}},me=s=>{const t={},a=s.map(i=>i.toLowerCase());s.forEach((i,m)=>{const h=a[m];["id","code","control id","control_id","ref","reference","safeguard","control"].some(n=>h.includes(n))?t[i]="controlCode":["title","name","control name","control_name"].some(n=>h.includes(n))?t[i]="title":["description","desc","specification","detail"].some(n=>h.includes(n))?t[i]="description":["domain","category","group","family","section"].some(n=>h.includes(n))?t[i]="grouping":["owner","responsible","assignee"].some(n=>h.includes(n))?t[i]="owner":["status","state"].some(n=>h.includes(n))?t[i]="status":["notes","implementation","how"].some(n=>h.includes(n))?t[i]="implementationNotes":["evidence","proof","location"].some(n=>h.includes(n))?t[i]="evidenceLocation":t[i]="__SKIP__"}),W(t)},pe=(s,t)=>{W(a=>({...a,[s]:t}))},ee=()=>{const s=Object.values(d),t=s.includes("controlCode"),a=s.includes("title");return t&&a&&M.trim()!==""},ue=async()=>{if(!ee()){y("Please map at least Control Code and Title, and provide a Framework Name");return}X(!0),y(null);try{(await C({frameworkName:M,frameworkVersion:$,columnMappings:d,fileContent:N,sheetName:r,headerRow:x})).success&&p(!1)}catch(s){y(s.message||"Import failed")}finally{X(!1)}},xe=w&&I.length>0,he=j.length>0&&P.length>0,fe=ee(),_=["upload","configure","mapping","preview"],se=s=>{var a;const t=d[s];return!t||t==="__SKIP__"?null:(a=ne.find(i=>i.key===t))==null?void 0:a.label};return e.jsx(ye,{open:c,onOpenChange:p,children:e.jsxs(we,{className:"sm:max-w-[900px] w-[95vw] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ve,{children:[e.jsx(je,{children:"Import Custom Framework"}),e.jsx(Se,{children:"Upload an Excel file and map columns to import your custom framework."})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 py-4",children:_.map((s,t)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${l===s?"bg-primary text-primary-foreground":_.indexOf(l)>t?"bg-green-500 text-white":"bg-muted text-muted-foreground"}`,children:_.indexOf(l)>t?e.jsx(Ne,{className:"h-4 w-4"}):t+1}),t<_.length-1&&e.jsx("div",{className:"w-8 h-0.5 bg-muted mx-1"})]},s))}),Y&&e.jsxs(We,{variant:"destructive",children:[e.jsx(be,{className:"h-4 w-4"}),e.jsx(Be,{children:Y})]}),l==="upload"&&e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 flex flex-col items-center justify-center cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>{var s;return(s=Z.current)==null?void 0:s.click()},children:[w?e.jsxs("div",{className:"text-center",children:[e.jsx(Oe,{className:"h-12 w-12 text-green-600 mx-auto mb-3"}),e.jsx("p",{className:"font-medium",children:w.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(w.size/1024).toFixed(1)," KB • ",I.length," sheet(s) detected"]})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(le,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"font-medium",children:"Click to upload Excel file"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Supported format: .xlsx, .xls"})]}),e.jsx("input",{ref:Z,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:ce})]})}),l==="configure"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(qe,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Configure Import Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select which sheet to import and where the column headers are located."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Select Sheet *"}),e.jsxs(te,{value:r,onValueChange:g,children:[e.jsx(re,{children:e.jsx(ae,{placeholder:"Select sheet"})}),e.jsx(oe,{children:I.map((s,t)=>e.jsxs(ie,{value:s,children:[s," (Tab ",t+1,")"]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Header Row Number *"}),e.jsx(R,{type:"number",min:1,value:x,onChange:s=>E(parseInt(s.target.value)||1),placeholder:"e.g., 1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Row containing column titles (1 = first row)"})]})]}),j.length>0&&e.jsxs("div",{className:"border rounded-lg p-3 mt-4",children:[e.jsxs("p",{className:"text-sm font-medium mb-2",children:["Detected Columns (",j.length,"):"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:j.map(s=>e.jsx("span",{className:"text-xs bg-muted px-2 py-1 rounded",children:s},s))}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[P.length," data row(s) found after header row"]})]})]}),l==="mapping"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Framework Name *"}),e.jsx(R,{value:M,onChange:s=>G(s.target.value),placeholder:"e.g., NIST CSF 2.0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Version"}),e.jsx(R,{value:$,onChange:s=>Q(s.target.value),placeholder:"e.g., 2.0"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Map Excel Columns to Database Fields"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["For each Excel column, select which database field it should map to.",e.jsx("span",{className:"text-destructive",children:" * Control Code and Title are required."})]}),e.jsx("div",{className:"border rounded-lg divide-y max-h-[300px] overflow-y-auto",children:j.map(s=>e.jsxs("div",{className:"grid grid-cols-[1fr_24px_220px] items-center gap-2 p-3 hover:bg-muted/30",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-mono text-sm truncate",children:s}),A[0]&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:['e.g., "',A[0][s],'"']})]}),e.jsx(z,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("div",{className:"min-w-[220px]",children:e.jsxs(te,{value:d[s]||"__SKIP__",onValueChange:t=>pe(s,t),children:[e.jsx(re,{className:"text-sm",children:e.jsx(ae,{})}),e.jsx(oe,{children:ne.map(t=>e.jsx(ie,{value:t.key,children:t.label},t.key))})]})})]},s))}),e.jsxs("div",{className:"mt-3 text-sm",children:[Object.values(d).includes("controlCode")?e.jsx("span",{className:"text-green-600",children:"✓ Control Code mapped"}):e.jsx("span",{className:"text-destructive",children:"✗ Control Code not mapped"}),e.jsx("span",{className:"mx-2",children:"|"}),Object.values(d).includes("title")?e.jsx("span",{className:"text-green-600",children:"✓ Title mapped"}):e.jsx("span",{className:"text-destructive",children:"✗ Title not mapped"})]})]})]}),l==="preview"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Importing ",e.jsx("strong",{children:P.length})," controls into ",e.jsx("strong",{children:M})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 text-sm",children:[e.jsx("div",{className:"font-medium mb-2",children:"Mapping Summary:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:j.filter(s=>d[s]&&d[s]!=="__SKIP__").map(s=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-muted-foreground",children:s}),e.jsx(z,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:se(s)})]},s))})]}),e.jsx("div",{className:"border rounded-lg overflow-x-auto max-h-[200px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-muted sticky top-0",children:e.jsx("tr",{children:j.filter(s=>d[s]&&d[s]!=="__SKIP__").map(s=>e.jsxs("th",{className:"px-3 py-2 text-left font-medium whitespace-nowrap border-r last:border-r-0",children:[se(s),e.jsx("span",{className:"block text-xs font-normal text-muted-foreground",children:s})]},s))})}),e.jsx("tbody",{children:A.map((s,t)=>e.jsx("tr",{className:"border-t hover:bg-muted/30",children:j.filter(a=>d[a]&&d[a]!=="__SKIP__").map(a=>e.jsx("td",{className:"px-3 py-2 whitespace-nowrap border-r last:border-r-0 max-w-[200px] truncate",children:s[a]!==void 0?String(s[a]):""},a))},t))})]})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Showing first ",A.length," rows.",P.length-A.length>0&&` ${P.length-A.length} more rows will be imported.`]})]}),e.jsxs(ke,{className:"gap-2",children:[l!=="upload"&&e.jsxs(S,{variant:"outline",onClick:()=>{const s=_.indexOf(l);s>0&&f(_[s-1])},children:[e.jsx(Ve,{className:"h-4 w-4 mr-1"})," Back"]}),e.jsx(S,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),l==="upload"&&e.jsxs(S,{onClick:()=>f("configure"),disabled:!xe,children:["Next ",e.jsx(B,{className:"h-4 w-4 ml-1"})]}),l==="configure"&&e.jsxs(S,{onClick:()=>f("mapping"),disabled:!he,children:["Next ",e.jsx(B,{className:"h-4 w-4 ml-1"})]}),l==="mapping"&&e.jsxs(S,{onClick:()=>f("preview"),disabled:!fe,children:["Preview ",e.jsx(B,{className:"h-4 w-4 ml-1"})]}),l==="preview"&&e.jsxs(S,{onClick:ue,disabled:J,children:[J?e.jsx(Ce,{className:"h-4 w-4 animate-spin mr-2"}):null,"Import ",P.length," Controls"]})]})]})})}const Qe=({fw:c,stats:p,onClick:T})=>{const[C,l]=o.useState(!1),f=v=>v===0?"text-slate-200":v<30?"text-red-500":v<70?"text-amber-500":"text-emerald-500",w=c.name.split(" ")[0].substring(0,4).toUpperCase();return e.jsx(_e,{className:"group hover:border-primary/50 transition-all duration-300 cursor-pointer shadow-sm hover:shadow-md overflow-hidden flex flex-col h-full",onClick:T,children:e.jsxs("div",{className:"p-6 flex h-full gap-5",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"h-12 w-12 min-w-[3rem] rounded-lg bg-white border border-slate-200 flex items-center justify-center overflow-hidden",children:!C&&c.logo?e.jsx("img",{src:c.logo,alt:c.name,className:"w-full h-full object-contain p-1",onError:()=>l(!0)}):e.jsx("div",{className:"text-xs font-bold text-slate-700",children:w})}),e.jsx(Fe,{variant:"secondary",className:"bg-slate-100 text-slate-600 font-normal hover:bg-slate-200 text-[10px] px-2 py-0.5 whitespace-nowrap ml-2",children:c.type})]}),e.jsxs("div",{className:"mb-auto",children:[e.jsx("h3",{className:"font-bold text-lg text-slate-900 group-hover:text-primary transition-colors leading-tight mb-2 truncate",title:c.name,children:c.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3 leading-relaxed",children:c.description})]}),e.jsxs("div",{className:"mt-4 pt-2 flex items-center text-sm font-medium text-primary group-hover:translate-x-1 transition-transform",children:["View Controls ",e.jsx(z,{className:"ml-1 h-4 w-4"})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center border-l border-dashed border-slate-100 pl-4 min-w-[100px]",children:[e.jsx(Me,{value:p.percentage,size:80,strokeWidth:8,color:f(p.percentage)}),e.jsx("span",{className:`mt-3 text-[10px] font-bold uppercase tracking-wide text-center ${p.percentage>0?"text-slate-700":"text-slate-400"}`,children:p.percentage>0?`${p.percentage}% Done`:"Not Started"})]})]})})};function Es(){const[c,p]=o.useState(""),[T,C]=o.useState(!1),[l,f]=o.useState(!1),[,w]=Ie(),{selectedClientId:v}=Ae(),N=v||1,{data:b}=q.compliance.frameworkStats.list.useQuery({clientId:N},{enabled:!0}),{data:u}=q.clients.get.useQuery({id:N},{enabled:!0}),k=((u==null?void 0:u.planTier)==="pro"||(u==null?void 0:u.planTier)==="enterprise")&&!0,I=Ge.filter(r=>r.name.toLowerCase().includes(c.toLowerCase())||r.description.toLowerCase().includes(c.toLowerCase())),D=r=>{if(!b||!Array.isArray(b))return{percentage:0,total:0,implemented:0};const g=b.find(x=>x.framework===r);return g||b.find(x=>r.includes(x.framework)||x.framework.includes(r))||{percentage:0,total:0,implemented:0}};return e.jsx(Te,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(De,{items:[{label:"Compliance",href:"/compliance"},{label:"Frameworks Library"}]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Frameworks Library"}),e.jsx("p",{className:"text-muted-foreground",children:"Browse and manage adoption of standard security and privacy frameworks."})]}),e.jsx(Ee,{title:"Framework Implementation Guide",description:"Learn how to adopt and implement compliance standards efficiently.",rationale:"Compliance frameworks provide the structure for your security program. Proper implementation ensures you meet regulatory requirements while building a robust security posture.",howToUse:[{step:"Browse Standards",description:"Search for frameworks like SOC 2, ISO 27001, or NIST in our library."},{step:"Adopt & Import",description:"Select a framework to import its controls into your Control Workbench."},{step:"Track Progress",description:"Monitor implementation status across all active frameworks via the dashboard."},{step:"Custom Frameworks",description:"Pro and Enterprise users can import proprietary control sets."}],integrations:[{name:"Ready Wizards",description:"Launch step-by-step readiness assessments for any standard."},{name:"Global Mappings",description:"Controls are cross-mapped to reduce duplicate implementation work."},{name:"Audit Hub",description:"Implementation data flows directly into audit reports."}]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-white p-2 rounded-lg border shadow-sm flex-1 max-w-md",children:[e.jsx(ze,{className:"h-5 w-5 text-gray-400 ml-2"}),e.jsx(R,{className:"border-0 focus-visible:ring-0 focus-visible:ring-offset-0",placeholder:"Search frameworks...",value:c,onChange:r=>p(r.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{onClick:()=>C(!0),variant:"outline",className:"gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Import Standard"]}),e.jsxs(S,{onClick:()=>k?f(!0):w("/upgrade-required?feature=custom-frameworks"),variant:k?"default":"secondary",className:"gap-2",children:[k?e.jsx(Ke,{className:"h-4 w-4"}):e.jsx(Ue,{className:"h-4 w-4"}),"Import Custom"]})]})]}),e.jsx(Re,{open:T,onOpenChange:C,clientId:N}),k&&e.jsx($e,{open:l,onOpenChange:f,clientId:N,onImport:async r=>{const g=await q.frameworkImport.importCustomFramework.mutate({clientId:N,...r});return g.success&&Pe.success(`Imported ${g.count} controls!`),g}}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[I.map(r=>e.jsx(Qe,{fw:r,stats:D(r.name),onClick:()=>w(`/controls?framework=${encodeURIComponent(r.name)}`)},r.id)),I.length===0&&e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(He,{className:"h-12 w-12 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No frameworks found"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Try adjusting your search terms."})]})]})]})})}export{Es as default};
