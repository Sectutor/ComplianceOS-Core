import{ac as I,r as h,t as g,i as y,j as e,x as f,c as k,C as v,m as j,d as P,e as E,E as T,G as M,H as R,J as L,K as m}from"./index-DOc7Nwb7.js";import{c as H}from"./utils-BC5CVi_C.js";import{P as q}from"./progress-B-1k4ZZX.js";import{T as B}from"./textarea-BtxBxzdY.js";import{C as D}from"./CyberLayout-B8x_G-rt.js";import{P as F}from"./PageGuide-CPKKXXS6.js";import{S as G}from"./save-CvVmWchr.js";import{C as V}from"./circle-check-C5kiwRoG.js";import"./DashboardLayout-aHnUqq57.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./bar-chart-3-BCngNY6H.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";const C=[{id:"risk_mgmt",category:"1. Risk Analysis & Information System Security Policies",questions:[{id:"rm_1",text:"Do you have a formal Risk Management Policy approved by top management?"},{id:"rm_2",text:"Is there an up-to-date asset inventory of all critical information systems?"},{id:"rm_3",text:"Are risk assessments conducted regularly (at least annually)?"}]},{id:"incident_handling",category:"2. Incident Handling",questions:[{id:"ih_1",text:"Is there a documented Incident Response Plan (IRP)?"},{id:"ih_2",text:"Are you capable of reporting significant incidents to the CSIRT within 24 hours (early warning)?"},{id:"ih_3",text:"Are incidents tracked, logged, and analyzed for root causes?"}]},{id:"bcp_dr",category:"3. Business Continuity & Crisis Management",questions:[{id:"bc_1",text:"Are backups performed regularly and tested for recoverability?"},{id:"bc_2",text:"Is there a Business Continuity Plan (BCP) in place for critical operations?"},{id:"bc_3",text:"Do you have a Crisis Management process to coordinate specific responses?"}]},{id:"supply_chain",category:"4. Supply Chain Security",questions:[{id:"sc_1",text:"Are security requirements included in contracts with ICT suppliers?"},{id:"sc_2",text:"Do you assess the risks posed by immediate suppliers and service providers?"}]},{id:"vuln_handling",category:"5. Vulnerability Handling & Disclosure",questions:[{id:"vh_1",text:"Is there a process for regular vulnerability scanning?"},{id:"vh_2",text:"Are patches applied within a defined timeframe based on severity?"}]},{id:"effectiveness",category:"6. Assessment of Effectiveness",questions:[{id:"test_1",text:"Do you conduct regular penetration tests?"},{id:"test_2",text:"Are security audits (internal or external) performed annually?"}]},{id:"hygiene",category:"7. Basic Cyber Hygiene & Training",questions:[{id:"tr_1",text:"Is cybersecurity training mandatory for all staff?"},{id:"tr_2",text:"Are best practices for password management and software updates enforced?"}]},{id:"crypto",category:"8. Cryptography & Encryption",questions:[{id:"enc_1",text:"Is encryption used for data at rest containing sensitive info?"},{id:"enc_2",text:"Is encryption used for data in transit (TLS/SSL)?"}]},{id:"hr_sec",category:"9. Human Resources Security",questions:[{id:"hr_1",text:"Are access rights revoked immediately upon employee termination?"},{id:"hr_2",text:"Are background checks performed for sensitive roles?"}]},{id:"mfa",category:"10. Multi-Factor Authentication (MFA)",questions:[{id:"mfa_1",text:"Is MFA enabled for all remote access and administrative accounts?"},{id:"mfa_2",text:"Are secured voice/video/text communications used for critical operations?"}]}];function Te(){const{selectedClientId:d}=I(),[r,p]=h.useState({}),[n,N]=h.useState(0),{data:z,isLoading:_,refetch:b}=g.cyber.getAssessment.useQuery({clientId:d||0},{enabled:!!d,onSuccess:s=>{s!=null&&s.responses&&p(s.responses)}}),u=g.cyber.saveAssessment.useMutation({onSuccess:()=>{y.success("Assessment saved successfully"),b()},onError:s=>y.error(s.message)});h.useEffect(()=>{let s=0,t=0;C.forEach(l=>{l.questions.forEach(a=>{var o,c;t++,((o=r[a.id])==null?void 0:o.answer)==="yes"&&s++,((c=r[a.id])==null?void 0:c.answer)==="partial"&&(s+=.5)})});const i=t>0?Math.round(s/t*100):0;N(i)},[r]);const S=(s,t)=>{p(i=>({...i,[s]:{...i[s],answer:t}}))},A=(s,t)=>{p(i=>({...i,[s]:{...i[s],notes:t}}))},w=()=>{if(!d)return;const s=n===100?"completed":n>0?"in_progress":"not_started";u.mutate({clientId:d||0,responses:r,score:n,status:s})};return _?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(f,{className:"animate-spin"})}):e.jsx(D,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(F,{title:"NIS2 Compliance Checklist",description:"Assess your readiness against Article 21 requirements.",rationale:"Regular self-assessment is mandatory to ensure ongoing compliance with NIS2 security measures.",howToUse:[{step:"Assess",description:"Answer questions across all 10 categories."},{step:"Evidence",description:"Add notes or links to evidence for verification."},{step:"Track",description:"Monitor your compliance score and progress."}]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n,"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Compliance Score"})]}),e.jsxs(k,{onClick:w,disabled:u.isLoading,children:[u.isLoading&&e.jsx(f,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(G,{className:"mr-2 h-4 w-4"})," Save Progress"]})]})]}),e.jsx(v,{children:e.jsx(j,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Overall Progress"}),e.jsx("span",{className:n>=100?"text-green-600 font-medium":"text-muted-foreground",children:n>=100?"Compliant":`${n}%`})]}),e.jsx(q,{value:n,className:"h-3"})]})})}),e.jsx("div",{className:"space-y-6",children:C.map(s=>e.jsxs(v,{children:[e.jsx(P,{className:"bg-muted/30 pb-4",children:e.jsxs(E,{className:"text-lg flex items-center gap-2",children:[s.category,s.questions.every(t=>{var i;return((i=r[t.id])==null?void 0:i.answer)==="yes"})&&e.jsx(V,{className:"h-5 w-5 text-green-500"})]})}),e.jsx(j,{className:"space-y-0 pt-0",children:e.jsx("div",{className:"divide-y",children:s.questions.map((t,i)=>{var l,a,o,c;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 p-4 hover:bg-slate-50 transition-colors",children:[e.jsx("div",{className:"md:col-span-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("span",{className:"text-muted-foreground text-xs font-mono mt-1 w-6 shrink-0",children:[i+1,"."]}),e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:t.text})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(T,{value:((l=r[t.id])==null?void 0:l.answer)||"not_started",onValueChange:x=>S(t.id,x),children:[e.jsx(M,{className:H("h-8 text-xs font-medium border-0 ring-1 ring-inset",((a=r[t.id])==null?void 0:a.answer)==="yes"?"bg-green-50 text-green-700 ring-green-600/20":((o=r[t.id])==null?void 0:o.answer)==="partial"?"bg-yellow-50 text-yellow-700 ring-yellow-600/20":"bg-slate-50 text-slate-600 ring-slate-400/20"),children:e.jsx(R,{})}),e.jsxs(L,{children:[e.jsx(m,{value:"not_started",children:"Gap / Not Started"}),e.jsx(m,{value:"partial",children:"In Progress"}),e.jsx(m,{value:"yes",children:"Implemented"}),e.jsx(m,{value:"na",children:"N/A"})]})]})}),e.jsx("div",{className:"md:col-span-4",children:e.jsx(B,{placeholder:"Add implementation notes or evidence links...",className:"min-h-[2.5rem] text-xs resize-y",value:((c=r[t.id])==null?void 0:c.notes)||"",onChange:x=>A(t.id,x.target.value)})})]},t.id)})})})]},s.id))})]})})}export{Te as default};
