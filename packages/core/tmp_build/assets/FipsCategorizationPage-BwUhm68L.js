import{ab as E,t as S,r as T,j as e,c as j,C as f,d as u,e as g,f as k,m as y,I as v,N as W,O as D,P as z,Q as m,V,W as x,i as M,E as $,G as Q,H as q,J as G,K as N}from"./index-DOc7Nwb7.js";import{D as J}from"./DashboardLayout-aHnUqq57.js";import{B as K}from"./Breadcrumb-CRi3LAxS.js";import{S as O}from"./save-CvVmWchr.js";import{P as _}from"./plus-BaQ35Jcx.js";import{T as U}from"./trash-2-CFEfisbM.js";import{S as X}from"./shield-alert-iAruRy4W.js";import{I as Y}from"./info-By5wLOUH.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function Ee(){const c=E(),l=Number(c.id),{data:i,refetch:P}=S.federal.getFipsCategorization.useQuery({clientId:l}),H=S.federal.saveFipsCategorization.useMutation(),[I,F]=T.useState((i==null?void 0:i.systemName)||""),[n,p]=T.useState((i==null?void 0:i.informationTypes)||[{type:"PII",description:"Personally Identifiable Information",confidentiality:"moderate",integrity:"moderate",availability:"moderate"}]),A=()=>{p([...n,{type:"",description:"",confidentiality:"low",integrity:"low",availability:"low"}])},B=a=>{p(n.filter((t,s)=>s!==a))},d=(a,t,s)=>{const o=[...n];o[a]={...o[a],[t]:s},p(o)},r=(()=>{const a={low:1,moderate:2,high:3},t={1:"Low",2:"Moderate",3:"High"};let s=1,o=1,h=1;n.forEach(b=>{s=Math.max(s,a[b.confidentiality]),o=Math.max(o,a[b.integrity]),h=Math.max(h,a[b.availability])});const R=Math.max(s,o,h);return{conf:t[s],int:t[o],avail:t[h],overall:t[R]}})(),L=async()=>{try{await H.mutateAsync({clientId:l,systemName:I,informationTypes:n,confidentialityImpact:r.conf,integrityImpact:r.int,availabilityImpact:r.avail,highWaterMark:r.overall,status:"final"}),M.success("Categorization saved successfully"),P()}catch{M.error("Failed to save categorization")}};return e.jsx(J,{children:e.jsxs("div",{className:"p-8 space-y-6 w-full",children:[e.jsx(K,{items:[{label:"Dashboard",href:`/clients/${l}/dashboard`},{label:"Federal Hub",href:`/clients/${l}/federal`},{label:"FIPS 199 Categorization"}]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"FIPS 199 Categorization"}),e.jsx("p",{className:"text-slate-500",children:"Determine the security impact level of your system."})]}),e.jsxs(j,{onClick:L,className:"bg-blue-600 hover:bg-blue-700 font-bold gap-2 h-11 px-6 shadow-lg shadow-blue-100",children:[e.jsx(O,{className:"h-4 w-4"})," Save Categorization"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs(f,{className:"border-slate-200",children:[e.jsxs(u,{children:[e.jsx(g,{className:"text-xl",children:"System Information"}),e.jsx(k,{children:"Basic identification for the system being categorized."})]}),e.jsx(y,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-700",children:"System Name"}),e.jsx(v,{placeholder:"e.g. Corporate ERP System",value:I,onChange:a=>F(a.target.value),className:"h-11"})]})})]}),e.jsxs(f,{className:"border-slate-200",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-6",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-xl",children:"Information Types"}),e.jsx(k,{children:"Select and assess information types processed by the system."})]}),e.jsxs(j,{onClick:A,variant:"outline",size:"sm",className:"gap-2 border-slate-200 font-bold",children:[e.jsx(_,{className:"h-4 w-4"})," Add Type"]})]}),e.jsx(y,{children:e.jsxs(W,{children:[e.jsx(D,{children:e.jsxs(z,{className:"bg-slate-50 border-slate-200 hover:bg-slate-50",children:[e.jsx(m,{className:"font-bold text-slate-700",children:"Information Type"}),e.jsx(m,{className:"font-bold text-slate-700",children:"Confidentiality"}),e.jsx(m,{className:"font-bold text-slate-700",children:"Integrity"}),e.jsx(m,{className:"font-bold text-slate-700",children:"Availability"}),e.jsx(m,{className:"w-10"})]})}),e.jsx(V,{children:n.map((a,t)=>e.jsxs(z,{className:"border-slate-100 odd:bg-white even:bg-slate-50/30",children:[e.jsxs(x,{className:"py-4",children:[e.jsx(v,{value:a.type,onChange:s=>d(t,"type",s.target.value),placeholder:"Type",className:"h-9 mb-1"}),e.jsx(v,{value:a.description,onChange:s=>d(t,"description",s.target.value),placeholder:"Description",className:"h-8 text-xs text-slate-500"})]}),e.jsx(x,{children:e.jsx(w,{value:a.confidentiality,onChange:s=>d(t,"confidentiality",s)})}),e.jsx(x,{children:e.jsx(w,{value:a.integrity,onChange:s=>d(t,"integrity",s)})}),e.jsx(x,{children:e.jsx(w,{value:a.availability,onChange:s=>d(t,"availability",s)})}),e.jsx(x,{children:e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>B(t),className:"text-slate-400 hover:text-red-600",children:e.jsx(U,{className:"h-4 w-4"})})})]},t))})]})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(f,{className:"bg-slate-900 text-white border-none shadow-2xl sticky top-8 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 -mr-16 -mt-16 bg-blue-600/20 rounded-full blur-3xl"}),e.jsx(u,{className:"relative",children:e.jsxs(g,{className:"text-lg flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-blue-400"}),"Categorization Result"]})}),e.jsxs(y,{className:"space-y-8 relative",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{label:"Confidentiality",value:r.conf}),e.jsx(C,{label:"Integrity",value:r.int}),e.jsx(C,{label:"Availability",value:r.avail})]}),e.jsxs("div",{className:"pt-8 border-t border-slate-800",children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-slate-400 mb-1",children:"High Water Mark"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-5xl font-black text-blue-400 tracking-tighter",children:r.overall}),e.jsxs("div",{className:"text-xs text-slate-400 leading-snug",children:["Based on Information System ",e.jsx("br",{})," impact analysis (FIPS 199)."]})]})]}),e.jsxs("div",{className:"bg-blue-600/10 border border-blue-600/20 p-4 rounded-xl space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 text-xs font-bold",children:[e.jsx(Y,{className:"h-3 w-3"}),"Next Steps"]}),e.jsx("p",{className:"text-xs text-slate-300",children:"This categorization determines the baseline of NIST 800-171 controls required for your SSP."})]})]})]})})]})]})})}function w({value:c,onChange:l}){return e.jsxs($,{value:c,onValueChange:l,children:[e.jsx(Q,{className:"h-9 w-32 border-slate-200",children:e.jsx(q,{})}),e.jsxs(G,{children:[e.jsx(N,{value:"low",children:"Low"}),e.jsx(N,{value:"moderate",children:"Moderate"}),e.jsx(N,{value:"high",children:"High"})]})]})}function C({label:c,value:l}){const i={Low:"bg-emerald-500",Moderate:"bg-amber-500",High:"bg-rose-500"};return e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 text-sm font-medium",children:c}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-bold text-sm",children:l}),e.jsx("div",{className:`h-2 w-12 rounded-full ${i[l]||"bg-slate-700"}`})]})]})}export{Ee as default};
