import{ab as $,b as H,t as h,r as d,i as k,j as e,c as l,C as m,m as o,T as R,F as O,k as j,U as Q,X as V,Y as X,D as u,o as g,p as v,q as N,L as F,w as f}from"./index-DOc7Nwb7.js";import{S as Y}from"./separator-BWuYil37.js";import{T as I}from"./textarea-BtxBxzdY.js";import{A as q,b as L}from"./alert-BudCfM-X.js";import{D as G}from"./DashboardLayout-aHnUqq57.js";import{A as J}from"./arrow-left-CpuUojG-.js";import{C as T}from"./clock-osbacZli.js";import{C as b}from"./circle-check-C5kiwRoG.js";import{C as K}from"./calendar-BlLJlGbj.js";import{M as W}from"./message-square-5hBo7zY3.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function Be(){const{clientId:x}=$(),[Z,M]=H(),U=h.useUtils(),[t,r]=d.useState(null),[B,i]=d.useState(!1),[w,C]=d.useState(""),[P,n]=d.useState(!1),[p,y]=d.useState(""),{data:c=[],isLoading:_}=h.management.getApprovals.useQuery({clientId:parseInt(x||"0")},{enabled:!!x}),z=h.management.processApproval.useMutation({onSuccess:()=>{U.management.getApprovals.invalidate(),k.success("Document processed successfully"),i(!1),n(!1),C(""),y(""),r(null)},onError:s=>{k.error(`Failed to process document: ${s.message}`)}}),S=s=>{switch(s){case"approved":return e.jsx(b,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(R,{className:"h-4 w-4 text-red-500"});default:return e.jsx(T,{className:"h-4 w-4 text-yellow-500"})}},D=s=>{const a={approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"};return e.jsx(j,{className:a[s],children:s.charAt(0).toUpperCase()+s.slice(1)})},A=async s=>{t&&z.mutate({approvalId:t.id,action:s?"approve":"reject",comment:s?w:p,signature:"digital-signature-placeholder"})};return e.jsxs(G,{children:[e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(l,{variant:"ghost",onClick:()=>M(`/clients/${x}/coverage`),className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Back to Coverage"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Management Sign-off"}),e.jsx("p",{className:"text-slate-600",children:"Review and approve critical compliance documents"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsx(m,{className:"bg-white border-slate-200 shadow-sm",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-amber-600",children:c.filter(s=>s.status==="pending").length})]}),e.jsx(T,{className:"h-8 w-8 text-amber-600 opacity-20"})]})})}),e.jsx(m,{className:"bg-white border-slate-200 shadow-sm",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:c.filter(s=>s.status==="approved").length})]}),e.jsx(b,{className:"h-8 w-8 text-emerald-600 opacity-20"})]})})}),e.jsx(m,{className:"bg-white border-slate-200 shadow-sm",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Rejected"}),e.jsx("p",{className:"text-2xl font-bold text-rose-600",children:c.filter(s=>s.status==="rejected").length})]}),e.jsx(R,{className:"h-8 w-8 text-rose-600 opacity-20"})]})})}),e.jsx(m,{className:"bg-white border-slate-200 shadow-sm",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:c.length})]}),e.jsx(O,{className:"h-8 w-8 text-slate-400 opacity-20"})]})})})]}),e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsx(m,{className:"bg-white border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[S(s.status),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:s.title}),D(s.status),e.jsx(j,{variant:"outline",className:"border-slate-200 text-slate-600",children:s.type.replace("-"," ").toUpperCase()})]}),e.jsx("p",{className:"text-slate-600 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsxs("span",{children:["Submitted by ",s.submitter]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:s.submittedDate})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsxs("span",{children:["Required: ",s.requiredApprovers.join(", ")]})]})]}),s.signatures.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx(Y,{className:"mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Signatures:"}),s.signatures.map(a=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-slate-50 border border-slate-100 rounded",children:[e.jsx(V,{className:"h-8 w-8",children:e.jsx(X,{className:"bg-slate-200 text-slate-700",children:a.signerName.split(" ").map(E=>E[0]).join("")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:a.signerName}),e.jsxs("p",{className:"text-xs text-slate-500",children:[a.signerRole," â€¢ ",new Date(a.timestamp).toLocaleDateString()]}),a.comment&&e.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:[e.jsx(W,{className:"h-3 w-3 inline mr-1"}),a.comment]})]}),e.jsx(b,{className:"h-4 w-4 text-emerald-500"})]},a.id))]})]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>r(s),children:"View Details"}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{size:"sm",onClick:()=>i(!0),className:"bg-green-600 hover:bg-green-700",children:"Approve & Sign"}),e.jsx(l,{variant:"destructive",size:"sm",onClick:()=>n(!0),children:"Reject"})]})]})]})})},s.id))})]})}),e.jsx(u,{open:B,onOpenChange:i,children:e.jsxs(g,{children:[e.jsx(v,{children:e.jsx(N,{children:"Approve and Sign Document"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"comment",children:"Approval Comment (Optional)"}),e.jsx(I,{id:"comment",placeholder:"Add any comments for the approval record...",value:w,onChange:s=>C(s.target.value),className:"mt-2"})]}),e.jsx(q,{children:e.jsx(L,{children:'By clicking "Approve & Sign", you are digitally signing this document and confirming your approval of its contents.'})})]}),e.jsxs(f,{children:[e.jsx(l,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(l,{onClick:()=>A(!0),className:"bg-green-600 hover:bg-green-700",children:"Approve & Sign"})]})]})}),e.jsx(u,{open:P,onOpenChange:n,children:e.jsxs(g,{children:[e.jsx(v,{children:e.jsx(N,{children:"Reject Document"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"reject-comment",children:"Rejection Reason (Required)"}),e.jsx(I,{id:"reject-comment",placeholder:"Please provide a reason for rejection...",value:p,onChange:s=>y(s.target.value),className:"mt-2",required:!0})]}),e.jsx(q,{children:e.jsx(L,{children:"This document will be returned to the submitter with your comments for revision."})})]}),e.jsxs(f,{children:[e.jsx(l,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(l,{variant:"destructive",onClick:()=>A(!1),disabled:!p.trim(),children:"Reject Document"})]})]})}),t&&e.jsx(u,{open:!!t,onOpenChange:()=>r(null),children:e.jsxs(g,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(v,{children:e.jsxs(N,{className:"flex items-center space-x-3",children:[S(t.status),t.title,D(t.status),e.jsx(j,{variant:"outline",className:"border-slate-200 text-slate-600",children:t.type.toUpperCase()})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-slate-900",children:"Description"}),e.jsx("p",{className:"text-slate-600",children:t.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-slate-900",children:"Submission Details"}),e.jsxs("div",{className:"space-y-1 text-sm text-slate-600",children:[e.jsxs("p",{children:["Submitter: ",t.submitter]}),e.jsxs("p",{children:["Date: ",t.submittedDate]}),e.jsxs("p",{children:["Current Approver: ",t.currentApprover]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-slate-900",children:"Approval Requirements"}),e.jsx("div",{className:"space-y-1 text-sm text-slate-600",children:t.requiredApprovers.map(s=>e.jsx("p",{children:s},s))})]})]}),t.metadata&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-slate-900",children:"Metadata"}),e.jsx("div",{className:"bg-slate-50 p-4 rounded border border-slate-100",children:Object.entries(t.metadata).map(([s,a])=>e.jsxs("div",{className:"flex justify-between py-1",children:[e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[s,":"]}),e.jsx("span",{className:"text-sm text-slate-600",children:String(a)})]},s))})]}),t.content&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-slate-900",children:"Document Content"}),e.jsx("div",{className:"bg-slate-50 p-4 rounded border border-slate-100 max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm text-slate-700 font-mono",children:t.content})})]})]}),e.jsxs(f,{children:[e.jsx(l,{variant:"outline",onClick:()=>r(null),children:"Close"}),t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{onClick:()=>{r(null),i(!0)},className:"bg-green-600 hover:bg-green-700",children:"Approve & Sign"}),e.jsx(l,{variant:"destructive",onClick:()=>{r(null),n(!0)},children:"Reject"})]})]})]})})]})}export{Be as default};
