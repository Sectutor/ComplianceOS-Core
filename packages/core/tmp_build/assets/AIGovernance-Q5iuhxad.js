import{r as R,t as c,i as M,S as Ie,T as le,aa as he,j as e,C as g,m as S,L as h,c as d,I as ie,E as F,G as D,H as P,J as V,K as l,d as b,k as T,e as w,f as W,ab as ke,R as Ae,x as ue,F as pe,ao as je,D as _,o as q,p as J,q as Y,s as X,w as te}from"./index-DOc7Nwb7.js";import{S as Re,D as ge}from"./DashboardLayout-aHnUqq57.js";import{T as ve,a as Ne,b as E,c as O}from"./tabs-CBDTXbEn.js";import{T as B}from"./textarea-BtxBxzdY.js";import{S as Me}from"./scale-BCebIfgE.js";import{L as Le}from"./lock-czWF3qbC.js";import{C as Te}from"./chevron-left-DZH-lUm7.js";import{S as Fe}from"./search-CwuIBBPE.js";import{C as De}from"./circle-check-C5kiwRoG.js";import{U as Pe}from"./unlink-BReNnSJu.js";import{L as Ve}from"./link-FmUqdGRG.js";import{A as Ee}from"./arrow-left-CpuUojG-.js";import{P as Oe}from"./pencil-Bud7U1sU.js";import{T as Be}from"./trash-2-CFEfisbM.js";import{C as Q}from"./clipboard-check-CQkJX5J0.js";import{L as fe}from"./layout-grid-CGqkIAJU.js";import{S as G}from"./shield-check-ETs8j4-d.js";import{P as Ue}from"./plus-BaQ35Jcx.js";import{B as re}from"./brain-C-Zi22rJ.js";import{A as ze}from"./activity-B1F2IRm3.js";import"./index--2vFva6Y.js";import"./filter-Ceo--4mb.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./shield-alert-iAruRy4W.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";const j=[{title:"Safety & Reliability",icon:Ie,color:"text-blue-500",key:"safetyImpact"},{title:"Bias & Fairness",icon:Me,color:"text-purple-500",key:"biasImpact"},{title:"Privacy & Data",icon:Le,color:"text-emerald-500",key:"privacyImpact"},{title:"Security & Robustness",icon:le,color:"text-orange-500",key:"securityImpact"}],He=({aiSystemId:L,onComplete:y})=>{const[i,C]=R.useState(0),[o,I]=R.useState({safetyImpact:"",biasImpact:"",privacyImpact:"",securityImpact:"",overallRiskScore:50,recommendations:""}),m=c.ai.systems.addImpactAssessment.useMutation({onSuccess:()=>{M.success("Impact Assessment submitted successfully"),y()}}),k=()=>{i<j.length?C(i+1):m.mutate({aiSystemId:L,...o})},K=()=>{i>0&&C(i-1)},u=i<j.length?j[i].icon:he;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:j.map((v,x)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center border-2 transition-colors ${x<=i?"bg-primary border-primary text-white":"border-muted text-muted-foreground"}`,children:x<i?"âœ“":x+1}),x<j.length-1&&e.jsx("div",{className:`h-0.5 w-12 mx-2 ${x<i?"bg-primary":"bg-muted"}`})]},x))}),i<j.length?e.jsx(g,{className:"border-muted/30 shadow-sm animate-in slide-in-from-right-4 duration-300",children:e.jsxs(S,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-2 rounded-xl bg-opacity-10 bg-current ${j[i].color}`,children:e.jsx(u,{className:"h-6 w-6"})}),e.jsx("h3",{className:"text-xl font-bold",children:j[i].title})]}),e.jsxs("p",{className:"text-sm text-muted-foreground italic",children:["How does this AI system address ",j[i].title.toLowerCase(),"? List known risks and mitigation strategies."]}),e.jsx(B,{placeholder:"Enter your assessment details here...",className:"min-h-[150px] text-base leading-relaxed",value:o[j[i].key],onChange:v=>I({...o,[j[i].key]:v.target.value})})]})}):e.jsx(g,{className:"border-muted/30 shadow-sm animate-in slide-in-from-right-4 duration-300",children:e.jsxs(S,{className:"pt-6 space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Final Review & recommendations"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(h,{children:"Self-Assessed Overall Risk Score"}),e.jsxs("span",{className:"font-bold text-primary",children:[o.overallRiskScore," / 100"]})]}),e.jsx(Re,{value:[o.overallRiskScore],max:100,step:1,onValueChange:([v])=>I({...o,overallRiskScore:v}),className:"py-4"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Key Recommendations (MANAGE 1.1)"}),e.jsx(B,{placeholder:"State any immediate actions or required human-in-the-loop controls...",className:"min-h-[100px]",value:o.recommendations,onChange:v=>I({...o,recommendations:v.target.value})})]})]})}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsxs(d,{variant:"ghost",onClick:K,disabled:i===0,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"})," Back"]}),e.jsxs(d,{onClick:k,disabled:m.isPending,children:[i<j.length?"Next Section":"Submit Assessment",i<j.length&&e.jsx(he,{className:"h-4 w-4 ml-2"})]})]})]})},$e=({aiSystemId:L,clientId:y})=>{const[i,C]=R.useState(""),[o,I]=R.useState("NIST AI RMF"),{data:m}=c.controls.getAvailableFrameworks.useQuery({clientId:y}),{data:k,isLoading:K}=c.controls.list.useQuery({framework:o,clientId:y}),{data:u,refetch:v}=c.ai.systems.getMappedControls.useQuery({aiSystemId:L}),x=c.ai.systems.mapControl.useMutation({onSuccess:()=>{M.success("Control mapped successfully"),v()}}),N=c.ai.systems.unmapControl.useMutation({onSuccess:()=>{M.success("Control unmapped"),v()}}),U=c.ai.systems.updateControlStatus.useMutation({onSuccess:()=>{M.success("Control status updated"),v()}}),n=r=>u==null?void 0:u.find(a=>a.controlId===r),f=k==null?void 0:k.filter(r=>r.name.toLowerCase().includes(i.toLowerCase())||r.controlId.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{placeholder:`Search ${o} controls...`,className:"pl-10",value:i,onChange:r=>C(r.target.value)})]}),e.jsx("div",{className:"w-[200px]",children:e.jsxs(F,{value:o,onValueChange:I,children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select Framework"})}),e.jsxs(V,{children:[e.jsx(l,{value:"NIST AI RMF",children:"NIST AI RMF"}),m==null?void 0:m.filter(r=>r!=="NIST AI RMF").map(r=>e.jsx(l,{value:r,children:r},r))]})]})}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-primary/5 rounded-lg border border-primary/20",children:[e.jsx(De,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{className:"text-sm font-medium",children:[(u==null?void 0:u.length)||0," Controls Mapped"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto max-h-[600px] pr-2 custom-scrollbar",children:[f==null?void 0:f.map(r=>{const a=n(r.id),z=!!a;return e.jsx(g,{className:`transition-all ${z?"border-primary/50 bg-primary/5 shadow-sm":"border-muted/40 opacity-90 hover:opacity-100"}`,children:e.jsx(b,{className:"p-4 flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{variant:"outline",className:"font-mono bg-background",children:r.controlId}),e.jsx(w,{className:"text-base",children:r.name})]}),e.jsx(W,{className:"line-clamp-2 text-xs md:text-sm max-w-2xl",children:r.description})]}),e.jsx("div",{className:"flex items-center gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsxs(F,{value:(a==null?void 0:a.status)||"mapped",onValueChange:H=>U.mutate({aiSystemId:L,controlId:r.id,status:H}),children:[e.jsx(D,{className:"w-[140px] h-8 text-xs bg-background",children:e.jsx(P,{})}),e.jsxs(V,{children:[e.jsx(l,{value:"mapped",children:"Mapped"}),e.jsx(l,{value:"implemented",children:"Implemented"}),e.jsx(l,{value:"verified",children:"Verified"}),e.jsx(l,{value:"not_applicable",children:"Not Applicable"})]})]}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>N.mutate({aiSystemId:L,controlId:r.id}),disabled:N.isPending,children:e.jsx(Pe,{className:"h-4 w-4"})})]}):e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>x.mutate({aiSystemId:L,controlId:r.id}),disabled:x.isPending,className:"gap-2",children:[e.jsx(Ve,{className:"h-3 w-3"})," Map Control"]})})]})})},r.id)}),(f==null?void 0:f.length)===0&&e.jsx("div",{className:"text-center py-10 text-muted-foreground",children:"No controls found matching your search."})]})]})},Ls=()=>{var ne,de,ce,oe,me;const{id:L}=ke(),y=L?parseInt(L):1,[i,C]=R.useState(!1),[o,I]=R.useState(!1),[m,k]=R.useState(null),[K,u]=R.useState(!1),[v,x]=R.useState(!1),{data:N,refetch:U}=c.ai.systems.list.useQuery({clientId:y}),{data:n}=c.ai.systems.getStats.useQuery({clientId:y}),{data:f}=c.ai.systems.listAllAssessments.useQuery({clientId:y}),{data:r}=c.vendors.listVendors.useQuery({clientId:y}),{data:a,refetch:z}=c.ai.systems.getWithAssessments.useQuery({id:m},{enabled:!!m}),H=c.ai.systems.create.useMutation({onSuccess:()=>{M.success("AI System registered successfully"),C(!1),U()}}),Z=c.ai.systems.update.useMutation({onSuccess:()=>{M.success("AI System updated successfully"),I(!1),z(),U()}}),ee=c.ai.systems.delete.useMutation({onSuccess:()=>{M.success("AI System deleted successfully"),x(!1),k(null),U()}}),se=c.ai.systems.exportModelCard.useMutation({onSuccess:s=>{const A=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),xe=URL.createObjectURL(A),$=document.createElement("a");$.href=xe,$.download=`ModelCard_${a==null?void 0:a.name.replace(/\s+/g,"_")}.json`,document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(xe),M.success("Model Card exported successfully")}}),ye=()=>{m&&se.mutate({id:m})},ae=c.ai.systems.downloadAssessmentReport.useMutation({onSuccess:s=>{const A=document.createElement("a");A.href=`data:application/pdf;base64,${s.pdfBase64}`,A.download=s.filename,document.body.appendChild(A),A.click(),document.body.removeChild(A),M.success("Report downloaded successfully")},onError:()=>{M.error("Failed to generate report")}}),be=()=>{m&&ae.mutate({id:m})},[t,p]=R.useState({name:"",description:"",purpose:"",type:"internal",riskLevel:"medium",status:"evaluation",vendorId:void 0}),we=()=>{H.mutate({clientId:y,...t})},Se=()=>{a&&Z.mutate({id:a.id,name:t.name,description:t.description,purpose:t.purpose,riskLevel:t.riskLevel,status:t.status,vendorId:t.vendorId})},Ce=()=>{m&&ee.mutate({id:m})};return Ae.useEffect(()=>{o&&a&&p({name:a.name,description:a.description||"",purpose:a.purpose||"",type:a.type||"internal",riskLevel:a.riskLevel||"medium",status:a.status||"evaluation",vendorId:a.vendorId||void 0})},[o,a]),m&&a?e.jsx(ge,{children:e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-8 animate-in fade-in duration-500",children:[e.jsxs(d,{variant:"ghost",className:"gap-2",onClick:()=>k(null),children:[e.jsx(Ee,{className:"h-4 w-4"})," Back to Inventory"]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-3xl font-bold",children:a.name}),e.jsxs(T,{variant:a.riskLevel==="high"?"destructive":"secondary",children:[(ne=a.riskLevel)==null?void 0:ne.toUpperCase()," RISK"]})]}),e.jsx("p",{className:"text-muted-foreground",children:a.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",size:"icon",onClick:()=>I(!0),children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>x(!0),children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-8 bg-border mx-2"}),e.jsxs(d,{variant:"outline",className:"gap-2",onClick:()=>u(!0),children:[e.jsx(Q,{className:"h-4 w-4"})," Assessment"]}),e.jsxs(d,{variant:"outline",className:"gap-2",onClick:be,disabled:ae.isPending,children:[ae.isPending?e.jsx(ue,{className:"h-4 w-4 animate-spin"}):e.jsx(pe,{className:"h-4 w-4"}),"Report"]}),e.jsxs(d,{className:"gap-2",onClick:ye,disabled:se.isPending,children:[se.isPending?e.jsx(ue,{className:"h-4 w-4 animate-spin"}):e.jsx(pe,{className:"h-4 w-4"}),"Model Card"]})]})]}),e.jsxs(ve,{defaultValue:"overview",className:"w-full",children:[e.jsxs(Ne,{className:"flex w-fit mb-8 bg-slate-100/80 p-1 rounded-xl border border-slate-200/50",children:[e.jsxs(E,{value:"overview",className:"px-6 py-2.5 rounded-lg text-sm font-medium transition-all data-[state=active]:bg-white data-[state=active]:text-indigo-600 data-[state=active]:shadow-sm text-slate-600 hover:text-slate-900",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"})," Overview"]}),e.jsxs(E,{value:"assessments",className:"px-6 py-2.5 rounded-lg text-sm font-medium transition-all data-[state=active]:bg-white data-[state=active]:text-indigo-600 data-[state=active]:shadow-sm text-slate-600 hover:text-slate-900",children:[e.jsx(je,{className:"h-4 w-4 mr-2"})," Assessments History"]}),e.jsxs(E,{value:"mapping",className:"px-6 py-2.5 rounded-lg text-sm font-medium transition-all data-[state=active]:bg-white data-[state=active]:text-indigo-600 data-[state=active]:shadow-sm text-slate-600 hover:text-slate-900",children:[e.jsx(G,{className:"h-4 w-4 mr-2"})," NIST Control Mapping"]})]}),e.jsx(O,{value:"overview",className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(g,{className:"md:col-span-2",children:[e.jsx(b,{children:e.jsx(w,{className:"text-lg",children:"Deployment Context (MAP 1.2)"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wider",children:"Intended Purpose"}),e.jsx("p",{className:"mt-1",children:a.purpose||"No purpose documented."})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wider",children:"Technical Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Type"}),e.jsx("p",{className:"font-medium capitalize",children:a.type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Status"}),e.jsx("p",{className:"font-medium capitalize",children:a.status})]}),a.vendor&&e.jsxs("div",{className:"col-span-2 pt-2 border-t mt-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Vendor Provider"}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsxs(T,{variant:"outline",className:"pl-1 pr-3 py-1 flex gap-2",children:[e.jsx("img",{src:`https://www.google.com/s2/favicons?domain=${a.vendor.website}&sz=16`,alt:"",className:"w-4 h-4 rounded-full",onError:s=>s.currentTarget.style.display="none"}),a.vendor.name]})})]})]})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-lg",children:"Quick Stats"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Audit Readiness"}),e.jsx("span",{className:"font-bold",children:"42%"})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:"42%"}})}),e.jsxs("div",{className:"pt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(G,{className:"h-4 w-4 text-emerald-500"}),e.jsx("span",{children:"31 Controls Mapped"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(le,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{children:"2 Moderate Gaps"})]})]})]})]})]})}),e.jsx(O,{value:"assessments",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[(de=a.assessments)==null?void 0:de.map(s=>e.jsx(g,{className:"hover:border-primary/30 transition-colors",children:e.jsxs(b,{className:"p-4 flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.overallRiskScore>70?"bg-red-500/10 text-red-500":"bg-green-500/10 text-green-500"}`,children:e.jsx(je,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"text-base uppercase",children:"Impact Assessment"}),e.jsx(T,{variant:"outline",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs(W,{children:["Risk Score: ",s.overallRiskScore,"/100"]})]})]}),e.jsx(d,{variant:"ghost",size:"sm",children:"View Report"})]})},s.id)),((ce=a.assessments)==null?void 0:ce.length)===0&&e.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-3xl",children:[e.jsx(Q,{className:"h-10 w-10 text-muted-foreground/30 mx-auto mb-4"}),e.jsx("h4",{className:"font-semibold",children:"No assessments found"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Start your first NIST AI RMF assessment for this system."}),e.jsx(d,{variant:"outline",className:"mt-4",onClick:()=>u(!0),children:"Run Assessment"})]})]})}),e.jsx(O,{value:"mapping",className:"mt-6",children:e.jsx($e,{aiSystemId:a.id,clientId:y})})]}),e.jsx(_,{open:K,onOpenChange:u,children:e.jsxs(q,{className:"sm:max-w-3xl rounded-3xl",children:[e.jsxs(J,{children:[e.jsx(Y,{children:"AI Impact Assessment (NIST MEASURE)"}),e.jsxs(X,{children:["Evaluate the characteristics of ",a.name," according to trustworthy AI criteria."]})]}),e.jsx(He,{aiSystemId:a.id,onComplete:()=>{u(!1),z()}})]})}),e.jsx(_,{open:v,onOpenChange:x,children:e.jsxs(q,{children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Delete AI System?"}),e.jsxs(X,{children:["Are you sure you want to delete ",e.jsx("strong",{children:a.name}),"? This action cannot be undone and will delete all associated assessments and mappings."]})]}),e.jsxs(te,{children:[e.jsx(d,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(d,{variant:"destructive",onClick:Ce,disabled:ee.isPending,children:ee.isPending?"Deleting...":"Delete System"})]})]})}),e.jsx(_,{open:o,onOpenChange:I,children:e.jsxs(q,{className:"sm:max-w-[600px] rounded-3xl",children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Edit AI System"}),e.jsxs(X,{children:["Update details for ",a.name,"."]})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"edit-name",children:"System Name"}),e.jsx(ie,{id:"edit-name",value:t.name,onChange:s=>p({...t,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"edit-status",children:"Status"}),e.jsxs(F,{value:t.status,onValueChange:s=>p({...t,status:s}),children:[e.jsx(D,{children:e.jsx(P,{})}),e.jsxs(V,{children:[e.jsx(l,{value:"evaluation",children:"Evaluation"}),e.jsx(l,{value:"development",children:"Development"}),e.jsx(l,{value:"production",children:"Production"}),e.jsx(l,{value:"monitoring",children:"Monitoring"}),e.jsx(l,{value:"retired",children:"Retired"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"edit-risk",children:"Risk Level"}),e.jsxs(F,{value:t.riskLevel,onValueChange:s=>p({...t,riskLevel:s}),children:[e.jsx(D,{children:e.jsx(P,{})}),e.jsxs(V,{children:[e.jsx(l,{value:"low",children:"Low"}),e.jsx(l,{value:"medium",children:"Medium"}),e.jsx(l,{value:"high",children:"High"}),e.jsx(l,{value:"critical",children:"Critical"}),e.jsx(l,{value:"unacceptable",children:"Unacceptable"})]})]})]})]}),a.type==="vendor"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"edit-vendor",children:"Vendor"}),e.jsxs(F,{value:(oe=t.vendorId)==null?void 0:oe.toString(),onValueChange:s=>p({...t,vendorId:parseInt(s)}),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select a vendor..."})}),e.jsx(V,{children:r==null?void 0:r.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"edit-description",children:"Description"}),e.jsx(B,{id:"edit-description",value:t.description,onChange:s=>p({...t,description:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"edit-purpose",children:"Intended Purpose"}),e.jsx(B,{id:"edit-purpose",value:t.purpose,onChange:s=>p({...t,purpose:s.target.value})})]})]}),e.jsxs(te,{children:[e.jsx(d,{variant:"outline",onClick:()=>I(!1),children:"Cancel"}),e.jsx(d,{onClick:Se,disabled:Z.isPending,children:Z.isPending?"Saving...":"Save Changes"})]})]})})]})}):e.jsx(ge,{children:e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight text-foreground",children:"AI Governance"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"NIST AI Risk Management Framework (RMF 1.0) Lifecycle Management"})]}),e.jsxs(d,{onClick:()=>C(!0),className:"gap-2 bg-primary hover:bg-primary/90",children:[e.jsx(Ue,{className:"h-4 w-4"})," Register AI System"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(g,{className:"bg-gradient-to-br from-blue-500/10 to-indigo-500/10 border-blue-500/20 shadow-lg hover:shadow-xl transition-all",children:[e.jsx(b,{className:"pb-2",children:e.jsxs(w,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-blue-500"})," Total AI Systems"]})}),e.jsx(S,{children:e.jsx("div",{className:"text-3xl font-bold",children:(N==null?void 0:N.length)||0})})]}),e.jsxs(g,{className:"bg-gradient-to-br from-purple-500/10 to-pink-500/10 border-purple-500/20 shadow-lg",children:[e.jsx(b,{className:"pb-2",children:e.jsxs(w,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-purple-500"})," NIST Compliance"]})}),e.jsxs(S,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[(n==null?void 0:n.nistCompliance.percentage)||0,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(n==null?void 0:n.nistCompliance.mappedCount)||0,"/",(n==null?void 0:n.nistCompliance.totalCount)||73," subcategories mapped"]})]})]}),e.jsxs(g,{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 border-orange-500/20 shadow-lg",children:[e.jsx(b,{className:"pb-2",children:e.jsxs(w,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4 text-orange-500"})," High Risk Systems"]})}),e.jsx(S,{children:e.jsx("div",{className:"text-3xl font-bold",children:(n==null?void 0:n.highRiskSystems)||0})})]}),e.jsxs(g,{className:"bg-gradient-to-br from-emerald-500/10 to-teal-500/10 border-emerald-500/20 shadow-lg",children:[e.jsx(b,{className:"pb-2",children:e.jsxs(w,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4 text-emerald-500"})," Active Assessments"]})}),e.jsx(S,{children:e.jsx("div",{className:"text-3xl font-bold",children:(n==null?void 0:n.totalAssessments)||0})})]})]}),e.jsxs(ve,{defaultValue:"inventory",className:"w-full",children:[e.jsxs(Ne,{className:"grid w-full grid-cols-3 mb-10 bg-slate-100/80 p-1.5 rounded-2xl border border-slate-200/60 shadow-inner",children:[e.jsxs(E,{value:"inventory",className:"rounded-xl py-3 text-sm font-semibold transition-all data-[state=active]:bg-white data-[state=active]:text-indigo-600 data-[state=active]:shadow-md text-slate-500 hover:text-slate-800",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"})," AI System Inventory"]}),e.jsxs(E,{value:"assessments",className:"rounded-xl py-3 text-sm font-semibold transition-all data-[state=active]:bg-white data-[state=active]:text-indigo-600 data-[state=active]:shadow-md text-slate-500 hover:text-slate-800",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"})," Global Assessments"]}),e.jsxs(E,{value:"nist-map",className:"rounded-xl py-3 text-sm font-semibold transition-all data-[state=active]:bg-white data-[state=active]:text-indigo-600 data-[state=active]:shadow-md text-slate-500 hover:text-slate-800",children:[e.jsx(G,{className:"h-4 w-4 mr-2"})," NIST AI RMF Core"]})]}),e.jsx(O,{value:"inventory",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[N==null?void 0:N.map(s=>{var A;return e.jsxs(g,{className:"hover:border-primary/50 transition-colors shadow-sm cursor-pointer group hover:shadow-md",onClick:()=>k(s.id),children:[e.jsxs(b,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"p-3 bg-primary/5 rounded-xl group-hover:bg-primary/10 transition-colors",children:e.jsx(re,{className:"h-6 w-6 text-primary"})}),e.jsxs(T,{variant:s.riskLevel==="high"?"destructive":"secondary",children:[(A=s.riskLevel)==null?void 0:A.toUpperCase()," RISK"]})]}),e.jsx(w,{className:"mt-4",children:s.name}),e.jsx(W,{className:"line-clamp-2",children:s.description})]}),e.jsx(S,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{variant:"outline",children:s.status}),e.jsx(T,{variant:"outline",children:s.type})]})})]},s.id)}),(N==null?void 0:N.length)===0&&e.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed rounded-3xl bg-muted/20",children:[e.jsx(re,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold",children:"No AI Systems Registered"}),e.jsx("p",{className:"text-muted-foreground max-w-xs mx-auto mt-2",children:"Start by documenting your AI models or third-party AI services to map them against NIST RMF."}),e.jsx(d,{variant:"outline",className:"mt-6",onClick:()=>C(!0),children:"Add Your First System"})]})]})}),e.jsx(O,{value:"assessments",children:e.jsxs(g,{className:"rounded-3xl border-muted/30 shadow-xl overflow-hidden",children:[e.jsxs(b,{className:"bg-muted/30 pb-6 border-b border-muted/20",children:[e.jsx(w,{children:"Global Assessment History"}),e.jsx(W,{children:"All evaluations performed across your AI inventory"})]}),e.jsx(S,{className:"p-0",children:e.jsxs("div",{className:"divide-y divide-muted/10",children:[f==null?void 0:f.map(s=>e.jsxs("div",{className:"p-6 flex items-center justify-between hover:bg-muted/5 transition-colors cursor-pointer",onClick:()=>k(s.aiSystemId),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${s.overallRiskScore>70?"bg-red-500/10 text-red-500":"bg-emerald-500/10 text-emerald-500"}`,children:e.jsx(Q,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg",children:s.systemName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(T,{variant:"outline",className:"text-xs",children:new Date(s.createdAt).toLocaleDateString()}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Assessor: ",s.assessorName||"System"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-black text-foreground",children:[s.overallRiskScore,e.jsx("span",{className:"text-sm font-normal text-muted-foreground",children:"/100"})]}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider font-bold mt-1",children:"Risk Score"})]})]},s.id)),(!f||f.length===0)&&e.jsxs("div",{className:"p-20 text-center",children:[e.jsx(Q,{className:"h-16 w-16 text-muted-foreground/20 mx-auto mb-6"}),e.jsx("h3",{className:"text-2xl font-bold",children:"No Assessments Yet"}),e.jsx("p",{className:"text-muted-foreground mt-2 max-w-sm mx-auto",children:"Select an individual system from the inventory to run your first impact assessment."})]})]})})]})}),e.jsx(O,{value:"nist-map",children:e.jsxs(g,{className:"rounded-3xl border-muted/30 shadow-xl overflow-hidden",children:[e.jsxs(b,{className:"bg-muted/30 pb-6 border-b border-muted/20",children:[e.jsx(w,{children:"NIST AI RMF 1.0 Core Mapping"}),e.jsx(W,{children:"Visualizing your coverage across the 73 subcategories"})]}),e.jsxs(S,{className:"p-8",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[((n==null?void 0:n.categoryBreakdown)||[]).map(s=>e.jsxs("div",{className:"p-8 rounded-3xl bg-slate-50 border border-muted/30 flex flex-col items-center shadow-sm hover:shadow-md transition-all",children:[e.jsx("span",{className:"text-xs font-black text-indigo-600 mb-3 tracking-[0.2em]",children:s.category}),e.jsxs("div",{className:"relative h-24 w-24 flex items-center justify-center mb-4",children:[e.jsxs("svg",{className:"w-full h-full -rotate-90",children:[e.jsx("circle",{cx:"48",cy:"48",r:"38",stroke:"currentColor",strokeWidth:"8",fill:"transparent",className:"text-slate-200"}),e.jsx("circle",{cx:"48",cy:"48",r:"38",stroke:"currentColor",strokeWidth:"8",fill:"transparent",strokeDasharray:238.76,strokeDashoffset:238.76-238.76*s.percentage/100,className:"text-indigo-600 transition-all duration-1000"})]}),e.jsxs("span",{className:"absolute text-xl font-bold",children:[s.percentage,"%"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 font-medium",children:[s.mapped," of ",s.total," mapped"]})]},s.category)),(!(n!=null&&n.categoryBreakdown)||n.categoryBreakdown.length===0)&&e.jsx("div",{className:"col-span-full text-center py-10",children:e.jsx("p",{className:"text-muted-foreground italic",children:"No mapping data available for this client yet."})})]}),e.jsxs("div",{className:"mt-12 text-center py-10 bg-indigo-50/30 rounded-3xl border border-indigo-100/50",children:[e.jsx(G,{className:"h-10 w-10 text-indigo-200 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 font-medium",children:"Select an AI System to begin mapping controls across the NIST AI RMF core lifecycle."})]})]})]})})]}),e.jsx(_,{open:i,onOpenChange:C,children:e.jsxs(q,{className:"sm:max-w-[600px] rounded-3xl",children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Register AI System"}),e.jsx(X,{children:"Define the scope and context of your AI system as per NIST AI RMF MAP function."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"name",children:"System Name"}),e.jsx(ie,{id:"name",placeholder:"e.g., Customer Support LLM",value:t.name,onChange:s=>p({...t,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"type",children:"System Type"}),e.jsxs(F,{value:t.type,onValueChange:s=>p({...t,type:s,vendorId:void 0}),children:[e.jsx(D,{children:e.jsx(P,{})}),e.jsxs(V,{children:[e.jsx(l,{value:"internal",children:"In-house Developed"}),e.jsx(l,{value:"vendor",children:"Vendor Provided (SaaS)"}),e.jsx(l,{value:"opensource",children:"Open Source"})]})]})]}),t.type==="vendor"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"vendor",children:"Select Vendor"}),e.jsxs(F,{value:(me=t.vendorId)==null?void 0:me.toString(),onValueChange:s=>p({...t,vendorId:parseInt(s)}),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select a vendor..."})}),e.jsxs(V,{children:[(r==null?void 0:r.length)===0&&e.jsx("div",{className:"p-2 text-sm text-muted-foreground text-center",children:"No vendors found. Please add vendors in the Vendor module first."}),r==null?void 0:r.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"risk",children:"Self-Assessed Risk Level"}),e.jsxs(F,{value:t.riskLevel,onValueChange:s=>p({...t,riskLevel:s}),children:[e.jsx(D,{children:e.jsx(P,{})}),e.jsxs(V,{children:[e.jsx(l,{value:"low",children:"Low"}),e.jsx(l,{value:"medium",children:"Medium"}),e.jsx(l,{value:"high",children:"High"}),e.jsx(l,{value:"critical",children:"Critical (Unacceptable)"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"description",children:"System Description"}),e.jsx(B,{id:"description",placeholder:"Briefly describe what the AI system does...",value:t.description,onChange:s=>p({...t,description:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"purpose",children:"Intended Purpose (MAP 1.1)"}),e.jsx(B,{id:"purpose",placeholder:"What is the business mission this AI system fulfills?",value:t.purpose,onChange:s=>p({...t,purpose:s.target.value})})]})]}),e.jsxs(te,{children:[e.jsx(d,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),e.jsx(d,{onClick:we,disabled:!t.name||H.isPending,children:H.isPending?"Registering...":"Register System"})]})]})})]})})};export{Ls as default};
