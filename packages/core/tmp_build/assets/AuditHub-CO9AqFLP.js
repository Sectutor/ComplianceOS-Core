const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EvidenceFileUpload-BXLp96ZN.js","assets/index-DOc7Nwb7.js","assets/index-Bl3DBbCH.css","assets/scroll-area-DPaNxEJD.js","assets/search-CwuIBBPE.js","assets/upload-BBmUECj8.js","assets/circle-check-C5kiwRoG.js","assets/download-ByfWg1Mi.js","assets/trash-2-CFEfisbM.js"])))=>i.map(i=>d[i]);
import{r as m,t as o,i as p,j as e,D as V,o as B,p as $,q as Q,s as _,I as F,x as os,c as d,u as $e,a as Us,B as Ps,Z as Vs,_ as Bs,X as he,Y as ue,$ as $s,a1 as Qs,ba as _s,au as Hs,S as ls,E as de,G as ce,H as oe,J as xe,K as S,k as E,ap as xs,w as Z,ar as Ws,z as rs,F as Ve,C as T,N as ms,O as hs,P as z,Q as M,V as us,W as N,T as ye,L as qs,bG as Gs,d as J,f as Y,e as X,m as P,l as ps}from"./index-DOc7Nwb7.js";import{c as w}from"./utils-BC5CVi_C.js";import{D as Ks}from"./DashboardLayout-aHnUqq57.js";import{S as Js}from"./scroll-area-DPaNxEJD.js";import{S as Be}from"./search-CwuIBBPE.js";import{T as Ys,a as Xs,b as ze,c as ns}from"./tabs-CBDTXbEn.js";import{T as gs}from"./textarea-BtxBxzdY.js";import{C as Zs}from"./circular-progress-DYaMZs5I.js";import{A as et,a as st,b as tt,c as at,d as it,e as lt,f as rt,g as nt}from"./alert-dialog-V7xGXdVc.js";import{S as dt,a as ct}from"./slotNames-XB2IFQPg.js";import{P as ot}from"./PageGuide-CPKKXXS6.js";import{M as xt}from"./mail-xRDvl6QK.js";import{P as mt}from"./plus-BaQ35Jcx.js";import{C as me}from"./circle-check-C5kiwRoG.js";import{M as pe}from"./message-square-5hBo7zY3.js";import{R as Ne}from"./rotate-cw-asiX3B-o.js";import{F as ht}from"./filter-Ceo--4mb.js";import{T as ds}from"./trash-2-CFEfisbM.js";import{U as ut}from"./upload-BBmUECj8.js";import{E as Ue}from"./ellipsis-BXWwt8ER.js";import{D as cs}from"./download-ByfWg1Mi.js";import{B as pt}from"./briefcase-BxorFA78.js";import{C as gt}from"./clock-osbacZli.js";import{A as Pe}from"./arrow-left-CpuUojG-.js";import{A as jt}from"./arrow-right-M96iV-v9.js";import"./index--2vFva6Y.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";function vt({open:g,onOpenChange:l,clientId:a,evidenceId:i,onSuccess:c}){const[t,j]=m.useState(""),[A,k]=m.useState(null),{data:h}=o.evidenceFiles.listAll.useQuery({clientId:a,search:t},{enabled:g}),{data:u}=o.evidenceFiles.list.useQuery({evidenceId:i},{enabled:g}),r=n=>u==null?void 0:u.some(L=>L.fileKey===n),ee=o.evidenceFiles.linkExisting.useMutation({onSuccess:()=>{p.success("File linked successfully"),k(null),l(!1),c&&c()},onError:n=>{p.error(n.message),k(null)}}),se=n=>{k(n.id),ee.mutate({targetEvidenceId:i,sourceFileId:n.id})},v=n=>n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`,O=n=>n.startsWith("image/")?"ðŸ–¼ï¸":n==="application/pdf"?"ðŸ“„":n.includes("spreadsheet")||n.includes("excel")?"ðŸ“Š":n.includes("word")||n.includes("document")?"ðŸ“":"ðŸ“Ž";return e.jsx(V,{open:g,onOpenChange:l,children:e.jsxs(B,{className:"sm:max-w-[600px] max-h-[80vh] flex flex-col",children:[e.jsxs($,{children:[e.jsx(Q,{children:"Select from Evidence Library"}),e.jsx(_,{children:"Choose an existing file to link to this request."})]}),e.jsx("div",{className:"py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Search files...",value:t,onChange:n=>j(n.target.value),className:"pl-8"})]})}),e.jsx(Js,{className:"flex-1 min-h-[300px] border rounded-md p-2",children:e.jsxs("div",{className:"space-y-2",children:[h==null?void 0:h.map(n=>{const L=r(n.fileKey);return e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border border-transparent transition-colors group ${L?"opacity-50 cursor-not-allowed bg-muted":"hover:bg-muted cursor-pointer hover:border-border"}`,onClick:()=>!L&&se(n),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"text-xl",children:O(n.contentType||"application/octet-stream")}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:n.filename}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[v(n.size||0)," â€¢ ",n.evidenceTitle||"Uncategorized"," â€¢ ",new Date(n.createdAt).toLocaleDateString()]})]})]}),ee.isLoading&&A===n.id?e.jsx(os,{className:"h-4 w-4 animate-spin text-blue-600"}):e.jsx(d,{size:"sm",variant:"ghost",className:`opacity-0 group-hover:opacity-100 ${L?"hidden":""}`,disabled:L,children:"Select"}),L&&e.jsx("span",{className:"text-xs text-muted-foreground italic px-2",children:"Attached"})]},n.id)}),(h==null?void 0:h.length)===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No files found matching your search."})]})})]})})}function bt({children:g}){var c,t;const{user:l,signOut:a}=$e(),{appName:i}=Us();return e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[e.jsxs("header",{className:"h-16 bg-[#001B2B] text-white flex items-center justify-between px-6 shrink-0 shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white/10 p-2 rounded-lg",children:e.jsx(Ps,{className:"text-white",showText:!1})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg tracking-tight",children:i}),e.jsx("div",{className:"text-[10px] uppercase tracking-wider text-slate-400 font-medium",children:"Auditor Portal"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"hidden md:block text-right",children:[e.jsx("div",{className:"text-sm font-medium text-slate-200",children:((c=l==null?void 0:l.user_metadata)==null?void 0:c.full_name)||(l==null?void 0:l.email)}),e.jsx("div",{className:"text-xs text-slate-500",children:"External Auditor"})]}),e.jsxs(Vs,{children:[e.jsx(Bs,{asChild:!0,children:e.jsx(d,{variant:"ghost",className:"relative h-10 w-10 rounded-full border border-white/10 hover:bg-white/10 ring-offset-[#001B2B]",children:e.jsx(he,{className:"h-8 w-8",children:e.jsx(ue,{className:"bg-indigo-600 text-white font-bold",children:((t=l==null?void 0:l.email)==null?void 0:t.substring(0,2).toUpperCase())||"AU"})})})}),e.jsx($s,{className:"w-56",align:"end",forceMount:!0,children:e.jsxs(Qs,{onClick:()=>a(),className:"text-red-600 cursor-pointer",children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Log out"})]})})]})]})]}),e.jsx("main",{className:"flex-1 flex flex-col overflow-hidden",children:g}),e.jsx("footer",{className:"py-4 text-center text-xs text-slate-400 border-t bg-white",children:e.jsx("p",{children:"SECURE AUDIT PREVIEW ENVIRONMENT â€¢ CONFIDENTIAL"})})]})}const ft=m.lazy(()=>Gs(()=>import("./EvidenceFileUpload-BXLp96ZN.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])));function wa(){var Je,Ye,Xe,Ze,es,ss;const[g,l]=Hs("/clients/:clientId/audit-hub"),a=l!=null&&l.clientId?parseInt(l.clientId):0,[i,c]=m.useState("pbc"),[t,j]=m.useState(null),[A,k]=m.useState("all"),[h,u]=m.useState("ISO 27001"),{user:r}=$e(),se=((Je=r==null?void 0:r.user_metadata)==null?void 0:Je.role)==="auditor"||window.location.search.includes("view=auditor")?bt:Ks,[v,O]=m.useState(!1),[n,L]=m.useState(""),te=o.audit.inviteAuditor.useMutation({onSuccess:()=>{p.success("Invitation sent successfully"),O(!1),L("")},onError:s=>{p.error(s.message)}}),Qe=()=>{n&&te.mutate({clientId:a,email:n})},js=((Ye=r==null?void 0:r.user_metadata)==null?void 0:Ye.role)==="admin"||((Xe=r==null?void 0:r.user_metadata)==null?void 0:Xe.role)==="owner",{data:H}=o.evidence.getFrameworks.useQuery();console.log("[AuditHub] Frameworks Data:",H);const{data:W,isLoading:vs,refetch:Ce}=o.evidence.list.useQuery({clientId:a},{enabled:!!a}),{data:q,isLoading:bs,refetch:ke}=o.evidence.getFiles.useQuery({evidenceId:((Ze=t==null?void 0:t.original)==null?void 0:Ze.id)||0},{enabled:!!((es=t==null?void 0:t.original)!=null&&es.id)}),{data:Se}=o.findings.list.useQuery({clientId:a},{enabled:!!a}),{data:Ae}=o.evidence.getAllComments.useQuery({clientId:a},{enabled:!!a}),ae=o.useContext(),U=o.evidence.seed.useMutation({onSuccess:()=>{p.success("Audit workspace initialized with request list."),ae.evidence.list.invalidate()}}),Ie=()=>{U.mutate({clientId:a,framework:h})},[_e,ge]=m.useState(!1),[y,G]=m.useState({evidenceId:"",description:"",clientControlId:"",owner:"",dueDate:""}),[K,De]=m.useState(null),[fs,He]=m.useState(!1),[Ns,je]=m.useState(!1),[I,Le]=m.useState({provider:"github",resourceId:""}),[ie,le]=m.useState("idle"),ws=()=>{if(!I.resourceId){p.error("Please enter a resource ID first");return}le("testing"),setTimeout(()=>{le("success"),p.success("Connection established successfully")},1500)},Fe=o.evidence.linkIntegration.useMutation({onSuccess:()=>{p.success("Integration Linked Successfully"),je(!1),Le({provider:"github",resourceId:""}),le("idle"),ae.evidence.list.invalidate()},onError:s=>{p.error(s.message)}}),ve=o.evidenceFiles.delete.useMutation({onSuccess:()=>{p.success("File removed successfully"),ke(),ae.evidence.list.invalidate()},onError:s=>{p.error(s.message)}}),ys=o.evidenceFiles.create.useMutation({onSuccess:()=>{ke(),ae.evidence.list.invalidate()},onError:s=>p.error(s.message)}),Cs=async s=>{var D;const x=Array.from(s.target.files||[]);if(x.length===0)return;const b=(D=t==null?void 0:t.original)==null?void 0:D.id;if(b)for(const f of x)try{const R=new FileReader,ts=new Promise((Fs,Es)=>{R.onload=async()=>{try{const Re=R.result.split(",")[1],Ts=Date.now(),Ms=Math.random().toString(36).substring(2,8),Os=f.name.split(".").pop()||"",as=`evidence-${b}-${Ts}-${Ms}.${Os}`,is=await fetch("/api/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:as,data:Re,contentType:f.type,folder:"evidence"})});if(!is.ok)throw new Error("Upload failed");const{key:Rs,url:zs}=await is.json();await ys.mutateAsync({evidenceId:b,filename:as,originalFilename:f.name,mimeType:f.type,size:f.size,fileKey:Rs,url:zs}),Fs()}catch(Re){Es(Re)}},R.readAsDataURL(f)});p.promise(ts,{loading:`Uploading ${f.name}...`,success:`${f.name} uploaded successfully`,error:`Failed to upload ${f.name}`}),await ts}catch(R){console.error(R)}},ks=()=>{!t||!I.resourceId||Fe.mutate({evidenceId:t.original.id,provider:I.provider,resourceId:I.resourceId})},{data:Ee}=o.audit.list.useQuery({clientId:a},{enabled:!!a}),be=Ee==null?void 0:Ee[0],Ss=s=>s?s.split(" ").map(x=>x[0]).join("").slice(0,2).toUpperCase():"??",Te=o.evidence.create.useMutation({onSuccess:()=>{p.success("Evidence request created successfully"),ge(!1),G({evidenceId:"",description:"",clientControlId:"",owner:"",dueDate:""}),Ce()},onError:s=>{p.error("Failed to create request: "+s.message)}}),{data:Me}=o.clientControls.list.useQuery({clientId:a},{enabled:_e}),As=()=>{if(!y.description||!y.clientControlId){p.error("Description and Control are required");return}Te.mutate({clientId:a,clientControlId:parseInt(y.clientControlId),evidenceId:y.evidenceId||`MANUAL-${Date.now().toString().slice(-4)}`,description:y.description,owner:y.owner})},Oe=o.evidence.updateStatus.useMutation({onSuccess:()=>{p.success("Audit status updated"),Ce()},onError:s=>{p.error("Failed to update status: "+s.message)}}),[Is,fe]=m.useState(!1),[re,We]=m.useState(null),qe=o.evidence.delete.useMutation({onSuccess:()=>{p.success("Evidence request deleted"),Ce(),j(null),fe(!1),We(null)},onError:s=>{p.error("Failed to delete request: "+s.message)}}),Ds=(s,x)=>{s.stopPropagation(),We(x),fe(!0)},Ls=()=>{re&&qe.mutate({id:re.original.id})},Ge=s=>{var x;(x=t==null?void 0:t.original)!=null&&x.id&&(Oe.mutate({evidenceId:t.original.id,status:s}),j({...t,status:s==="verified"?"Accepted":"Returned"}))},ne=(W==null?void 0:W.map(s=>{var x;return{id:s.evidenceId||`EV-${s.id}`,title:s.title||"Untitled Request",control:((x=s.control)==null?void 0:x.controlCode)||"General",status:s.status==="verified"?"Accepted":s.status==="collected"?"In Review":"Open",comments:0,evidence:s.fileCount||0,dueDate:s.dueDate||null,description:s.description,original:s}}))||[],C=ne.filter(s=>{var R;const x=A==="all"||s.status.toLowerCase()===A.toLowerCase(),b=(R=s.original.framework)==null?void 0:R.toString().trim().toLowerCase(),D=h.trim().toLowerCase();return x&&(!b&&D==="iso 27001"||b===D||D==="all"||b==="custom"||!b)});m.useEffect(()=>{C.length>0&&!t&&(j(C[0]),c("pbc"))},[C,t]),ne.length,ne.filter(s=>s.status==="Accepted").length,ne.filter(s=>s.status==="In Review").length,ne.filter(s=>s.status==="Open").length;const Ke=s=>{switch(s){case"Accepted":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"In Review":return"bg-amber-100 text-amber-700 border-amber-200";case"Returned":return"bg-rose-100 text-rose-700 border-rose-200";case"Open":return"bg-slate-100 text-slate-700 border-slate-200";default:return"bg-slate-100 text-slate-700"}};return e.jsxs(se,{children:[e.jsxs("div",{className:"flex flex-col h-[calc(100vh-64px)] w-full bg-slate-50/50 overflow-hidden",children:[e.jsxs("header",{className:"h-16 bg-white border-b flex items-center justify-between px-6 shrink-0 z-40 relative shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-[#0f172a] h-9 w-9 rounded-lg flex items-center justify-center shadow-sm ring-1 ring-slate-900/5",children:e.jsx(ls,{className:"h-5 w-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-slate-900 leading-tight tracking-tight",children:"AuditWorkspaceâ„¢"}),e.jsx("div",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wider",children:"Secure Clean Room"})]})]}),e.jsx("div",{className:"h-8 w-px bg-slate-200"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tighter",children:"Compliance Standard"}),e.jsxs(de,{value:h,onValueChange:u,children:[e.jsx(ce,{className:"w-[180px] h-9 bg-slate-50 border-slate-200 text-xs font-semibold text-slate-700",children:e.jsx(oe,{placeholder:"Select Framework"})}),e.jsxs(xe,{children:[H==null?void 0:H.map(s=>e.jsx(S,{value:s.id,className:"text-xs",children:s.name},s.id)),(!H||H.length===0)&&e.jsx(S,{value:"ISO 27001",className:"text-xs",children:"ISO 27001"})]})]})]}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-semibold text-sm text-slate-800",children:[h," Sync"]}),e.jsx(E,{variant:"outline",className:"text-[10px] h-5 px-1.5 font-normal bg-slate-50 text-slate-600 border-slate-200",children:"FY2025"})]}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Client ID: #",a]})]})]}),(()=>{const s=C.length,x=C.filter(D=>D.status==="Accepted").length,b=s>0?Math.round(x/s*100):0;return e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pr-6 border-r border-slate-100",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[10px] font-semibold uppercase text-slate-400 tracking-wider",children:"Audit Status"}),e.jsxs("div",{className:"text-sm font-bold text-slate-700",children:[b,"% Verified"]})]}),e.jsx("div",{className:"w-24 h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-emerald-500 h-full rounded-full transition-all duration-1000",style:{width:`${b}%`}})})]}),e.jsx(ot,{title:"Audit Hub",description:"Centralized workspace for audit evidence and external auditor collaboration.",rationale:"Streamlines the audit process by providing a secure, auditable 'Clean Room' where auditors only see verified evidence.",howToUse:[{step:"Initialize PBC",description:"Use the rotate icon in the sidebar to sync a standard request list."},{step:"Collect Evidence",description:"Drag and drop files or link integrations to fulfill requests."},{step:"Internal Review",description:"Set status to 'Verified' to make evidence visible to the auditor."},{step:"Manage Findings",description:"Track auditor observations and link them to remediation tasks."}],integrations:[{name:"Global Vault",description:"Sync existing evidence."},{name:"Magic Links",description:"Secure external auditor access."}]}),js&&e.jsxs(V,{open:v,onOpenChange:O,children:[e.jsx(xs,{asChild:!0,children:e.jsxs(d,{variant:"outline",size:"sm",className:"h-9 gap-2 bg-white border-slate-200 text-slate-700 hover:bg-slate-50 hover:text-slate-900 font-medium",children:[e.jsx(xt,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Invite Auditor"})]})}),e.jsxs(B,{className:"sm:max-w-[425px]",children:[e.jsxs($,{children:[e.jsx(Q,{children:"Invite External Auditor"}),e.jsx(_,{children:"Send a secure link to an external auditor to review evidence for this client."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Auditor Email"}),e.jsx(F,{id:"email",value:n,onChange:D=>L(D.target.value),placeholder:"auditor@firm.com"})]})}),e.jsxs(Z,{children:[e.jsx(d,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),e.jsx(d,{onClick:Qe,disabled:te.isLoading,children:te.isLoading?"Sending...":"Send Invitation"})]})]})]})]})})()]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("nav",{className:"w-64 bg-slate-50 border-r border-slate-200 flex flex-col shrink-0 relative z-30",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 pr-2",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Workspace"}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-slate-200 rounded-full",onClick:()=>ge(!0),title:"Add Manual Request",children:e.jsx(mt,{className:"h-3.5 w-3.5 text-slate-500"})})]}),(()=>{const s=C.length,x=C.filter(f=>f.status==="Accepted").length,b=s>0?Math.round(x/s*100):0,D=f=>f===0?"Not Started":f<30?"Planning":f<70?"Evidence Collection":f<100?"Final Review":"Audit Ready";return e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm mb-6 flex flex-col items-center text-center",children:[e.jsx(Zs,{value:b,size:72,strokeWidth:6,color:"text-indigo-600",className:"mb-3"}),e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Audit Readiness"}),e.jsx("div",{className:"text-sm font-extrabold text-slate-900 mb-1",children:D(b)}),e.jsxs("div",{className:"text-[10px] text-slate-500 font-medium",children:[x," / ",s," Verified"]})]})})(),e.jsxs("div",{className:"space-y-1",children:[e.jsx(we,{active:i==="overview",onClick:()=>c("overview"),icon:Ws,label:"Overview"}),e.jsx(we,{active:i==="pbc",onClick:()=>c("pbc"),icon:me,label:"PBC Inbox",count:C.length}),e.jsx(we,{active:i==="findings",onClick:()=>c("findings"),icon:rs,label:"Findings",count:(Se==null?void 0:Se.length)??0}),e.jsx(we,{active:i==="discussions",onClick:()=>c("discussions"),icon:pe,label:"Discussions",count:(Ae==null?void 0:Ae.length)||0})]})]}),e.jsx("div",{className:"mt-auto p-6 border-t border-slate-200",children:be?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200 shadow-sm",children:[e.jsx(he,{className:"h-9 w-9 border-2 border-slate-50 bg-slate-100",children:e.jsx(ue,{className:"text-xs font-bold text-slate-600",children:Ss(be.auditorName||"Unknown")})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-bold text-slate-900 truncate",children:be.auditorName||"Auditor Assigned"}),e.jsx("div",{className:"text-[10px] text-slate-500 truncate",children:be.auditFirm||"External Audit"})]})]}):e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-dashed border-slate-300 text-center",children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-medium mb-2",children:"No active audit detected"}),e.jsx(d,{variant:"outline",size:"sm",className:"w-full h-7 text-[10px] bg-white",onClick:()=>O(!0),children:"Invite Auditor"})]})})]}),i==="pbc"&&e.jsxs("div",{className:"w-96 bg-white border-r border-slate-200 flex flex-col shrink-0 z-20 shadow-sm h-full max-h-full overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 space-y-3 bg-white/50 backdrop-blur-sm sticky top-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-bold text-slate-800 text-sm tracking-tight",children:"Evidence Requests"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"ghost",size:"icon",className:"h-5 w-5 text-slate-400 hover:text-indigo-600",onClick:s=>{s.stopPropagation(),Ie()},disabled:U.isLoading,title:"Sync Standard Requests",children:e.jsx(Ne,{className:w("h-3 w-3",U.isLoading&&"animate-spin")})}),e.jsx(E,{variant:"secondary",className:"bg-slate-100 text-slate-600 border-0 text-[10px] h-5",children:C.length})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Be,{className:"absolute left-2.5 top-2.5 h-3.5 w-3.5 text-slate-400"}),e.jsx(F,{placeholder:"Search by ID or title...",className:"pl-8 bg-slate-50 border-slate-200 h-9 text-xs focus-visible:ring-indigo-500"})]}),e.jsxs(de,{value:A,onValueChange:k,children:[e.jsx(ce,{className:"w-[110px] h-9 text-xs bg-white border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ht,{className:"h-3 w-3 text-slate-400"}),e.jsx(oe,{})]})}),e.jsxs(xe,{children:[e.jsx(S,{value:"all",children:"All Status"}),e.jsx(S,{value:"Open",children:"Open"}),e.jsx(S,{value:"In Review",children:"In Review"}),e.jsx(S,{value:"Accepted",children:"Accepted"})]})]})]})]}),e.jsx("div",{className:"flex-1 bg-slate-50/30 overflow-y-auto min-h-0",children:vs?e.jsx("div",{className:"p-4 space-y-3",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-16 bg-white border border-slate-100 rounded-lg animate-pulse"},s))}):e.jsx("div",{className:"divide-y divide-slate-100",children:C.length===0?e.jsxs("div",{className:"p-8 text-center bg-slate-50/50 rounded-xl m-4 border border-slate-100",children:[e.jsx("div",{className:"bg-white h-12 w-12 rounded-full flex items-center justify-center mx-auto mb-4 shadow-sm ring-1 ring-slate-900/5",children:e.jsx(ls,{className:"h-6 w-6 text-indigo-500"})}),e.jsx("h3",{className:"text-sm font-bold text-slate-900 mb-1",children:"Standard Not Initialized"}),e.jsxs("p",{className:"text-xs text-slate-500 mb-6 max-w-[200px] mx-auto leading-relaxed",children:["No requests found for ",e.jsx("span",{className:"font-semibold text-slate-700",children:h}),". Would you like to populate the standard request list?"]}),e.jsx(d,{size:"sm",variant:"default",className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm ring-1 ring-slate-900/10 gap-2 h-9",onClick:Ie,disabled:U.isLoading,children:U.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-3.5 w-3.5 animate-spin"}),e.jsx("span",{children:"Initializing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:["Initialize ",h]})]})}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-4 italic",children:"This will import verified seed requests for this standard."})]}):C.map(s=>e.jsxs("div",{onClick:()=>j(s),className:w("group px-4 py-3 cursor-pointer border-b border-slate-100 transition-colors relative",(t==null?void 0:t.id)===s.id?"bg-white shadow-sm z-10":"bg-white/50 hover:bg-white"),children:[(t==null?void 0:t.id)===s.id&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-[4px] bg-indigo-600"}),e.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx("span",{className:w("font-medium text-xs truncate max-w-[120px]",(t==null?void 0:t.id)===s.id?"text-indigo-700":"text-slate-900"),children:s.id}),!s.status||s.status==="pending"||s.status==="Open"?e.jsx("span",{className:"h-2 w-2 rounded-full bg-indigo-600 shrink-0",title:"Unread"}):null]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("span",{className:w("text-[10px] whitespace-nowrap",(t==null?void 0:t.id)===s.id?"text-indigo-600/80":"text-slate-400 group-hover:text-slate-500"),children:s.dueDate?new Date(s.dueDate).toLocaleDateString("en-GB",{day:"numeric",month:"short"}):""}),e.jsx("button",{className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 text-slate-400 hover:text-red-500",onClick:x=>Ds(x,s),title:"Delete",children:e.jsx(ds,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:w("text-sm mb-1 leading-tight truncate pr-2",(t==null?void 0:t.id)===s.id?"font-bold text-slate-900":"font-medium text-slate-700 group-hover:text-slate-900"),children:s.title}),e.jsxs("div",{className:"text-xs text-slate-500 line-clamp-1 mb-2.5 pr-4",children:[e.jsx("span",{className:"text-slate-400 mr-1",children:s.framework||"General"}),s.description||"No description provided..."]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{variant:"secondary",className:w("text-[10px] h-4 px-1.5 font-normal bg-transparent border-0 p-0",Ke(s.status).replace("bg-","text-").replace("/10","")),children:s.status}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-slate-400",children:[s.evidence>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3 text-slate-500"}),e.jsx("span",{children:s.evidence})]}),s.comments>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3 text-slate-500"}),e.jsx("span",{children:s.comments})]})]})]})]},s.id))})}),e.jsxs("div",{className:"p-2 border-t border-slate-100 bg-slate-50 text-[10px] text-slate-400 font-mono",children:["Total: ",(W==null?void 0:W.length)||0," | Shown: ",C.length," | Client: ",a]})]}),e.jsx("div",{className:"flex-1 bg-slate-50/30 flex flex-col h-full min-w-0 overflow-auto",children:i==="pbc"?t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 px-8 py-6 flex items-start justify-between shrink-0 sticky top-0 z-30 shadow-sm",children:[e.jsxs("div",{className:"max-w-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(E,{variant:"outline",className:"bg-slate-50 text-slate-700 border-slate-200 font-mono tracking-tight text-[11px]",children:t.control}),e.jsxs("span",{className:"text-slate-400 text-xs font-medium uppercase tracking-wider",children:["Due ",new Date(t.dueDate).toLocaleDateString()]})]}),e.jsx("h1",{className:"text-xl font-bold text-slate-900 mb-3 leading-tight",children:t.title}),e.jsx("p",{className:"text-slate-600 text-sm leading-relaxed max-w-xl",children:t.description||"Please provide evidence demonstrating compliance with this control requirement. Ensure all documents are recent (within last 12 months) and approved by management."})]}),e.jsxs("div",{className:"flex flex-col items-end gap-3",children:[e.jsx(E,{variant:"outline",className:w("px-3 py-1 text-xs font-semibold uppercase tracking-wider border",Ke(t.status)),children:t.status}),t.status!=="Accepted"&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(d,{variant:"outline",size:"sm",className:"h-8 border-rose-200 text-rose-700 hover:bg-rose-50 hover:text-rose-800 hover:border-rose-300 gap-2 font-medium",onClick:()=>Ge("rejected"),disabled:Oe.isLoading,children:[e.jsx(rs,{className:"h-3.5 w-3.5"})," Return"]}),e.jsxs(d,{size:"sm",className:"h-8 bg-emerald-600 hover:bg-emerald-700 text-white gap-2 font-medium shadow-sm",onClick:()=>Ge("verified"),disabled:Oe.isLoading,children:[e.jsx(me,{className:"h-3.5 w-3.5"})," Verify & Accept"]})]})]})]}),e.jsxs(Ys,{defaultValue:"evidence",className:"flex-1 flex flex-col min-h-0",children:[e.jsx("div",{className:"bg-white border-b px-8 sticky top-[calc(theme(spacing.24)+theme(spacing.10))] z-20",children:e.jsxs(Xs,{className:"bg-transparent h-12 w-full justify-start p-0 space-x-8",children:[e.jsx(ze,{value:"evidence",className:"h-12 rounded-none border-b-2 border-transparent data-[state=active]:border-indigo-600 data-[state=active]:text-indigo-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none px-0 font-medium text-slate-500 hover:text-slate-700",children:"Evidence Files"}),e.jsx(ze,{value:"activity",className:"h-12 rounded-none border-b-2 border-transparent data-[state=active]:border-indigo-600 data-[state=active]:text-indigo-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none px-0 font-medium text-slate-500 hover:text-slate-700",children:"Activity & Discussion"}),e.jsx(ze,{value:"audit-log",className:"h-12 rounded-none border-b-2 border-transparent data-[state=active]:border-indigo-600 data-[state=active]:text-indigo-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none px-0 font-medium text-slate-500 hover:text-slate-700",children:"Audit Log"})]})}),e.jsxs("div",{className:"flex-1 overflow-auto bg-slate-50/50",children:[e.jsxs(ns,{value:"evidence",className:"m-0 p-8 max-w-5xl mx-auto w-full focus-visible:ring-0 outline-none",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Evidence Documentation"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(dt,{name:ct.EVIDENCE_TOOLBAR_ACTIONS,props:{evidenceId:t.original.id,controlName:t.control,controlDescription:t.description||t.evidenceDescription||"No description provided"}}),e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>He(!0),children:[e.jsx(Be,{className:"h-4 w-4"}),"Select from Library"]}),e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>{var s;return(s=document.getElementById("audit-hub-upload-input"))==null?void 0:s.click()},children:[e.jsx(ut,{className:"h-4 w-4"}),"Upload New"]}),e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>je(!0),children:[e.jsx(Ue,{className:"h-4 w-4"}),"Link Integration"]}),e.jsx("input",{id:"audit-hub-upload-input",type:"file",className:"hidden",onChange:Cs,multiple:!0})]})]}),t.evidence===0&&!(q!=null&&q.length)?e.jsx("div",{className:"p-6",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"p-8 text-center text-slate-400",children:"Loading uploader..."}),children:e.jsx(ft,{evidenceId:t.original.id,clientId:a})})}):e.jsx(T,{className:"border-slate-200 shadow-sm overflow-hidden",children:e.jsxs(ms,{children:[e.jsx(hs,{className:"bg-slate-50/50",children:e.jsxs(z,{className:"hover:bg-transparent border-slate-100",children:[e.jsx(M,{className:"w-[40%] text-xs font-semibold text-slate-500 uppercase tracking-wider h-10",children:"Filename / Resource"}),e.jsx(M,{className:"w-[20%] text-xs font-semibold text-slate-500 uppercase tracking-wider h-10",children:"Date Uploaded"}),e.jsx(M,{className:"w-[15%] text-xs font-semibold text-slate-500 uppercase tracking-wider h-10",children:"Type"}),e.jsx(M,{className:"w-[15%] text-xs font-semibold text-slate-500 uppercase tracking-wider h-10",children:"Validation"}),e.jsx(M,{className:"w-[10%] text-right text-xs font-semibold text-slate-500 uppercase tracking-wider h-10",children:"Action"})]})}),e.jsxs(us,{children:[bs?e.jsx(z,{children:e.jsx(N,{colSpan:5,className:"h-24 text-center text-slate-400",children:"Loading evidence..."})}):q==null?void 0:q.map(s=>e.jsxs(z,{className:"hover:bg-slate-50/50 group border-slate-100 transition-colors",children:[e.jsx(N,{className:"font-medium text-slate-700 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-indigo-50 rounded flex items-center justify-center shrink-0 border border-indigo-100 text-indigo-600",children:s.fileUrl?e.jsx(Ve,{className:"h-4 w-4"}):e.jsx(Ue,{className:"h-4 w-4"})}),e.jsx("button",{className:"truncate max-w-[240px] hover:text-indigo-600 hover:underline text-left transition-colors",title:`Open ${s.filename}`,onClick:()=>s.fileUrl&&window.open(s.fileUrl,"_blank"),children:s.filename})]})}),e.jsxs(N,{className:"text-slate-500 text-xs",children:[new Date(s.createdAt).toLocaleDateString()," ",new Date(s.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),e.jsx(N,{className:"text-slate-500 text-xs font-mono",children:s.contentType||"Integration"}),e.jsx(N,{children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 rounded-full bg-emerald-50 text-emerald-700 text-[10px] font-medium border border-emerald-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"})," Safe"]})}),e.jsxs(N,{className:"text-right",children:[s.fileUrl&&e.jsx(d,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50",onClick:()=>window.open(s.fileUrl,"_blank"),children:e.jsx(cs,{className:"h-4 w-4"})}),e.jsx(d,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-slate-400 hover:text-red-600 hover:bg-red-50",onClick:()=>De(s),disabled:ve.isLoading,children:ve.isLoading?e.jsx(os,{className:"h-4 w-4 animate-spin"}):e.jsx(ds,{className:"h-4 w-4"})})]})]},s.id)),t.type==="api"&&e.jsxs(z,{className:"hover:bg-slate-50/50 group border-slate-100 transition-colors",children:[e.jsx(N,{className:"font-medium text-slate-700 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-blue-50 rounded flex items-center justify-center shrink-0 border border-blue-100 text-blue-600",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsxs("span",{className:"truncate max-w-[240px]",children:["Link Integration: ",t.location]})]})}),e.jsx(N,{className:"text-slate-500 text-xs",children:new Date(t.updatedAt).toLocaleDateString()}),e.jsx(N,{className:"text-slate-500 text-xs font-mono",children:"API Link"}),e.jsx(N,{children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 rounded-full bg-blue-50 text-blue-700 text-[10px] font-medium border border-blue-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 animate-pulse"})," Active"]})}),e.jsx(N,{className:"text-right",children:e.jsx(d,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50",children:e.jsx(Ue,{className:"h-4 w-4"})})})]})]})]})})]}),e.jsx(ns,{value:"activity",className:"m-0 p-8 max-w-4xl mx-auto w-full focus-visible:ring-0",children:e.jsx(Nt,{request:t})})]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center text-slate-400 bg-slate-50/50",children:[e.jsx("div",{className:"h-24 w-24 bg-white rounded-2xl flex items-center justify-center shadow-sm mb-6 border border-slate-100",children:e.jsx(pt,{className:"h-10 w-10 text-slate-300"})}),e.jsx("h2",{className:"text-lg font-bold text-slate-700 mb-2",children:C.length>0?"Select a Request":"Ready to Audit"}),e.jsx("p",{className:"max-w-xs text-slate-500 text-sm mb-8 leading-relaxed",children:C.length>0?"Select a request from the list on the left to view evidence, verify compliance, and leave findings.":"Initialize the workspace to generate the standard evidence request list for this framework."}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsxs(d,{variant:"outline",className:"gap-2 text-indigo-600 border-indigo-200 bg-indigo-50 hover:bg-indigo-100 h-9 text-sm",children:[e.jsx(cs,{className:"h-4 w-4"})," Audit Methodology"]}),e.jsx(d,{className:"gap-2 h-9 text-sm",onClick:Ie,disabled:U.isLoading,children:U.isLoading?"Updating...":C.length>0?"Update Workspace":"Initialize Workspace"})]}),C.length>0&&e.jsx("p",{className:"text-[10px] text-slate-400 mt-4 max-w-sm",children:'Tip: Click "Update Workspace" to add any missing standard requests for the selected framework without affecting existing work.'})]}):i==="overview"?e.jsx(wt,{clientId:a,onNavigate:(s,x)=>{c(s),x&&k(x)}}):i==="findings"?e.jsx(yt,{clientId:a}):i==="discussions"?e.jsx(Ct,{clientId:a}):null})]})]}),e.jsx(V,{open:Is,onOpenChange:fe,children:e.jsxs(B,{className:"sm:max-w-[425px]",children:[e.jsxs($,{children:[e.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mb-4",children:e.jsx(ye,{className:"h-6 w-6 text-red-600"})}),e.jsx(Q,{className:"text-center text-lg font-bold text-slate-900",children:"Delete Evidence Request?"}),e.jsxs(_,{className:"text-center text-sm text-slate-500 max-w-[300px] mx-auto leading-relaxed pt-2",children:["Are you sure you want to delete ",e.jsxs("span",{className:"font-semibold text-slate-700",children:['"',re==null?void 0:re.title,'"']}),"? This action cannot be undone and will remove all associated findings."]})]}),e.jsxs(Z,{className:"grid grid-cols-2 gap-3 sm:space-x-0 pt-6",children:[e.jsx(d,{variant:"outline",onClick:()=>fe(!1),className:"h-10 font-medium border-slate-200 hover:bg-slate-50",children:"Cancel"}),e.jsx(d,{variant:"destructive",onClick:Ls,className:"h-10 font-semibold bg-red-600 hover:bg-red-700 text-white shadow-sm ring-1 ring-red-700/10",children:qe.isLoading?"Deleting...":"Delete Request"})]})]})}),e.jsx(V,{open:_e,onOpenChange:ge,children:e.jsxs(B,{className:"sm:max-w-[500px]",children:[e.jsxs($,{children:[e.jsx(Q,{children:"Add Manual Evidence Request"}),e.jsx(_,{children:"Create a new evidence request linked to a specific control."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Reference ID *"}),e.jsx(F,{value:y.evidenceId,onChange:s=>G({...y,evidenceId:s.target.value}),placeholder:"e.g. MANUAL-001"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Control *"}),e.jsxs(de,{value:y.clientControlId,onValueChange:s=>G({...y,clientControlId:s}),children:[e.jsx(ce,{children:e.jsx(oe,{placeholder:"Select a control..."})}),e.jsx(xe,{className:"max-h-[300px]",children:Me==null?void 0:Me.map(s=>{var x,b;return e.jsxs(S,{value:s.clientControl.id.toString(),children:[e.jsx("span",{className:"font-mono text-xs mr-2 text-slate-500",children:((x=s.control)==null?void 0:x.controlId)||s.clientControl.clientControlId}),((b=s.control)==null?void 0:b.name)||"Unknown Control"]},s.clientControl.id)})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description *"}),e.jsx(F,{value:y.description,onChange:s=>G({...y,description:s.target.value}),placeholder:"Describe the evidence required..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Owner"}),e.jsx(F,{value:y.owner,onChange:s=>G({...y,owner:s.target.value}),placeholder:"Optional"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Due Date"}),e.jsx(F,{type:"date",value:y.dueDate,onChange:s=>G({...y,dueDate:s.target.value})})]})]})]}),e.jsxs(Z,{children:[e.jsx(d,{variant:"outline",onClick:()=>ge(!1),children:"Cancel"}),e.jsx(d,{onClick:As,disabled:Te.isLoading,children:Te.isLoading?"Creating...":"Create Request"})]})]})}),e.jsx(V,{open:v,onOpenChange:O,children:e.jsxs(B,{children:[e.jsxs($,{children:[e.jsx(Q,{children:"Invite Auditor"}),e.jsx(_,{children:"This will send an email invitation to the external auditor to access this specific clean room."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(qs,{htmlFor:"email",className:"text-right",children:"Email"}),e.jsx(F,{id:"email",value:n,onChange:s=>L(s.target.value),className:"col-span-3",placeholder:"auditor@firm.com"})]})}),e.jsxs(Z,{children:[e.jsx(d,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),e.jsx(d,{onClick:Qe,disabled:te.isLoading||!n,children:te.isLoading?"Sending Invitation...":"Send Invitation"})]})]})}),e.jsx(V,{open:Ns,onOpenChange:je,children:e.jsxs(B,{className:"sm:max-w-[500px]",children:[e.jsxs($,{children:[e.jsx(Q,{children:"Link Automated Evidence"}),e.jsx(_,{children:"Connect an external integration to automatically collect evidence for this control."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Integration Provider"}),e.jsxs(de,{value:I.provider,onValueChange:s=>{Le({...I,provider:s}),le("idle")},children:[e.jsx(ce,{children:e.jsx(oe,{placeholder:"Select provider"})}),e.jsxs(xe,{children:[e.jsx(S,{value:"github",children:"GitHub (Commits/PRs)"}),e.jsx(S,{value:"aws",children:"AWS CloudTrail"}),e.jsx(S,{value:"jira",children:"Jira Tickets"}),e.jsx(S,{value:"s3",children:"S3 Bucket Policy"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Resource ID / URL"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(F,{value:I.resourceId,onChange:s=>{Le({...I,resourceId:s.target.value}),le("idle")},placeholder:I.provider==="github"?"https://github.com/org/repo/pull/123":I.provider==="aws"?"arn:aws:cloudtrail:us-east-1:123456789012:trail/management-events":"Resource Identifier",className:"flex-1"})}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-[10px] text-slate-500",children:"The system will monitor this resource for changes."}),ie==="success"?e.jsxs("span",{className:"text-[10px] font-bold text-emerald-600 flex items-center gap-1",children:[e.jsx(me,{className:"h-3 w-3"})," Connection Verified"]}):ie==="testing"?e.jsxs("span",{className:"text-[10px] font-bold text-indigo-600 flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3 animate-spin"})," Verifying..."]}):e.jsx(d,{variant:"ghost",size:"sm",className:"h-6 text-[10px] text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50 px-2",onClick:ws,disabled:!I.resourceId,children:"Test Connection"})]})]})]}),e.jsxs(Z,{children:[e.jsx(d,{variant:"outline",onClick:()=>je(!1),children:"Cancel"}),e.jsx(d,{onClick:ks,disabled:Fe.isLoading||!I.resourceId||ie!=="success",className:w(ie==="success"?"bg-emerald-600 hover:bg-emerald-700":""),children:Fe.isLoading?"Linking...":ie==="success"?"Confirm Integration":"Connect Integration"})]})]})}),e.jsx(vt,{open:fs,onOpenChange:He,clientId:a,evidenceId:((ss=t==null?void 0:t.original)==null?void 0:ss.id)||0,onSuccess:()=>{ke(),ae.evidence.list.invalidate()}}),e.jsx(et,{open:!!K,onOpenChange:s=>!s&&De(null),children:e.jsxs(st,{children:[e.jsxs(tt,{children:[e.jsx(at,{children:"Are you sure?"}),e.jsxs(it,{children:['This will permanently remove the evidence file "',K==null?void 0:K.filename,'". This action cannot be undone.']})]}),e.jsxs(lt,{children:[e.jsx(rt,{children:"Cancel"}),e.jsx(nt,{className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",onClick:()=>{K&&(ve.mutate({id:K.id}),De(null))},children:ve.isLoading?"Deleting...":"Delete"})]})]})})]})}function Nt({request:g}){const[l,a]=m.useState(""),{user:i}=$e(),c=o.useContext(),t=g.original.id,{data:j,isLoading:A}=o.evidence.getComments.useQuery({evidenceId:t},{enabled:!!t,refetchInterval:5e3}),k=o.evidence.addComment.useMutation({onSuccess:()=>{a(""),c.evidence.getComments.invalidate({evidenceId:t}),p.success("Comment posted")},onError:u=>{p.error("Failed to post comment")}}),h=()=>{l.trim()&&k.mutate({evidenceId:t,content:l})};return e.jsx("div",{className:"max-w-4xl p-0",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"space-y-6 min-h-[200px]",children:A?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading comments..."}):(j==null?void 0:j.length)===0?e.jsxs("div",{className:"p-8 bg-slate-50 rounded-lg border border-slate-100 text-center",children:[e.jsx(pe,{className:"h-8 w-8 text-slate-300 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-500 italic",children:"No discussion yet. Start a thread below."})]}):j==null?void 0:j.map(u=>{const r=u.userId===(i==null?void 0:i.id);return e.jsxs("div",{className:w("flex gap-3",r?"flex-row-reverse":"flex-row"),children:[e.jsx(he,{className:"h-8 w-8 shrink-0 mt-1",children:e.jsx(ue,{className:w("text-[10px]",r?"bg-indigo-100 text-indigo-700":"bg-slate-100 text-slate-600"),children:(u.userName||u.userEmail||"U").substring(0,2).toUpperCase()})}),e.jsxs("div",{className:w("flex flex-col max-w-[80%]",r?"items-end":"items-start"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:u.userName||u.userEmail}),e.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(u.createdAt).toLocaleString()})]}),e.jsx("div",{className:w("p-3 rounded-lg text-sm",r?"bg-indigo-600 text-white rounded-tr-none":"bg-white border rounded-tl-none shadow-sm text-slate-700"),children:u.content})]})]},u.id)})}),e.jsxs("div",{className:"flex gap-4 items-start pt-6 border-t mt-4",children:[e.jsx(he,{className:"h-8 w-8 hidden sm:block",children:e.jsx(ue,{className:"bg-indigo-50 text-indigo-600",children:"ME"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(gs,{placeholder:"Leave a comment, request clarification, or approve...",className:"min-h-[80px] bg-white",value:l,onChange:u=>a(u.target.value)}),e.jsx("div",{className:"flex justify-end",children:e.jsx(d,{size:"sm",className:"bg-indigo-600 text-white",onClick:h,disabled:k.isLoading||!l.trim(),children:k.isLoading?"Posting...":"Post Comment"})})]})]})]})})}function wt({clientId:g,onNavigate:l}){const{data:a}=o.evidence.list.useQuery({clientId:g}),{data:i}=o.findings.list.useQuery({clientId:g}),c=(a==null?void 0:a.filter(r=>r.status==="open"||r.status==="collected").length)||0,t=(a==null?void 0:a.filter(r=>r.status==="verified").length)||0,j=(a==null?void 0:a.length)||1,A=Math.round(t/j*100),k=(i==null?void 0:i.filter(r=>r.status==="open").length)||0,h=(i==null?void 0:i.filter(r=>r.status==="open"&&(r.severity==="high"||r.severity==="critical")).length)||0,u=(a==null?void 0:a.filter(r=>(r.commentCount||0)>0).length)||0;return e.jsxs("div",{className:"p-8 space-y-8 h-full flex flex-col",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Executive Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(T,{className:"shadow-sm border-slate-200",children:[e.jsxs(J,{className:"p-5 pb-1",children:[e.jsx(Y,{className:"text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Audit Progress"}),e.jsxs(X,{className:"text-3xl font-bold text-slate-900 tracking-tight",children:[A,"%"]})]}),e.jsxs(P,{className:"p-5 pt-3",children:[e.jsx("div",{className:"w-full h-1.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-600 rounded-full transition-all duration-1000",style:{width:`${A}%`}})}),e.jsxs("p",{className:"text-[11px] text-slate-400 mt-2 font-medium",children:[t," of ",j," controls verified"]})]})]}),e.jsxs(T,{className:"shadow-sm border-slate-200",children:[e.jsxs(J,{className:"p-5 pb-1",children:[e.jsx(Y,{className:"text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Open Requests"}),e.jsx(X,{className:"text-3xl font-bold text-slate-900 tracking-tight",children:c})]}),e.jsx(P,{className:"p-5 pt-3",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-amber-600 bg-amber-50 inline-flex px-2 py-0.5 rounded-full border border-amber-100",children:[e.jsx(gt,{className:"h-3 w-3"}),e.jsx("span",{children:"Action Required"})]})})]}),e.jsxs(T,{className:"shadow-sm border-slate-200",children:[e.jsxs(J,{className:"p-5 pb-1",children:[e.jsx(Y,{className:"text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Open Findings"}),e.jsx(X,{className:"text-3xl font-bold text-slate-900 tracking-tight",children:k})]}),e.jsx(P,{className:"p-5 pt-3",children:h>0?e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-red-600 bg-red-50 inline-flex px-2 py-0.5 rounded-full border border-red-100",children:[e.jsx(ye,{className:"h-3 w-3"}),e.jsxs("span",{children:[h," High Severity"]})]}):e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-emerald-600 bg-emerald-50 inline-flex px-2 py-0.5 rounded-full border border-emerald-100",children:[e.jsx(ps,{className:"h-3 w-3"}),e.jsx("span",{children:"Risk Low"})]})})]}),e.jsxs(T,{className:"shadow-sm border-slate-200",children:[e.jsxs(J,{className:"p-5 pb-1",children:[e.jsx(Y,{className:"text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Audit Phase"}),e.jsx(X,{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Fieldwork"})]}),e.jsx(P,{className:"p-5 pt-3",children:e.jsx("p",{className:"text-[11px] text-slate-400 font-medium",children:"Est. Completion: Feb 28, 2026"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(T,{className:"lg:col-span-2 shadow-sm border-slate-200 h-full",children:[e.jsx(J,{className:"border-b border-slate-100 bg-slate-50/50 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{className:"text-base font-semibold text-slate-900",children:"Priority Action Items"}),e.jsx(Y,{className:"text-xs",children:"Tasks requiring immediate attention to proceed."})]}),e.jsx(d,{variant:"ghost",size:"sm",className:"h-8 text-xs",onClick:()=>l("pbc","all"),children:"View All Tasks"})]})}),e.jsx(P,{className:"p-0",children:e.jsxs("div",{className:"divide-y divide-slate-100",children:[h>0&&e.jsxs("div",{className:"p-4 hover:bg-slate-50 transition-colors flex gap-4 items-start group cursor-pointer",onClick:()=>l("findings"),children:[e.jsx("div",{className:"mt-1 p-2 bg-red-50 text-red-600 rounded-lg border border-red-100 shrink-0",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 group-hover:text-indigo-700 transition-colors",children:"Resolve Critical Findings"}),e.jsx(E,{variant:"outline",className:"border-red-200 text-red-700 bg-red-50 text-[10px]",children:"High Priority"})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1 line-clamp-1",children:["There are ",h," high severity findings that impact compliance certification."]})]}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-300 opacity-0 group-hover:opacity-100",children:e.jsx(Pe,{className:"h-4 w-4 rotate-180"})})]}),c>0&&e.jsxs("div",{className:"p-4 hover:bg-slate-50 transition-colors flex gap-4 items-start group cursor-pointer",onClick:()=>l("pbc","open"),children:[e.jsx("div",{className:"mt-1 p-2 bg-indigo-50 text-indigo-600 rounded-lg border border-indigo-100 shrink-0",children:e.jsx(Ve,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 group-hover:text-indigo-700 transition-colors",children:"Submit Missing Evidence"}),e.jsx(E,{variant:"outline",className:"border-indigo-200 text-indigo-700 bg-indigo-50 text-[10px]",children:"Action Required"})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1 line-clamp-1",children:[c," evidence requests are pending submission."]})]}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-300 opacity-0 group-hover:opacity-100",children:e.jsx(Pe,{className:"h-4 w-4 rotate-180"})})]}),u>0?e.jsxs("div",{className:"p-4 hover:bg-slate-50 transition-colors flex gap-4 items-start group cursor-pointer",onClick:()=>l("pbc","all"),children:[e.jsx("div",{className:"mt-1 p-2 bg-slate-50 text-slate-500 rounded-lg border border-slate-100 shrink-0",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 group-hover:text-indigo-700 transition-colors",children:"Review Auditor Comments"}),e.jsx(E,{variant:"outline",className:"border-slate-200 text-slate-600 text-[10px]",children:"Review"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 line-clamp-1",children:"Check discussions on evidence requests."})]}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-300 opacity-0 group-hover:opacity-100",children:e.jsx(Pe,{className:"h-4 w-4 rotate-180"})})]}):null,h===0&&c===0&&u===0&&e.jsxs("div",{className:"p-8 text-center text-slate-400",children:[e.jsx(me,{className:"h-8 w-8 text-emerald-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"All caught up!"}),e.jsx("p",{className:"text-xs",children:"No priority actions required at this time."})]})]})})]}),e.jsxs(T,{className:"shadow-sm border-slate-200 h-full",children:[e.jsxs(J,{className:"border-b border-slate-100 bg-slate-50/50 py-4",children:[e.jsx(X,{className:"text-base font-semibold text-slate-900",children:"Recent Findings"}),e.jsx(Y,{className:"text-xs",children:"Latest observations"})]}),e.jsx(P,{className:"p-0",children:e.jsx("div",{className:"divide-y divide-slate-100",children:(i==null?void 0:i.length)===0?e.jsx("div",{className:"p-8 text-center text-slate-400 text-xs italic",children:"No findings reported."}):i==null?void 0:i.slice(0,5).map(r=>e.jsxs("div",{className:"p-3 flex items-start gap-3 hover:bg-slate-50 transition-colors group",children:[e.jsx("div",{className:w("mt-0.5 h-2 w-2 rounded-full shrink-0",r.severity==="critical"?"bg-red-600":r.severity==="high"?"bg-red-500":r.severity==="medium"?"bg-orange-500":"bg-yellow-500")}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-slate-900 truncate group-hover:text-indigo-700",children:r.title}),e.jsx("p",{className:"text-[10px] text-slate-400",children:new Date(r.createdAt).toLocaleDateString()})]})]},r.id))})})]})]})]})}function yt({clientId:g}){const[l,a]=m.useState(!1),i=o.useContext(),{data:c,isLoading:t}=o.findings.list.useQuery({clientId:g}),[j,A]=m.useState(""),[k,h]=m.useState(""),[u,r]=m.useState("medium"),ee=o.findings.create.useMutation({onSuccess:()=>{p.success("Finding created"),a(!1),A(""),h(""),i.findings.list.invalidate()}}),se=()=>{j&&ee.mutate({clientId:g,title:j,description:k,severity:u})};return e.jsxs("div",{className:"p-8 h-full flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-end border-b border-slate-100 pb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Audit Findings"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Official record of non-conformities and audit observations."})]}),e.jsxs(V,{open:l,onOpenChange:a,children:[e.jsx(xs,{asChild:!0,children:e.jsxs(d,{className:"bg-red-600 hover:bg-red-700 text-white gap-2 h-9 shadow-sm",children:[e.jsx(ye,{className:"h-4 w-4"})," Report New Finding"]})}),e.jsxs(B,{className:"sm:max-w-[500px]",children:[e.jsxs($,{children:[e.jsx(Q,{children:"Issue Formal Finding"}),e.jsx(_,{children:"Document a non-conformity found during the audit process."})]}),e.jsxs("div",{className:"grid gap-5 py-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Finding Title"}),e.jsx(F,{value:j,onChange:v=>A(v.target.value),placeholder:"e.g. Lack of Multi-Factor Authentication",className:"h-10 border-slate-200 focus:ring-red-500/10 focus:border-red-500/50"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Severity Level"}),e.jsxs(de,{value:u,onValueChange:v=>r(v),children:[e.jsx(ce,{className:"h-10 border-slate-200",children:e.jsx(oe,{placeholder:"Select severity"})}),e.jsxs(xe,{children:[e.jsx(S,{value:"low",children:"Low - Minor Observation"}),e.jsx(S,{value:"medium",children:"Medium - Process Issue"}),e.jsx(S,{value:"high",children:"High - Security Risk"}),e.jsx(S,{value:"critical",children:"Critical - Compliance Blocker"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Detailed Description"}),e.jsx(gs,{value:k,onChange:v=>h(v.target.value),placeholder:"Provide context, evidence references, and impact analysis...",className:"min-h-[120px] border-slate-200 focus:ring-red-500/10 focus:border-red-500/50"})]})]}),e.jsxs(Z,{className:"bg-slate-50/50 p-6 -m-6 mt-0 rounded-b-lg border-t border-slate-100",children:[e.jsx(d,{variant:"ghost",onClick:()=>a(!1),className:"h-10 font-medium",children:"Cancel"}),e.jsx(d,{variant:"destructive",onClick:se,className:"h-10 px-8 bg-red-600 hover:bg-red-700 font-semibold uppercase tracking-wide text-xs",children:"Confirm Finding"})]})]})]})]}),e.jsx(T,{className:"rounded-xl border-slate-200 overflow-hidden shadow-sm shadow-slate-200/50",children:e.jsxs(ms,{children:[e.jsx(hs,{className:"bg-slate-50/80",children:e.jsxs(z,{className:"hover:bg-transparent border-slate-100",children:[e.jsx(M,{className:"w-[140px] text-[11px] font-bold uppercase tracking-wider text-slate-500",children:"Severity"}),e.jsx(M,{className:"text-[11px] font-bold uppercase tracking-wider text-slate-500",children:"Identification & Title"}),e.jsx(M,{className:"w-[120px] text-[11px] font-bold uppercase tracking-wider text-slate-500",children:"Status"}),e.jsx(M,{className:"w-[120px] text-right text-[11px] font-bold uppercase tracking-wider text-slate-500",children:"Date Issued"})]})}),e.jsx(us,{children:t?e.jsx(z,{children:e.jsx(N,{colSpan:4,className:"text-center py-20 text-slate-400",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 w-32 bg-slate-100 mx-auto rounded"}),e.jsx("div",{className:"h-3 w-48 bg-slate-50 mx-auto rounded"})]})})}):(c==null?void 0:c.length)===0?e.jsx(z,{children:e.jsx(N,{colSpan:4,className:"text-center py-24 text-slate-400",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-16 w-16 bg-emerald-50 text-emerald-500 rounded-full flex items-center justify-center mb-4 border border-emerald-100",children:e.jsx(ps,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-slate-900 font-semibold mb-1",children:"No Non-Conformities Found"}),e.jsx("p",{className:"text-sm max-w-xs text-slate-500",children:"The audit has not yielded any formal findings yet. Continue review to maintain this status."})]})})}):c==null?void 0:c.map(v=>e.jsxs(z,{className:"cursor-pointer hover:bg-slate-50/50 transition-colors border-slate-50 group",children:[e.jsx(N,{children:e.jsx(E,{className:w("capitalize font-bold border-none px-2 py-0.5 text-[10px]",v.severity==="critical"?"bg-red-600/10 text-red-700 hover:bg-red-600/20":v.severity==="high"?"bg-red-600/10 text-red-600 hover:bg-red-600/20":v.severity==="medium"?"bg-orange-600/10 text-orange-700 hover:bg-orange-600/20":"bg-yellow-600/10 text-yellow-700 hover:bg-yellow-600/20"),children:v.severity})}),e.jsx(N,{children:e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"font-semibold text-slate-900 group-hover:text-indigo-600 transition-colors",children:v.title}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 line-clamp-1 font-medium",children:v.description})]})}),e.jsx(N,{children:e.jsx(E,{variant:"outline",className:"uppercase text-[9px] font-black border-slate-200 tracking-tight text-slate-500 bg-white",children:v.status})}),e.jsx(N,{className:"text-right text-slate-400 font-medium text-[11px]",children:new Date(v.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]},v.id))})]})})]})}function Ct({clientId:g}){const{data:l,isLoading:a}=o.evidence.getAllComments.useQuery({clientId:g});return e.jsxs("div",{className:"p-8 h-full flex flex-col space-y-6 text-left",children:[e.jsxs("div",{className:"border-b border-slate-100 pb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Audit Communications"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Centralized activity feed for all evidence requests and auditor feedback."})]}),e.jsx("div",{className:"space-y-4",children:a?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(i=>e.jsx("div",{className:"h-32 w-full bg-slate-50 animate-pulse rounded-xl"},i))}):(l==null?void 0:l.length)===0?e.jsxs("div",{className:"text-center py-24 bg-slate-50 border border-dashed border-slate-200 rounded-2xl",children:[e.jsx(pe,{className:"h-10 w-10 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-slate-900 font-semibold mb-1",children:"No Active Threads"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Activity across all workspaces will appear here."})]}):l==null?void 0:l.map(i=>e.jsx(T,{className:"hover:shadow-md transition-all duration-300 border-slate-200 group overflow-hidden",children:e.jsx(P,{className:"p-0",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1 bg-indigo-500 group-hover:bg-indigo-600 transition-colors"}),e.jsxs("div",{className:"flex-1 p-5 flex gap-5",children:[e.jsx(he,{className:"h-10 w-10 border border-slate-100 shadow-sm shrink-0",children:e.jsx(ue,{className:"bg-slate-50 text-slate-600 text-xs font-bold",children:(i.userName||"U").substring(0,2).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-slate-900 text-sm",children:i.userName||i.userEmail}),e.jsxs("span",{className:"text-[10px] text-slate-400 font-medium tracking-tight",children:[new Date(i.createdAt).toLocaleDateString()," at ",new Date(i.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs(d,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[10px] font-bold uppercase tracking-wider text-indigo-600 hover:bg-indigo-50 hover:text-indigo-700 bg-slate-50 border border-slate-100",children:["View Context ",e.jsx(jt,{className:"ml-1.5 h-3 w-3"})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[e.jsx("div",{className:"px-1.5 py-0.5 rounded bg-slate-100 border border-slate-200 text-[10px] font-bold text-slate-500 uppercase tracking-tight",children:"On Request"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700 truncate hover:text-indigo-600 cursor-pointer transition-colors",children:i.evidenceTitle||`Evidence Request #${i.evidenceId}`})]}),e.jsx("div",{className:"text-sm text-slate-700 leading-relaxed bg-slate-50 p-4 rounded-xl border border-slate-100 group-hover:border-slate-200 font-medium",children:i.content})]})]})]})})},i.id))})]})}function we({active:g,onClick:l,icon:a,label:i,count:c}){return e.jsxs("button",{onClick:l,className:w("w-full flex items-center gap-3 px-3 py-2.5 rounded-md text-sm font-medium transition-all group border-l-2",g?"bg-indigo-50 text-indigo-700 border-indigo-600 shadow-sm":"text-slate-600 hover:bg-slate-50 hover:text-slate-900 border-transparent hover:border-slate-200"),children:[e.jsx(a,{className:w("h-4.5 w-4.5 transition-colors",g?"text-indigo-600":"text-slate-400 group-hover:text-slate-600")}),e.jsx("span",{children:i}),c!==void 0&&e.jsx("span",{className:w("ml-auto text-[10px] font-bold py-0.5 px-2 rounded-full",g?"bg-indigo-100/50 text-indigo-700":"bg-slate-100 text-slate-500"),children:c})]})}export{wa as default};
