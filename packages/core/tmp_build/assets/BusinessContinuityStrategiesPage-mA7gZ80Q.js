import{ab as M,b as z,r as t,t as u,i as n,j as e,c as a,D as Q,ap as V,o as W,p as _,q as G,L as c,I as F,w as J,C as K,d as U,e as X,f as Y,m as Z,N as ee,O as se,P as R,Q as d,V as te,W as l,S as ae,l as ie,k as E}from"./index-DOc7Nwb7.js";import{T as k}from"./textarea-BtxBxzdY.js";import{D as re}from"./DashboardLayout-aHnUqq57.js";import{B as le}from"./Breadcrumb-CRi3LAxS.js";import{A as oe}from"./arrow-left-CpuUojG-.js";import{P as ne}from"./plus-BaQ35Jcx.js";import{D as ce}from"./dollar-sign-M9UCfTjq.js";import{T as de}from"./target-cfAj3L6j.js";import{P as me}from"./pencil-Bud7U1sU.js";import{T as he}from"./trash-2-CFEfisbM.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function es(){const q=M(),o=parseInt(q.id||"0"),[xe,L]=z(),[$,i]=t.useState(!1),[m,P]=t.useState(null),[h,p]=t.useState(""),[g,j]=t.useState(""),[b,f]=t.useState(""),[y,v]=t.useState(""),[N,C]=t.useState(""),{data:r,refetch:S}=u.businessContinuity.strategies.list.useQuery({clientId:o}),w=u.businessContinuity.strategies.create.useMutation({onSuccess:()=>{n.success("Strategy created successfully"),i(!1),x(),S()},onError:s=>n.error(`Failed to create: ${s.message}`)}),D=u.businessContinuity.strategies.update.useMutation({onSuccess:()=>{n.success("Strategy updated successfully"),i(!1),x(),S()},onError:s=>n.error(`Failed to update: ${s.message}`)}),I=u.businessContinuity.strategies.delete.useMutation({onSuccess:()=>{n.success("Strategy deleted"),S()}}),x=()=>{p(""),j(""),f(""),v(""),C(""),P(null)},B=()=>{x(),i(!0)},O=s=>{P(s),p(s.title),j(s.description||""),f(s.resourceRequirements||""),v(s.benefits||""),C(s.estimatedCost||""),i(!0)},A=()=>{h&&(m?D.mutate({id:m.id,title:h,description:g,resourceRequirements:b,estimatedCost:N,benefits:y}):w.mutate({clientId:o,title:h,description:g,resourceRequirements:b,estimatedCost:N,benefits:y}))},H=async(s,T)=>{s.stopPropagation(),confirm("Are you sure you want to delete this strategy?")&&I.mutate({id:T})};return e.jsx(re,{children:e.jsxs("div",{className:"space-y-6 w-full max-w-full p-6",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx(le,{items:[{label:"Clients",href:"/clients"},{label:"Business Continuity",href:`/clients/${o}/business-continuity`},{label:"Strategies",href:`/clients/${o}/business-continuity/strategies`}]}),e.jsxs(a,{variant:"ghost",size:"sm",className:"mt-2 -ml-3 text-muted-foreground hover:text-foreground",onClick:()=>L(`/clients/${o}/business-continuity`),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Back to BC Dashboard"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Recovery Strategies"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Define and manage strategies to recover critical activities."})]}),e.jsxs(Q,{open:$,onOpenChange:s=>{i(s),s||x()},children:[e.jsx(V,{asChild:!0,children:e.jsxs(a,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:B,children:[e.jsx(ne,{className:"mr-2 h-4 w-4"})," New Strategy"]})}),e.jsxs(W,{className:"sm:max-w-[700px]",children:[e.jsx(_,{children:e.jsx(G,{children:m?"Edit Strategy":"Define Recovery Strategy"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(c,{htmlFor:"title",children:"Strategy Title *"}),e.jsx(F,{id:"title",placeholder:"e.g., Cloud Failover to Secondary Region",value:h,onChange:s=>p(s.target.value),className:"font-medium"})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(c,{htmlFor:"description",children:"Description *"}),e.jsx(k,{id:"description",placeholder:"Detailed description of the strategy...",value:g,onChange:s=>j(s.target.value),className:"min-h-[100px]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"resources",children:"Resource Requirements"}),e.jsx(k,{id:"resources",placeholder:"People, tech, data needs...",value:b,onChange:s=>f(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"benefits",children:"Benefits / Mitigation"}),e.jsx(k,{id:"benefits",placeholder:"Expected RTO reduction, risk mitigation...",value:y,onChange:s=>v(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"cost",children:"Estimated Cost"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(F,{id:"cost",className:"pl-9",placeholder:"e.g., $5,000 / month",value:N,onChange:s=>C(s.target.value)})]})]})]}),e.jsxs(J,{children:[e.jsx(a,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(a,{onClick:A,disabled:w.isPending||D.isPending,children:w.isPending||D.isPending?"Saving...":m?"Save Changes":"Create Strategy"})]})]})]})]}),e.jsx("div",{className:"grid md:grid-cols-1 gap-6",children:e.jsxs(K,{children:[e.jsxs(U,{children:[e.jsx(X,{children:"Strategy Portfolio"}),e.jsx(Y,{children:"List of strategies evaluated and approved for implementation."})]}),e.jsx(Z,{children:e.jsx("div",{className:"rounded-xl border border-slate-200 shadow-lg overflow-hidden bg-white",children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(R,{className:"bg-[#1C4D8D] hover:bg-[#1C4D8D] border-none",children:[e.jsx(d,{className:"w-[300px] text-white font-semibold py-4",children:"Strategy"}),e.jsx(d,{className:"text-white font-semibold py-4",children:"Resources & Benefits"}),e.jsx(d,{className:"text-white font-semibold py-4",children:"Cost"}),e.jsx(d,{className:"text-white font-semibold py-4",children:"Status"}),e.jsx(d,{className:"w-[100px] text-white font-semibold py-4 text-right",children:"Actions"})]})}),e.jsxs(te,{children:[(r==null?void 0:r.length)===0&&e.jsx(R,{children:e.jsx(l,{colSpan:5,className:"text-center py-12 bg-white",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500",children:[e.jsx(ae,{className:"h-12 w-12 mb-4 bg-slate-100 p-2 rounded-full"}),e.jsx("p",{children:"No strategies defined yet."}),e.jsx(a,{variant:"link",onClick:B,children:"Create your first strategy"})]})})}),r==null?void 0:r.map(s=>e.jsxs(R,{className:"bg-white border-b border-slate-200 transition-all duration-200 hover:bg-slate-50 hover:shadow-sm group cursor-pointer",onClick:()=>O(s),children:[e.jsxs(l,{className:"py-4",children:[e.jsx("div",{className:"font-semibold text-black",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:s.description})]}),e.jsx(l,{className:"py-4",children:e.jsxs("div",{className:"text-sm space-y-1",children:[s.resourceRequirements&&e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(de,{className:"w-3 h-3 mt-1 text-slate-400"}),e.jsx("span",{className:"text-gray-500",children:s.resourceRequirements})]}),s.benefits&&e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(ie,{className:"w-3 h-3 mt-1 text-green-500"}),e.jsx("span",{className:"text-gray-500",children:s.benefits})]})]})}),e.jsx(l,{className:"py-4",children:s.estimatedCost?e.jsx(E,{variant:"outline",className:"font-mono bg-white border-gray-300 text-gray-700",children:s.estimatedCost}):"-"}),e.jsx(l,{className:"py-4",children:e.jsx(E,{className:s.approvalStatus==="approved"?"bg-green-100 text-green-800 hover:bg-green-200 border border-green-200":"bg-slate-100 text-slate-800 hover:bg-slate-200 border border-slate-200",children:s.approvalStatus})}),e.jsx(l,{className:"py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(a,{variant:"ghost",size:"icon",className:"text-slate-500 hover:text-blue-600 hover:bg-blue-50 transition-colors duration-200",children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx(a,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-600 hover:bg-red-50 transition-colors duration-200",onClick:T=>H(T,s.id),children:e.jsx(he,{className:"w-4 h-4"})})]})})]},s.id))]})]})})})]})})]})})}export{es as default};
