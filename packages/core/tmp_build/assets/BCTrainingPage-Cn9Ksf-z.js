import{b as N,au as S,t as h,i as j,r as f,j as e,c as d,C as w,d as I,e as k,f as L,m as B,N as R,O as H,P as u,Q as o,V as O,W as t,k as P,D as U,o as A,p as M,q as _,L as m,E as z,G as E,H as Q,J as V,K as p,I as C,w as q}from"./index-DOc7Nwb7.js";import{D as F}from"./DashboardLayout-aHnUqq57.js";import{A as G}from"./arrow-left-CpuUojG-.js";import{P as J}from"./plus-BaQ35Jcx.js";import{U as K}from"./user-CqRnJLgW.js";import{C as W}from"./circle-check-big-BSqJVrgh.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";function He(){const[,T]=N(),[$,l]=S("/clients/:clientId/business-continuity/training"),n=l!=null&&l.clientId?parseInt(l.clientId):0,{data:i,refetch:y}=h.businessContinuity.program.training.list.useQuery({clientId:n},{enabled:!!n}),{data:x}=h.users.list.useQuery({clientId:n},{enabled:!!n}),b=h.businessContinuity.program.training.add.useMutation({onSuccess:()=>{j.success("Training record and certification logged"),c(!1),y(),r({userId:"",trainingType:"awareness",completionDate:new Date().toISOString().split("T")[0],notes:""})}}),[v,c]=f.useState(!1),[a,r]=f.useState({userId:"",trainingType:"awareness",completionDate:new Date().toISOString().split("T")[0],notes:""}),D=()=>{if(!a.userId)return j.error("Select a user");b.mutate({clientId:n,userId:parseInt(a.userId),trainingType:a.trainingType,completionDate:a.completionDate,notes:a.notes})};return e.jsx(F,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2 text-muted-foreground mb-1",children:e.jsxs(d,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>T(`/clients/${n}/business-continuity/dashboard`),children:[e.jsx(G,{className:"w-4 h-4 mr-1"})," Back to Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"BCP Training & Awareness"}),e.jsx("p",{className:"text-muted-foreground",children:"Track staff training, role-specific certifications, and awareness campaigns."})]}),e.jsxs(d,{onClick:()=>c(!0),children:[e.jsx(J,{className:"w-4 h-4 mr-2"})," Log Training"]})]}),e.jsxs(w,{children:[e.jsxs(I,{children:[e.jsx(k,{children:"Training Records"}),e.jsx(L,{children:"History of completed BCP training modules."})]}),e.jsx(B,{children:e.jsxs(R,{children:[e.jsx(H,{children:e.jsxs(u,{children:[e.jsx(o,{children:"Staff Member"}),e.jsx(o,{children:"Training Type"}),e.jsx(o,{children:"Completion Date"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Notes"})]})}),e.jsxs(O,{children:[i==null?void 0:i.map(s=>{var g;return e.jsxs(u,{children:[e.jsxs(t,{className:"font-medium flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-muted-foreground"}),((g=s.user)==null?void 0:g.name)||"Unknown User"]}),e.jsx(t,{className:"capitalize",children:s.trainingType.replace("_"," ")}),e.jsx(t,{children:new Date(s.completionDate).toLocaleDateString()}),e.jsx(t,{children:e.jsxs(P,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(W,{className:"w-3 h-3 mr-1"})," Completed"]})}),e.jsx(t,{className:"text-muted-foreground",children:s.notes})]},s.id)}),(!i||i.length===0)&&e.jsx(u,{children:e.jsx(t,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No training records found."})})]})]})})]}),e.jsx(U,{open:v,onOpenChange:c,children:e.jsxs(A,{children:[e.jsx(M,{children:e.jsx(_,{children:"Log Training Record"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Staff Member"}),e.jsxs("select",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm",value:a.userId,onChange:s=>r({...a,userId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select User..."}),x==null?void 0:x.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.role,")"]},s.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Training Type"}),e.jsxs(z,{value:a.trainingType,onValueChange:s=>r({...a,trainingType:s}),children:[e.jsx(E,{children:e.jsx(Q,{})}),e.jsxs(V,{children:[e.jsx(p,{value:"awareness",children:"General Awareness"}),e.jsx(p,{value:"role_based",children:"Role-Based Training"}),e.jsx(p,{value:"incident_response",children:"Incident Response Simulation"}),e.jsx(p,{value:"crisis_management",children:"Crisis Management Certification"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Completion Date"}),e.jsx(C,{type:"date",value:a.completionDate,onChange:s=>r({...a,completionDate:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Notes / Score"}),e.jsx(C,{value:a.notes,onChange:s=>r({...a,notes:s.target.value}),placeholder:"e.g. Scored 100% on quiz"})]})]}),e.jsxs(q,{children:[e.jsx(d,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(d,{onClick:D,children:"Log Training"})]})]})})]})})}export{He as default};
