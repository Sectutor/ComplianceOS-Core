import{M as ne,r as x,t as c,i as t,j as e,c as l,L as p,I as j,E as z,G as q,H as O,J as G,K as m,x as f,C as P,m as I,k as M,d as H,e as B,f as V,F as J}from"./index-DOc7Nwb7.js";import{D as le}from"./DashboardLayout-aHnUqq57.js";import{S as _}from"./switch-B74-5eCi.js";import{E as de}from"./enhanced-dialog-CeRPsI16.js";import{T as oe,a as ce,b as D,c as R}from"./tabs-CBDTXbEn.js";import{A as me,a as pe,b as ue,c as xe,d as he,e as ge,f as je,g as fe}from"./alert-dialog-V7xGXdVc.js";import{P as be}from"./plus-BaQ35Jcx.js";import{P as w}from"./play-CNfCaKB0.js";import{C as Q}from"./circle-check-C5kiwRoG.js";import{C as ve}from"./circle-x-DxtMpzS7.js";import{S as ye}from"./square-pen-ClRv15cM.js";import{T as Ne}from"./trash-2-CFEfisbM.js";import{M as Ce}from"./monitor-C57DnQTF.js";import{S as X}from"./shield-alert-iAruRy4W.js";import{B as $}from"./briefcase-BxorFA78.js";import{N as we}from"./network-CgrL7DP_.js";import{C as ke}from"./cpu-Dyg_8Jsq.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=ne("ServerCog",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M4.5 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-.5",key:"tn8das"}],["path",{d:"M4.5 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-.5",key:"1g2pve"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m15.7 13.4-.9-.3",key:"1jwmzr"}],["path",{d:"m9.2 10.9-.9-.3",key:"qapnim"}],["path",{d:"m10.6 15.7.3-.9",key:"quwk0k"}],["path",{d:"m13.6 15.7-.4-1",key:"cb9xp7"}],["path",{d:"m10.8 9.3-.4-1",key:"1uaiz5"}],["path",{d:"m8.3 13.6 1-.4",key:"s6srou"}],["path",{d:"m14.7 10.8 1-.4",key:"4d31cq"}],["path",{d:"m13.4 8.3-.3.9",key:"1bm987"}]]),Se=[{id:"general_advisor",name:"General AI Advisor",description:"Chat and general Q&A",icon:Ce},{id:"risk_analysis",name:"Risk Analysis",description:"Auto-triage and risk scoring",icon:X},{id:"policy_generation",name:"Policy Drafting",description:"Drafting and tailoring policies",icon:J},{id:"tech_suggestion",name:"Technology Suggestions",description:"Recommending controls/tools",icon:Ee},{id:"implementation_plan",name:"Implementation Planning",description:"Generating step-by-step plans",icon:$},{id:"explain_mapping",name:"Regulation Mapping",description:"Explaining compliance mapping",icon:we},{id:"vendor_mitigation",name:"Vendor Mitigation",description:"Vendor risk remediation plans",icon:ke}];function bs(){const[W,u]=x.useState(!1),[h,k]=x.useState(null),[a,n]=x.useState({name:"",provider:"openai",model:"",apiKey:"",baseUrl:"",priority:"0",isEnabled:!0,supportsEmbeddings:!1}),[b,v]=x.useState(null),[L,K]=x.useState(!1),[g,E]=x.useState(null),y=c.useUtils(),{data:d,isLoading:Y}=c.llm.list.useQuery(),{data:S}=c.llm.getRoutes.useQuery(),T=c.llm.setRoute.useMutation({onSuccess:()=>{t.success("Routing rule updated"),y.llm.getRoutes.invalidate()},onError:s=>t.error(s.message)}),U=c.llm.create.useMutation({onSuccess:()=>{t.success("Provider added successfully"),u(!1),C(),y.llm.list.invalidate()},onError:s=>t.error(s.message)}),F=c.llm.update.useMutation({onSuccess:()=>{t.success("Provider updated"),u(!1),k(null),C(),y.llm.list.invalidate()},onError:s=>t.error(s.message)}),A=c.llm.delete.useMutation({onSuccess:()=>{t.success("Provider deleted"),E(null),y.llm.list.invalidate()},onError:s=>t.error(s.message)}),Z=c.llm.test.useMutation({onSuccess:s=>{v({success:!!s,message:s?"Connection successful!":"Connection failed (empty response)"})},onError:s=>{v({success:!1,message:s.message})}}),[N,ee]=x.useState(null),o=c.advisor.reindexContent.useMutation({onSuccess:s=>{t.success("Indexing completed successfully"),ee(s.stats)},onError:s=>t.error("Indexing failed: "+s.message)}),C=()=>{n({name:"",provider:"openai",model:"",apiKey:"",baseUrl:"",priority:"0",isEnabled:!0,supportsEmbeddings:!1}),v(null)},se=s=>{n({name:s.name,provider:s.provider,model:s.model,apiKey:"",baseUrl:s.baseUrl||"",priority:s.priority.toString(),isEnabled:s.isEnabled,supportsEmbeddings:s.supportsEmbeddings||!1}),k(s.id),u(!0)},ae=s=>{s.preventDefault();const i={name:a.name,provider:a.provider,model:a.model,apiKey:a.apiKey,baseUrl:a.baseUrl||void 0,priority:parseInt(a.priority),isEnabled:a.isEnabled,supportsEmbeddings:a.supportsEmbeddings};if(h)i.apiKey||delete i.apiKey,F.mutate({id:h,...i});else{if(!i.apiKey){t.error("API Key is required");return}U.mutate(i)}},ie=async()=>{if(!a.apiKey&&!h){t.error("Enter an API Key to test");return}if(!a.apiKey){t.error("Please re-enter API Key to test connection");return}K(!0),v(null),Z.mutate({apiKey:a.apiKey,baseUrl:a.baseUrl||void 0,model:a.model},{onSettled:()=>K(!1)})};return e.jsx(le,{children:e.jsxs("div",{className:"container py-6 max-w-5xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"AI & LLM Settings"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure and prioritize the AI models used for policy generation and analysis."})]}),e.jsxs(l,{onClick:()=>{C(),u(!0)},children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"Add Provider"]})]}),e.jsx(de,{open:W,onOpenChange:s=>{u(s),s||(k(null),C())},title:h?"Edit Provider":"Add LLM Provider",description:"Add a new AI provider using your own API key. Keys are encrypted at rest.",footer:e.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[e.jsx(l,{type:"button",variant:"ghost",onClick:()=>u(!1),children:"Cancel"}),e.jsx(l,{onClick:s=>{const i=document.getElementById("llm-provider-form");i&&i.requestSubmit()},disabled:U.isPending||F.isPending,children:h?"Save Changes":"Create Provider"})]}),size:"lg",children:e.jsxs("form",{id:"llm-provider-form",onSubmit:ae,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{className:"font-semibold text-foreground/80",children:"Name"}),e.jsx(j,{placeholder:"My OpenAI",value:a.name,onChange:s=>n({...a,name:s.target.value}),required:!0,className:"border-2 border-slate-300 bg-slate-50 focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{className:"font-semibold text-foreground/80",children:"Provider Type"}),e.jsxs(z,{value:a.provider,onValueChange:s=>n({...a,provider:s}),children:[e.jsx(q,{className:"border-2 border-slate-300 bg-slate-50 focus:ring-2 focus:ring-primary/20",children:e.jsx(O,{})}),e.jsxs(G,{children:[e.jsx(m,{value:"openai",children:"OpenAI"}),e.jsx(m,{value:"anthropic",children:"Anthropic"}),e.jsx(m,{value:"gemini",children:"Gemini (Google)"}),e.jsx(m,{value:"deepseek",children:"DeepSeek"}),e.jsx(m,{value:"qwen",children:"Qwen / Gwen"}),e.jsx(m,{value:"openrouter",children:"OpenRouter"}),e.jsx(m,{value:"custom",children:"Custom (OpenAI Compat)"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{className:"font-semibold text-foreground/80",children:"Model Name"}),e.jsx(j,{placeholder:"e.g. gpt-4, deepseek-coder, gemini-1.5-flash",value:a.model,onChange:s=>n({...a,model:s.target.value}),required:!0,className:"border-2 border-slate-300 bg-slate-50 focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{className:"font-semibold text-foreground/80",children:["API Key ",h&&"(Leave blank to keep unchanged)"]}),e.jsx(j,{type:"password",placeholder:"sk-...",value:a.apiKey,onChange:s=>n({...a,apiKey:s.target.value}),className:"border-2 border-slate-300 bg-slate-50 focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{className:"font-semibold text-foreground/80",children:"Base URL (Optional)"}),e.jsx(j,{placeholder:"e.g. https://api.deepseek.com/v1",value:a.baseUrl,onChange:s=>n({...a,baseUrl:s.target.value}),className:"border-2 border-slate-300 bg-slate-50 focus:ring-2 focus:ring-primary/20"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Required for DeepSeek, Custom, or Local LLMs."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(p,{className:"font-semibold text-foreground/80",children:"Priority (Higher = Preferred)"}),e.jsx(j,{type:"number",value:a.priority,onChange:s=>n({...a,priority:s.target.value}),className:"border-2 border-slate-300 bg-slate-50 focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx(_,{id:"enabled",checked:a.isEnabled,onCheckedChange:s=>n({...a,isEnabled:s})}),e.jsx(p,{htmlFor:"enabled",children:"Enabled"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx(_,{id:"embeddings",checked:a.supportsEmbeddings,onCheckedChange:s=>n({...a,supportsEmbeddings:s})}),e.jsx(p,{htmlFor:"embeddings",children:"Embeddings"})]})]}),e.jsxs("div",{className:"pt-2 border-t flex items-center justify-between",children:[e.jsxs(l,{type:"button",variant:"outline",size:"sm",onClick:ie,disabled:L,children:[L?e.jsx(f,{className:"mr-2 h-3 w-3 animate-spin"}):e.jsx(w,{className:"mr-2 h-3 w-3"}),"Test Connection"]}),b&&e.jsxs("span",{className:`text-xs flex items-center ${b.success?"text-green-600":"text-red-600"}`,children:[b.success?e.jsx(Q,{className:"h-3 w-3 mr-1"}):e.jsx(ve,{className:"h-3 w-3 mr-1"}),b.message]})]})]})}),e.jsxs(oe,{defaultValue:"providers",className:"w-full",children:[e.jsxs(ce,{className:"mb-4",children:[e.jsx(D,{value:"providers",children:"LLM Providers"}),e.jsx(D,{value:"routing",children:"Dynamic Routing"}),e.jsx(D,{value:"indexing",children:"Data & Indexing"})]}),e.jsx(R,{value:"providers",children:Y?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(f,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"grid gap-4",children:[d==null?void 0:d.map(s=>e.jsx(P,{className:s.isEnabled?"":"opacity-60 bg-muted/30",children:e.jsxs(I,{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold",children:s.priority}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.name,s.isEnabled?e.jsx(M,{variant:"default",className:"text-[10px] h-5",children:"Active"}):e.jsx(M,{variant:"secondary",className:"text-[10px] h-5",children:"Disabled"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"capitalize",children:s.provider}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"font-mono text-xs",children:s.model}),s.baseUrl&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"text-xs truncate max-w-[200px]",children:s.baseUrl})]}),s.supportsEmbeddings&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx(M,{variant:"outline",className:"text-[10px] h-4 px-1 bg-blue-50 text-blue-700 border-blue-200",children:"Embeddings"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>se(s),children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>E(s),children:e.jsx(Ne,{className:"h-4 w-4"})})]})]})},s.id)),(d==null?void 0:d.length)===0&&e.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[e.jsx("p",{className:"text-muted-foreground",children:"No AI providers configured."}),e.jsx(l,{variant:"link",onClick:()=>u(!0),children:"Add your first provider"})]})]})}),e.jsx(R,{value:"routing",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(H,{children:[e.jsx(B,{children:"Feature Routing Rules"}),e.jsx(V,{children:'Configure which AI model handles each specific task. Leave "Default" to use the highest priority allowed provider.'})]}),e.jsx(I,{children:e.jsx("div",{className:"space-y-6",children:Se.map(s=>{const i=S==null?void 0:S.find(r=>r.feature===s.id),te=s.icon;return e.jsxs("div",{className:"flex items-center justify-between pb-4 border-b last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 bg-primary/5 rounded-lg flex items-center justify-center text-primary",children:e.jsx(te,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})]}),e.jsx("div",{className:"w-[300px]",children:e.jsxs(z,{value:i!=null&&i.providerId?i.providerId.toString():"default",onValueChange:r=>{const re=r==="default"?null:parseInt(r);T.mutate({feature:s.id,providerId:re})},disabled:T.isPending,children:[e.jsx(q,{className:"bg-white",children:e.jsx(O,{placeholder:"Default (Highest Priority)"})}),e.jsxs(G,{children:[e.jsx(m,{value:"default",children:"Default Provider (Highest Priority)"}),d==null?void 0:d.filter(r=>r.isEnabled).map(r=>e.jsxs(m,{value:r.id.toString(),children:[r.name," (",r.model,")"]},r.id))]})]})})]},s.id)})})})]})}),e.jsx(R,{value:"indexing",className:"space-y-4",children:e.jsxs(P,{children:[e.jsxs(H,{children:[e.jsx(B,{children:"Knowledge Base Indexing"}),e.jsx(V,{children:"Manage the vector index used for RAG (Retrieval-Augmented Generation). Re-index content if AI responses seem outdated."})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),e.jsx("h4",{className:"font-semibold",children:"Policies"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Index all generated policies for context-aware drafting."}),e.jsxs(l,{variant:"outline",size:"sm",className:"w-full",onClick:()=>o.mutate({type:"policies"}),disabled:o.isPending,children:[o.isPending?e.jsx(f,{className:"mr-2 h-3 w-3 animate-spin"}):e.jsx(w,{className:"mr-2 h-3 w-3"}),"Re-index Policies"]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx($,{className:"h-5 w-5 text-green-600"}),e.jsx("h4",{className:"font-semibold",children:"Evidence"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Index uploaded evidence summaries for verification."}),e.jsxs(l,{variant:"outline",size:"sm",className:"w-full",onClick:()=>o.mutate({type:"evidence"}),disabled:o.isPending,children:[o.isPending?e.jsx(f,{className:"mr-2 h-3 w-3 animate-spin"}):e.jsx(w,{className:"mr-2 h-3 w-3"}),"Re-index Evidence"]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(X,{className:"h-5 w-5 text-red-600"}),e.jsx("h4",{className:"font-semibold",children:"Full System"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Complete re-index of all knowledge base items."}),e.jsxs(l,{variant:"default",size:"sm",className:"w-full",onClick:()=>o.mutate({type:"all"}),disabled:o.isPending,children:[o.isPending?e.jsx(f,{className:"mr-2 h-3 w-3 animate-spin"}):e.jsx(w,{className:"mr-2 h-3 w-3"}),"Re-index Everything"]})]})]}),N&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 text-green-700 rounded-md text-sm border border-green-200 flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Last Run: Indexed ",N.policies," policies and ",N.evidence," evidence items. (",N.errors," errors)"]})]})]})})]}),e.jsx(me,{open:!!g,onOpenChange:s=>!s&&E(null),children:e.jsxs(pe,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:"Are you absolutely sure?"}),e.jsxs(he,{children:["This will permanently delete the provider ",e.jsx("b",{children:g==null?void 0:g.name}),"."]})]}),e.jsxs(ge,{children:[e.jsx(je,{children:"Cancel"}),e.jsx(fe,{className:"bg-red-600 hover:bg-red-700",onClick:()=>{g&&A.mutate({id:g.id})},disabled:A.isPending,children:A.isPending?"Deleting...":"Delete Provider"})]})]})})]})})}export{bs as default};
