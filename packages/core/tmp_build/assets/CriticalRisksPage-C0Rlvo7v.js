import{ab as N,t as v,j as e,aq as o,T as y,c as m,C as f,m as b,d as R,k as x,e as w}from"./index-DOc7Nwb7.js";import{D as p}from"./DashboardLayout-aHnUqq57.js";import{B as C,a as A,b as d,c as u,d as g,e as I}from"./breadcrumb-BTf0geTn.js";import{P as j}from"./PageGuide-CPKKXXS6.js";import{A as T}from"./activity-B1F2IRm3.js";import{C as B}from"./circle-check-C5kiwRoG.js";import{A as L}from"./arrow-right-M96iV-v9.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";function je(){const s=N(),t=s.id?parseInt(s.id):0,{data:n,isLoading:l}=v.risks.getRiskAssessments.useQuery({clientId:t},{enabled:!!t}),c=r=>{if(!r)return 0;const a=r.toString().toLowerCase().trim();let i=parseInt(a.charAt(0));return isNaN(i)&&(a.includes("critical")||a.includes("extreme")?i=5:a.includes("very high")?i=4:a.includes("high")?i=3:a.includes("medium")?i=2:a.includes("low")&&(i=1)),i>=1&&i<=5?i:0},k=r=>{const a=c(r.likelihood)*c(r.impact),i=c(r.residualRisk);return a>=15||i>=4},h=(n==null?void 0:n.filter(k))||[];return l?e.jsx(p,{children:e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[e.jsx(T,{className:"w-10 h-10 text-blue-500 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading critical risks..."})]})})}):e.jsx(p,{children:e.jsxs("div",{className:"space-y-6 max-w-5xl mx-auto",children:[e.jsx(C,{children:e.jsxs(A,{children:[e.jsx(d,{children:e.jsx(u,{asChild:!0,children:e.jsx(o,{href:`/clients/${t}`,children:"Home"})})}),e.jsx(g,{}),e.jsx(d,{children:e.jsx(u,{asChild:!0,children:e.jsx(o,{href:`/clients/${t}/risks`,children:"Risk Management"})})}),e.jsx(g,{}),e.jsx(d,{children:e.jsx(I,{children:"Critical Risks"})})]})}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-950 flex items-center gap-2",children:[e.jsx(y,{className:"w-8 h-8 text-red-600"}),"Critical Risks Attention Required"]}),e.jsx("p",{className:"text-slate-600 mt-2 text-lg",children:"These risks represent the highest threats to your organization. Immediate mitigation strategies are recommended."})]}),e.jsx(j,{title:"Critical Risks",description:"A focused view of your most dangerous exposure points.",rationale:"Executives need a 'red alert' dashboard to focus resources on the risks that matter most.",howToUse:[{step:"Immediate Action",description:"Everything on this list requires an active, funded treatment plan."},{step:"Residual Risk Check",description:"If a risk is here but has controls, those controls are likely failing or insufficient."},{step:"Review Weekly",description:"This list should be shrinking, not growing."}],integrations:[{name:"Risk Register",description:"Sources data from all high-severity assessments."},{name:"Alerting",description:"New critical risks can trigger automated notifications."}]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{href:`/clients/${t}/risks/register`,children:e.jsx(m,{variant:"outline",children:"View Full Register"})}),e.jsx(j,{title:"Critical Risks",description:"Prioritized view of high-severity risks that require immediate attention.",rationale:"Not all risks are created equal. This page filters out the noise to focus on 'Critical' and 'High' risks that exceed your organization's risk tolerance.",howToUse:[{step:"Review Cards",description:"Each card displays a critical risk with its score and status."},{step:"Check Recommendations",description:"Read the 'Recommended Action' to understand mitigation steps."},{step:"Take Action",description:"Click 'Manage Risk' to update the treatment plan or assign an owner."}],integrations:[{name:"Risk Register",description:"Clicking 'Manage Risk' takes you directly to the full register entry."},{name:"Dashboard",description:"The count of critical risks here drives the red metric on the main dashboard."}]})]})]}),h.length===0?e.jsx(f,{className:"bg-green-50 border-green-200",children:e.jsxs(b,{className:"flex flex-col items-center justify-center p-12 text-center",children:[e.jsx(B,{className:"w-16 h-16 text-green-600 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800",children:"No Critical Risks Found"}),e.jsx("p",{className:"text-green-700 mt-2 max-w-md",children:"Great job! You have no risks classified as Critical or High severity at this time."}),e.jsx(o,{href:`/clients/${t}/risks`,children:e.jsx(m,{className:"mt-6 bg-green-700 hover:bg-green-800 text-white",children:"Return to Risk Dashboard"})})]})}):e.jsx("div",{className:"grid gap-6",children:h.map(r=>e.jsx(D,{risk:r,clientId:t},r.id))})]})})}function D({risk:s,clientId:t}){const n=parseInt(s.likelihood||"0"),l=parseInt(s.impact||"0"),c=n*l;return e.jsxs(f,{className:"border-l-4 border-l-red-500 shadow-md hover:shadow-lg transition-shadow",children:[e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{variant:"outline",className:"text-muted-foreground",children:s.assessmentId}),e.jsxs(x,{className:"bg-red-100 text-red-700 border-red-200 hover:bg-red-200",children:["Score: ",c," (Critical)"]})]}),e.jsx(w,{className:"text-xl leading-snug",children:s.threatDescription||"Untitled Risk"})]}),e.jsx(o,{href:`/clients/${t}/risks/register?openRiskId=${s.id}`,children:e.jsxs(m,{size:"sm",className:"gap-2",children:["Manage Risk ",e.jsx(L,{className:"w-4 h-4"})]})})]})}),e.jsxs(b,{className:"grid md:grid-cols-2 gap-6 text-sm",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900 block mb-1",children:"Vulnerability"}),e.jsx("p",{className:"text-gray-600 bg-slate-50 p-3 rounded-md border border-slate-100",children:s.vulnerabilityDescription||"No vulnerability description provided."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900 block mb-1",children:"Recommended Action"}),e.jsx("p",{className:"text-gray-600 bg-blue-50/50 p-3 rounded-md border border-blue-100 text-blue-900",children:s.recommendedActions||"No specific recommendation."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900 block text-xs uppercase tracking-wide",children:"Likelihood"}),e.jsx("span",{className:"text-lg font-medium",children:s.likelihood})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900 block text-xs uppercase tracking-wide",children:"Impact"}),e.jsx("span",{className:"text-lg font-medium",children:s.impact})]})]})]})]})]})}export{je as default};
