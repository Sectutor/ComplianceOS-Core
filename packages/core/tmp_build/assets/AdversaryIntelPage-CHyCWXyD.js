import{M as Ce,r as u,t as f,i as P,j as e,C as B,d as V,e as H,f as Te,k as l,T as I,m as z,x as $,aq as xe,c as m,aa as ke,S as me,I as Ae,D as K,o as Z,p as U,q as Q,s as ie,w as F,z as Se,ab as Ie}from"./index-DOc7Nwb7.js";import{R as _,D as Re}from"./DashboardLayout-aHnUqq57.js";import{T as Me,a as Le,b as W,c as G}from"./tabs-CBDTXbEn.js";import{S as O}from"./scroll-area-DPaNxEJD.js";import{Z as T}from"./zap-B01fFOkT.js";import{T as R}from"./target-cfAj3L6j.js";import{S as De}from"./swords-ZtChPoEW.js";import{C as ne}from"./clock-osbacZli.js";import{E as y}from"./external-link-C3PXjBR9.js";import{S as Ee}from"./search-CwuIBBPE.js";import{A as Pe}from"./arrow-up-down-BDk2lJRe.js";import{T as ce}from"./tag-CaMuQCYj.js";import{P as A}from"./plus-BaQ35Jcx.js";import{R as de}from"./refresh-cw-Cjym1DSW.js";import{S as oe}from"./shield-check-ETs8j4-d.js";import{I as $e}from"./info-By5wLOUH.js";import{P as Oe,L as Be}from"./PageGuide-CPKKXXS6.js";import{A as Ve}from"./arrow-left-CpuUojG-.js";import{B as He}from"./bar-chart-3-BCngNY6H.js";import{T as ze}from"./trending-up-eUiO956o.js";import"./index--2vFva6Y.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=Ce("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);function Ke({clientId:p,onRiskCreated:N}){var se,te,ae,re,le;const[v,c]=u.useState("briefing"),[n,he]=u.useState(""),[C,q]=u.useState(null),[a,M]=u.useState(null),[t,L]=u.useState(null),[b,w]=u.useState({open:!1,type:"feed"}),[k,pe]=u.useState("date"),J={critical:4,high:3,medium:2,low:1,info:0},{data:o,isLoading:ge,refetch:je}=f.adversaryIntel.getSecurityFeeds.useQuery({limit:100,clientId:p},{staleTime:1e3*60*5}),D=f.adversaryIntel.refreshFeeds.useMutation({onSuccess:()=>{P.success("Security feeds refreshed with latest intelligence"),je()},onError:s=>P.error(`Failed to refresh feeds: ${s.message}`)}),{data:x,isLoading:ue,refetch:Ne}=f.adversaryIntel.getMitreData.useQuery({clientId:p},{staleTime:1e3*60*60}),{data:Ze}=f.adversaryIntel.searchTechniques.useQuery({query:n,limit:20,clientId:p},{enabled:n.length>=2&&v==="mitre"}),{data:j,isLoading:be}=f.threatIntel.getDailyBriefing.useQuery({clientId:p},{staleTime:1e3*60*30}),E=f.risks.createThreat.useMutation({onSuccess:s=>{P.success("Threat created successfully from intelligence"),w({open:!1,type:"feed"}),L(null),M(null),N==null||N(s)},onError:s=>P.error(`Failed to create threat: ${s.message}`)}),X=u.useMemo(()=>{if(!(o!=null&&o.items))return[];let s=[...o.items];if(n){const r=n.toLowerCase();s=s.filter(d=>{var g,h;return d.title.toLowerCase().includes(r)||d.description.toLowerCase().includes(r)||((g=d.tags)==null?void 0:g.some(i=>i.includes(r)))||((h=d.cveIds)==null?void 0:h.some(i=>i.toLowerCase().includes(r)))})}return k==="severity"?s.sort((r,d)=>{const g=J[r.severity||"info"]||0,h=J[d.severity||"info"]||0;return g!==h?h-g:new Date(d.pubDate).getTime()-new Date(r.pubDate).getTime()}):s.sort((r,d)=>new Date(d.pubDate).getTime()-new Date(r.pubDate).getTime()),s},[o==null?void 0:o.items,n,k]),Y=u.useMemo(()=>{if(!(x!=null&&x.techniques))return[];let s=x.techniques;if(C&&(s=s.filter(r=>r.tacticId===C)),n&&v==="mitre"){const r=n.toLowerCase();s=s.filter(d=>d.id.toLowerCase().includes(r)||d.name.toLowerCase().includes(r))}return s.slice(0,50)},[x==null?void 0:x.techniques,C,n,v]),ee=s=>{switch(s){case"critical":return"bg-red-600 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-yellow-500 text-black";case"low":return"bg-blue-500 text-white";default:return"bg-slate-500 text-white"}},fe=s=>{switch(s){case"critical":case"high":return e.jsx(I,{className:"w-3 h-3"});case"medium":return e.jsx(Se,{className:"w-3 h-3"});default:return e.jsx($e,{className:"w-3 h-3"})}},ve=()=>{var r;if(!t)return;const s={critical:"Almost Certain",high:"Likely",medium:"Possible",low:"Unlikely",info:"Rare"};E.mutate({clientId:p,threatId:`THREAT-INTEL-${Date.now()}`,name:t.title.slice(0,150),description:`**Source:** ${t.sourceName}
**Published:** ${new Date(t.pubDate).toLocaleDateString()}

${t.description}

[Original Article](${t.link})`,category:"Technical",source:"External",intent:"Deliberate",likelihood:s[t.severity||"info"],potentialImpact:(r=t.cveIds)!=null&&r.length?`Related CVEs: ${t.cveIds.join(", ")}`:"See threat description",status:"active"})},we=()=>{a&&E.mutate({clientId:p,threatId:a.id,name:`[${a.id}] ${a.name}`,description:`**MITRE ATT&CK Technique**

**ID:** ${a.id}
**Tactic:** ${a.tacticName}
**Platforms:** ${a.platforms.join(", ")}

${a.description}

**Recommended Mitigations:**
${a.mitigations.map(s=>`- ${s.id}: ${s.name}`).join(`
`)}

[View on MITRE ATT&CK](${a.url})`,category:"Technical",source:"External",intent:"Deliberate",likelihood:"Possible",potentialImpact:`Based on MITRE ATT&CK tactic: ${a.tacticName}`,status:"active"})},ye=s=>{const r=new Date(s),g=new Date().getTime()-r.getTime(),h=Math.floor(g/(1e3*60*60)),i=Math.floor(h/24);return i>0?`${i}d ago`:h>0?`${h}h ago`:"Just now"};return e.jsxs(B,{className:"border border-slate-200 shadow-xl bg-white text-slate-900 overflow-hidden",children:[e.jsxs(V,{className:"pb-4 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-red-500 to-orange-500 shadow-lg",children:e.jsx(_,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(H,{className:"text-xl font-bold text-slate-900",children:"Adversary Intelligence"}),e.jsx(Te,{className:"text-slate-500",children:"Live threat feeds & MITRE ATT&CK framework"})]})]}),e.jsxs(l,{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white border-0 px-3 py-1",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),"Premium"]})]}),e.jsxs("div",{className:"flex gap-6 mt-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-slate-500",children:"Feeds:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:((se=o==null?void 0:o.items)==null?void 0:se.length)||0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-slate-500",children:"Critical:"}),e.jsx("span",{className:"font-semibold text-red-600",children:((te=o==null?void 0:o.items)==null?void 0:te.filter(s=>s.severity==="critical").length)||0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-slate-500",children:"Techniques:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:((ae=x==null?void 0:x.techniques)==null?void 0:ae.length)||0})]})]})]}),e.jsx(z,{className:"p-0",children:e.jsxs(Me,{value:v,onValueChange:c,className:"w-full",children:[e.jsx("div",{className:"px-6 pt-4",children:e.jsxs(Le,{className:"bg-slate-50 border border-slate-200 p-1 w-full grid grid-cols-3",children:[e.jsxs(W,{value:"briefing",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-amber-600 data-[state=active]:to-orange-600 data-[state=active]:text-white",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Daily Briefing"]}),e.jsxs(W,{value:"feeds",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-cyan-600 data-[state=active]:text-white",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Security Feeds"]}),e.jsxs(W,{value:"mitre",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-600 data-[state=active]:to-pink-600 data-[state=active]:text-white",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"MITRE ATT&CK"]})]})}),e.jsx(G,{value:"briefing",className:"m-0",children:e.jsx(O,{className:"h-[500px]",children:be?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx($,{className:"w-6 h-6 animate-spin text-amber-400"}),e.jsx("span",{className:"ml-2 text-slate-400",children:"Analyzing latest threats..."})]}):j?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-amber-50 rounded-xl p-4 border border-amber-100",children:[e.jsx("div",{className:"text-amber-800 text-xs font-semibold uppercase tracking-wider mb-1",children:"New Vulns"}),e.jsx("div",{className:"text-3xl font-bold text-amber-900",children:j.summary.newCriticalVulns}),e.jsxs("div",{className:"text-[10px] text-amber-700 mt-1 flex items-center gap-1",children:[e.jsx(I,{className:"w-3 h-3"}),"Critical Matches"]})]}),e.jsxs("div",{className:"bg-red-50 rounded-xl p-4 border border-red-100",children:[e.jsx("div",{className:"text-red-800 text-xs font-semibold uppercase tracking-wider mb-1",children:"Urgent Threats"}),e.jsx("div",{className:"text-3xl font-bold text-red-900",children:j.summary.urgentThreats}),e.jsxs("div",{className:"text-[10px] text-red-700 mt-1 flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),"High Priority"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[e.jsx("div",{className:"text-slate-600 text-xs font-semibold uppercase tracking-wider mb-1",children:"Assets Scanned"}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:j.summary.totalScanned}),e.jsxs("div",{className:"text-[10px] text-slate-500 mt-1 flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3"}),"Last 24 Hours"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl p-5 text-white shadow-lg overflow-hidden relative",children:[e.jsx("div",{className:"absolute right-[-20px] top-[-20px] w-32 h-32 bg-amber-500/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-lg mb-1 flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-amber-400"}),"Daily Action Required"]}),e.jsxs("p",{className:"text-slate-300 text-sm max-w-md",children:["Review and resolve ",j.summary.newCriticalVulns," new critical vulnerabilities discovered in your environment today."]})]}),e.jsx(xe,{href:`/clients/${p}/risks/vulnerability-workbench`,children:e.jsxs(m,{size:"sm",className:"bg-amber-500 hover:bg-amber-600 text-white border-0 shadow-lg shadow-amber-500/20",children:["Open Workbench",e.jsx(ke,{className:"w-4 h-4 ml-1"})]})})]})]}),j.criticalVulns.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-red-500"}),"Impacted Internal Assets"]}),e.jsx("div",{className:"space-y-2",children:j.criticalVulns.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-slate-100 bg-white hover:border-red-200 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-red-50 flex items-center justify-center text-red-600 font-bold text-xs",children:"!"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s.id}),e.jsx("div",{className:"text-xs text-slate-500",children:s.asset})]})]}),e.jsx(l,{className:"bg-red-100 text-red-700 border-red-200 text-[10px]",children:s.severity})]},r))})]}),j.urgentNews.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-orange-500"}),"Urgent Intelligence Alerts"]}),e.jsx("div",{className:"space-y-2",children:j.urgentNews.map((s,r)=>e.jsxs("div",{className:"p-3 rounded-lg border border-slate-100 bg-white hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>window.open(s.link,"_blank"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 leading-snug",children:s.title}),e.jsx(y,{className:"w-3 h-3 text-slate-300 shrink-0"})]}),e.jsx("div",{className:"text-[10px] text-slate-400 mt-1 uppercase font-bold tracking-tight",children:s.source})]},r))})]})]}):e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(T,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"No briefing data available"})]})})}),e.jsxs("div",{className:"px-6 py-4 flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx(Ae,{placeholder:v==="feeds"?"Search feeds, CVEs, tags...":"Search techniques (e.g., T1566, Phishing)...",value:n,onChange:s=>he(s.target.value),className:"pl-10 bg-slate-50 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:border-blue-500"})]}),v==="feeds"&&e.jsx(m,{variant:"outline",size:"icon",onClick:()=>pe(s=>s==="date"?"severity":"date"),className:`shrink-0 transition-all duration-200 ${k==="severity"?"bg-blue-600 border-blue-600 text-white hover:bg-blue-700":"text-slate-500 border-slate-200 hover:bg-slate-50"}`,title:k==="severity"?"Sorted by Criticality":"Sorted by Date",children:e.jsx(Pe,{className:`w-4 h-4 ${k==="severity"?"rotate-180 transition-transform":""}`})})]}),e.jsxs(G,{value:"feeds",className:"m-0",children:[e.jsx(O,{className:"h-[500px]",children:ge?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx($,{className:"w-6 h-6 animate-spin text-blue-400"}),e.jsx("span",{className:"ml-2 text-slate-400",children:"Loading security feeds..."})]}):X.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"No feed items found"})]}):e.jsx("div",{className:"divide-y divide-slate-100",children:X.map(s=>{var r,d,g,h;return e.jsx("div",{className:"p-4 hover:bg-slate-50 transition-colors group cursor-pointer",onClick:()=>L(s),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsxs(l,{className:`text-[10px] ${ee(s.severity)}`,children:[fe(s.severity),e.jsx("span",{className:"ml-1",children:((r=s.severity)==null?void 0:r.toUpperCase())||"INFO"})]}),e.jsx("span",{className:"text-xs text-slate-500",children:s.sourceName}),e.jsx("span",{className:"text-xs text-slate-600",children:"•"}),e.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3"}),ye(s.pubDate)]}),s.relevanceScore&&s.relevanceScore>10&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-slate-600",children:"•"}),e.jsxs(l,{className:"bg-purple-100 text-purple-700 border-purple-200 text-[10px] flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),"Relevant match"]})]})]}),e.jsx("h4",{className:"font-medium text-slate-900 group-hover:text-blue-600 transition-colors line-clamp-2",children:s.title}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 line-clamp-2",children:s.description}),s.impactedAssets&&s.impactedAssets.length>0&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50/50 rounded border border-red-100 flex items-start gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-red-500 mt-0.5 shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-semibold text-red-800 uppercase tracking-wider mb-1",children:"Impacted Infrastructure"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.impactedAssets.map(i=>e.jsx(l,{variant:"outline",className:"text-[10px] bg-white border-red-200 text-red-700 hover:bg-red-50",children:i.name},i.id))})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[(d=s.cveIds)==null?void 0:d.slice(0,3).map(i=>e.jsx(l,{variant:"outline",className:"text-[10px] border-red-500/50 text-red-400",children:i},i)),(g=s.tags)==null?void 0:g.slice(0,3).map(i=>e.jsxs(l,{variant:"outline",className:"text-[10px] border-slate-200 text-slate-500",children:[e.jsx(ce,{className:"w-2.5 h-2.5 mr-1"}),i]},i)),(h=s.techStack)==null?void 0:h.map(i=>e.jsxs(l,{variant:"secondary",className:"text-[10px] bg-slate-100 text-slate-600 font-mono",children:["#",i]},i))]})]}),e.jsxs(m,{size:"sm",variant:"ghost",className:"shrink-0 opacity-0 group-hover:opacity-100 transition-opacity text-green-400 hover:text-green-300 hover:bg-green-500/10",onClick:i=>{i.stopPropagation(),L(s),w({open:!0,type:"feed"})},children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"Create Threat"]})]})},s.id)})})}),e.jsx("div",{className:"px-6 py-4 border-t border-slate-100",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>D.mutate({clientId:p}),disabled:D.isPending,className:"w-full border-slate-200 text-slate-600 hover:bg-slate-50",children:[e.jsx(de,{className:`w-4 h-4 mr-2 ${D.isPending?"animate-spin":""}`}),D.isPending?"Refreshing...":"Refresh Feeds"]})})]}),e.jsxs(G,{value:"mitre",className:"m-0",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-48 border-r border-slate-100 shrink-0",children:[e.jsx("div",{className:"p-3 border-b border-slate-100",children:e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Tactics"})}),e.jsx(O,{className:"h-[440px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[e.jsx("button",{onClick:()=>q(null),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${C?"text-slate-600 hover:bg-slate-50":"bg-purple-600 text-white shadow-sm"}`,children:"All Techniques"}),(re=x==null?void 0:x.tactics)==null?void 0:re.map(s=>e.jsxs("button",{onClick:()=>q(s.id),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${C===s.id?"bg-purple-600 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:[e.jsx("span",{className:`font-mono text-[10px] mr-1 ${C===s.id?"text-purple-200":"text-slate-400"}`,children:s.id}),e.jsx("br",{}),s.name]},s.id))]})})]}),e.jsx("div",{className:"flex-1",children:e.jsx(O,{className:"h-[500px]",children:ue?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx($,{className:"w-6 h-6 animate-spin text-purple-400"}),e.jsx("span",{className:"ml-2 text-slate-400",children:"Loading MITRE ATT&CK data..."})]}):Y.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(R,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"No techniques found"})]}):e.jsx("div",{className:"divide-y divide-slate-100",children:Y.map(s=>e.jsx("div",{className:"p-4 hover:bg-slate-50 transition-colors group cursor-pointer",onClick:()=>M(s),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(l,{className:"bg-purple-100 text-purple-700 border-purple-200 font-mono",children:s.id}),e.jsx(l,{variant:"outline",className:"text-[10px] border-slate-200 text-slate-500",children:s.tacticName}),s.isSubtechnique&&e.jsx(l,{variant:"outline",className:"text-[10px] border-blue-200 text-blue-600",children:"Sub-technique"})]}),e.jsx("h4",{className:"font-medium text-slate-900 group-hover:text-purple-600 transition-colors",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1 line-clamp-2",children:[s.description.slice(0,150),"..."]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.platforms.slice(0,3).map(r=>e.jsx(l,{variant:"outline",className:"text-[10px] border-white/20 text-slate-500",children:r},r)),s.mitigations.length>0&&e.jsxs(l,{variant:"outline",className:"text-[10px] border-green-500/30 text-green-400",children:[e.jsx(oe,{className:"w-2.5 h-2.5 mr-1"}),s.mitigations.length," mitigations"]})]})]}),e.jsxs(m,{size:"sm",variant:"ghost",className:"shrink-0 opacity-0 group-hover:opacity-100 transition-opacity text-green-400 hover:text-green-300 hover:bg-green-500/10",onClick:r=>{r.stopPropagation(),M(s),w({open:!0,type:"technique"})},children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"Create Risk"]})]})},s.id))})})})]}),e.jsx("div",{className:"px-6 py-4 border-t border-white/10",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>Ne(),className:"w-full border-white/20 text-slate-300 hover:bg-white/5",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Refresh MITRE Data"]})})]})]})}),e.jsx(K,{open:!!t&&!b.open,onOpenChange:s=>!s&&L(null),children:e.jsxs(Z,{className:"max-w-2xl bg-white border-slate-200 text-slate-900",children:[e.jsxs(U,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(l,{className:`${ee(t==null?void 0:t.severity)}`,children:((le=t==null?void 0:t.severity)==null?void 0:le.toUpperCase())||"INFO"}),e.jsx("span",{className:"text-sm text-slate-500",children:t==null?void 0:t.sourceName})]}),e.jsx(Q,{className:"text-xl text-slate-900",children:t==null?void 0:t.title}),e.jsxs(ie,{className:"text-slate-500",children:["Published ",(t==null?void 0:t.pubDate)&&new Date(t.pubDate).toLocaleString()]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-slate-600",children:t==null?void 0:t.description}),(t==null?void 0:t.cveIds)&&t.cveIds.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Related CVEs"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:t.cveIds.map(s=>e.jsx("a",{href:`https://nvd.nist.gov/vuln/detail/${s}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center",children:e.jsxs(l,{variant:"outline",className:"border-red-500/50 text-red-400 hover:bg-red-500/10",children:[s,e.jsx(y,{className:"w-3 h-3 ml-1"})]})},s))})]}),(t==null?void 0:t.tags)&&t.tags.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:t.tags.map(s=>e.jsxs(l,{variant:"outline",className:"border-slate-200 text-slate-600",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),s]},s))})]})]}),e.jsxs(F,{className:"gap-2",children:[e.jsxs(m,{variant:"outline",onClick:()=>window.open(t==null?void 0:t.link,"_blank"),className:"border-slate-200 text-slate-600 hover:bg-slate-50",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Read Full Article"]}),e.jsxs(m,{onClick:()=>w({open:!0,type:"feed"}),className:"bg-gradient-to-r from-green-600 to-emerald-600",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Create Threat from This"]})]})]})}),e.jsx(K,{open:!!a&&!b.open,onOpenChange:s=>!s&&M(null),children:e.jsxs(Z,{className:"max-w-2xl bg-white border-slate-200 text-slate-900 max-h-[80vh] overflow-y-auto",children:[e.jsxs(U,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(l,{className:"bg-purple-100 text-purple-700 border-purple-200 font-mono",children:a==null?void 0:a.id}),e.jsx(l,{variant:"outline",className:"border-slate-200 text-slate-500",children:a==null?void 0:a.tacticName})]}),e.jsx(Q,{className:"text-xl",children:a==null?void 0:a.name})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Description"}),e.jsx("p",{className:"text-slate-600 mt-1 whitespace-pre-wrap text-sm",children:a==null?void 0:a.description})]}),(a==null?void 0:a.platforms)&&a.platforms.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase",children:"Platforms"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:a.platforms.map(s=>e.jsx(l,{variant:"outline",className:"border-blue-500/30 text-blue-400",children:s},s))})]}),(a==null?void 0:a.mitigations)&&a.mitigations.length>0&&e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-slate-400 uppercase flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3"}),"Mitigations (",a.mitigations.length,")"]}),e.jsx("div",{className:"space-y-2 mt-2",children:a.mitigations.slice(0,5).map(s=>e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(l,{className:"bg-green-100 text-green-700 border-green-200 font-mono text-[10px]",children:s.id}),e.jsx("span",{className:"font-medium text-sm text-slate-900",children:s.name})]}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:s.description})]},s.id))})]})]}),e.jsxs(F,{className:"gap-2",children:[e.jsxs(m,{variant:"outline",onClick:()=>window.open(a==null?void 0:a.url,"_blank"),className:"border-slate-200 text-slate-600 hover:bg-slate-50",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"View on MITRE"]}),e.jsxs(m,{onClick:()=>w({open:!0,type:"technique"}),className:"bg-gradient-to-r from-green-600 to-emerald-600",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Create Threat from This"]})]})]})}),e.jsx(K,{open:b.open,onOpenChange:s=>w({...b,open:s}),children:e.jsxs(Z,{className:"bg-white border-slate-200 text-slate-900",children:[e.jsxs(U,{children:[e.jsxs(Q,{className:"flex items-center gap-2 text-slate-900",children:[e.jsx(A,{className:"w-5 h-5 text-green-600"}),"Create Threat from Intelligence"]}),e.jsxs(ie,{className:"text-slate-500",children:["This will create a new threat entry in your Threat Library based on the selected ",b.type==="feed"?"security alert":"MITRE ATT&CK technique","."]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-100",children:[b.type==="feed"&&t&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"font-medium text-slate-900",children:["[Threat Intel] ",t.title.slice(0,80)]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["From: ",t.sourceName]})]}),b.type==="technique"&&a&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"font-medium text-slate-900",children:["[",a.id,"] ",a.name]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["Tactic: ",a.tacticName]})]})]}),e.jsxs(F,{children:[e.jsx(m,{variant:"outline",onClick:()=>w({open:!1,type:"feed"}),className:"border-slate-200 text-slate-600 hover:bg-slate-50",children:"Cancel"}),e.jsxs(m,{onClick:b.type==="feed"?ve:we,disabled:E.isPending,className:"bg-gradient-to-r from-green-600 to-emerald-600",children:[E.isPending&&e.jsx($,{className:"w-4 h-4 mr-2 animate-spin"}),"Create Threat"]})]})]})})]})}function Os(){const p=Ie(),N=parseInt(p.id||"0"),{data:v}=f.clients.get.useQuery({id:N},{enabled:!!N}),{data:c}=f.adversaryIntel.getSummary.useQuery(void 0,{staleTime:1e3*60*5});return e.jsx(Re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(xe,{href:`/clients/${N}/risks/overview`,children:e.jsxs(m,{variant:"ghost",size:"sm",className:"gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Back to Risk Management"]})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white border-0 px-4 py-1.5 text-sm",children:[e.jsx(T,{className:"w-4 h-4 mr-1.5"}),"Premium Feature"]}),e.jsx(Oe,{title:"Adversary Intelligence",description:"Live threat feeds and MITRE ATT&CK integration.",rationale:"Proactive risk management requires knowing what adversaries are doing now.",howToUse:[{step:"Browse Feeds",description:"Review the latest CISA and news items daily."},{step:"Create Risks",description:"Click 'Create Risk' on any feed item to instantly start an assessment."},{step:"Explore MITRE",description:"Use the matrix to understand specific tactics (e.g., Phishing) and their mitigations."}],integrations:[{name:"Risk Register",description:"One-click conversion of intelligence into tracked risks."},{name:"Vulnerabilities",description:"Cross-reference CISA KEVs with your asset inventory."}]})]})]}),e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8 text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zNiAxOGMtOS45NDEgMC0xOCA4LjA1OS0xOCAxOHM4LjA1OSAxOCAxOCAxOCAxOC04LjA1OSAxOC0xOC04LjA1OS0xOC0xOC0xOHoiIHN0cm9rZT0icmdiYSgyNTUsMjU1LDI1NSwwLjA1KSIgc3Ryb2tlLXdpZHRoPSIyIi8+PC9nPjwvc3ZnPg==')] opacity-30"}),e.jsxs("div",{className:"relative z-10 flex items-start justify-between",children:[e.jsxs("div",{className:"max-w-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-red-500 to-orange-500 shadow-lg shadow-red-500/30",children:e.jsx(_,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Adversary Intelligence"}),e.jsx("p",{className:"text-slate-300 mt-1",children:"Live threat feeds & MITRE ATT&CK framework"})]})]}),e.jsxs("p",{className:"text-slate-300 leading-relaxed mb-6",children:["Stay ahead of emerging threats with real-time security intelligence from",e.jsx("span",{className:"text-blue-400",children:" CISA"}),",",e.jsx("span",{className:"text-green-400",children:" The Hacker News"}),", and",e.jsx("span",{className:"text-orange-400",children:" Bleeping Computer"}),". Browse the complete MITRE ATT&CK framework to understand adversary tactics and create targeted risks directly from threat intelligence."]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("a",{href:"https://attack.mitre.org/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-purple-400 hover:text-purple-300 transition-colors",children:[e.jsx(R,{className:"w-4 h-4"}),"MITRE ATT&CK Website",e.jsx(y,{className:"w-3 h-3"})]}),e.jsxs("a",{href:"https://www.cisa.gov/known-exploited-vulnerabilities-catalog",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-red-400 hover:text-red-300 transition-colors",children:[e.jsx(me,{className:"w-4 h-4"}),"CISA KEV Catalog",e.jsx(y,{className:"w-3 h-3"})]})]})]}),c&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 min-w-[140px]",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs mb-1",children:[e.jsx(S,{className:"w-3 h-3"}),"Feed Items"]}),e.jsx("div",{className:"text-2xl font-bold",children:c.feedItems})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 min-w-[140px]",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-xs mb-1",children:[e.jsx(I,{className:"w-3 h-3"}),"Critical"]}),e.jsx("div",{className:"text-2xl font-bold text-red-400",children:c.criticalItems})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 min-w-[140px]",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-400 text-xs mb-1",children:[e.jsx(R,{className:"w-3 h-3"}),"Techniques"]}),e.jsx("div",{className:"text-2xl font-bold",children:c.techniques})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 min-w-[140px]",children:[e.jsxs("div",{className:"flex items-center gap-2 text-cyan-400 text-xs mb-1",children:[e.jsx(He,{className:"w-3 h-3"}),"Tactics"]}),e.jsx("div",{className:"text-2xl font-bold",children:c.tactics})]})]})]})]}),(c==null?void 0:c.topTags)&&c.topTags.length>0&&e.jsxs(B,{className:"border-slate-200 shadow-sm",children:[e.jsx(V,{className:"pb-3",children:e.jsxs(H,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-blue-500"}),"Trending Threats"]})}),e.jsx(z,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:c.topTags.map(n=>e.jsxs(l,{variant:"outline",className:"border-slate-300 text-slate-600 px-3 py-1",children:[n.tag,e.jsx("span",{className:"ml-1.5 text-xs bg-slate-100 px-1.5 rounded-full",children:n.count})]},n.tag))})})]}),(c==null?void 0:c.recentCves)&&c.recentCves.length>0&&e.jsxs(B,{className:"border-slate-200 shadow-sm",children:[e.jsx(V,{className:"pb-3",children:e.jsxs(H,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-red-500"}),"CVEs in Recent News"]})}),e.jsx(z,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:c.recentCves.map(n=>e.jsx("a",{href:`https://nvd.nist.gov/vuln/detail/${n}`,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(l,{className:"bg-red-50 text-red-700 border border-red-200 hover:bg-red-100 transition-colors cursor-pointer",children:[n,e.jsx(y,{className:"w-3 h-3 ml-1"})]})},n))})})]}),e.jsx(Ke,{clientId:N,onRiskCreated:n=>{console.log("Risk created:",n)}}),e.jsxs(B,{className:"border-blue-100 bg-blue-50/50",children:[e.jsx(V,{className:"pb-3",children:e.jsxs(H,{className:"text-sm font-medium flex items-center gap-2 text-blue-800",children:[e.jsx(Be,{className:"w-4 h-4"}),"How to Use Adversary Intelligence"]})}),e.jsx(z,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm text-blue-700",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold shrink-0",children:"1"}),e.jsx("p",{children:"Browse live security feeds to stay aware of emerging threats and vulnerabilities affecting your industry."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold shrink-0",children:"2"}),e.jsx("p",{children:"Explore MITRE ATT&CK techniques to understand how adversaries operate and what defenses to prioritize."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold shrink-0",children:"3"}),e.jsx("p",{children:'Click "Create Risk" on any item to instantly add it to your Risk Register with pre-filled details.'})]})]})})]})]})})}export{Os as AdversaryIntelPage,Os as default};
