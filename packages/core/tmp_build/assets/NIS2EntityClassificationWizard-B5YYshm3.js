import{ab as ee,b as se,r as c,j as e,c as g,C as n,m as l,D as te,o as ie,p as ae,q as re,d as y,e as N,w as ne,i as D,L as x,E as le,G as ce,H as oe,J as de,K as me,U as F,F as xe,I as O,k as z,v as he,S as pe,T as ue}from"./index-DOc7Nwb7.js";import{P as ge}from"./progress-B-1k4ZZX.js";import{R as je,a as G}from"./radio-group-BhirXgcC.js";import{T as ye}from"./textarea-BtxBxzdY.js";import{A as b,b as S}from"./alert-BudCfM-X.js";import{D as Ne}from"./DashboardLayout-aHnUqq57.js";import{A as P}from"./arrow-left-CpuUojG-.js";import{A as fe}from"./arrow-right-M96iV-v9.js";import{I as C}from"./info-By5wLOUH.js";import{G as ve}from"./globe-BMGZmoaJ.js";import{B as be}from"./building-C0cheRWa.js";import{T as B}from"./trending-up-eUiO956o.js";import{T as Se}from"./target-cfAj3L6j.js";import{C as Ce}from"./circle-check-C5kiwRoG.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";const we=[{id:"energy",name:"Energy",description:"Electricity, oil, gas, and renewable energy sectors",examples:"Power generation, grid operators, energy suppliers"},{id:"transport",name:"Transport",description:"Air, rail, water, and road transport systems",examples:"Airlines, railways, shipping companies, traffic management"},{id:"banking",name:"Banking",description:"Financial services and digital payment infrastructure",examples:"Banks, payment processors, financial institutions"},{id:"financial",name:"Financial Market Infrastructure",description:"Stock exchanges, clearing houses, and trading platforms",examples:"Stock markets, investment firms, insurance companies"},{id:"health",name:"Healthcare",description:"Medical services, hospitals, and health data systems",examples:"Hospitals, medical device manufacturers, health IT systems"},{id:"drinking",name:"Drinking Water Supply",description:"Water treatment and distribution systems",examples:"Water utilities, treatment plants, distribution networks"},{id:"digital",name:"Digital Infrastructure",description:"Critical internet services and digital platforms",examples:"Cloud providers, DNS services, online marketplaces"},{id:"public",name:"Public Administration",description:"Government services and administrative systems",examples:"Tax systems, social security, public portals"},{id:"postal",name:"Postal Services",description:"Mail delivery and logistics services",examples:"Postal operators, delivery services, logistics companies"},{id:"waste",name:"Waste Management",description:"Waste collection, treatment, and disposal systems",examples:"Waste management companies, recycling facilities"}],w=[{country:"Germany",authority:"BSI (Federal Office for Information Security)",registration:"CIR Act Registration"},{country:"France",authority:"ANSSI (National Agency for the Security of Information Systems)",registration:"ANSSI Registry"},{country:"Netherlands",authority:"NCSC (National Cyber Security Centre)",registration:"Digital Trust Register"},{country:"Spain",authority:"CCN-CERT (National Cryptological Center)",registration:"Esquema Nacional de Seguridad"},{country:"Italy",authority:"CSIRT (Computer Security Incident Response Team)",registration:"Registro Nazionale"},{country:"Poland",authority:"CERT Polska (Polish Computer Emergency Response Team)",registration:"National Register of Essential Services"},{country:"Sweden",authority:"MSB (Swedish Civil Contingencies Agency)",registration:"NIS2 Registry"},{country:"Denmark",authority:"CFCS (Center for Cyber Security)",registration:"NIS2 Register"},{country:"Finland",authority:"Traficom (Finnish Transport and Communications Agency)",registration:"NIS2 Registry"}],f=["Sector Analysis","Size Assessment","Service Evaluation","Classification Result","Registration Guidance"];function js(){const{clientId:I}=ee(),[Ie,R]=se(),[i,k]=c.useState(0),[Re,L]=c.useState({}),[ke,H]=c.useState(!1),[M,v]=c.useState(!1),[o,E]=c.useState([]),[h,$]=c.useState(""),[p,q]=c.useState(""),[u,U]=c.useState(null),[d,W]=c.useState(""),[V,Y]=c.useState(""),_=()=>{const r=parseInt(h)||0,a=parseFloat(p.replace(/[^0-9.]/g,""))||0,t=r>=50||a>=1e7,s=o.some(j=>["energy","transport","banking","financial","health","drinking","digital"].includes(j));let m;return t&&s&&u?m="essential":t&&s||t&&o.length>0?m="important":m="not-applicable",L({id:`nis2_${Date.now()}`,sector:o.join(", "),employeeCount:r,annualRevenue:a,providesEssentialServices:u||!1,countryOfOperation:d,classification:m,lastUpdated:new Date().toISOString(),evidence:[]}),m},A=r=>{switch(r){case"essential":return"text-red-600 bg-red-100";case"important":return"text-orange-600 bg-orange-100";default:return"text-green-600 bg-green-100"}},J=r=>{switch(r){case"essential":return e.jsx(ue,{className:"h-5 w-5"});case"important":return e.jsx(pe,{className:"h-5 w-5"});default:return e.jsx(Ce,{className:"h-5 w-5"})}},K=()=>{var r,a;switch(i){case 0:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Sector Analysis"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Select all sectors where your organization operates. NIS2 applies to critical sectors defined by the EU."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:we.map(s=>e.jsx(n,{className:`cursor-pointer transition-all ${o.includes(s.id)?"ring-2 ring-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:shadow-md"}`,children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(he,{id:s.id,checked:o.includes(s.id),onCheckedChange:m=>{E(m?j=>[...j,s.id]:j=>j.filter(T=>T!==s.id))}}),e.jsxs("div",{className:"flex-1",children:[e.jsx(x,{htmlFor:s.id,className:"font-semibold text-lg mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx("strong",{children:"Examples:"})," ",s.examples]})]})]})})},s.id))}),o.length>0&&e.jsxs(b,{children:[e.jsx(C,{className:"h-4 w-4"}),e.jsxs(S,{children:["You've selected ",o.length," sector(s). Next, we'll assess if you meet NIS2 size thresholds."]})]})]});case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Size Assessment"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"NIS2 applies to organizations with 50+ employees OR €10M+ annual revenue."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(n,{children:[e.jsx(y,{children:e.jsxs(N,{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{children:"Employee Count"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(x,{htmlFor:"employees",children:"Number of employees"}),e.jsx(O,{id:"employees",type:"number",placeholder:"Enter total employee count",value:h,onChange:s=>$(s.target.value),className:"text-lg"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Include all employees across all selected sectors"})]})})]}),e.jsxs(n,{children:[e.jsx(y,{children:e.jsxs(N,{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-5 w-5"}),e.jsx("span",{children:"Annual Revenue"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(x,{htmlFor:"revenue",children:"Annual Revenue (€)"}),e.jsx(O,{id:"revenue",type:"text",placeholder:"10,000,000",value:p,onChange:s=>q(s.target.value),className:"text-lg"}),e.jsx("p",{className:"text-sm text-gray-500",children:"NIS2 threshold: €10,000,000 (10 million Euros)"})]})})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Size Threshold Analysis"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Employee Count (50+ required):"}),e.jsxs(z,{variant:parseInt(h)>=50?"default":"secondary",children:[h||"0"," ",parseInt(h)>=50?"✓":"✗"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Annual Revenue (€10M+ required):"}),e.jsxs(z,{variant:parseFloat(p.replace(/[^0-9.]/g,""))>=1e7?"default":"secondary",children:[p||"€0"," ",parseFloat(p.replace(/[^0-9.]/g,""))>=1e7?"✓":"✗"]})]})]})]})]});case 2:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Service Evaluation"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Determine if your organization provides essential services that society depends on."})]}),e.jsxs(n,{children:[e.jsx(y,{children:e.jsxs(N,{className:"flex items-center space-x-2",children:[e.jsx(Se,{className:"h-5 w-5"}),e.jsx("span",{children:"Essential Service Assessment"})]})}),e.jsxs(l,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-lg font-medium",children:"Do you provide essential services?"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Essential services are those whose disruption would have significant impact on society, public safety, or economic activity."}),e.jsxs(je,{value:(u==null?void 0:u.toString())||"",onValueChange:s=>U(s==="true"),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{value:"true",id:"essential-yes"}),e.jsx(x,{htmlFor:"essential-yes",children:"Yes, we provide essential services"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{value:"false",id:"essential-no"}),e.jsx(x,{htmlFor:"essential-no",children:"No, we do not provide essential services"})]})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"service-description",children:"Service Description"}),e.jsx(ye,{id:"service-description",placeholder:"Describe the services you provide and why they may be considered essential...",value:V,onChange:s=>Y(s.target.value),rows:4,className:"mt-2"})]}),e.jsxs(b,{children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(S,{children:"Examples of essential services: Power grid operations, banking systems, hospital emergency services, water treatment, air traffic control."})]})]})]})]});case 3:const t=_();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Classification Result"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Based on your assessment, here is your NIS2 classification."})]}),e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative inline-flex items-center justify-center",children:[e.jsx("div",{className:"text-4xl font-bold capitalize",children:t.replace("-"," ")}),e.jsx("div",{className:`absolute -top-2 -right-2 px-3 py-1 rounded-full text-xs font-medium ${A(t)}`,children:t==="essential"?"HIGH OBLIGATIONS":t==="important"?"MODERATE OBLIGATIONS":"LIMITED OBLIGATIONS"})]}),e.jsxs("div",{className:`inline-flex items-center space-x-3 px-6 py-4 rounded-full ${A(t)}`,children:[J(t),e.jsx("span",{className:"text-lg font-medium",children:t==="essential"?"Essential Entity":t==="important"?"Important Entity":"Not Applicable to NIS2"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(n,{children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(be,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Sectors"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[o.length," sector(s)"]})]})}),e.jsx(n,{children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(F,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Size"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[h," employees"]})]})}),e.jsx(n,{children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(B,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Revenue"}),e.jsx("p",{className:"text-sm text-gray-600",children:p})]})})]}),e.jsxs(b,{children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx(S,{children:t==="essential"?"As an Essential Entity, you must implement comprehensive cybersecurity measures, report incidents within 24 hours, and undergo regular audits.":t==="important"?"As an Important Entity, you must implement appropriate cybersecurity measures and establish risk management procedures.":"Your organization may not be subject to NIS2 obligations, but good cybersecurity practices are still recommended."})]})]});case 4:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Registration Guidance"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"NIS2 requires registration with national authorities. Here's guidance for your country."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"country",children:"Country of Operation"}),e.jsxs(le,{value:d,onValueChange:W,children:[e.jsx(ce,{children:e.jsx(oe,{placeholder:"Select your country"})}),e.jsx(de,{children:w.map(s=>e.jsx(me,{value:s.country,children:s.country},s.country))})]})]}),d&&e.jsx(n,{children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ve,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:d}),e.jsx("p",{className:"text-sm text-gray-600",children:"NIS2 Authority"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded",children:[e.jsx("p",{className:"font-medium mb-2",children:(r=w.find(s=>s.country===d))==null?void 0:r.authority}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"Registration:"})," ",(a=w.find(s=>s.country===d))==null?void 0:a.registration]}),e.jsx(g,{onClick:()=>v(!0),className:"w-full",children:"Get Registration Instructions"})]})]})})})]})]});default:return null}},Q=()=>{i<f.length-1?k(i+1):(H(!0),D.success("NIS2 Entity Classification completed!"))},X=()=>{i>0&&k(i-1)},Z=()=>{switch(i){case 0:return o.length>0;case 1:return h&&p;case 2:return u!==null;case 3:return!0;case 4:return d;default:return!1}};return e.jsxs(Ne,{children:[e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(g,{variant:"ghost",onClick:()=>R(`/clients/${I}/cyber`),className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{children:"Back to NIS2"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"NIS2 Entity Classification"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Determine if your organization must comply with NIS2 Directive"})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"flex space-x-2",children:f.map((r,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${a<=i?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:a<i?"✓":a+1}),e.jsx("span",{className:`ml-2 text-sm ${a<=i?"text-blue-600":"text-gray-500"}`,children:r}),a<f.length-1&&e.jsx("div",{className:`w-8 h-0.5 mx-2 ${a<i?"bg-blue-600":"bg-gray-200"}`})]},a))})}),e.jsx(ge,{value:i/(f.length-1)*100,className:"h-2"})]}),e.jsx(n,{children:e.jsx(l,{className:"p-8",children:K()})}),e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsxs(g,{variant:"outline",onClick:X,disabled:i===0,children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:Q,disabled:!Z(),children:[i===f.length-1?"Complete Classification":"Next",e.jsx(fe,{className:"h-4 w-4 ml-2"})]})]})]})}),e.jsx(te,{open:M,onOpenChange:v,children:e.jsxs(ie,{className:"max-w-2xl",children:[e.jsx(ae,{children:e.jsx(re,{children:"NIS2 Registration Instructions"})}),e.jsx("div",{className:"space-y-6",children:d&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(S,{children:"These are general registration requirements. Contact your national authority for specific guidance."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(n,{children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg",children:"Required Information"})}),e.jsx(l,{children:e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsx("li",{children:"• Organization registration details"}),e.jsx("li",{children:"• List of essential services provided"}),e.jsx("li",{children:"• Contact information for CSIRT reporting"}),e.jsx("li",{children:"• Cybersecurity risk assessment"}),e.jsx("li",{children:"• Description of security measures"})]})})]}),e.jsxs(n,{children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg",children:"Registration Timeline"})}),e.jsx(l,{children:e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsx("li",{children:"• Initial registration: within 21 months of adoption"}),e.jsx("li",{children:"• Annual updates: required"}),e.jsx("li",{children:"• Incident reporting: within 24 hours"}),e.jsx("li",{children:"• Compliance assessment: every 3 years"})]})})]})]})]})}),e.jsxs(ne,{children:[e.jsx(g,{variant:"outline",onClick:()=>v(!1),children:"Close"}),e.jsx(g,{onClick:()=>{D.success("Registration instructions saved!"),v(!1),R(`/clients/${I}/cyber`)},children:"Go to NIS2 Dashboard"})]})]})})]})}export{js as default};
