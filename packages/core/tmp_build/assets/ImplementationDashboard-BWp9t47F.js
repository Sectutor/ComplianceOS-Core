import{M as F,r as d,t as g,i as m,j as e,D as O,o as q,p as B,q as U,F as T,s as z,L as S,I as G,v as H,x as _,c,C as y,m as w,d as I,e as L,f as M,k as A,aq as R,U as K,ab as Q,b as V,ac as Y}from"./index-DOc7Nwb7.js";import{D as X,l as J}from"./DashboardLayout-aHnUqq57.js";import{D as W}from"./download-ByfWg1Mi.js";import{S as Z}from"./scroll-area-DPaNxEJD.js";import{C as ee}from"./circle-check-C5kiwRoG.js";import{C as se}from"./clock-osbacZli.js";import{A as $}from"./arrow-right-M96iV-v9.js";import{R as te,T as ae,B as re,l as ie}from"./generateCategoricalChart-KNLgM3hn.js";import{B as le}from"./BarChart-KWJ05I0m.js";import{X as ne,Y as oe}from"./YAxis-DC4HJ4F3.js";import{A as de,a as ce,b as me,c as xe,d as pe,e as he,f as ue,g as ge}from"./alert-dialog-V7xGXdVc.js";import{P as je}from"./PageGuide-CPKKXXS6.js";import{P as be}from"./plus-BaQ35Jcx.js";import{T as fe}from"./trash-2-CFEfisbM.js";import{C as Ne}from"./calendar-BlLJlGbj.js";import{P as ve}from"./panels-top-left-DItCQeAG.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./isEqual-D_xcZLCn.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=F("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]),we=[{id:"cover_page",label:"Cover Page",required:!0},{id:"executive_summary",label:"Executive Summary (AI-Generated)",recommended:!0},{id:"execution_dashboard",label:"Execution Dashboard"},{id:"detailed_task_log",label:"Detailed Task Log"},{id:"resource_allocation",label:"Resource Allocation & Budget"},{id:"appendix",label:"Appendix (Data Tables)"}];function Ce({open:l,onOpenChange:n,clientId:p,planId:i}){const[a,r]=d.useState("Implementation Status Report"),[o,C]=d.useState("v1.0"),[j,h]=d.useState(["cover_page","executive_summary","execution_dashboard","detailed_task_log"]),[v,k]=d.useState({gapAnalysis:!1,riskAssessment:!1,controls:!1,policies:!1}),[b,f]=d.useState(0),[N,u]=d.useState(""),x=g.reports.generateImplementationReport.useMutation({onMutate:()=>{m.info("Starting report generation...",{description:"This may take a few moments",duration:3e3}),f(10),u("Preparing data...")},onSuccess:s=>{f(100),u("Report generated successfully!"),m.success("Report generated successfully!",{description:"Your report is ready to download",duration:5e3}),setTimeout(()=>{n(!1),f(0),u("")},1500),s.reportId&&m.info("Report available in the Reports section.")},onError:s=>{f(0),u("Generation failed"),m.error(`Failed to generate report: ${s.message}`,{duration:5e3})}}),P=s=>{s!=="cover_page"&&h(D=>D.includes(s)?D.filter(E=>E!==s):[...D,s])},t=()=>{x.mutate({clientId:p,implementationPlanId:i,title:a,version:o,includedSections:j,dataSources:v})};return e.jsx(O,{open:l,onOpenChange:n,children:e.jsxs(q,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(B,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Generate Implementation Report"]}),e.jsx(z,{children:"Configure and generate an implementation status report"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"title",children:"Report Title"}),e.jsx(G,{id:"title",value:a,onChange:s=>r(s.target.value),placeholder:"Implementation Status Report"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"version",children:"Version"}),e.jsx(G,{id:"version",value:o,onChange:s=>C(s.target.value),placeholder:"v1.0, v2.0, final"})]})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-base font-semibold mb-3 block",children:"Report Sections"}),e.jsx("div",{className:"space-y-2 border rounded-lg p-4",children:we.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:s.id,checked:j.includes(s.id),onCheckedChange:()=>P(s.id),disabled:s.required}),e.jsxs("label",{htmlFor:s.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer flex-1",children:[s.label,s.required&&e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:"(Required)"}),s.recommended&&e.jsx("span",{className:"text-xs text-blue-600 ml-2",children:"(Recommended)"})]})]},s.id))})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-900",children:[e.jsx("strong",{children:"AI Enhancement:"})," The Executive Summary will be generated using AI based on your implementation progress and task completion rates."]})}),x.isPending&&e.jsxs("div",{className:"space-y-3 border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Generating Report..."}),e.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[b,"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${b}%`}})}),N&&e.jsxs("div",{className:"text-xs text-slate-600 flex items-center gap-2",children:[e.jsx(_,{className:"w-3 h-3 animate-spin"}),N]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(c,{variant:"outline",onClick:()=>n(!1),disabled:x.isPending,children:"Cancel"}),e.jsx(c,{onClick:t,disabled:x.isPending,className:`
                            ${x.isPending?"bg-blue-600 hover:bg-blue-700 animate-pulse shadow-lg shadow-blue-500/30":"bg-blue-600 hover:bg-blue-700"}
                            transition-all duration-300
                        `,children:x.isPending?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Generate Report"]})})]})]})})}const ke=()=>{const{data:l,isLoading:n}=g.implementation.getMyTasks.useQuery();if(n)return e.jsx("div",{className:"text-sm text-slate-500",children:"Loading your tasks..."});if(!l||l.length===0)return e.jsx(y,{className:"border-slate-200 bg-white",children:e.jsxs(w,{className:"pt-6 text-center py-12",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ee,{className:"w-6 h-6 text-slate-400"})}),e.jsx("p",{className:"text-slate-600 font-medium",children:"No active tasks assigned to you."}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Enjoy your free time!"})]})});const p=l.reduce((i,a)=>{const r=a.planTitle||"Untitled Plan";return i[r]||(i[r]=[]),i[r].push(a),i},{});return e.jsxs(y,{className:"border-slate-200 bg-white shadow-sm h-full",children:[e.jsx(I,{className:"border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(ye,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:"My Active Tasks"}),e.jsx(M,{children:"Tasks assigned to you across all plans"})]})]}),e.jsxs(A,{variant:"secondary",className:"bg-blue-50 text-blue-700",children:[l.length," Pending"]})]})}),e.jsx(Z,{className:"h-[400px]",children:e.jsx(w,{className:"pt-6 space-y-6",children:Object.entries(p).map(([i,a])=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3",children:i}),e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 border rounded-lg hover:border-blue-200 transition-colors group",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`mt-0.5 w-4 h-4 rounded-full border-2 ${r.priority==="high"?"border-red-400":"border-slate-300"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 text-sm group-hover:text-blue-700",children:r.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[r.estimatedHours>0&&e.jsxs("span",{className:"text-xs text-slate-500 flex items-center",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),r.estimatedHours,"h"]}),e.jsx(A,{variant:"outline",className:"text-[10px] h-5 font-normal",children:r.status.replace("_"," ")})]})]})]}),e.jsx("div",{className:"mt-3 sm:mt-0 flex justify-end",children:e.jsx(R,{href:`/implementation/${r.implementationPlanId}`,children:e.jsx(c,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx($,{className:"w-4 h-4 text-slate-400"})})})})]},r.id))})]},i))})})]})},Pe=({clientId:l})=>{const{data:n,isLoading:p}=g.implementation.getTeamCapacity.useQuery({clientId:l});if(p)return e.jsx("div",{className:"text-sm text-slate-500",children:"Loading team capacity..."});const i=n||[],a=["#3b82f6","#10b981","#f59e0b","#8b5cf6","#ec4899"];return e.jsxs(y,{className:"border-slate-200 bg-white shadow-sm h-full",children:[e.jsx(I,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:e.jsx(K,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:"Team Capacity"}),e.jsx(M,{children:"Total estimated hours assigned per team member"})]})]})}),e.jsx(w,{children:i.length===0?e.jsx("div",{className:"h-[200px] flex items-center justify-center text-slate-400",children:"No team assignments yet."}):e.jsx("div",{className:"h-[250px] w-full",children:e.jsx(te,{width:"100%",height:"100%",children:e.jsxs(le,{data:i,layout:"vertical",margin:{left:20},children:[e.jsx(ne,{type:"number",hide:!0}),e.jsx(oe,{dataKey:"name",type:"category",tick:{fontSize:12,fill:"#64748b"},width:100}),e.jsx(ae,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(re,{dataKey:"hours",radius:[0,4,4,0],barSize:20,children:i.map((r,o)=>e.jsx(ie,{fill:a[o%a.length]},`cell-${o}`))})]})})})})]})};function Ns(){const l=Q(),[,n]=V(),p=l.id?parseInt(l.id,10):null,{selectedClientId:i}=Y(),a=p||i,[r,o]=d.useState(!1),[C,j]=d.useState(!1),[h,v]=d.useState(null),k=g.useContext(),{data:b,isLoading:f}=g.implementation.list.useQuery({clientId:a},{enabled:!!a}),N=g.compliancePlanning.generatePlan.useMutation({onSuccess:t=>{t!=null&&t.planId?(m.success("PDCA demo plan created",{description:`Generated ${t.taskCount} tasks for ${t.framework}`}),n(`/clients/${a}/implementation/plan/${t.planId}`)):m.info("Plan generated, but no planId returned"),k.implementation.list.invalidate()},onError:t=>{m.error("Failed to generate demo plan",{description:t.message})}}),u=g.implementation.deletePlan.useMutation({onSuccess:()=>{m.success("Plan deleted successfully"),k.implementation.list.invalidate(),j(!1),v(null)},onError:t=>{m.error("Failed to delete plan",{description:t.message})}}),x=(t,s)=>{t.stopPropagation(),v(s),j(!0)},P=()=>{h&&u.mutate({planId:h.id})};return e.jsx(X,{children:e.jsxs("div",{className:"space-y-8 p-8 animate-in fade-in duration-500 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Tactical Implementation"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage your security projects and track execution progress."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(je,{title:"Tactical Implementation",description:"Execution hub for compliance tasks and remediation plans.",rationale:"Translates strategic goals into actionable tasks assigned to team members.",howToUse:[{step:"Create Plan",description:"Start from a roadmap or template."},{step:"Manage Tasks",description:"Use the Kanban board to track progress."},{step:"Orchestrate",description:"Use AI to break down requirements into subtasks."}],integrations:[{name:"Roadmap",description:"Inherits strategic milestones."},{name:"Ticketing",description:"Syncs with JIRA/Linear (if configured)."}]}),e.jsxs(c,{variant:"outline",className:"bg-white/50 hover:bg-white border-slate-200",onClick:()=>o(!0),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Generate Report"]}),e.jsx(c,{variant:"outline",className:"bg-indigo-50 hover:bg-indigo-100 border-indigo-200",disabled:N.isPending||!a,onClick:()=>N.mutate({clientId:a,framework:"ISO27001",useAi:!1}),children:N.isPending?"Creating Demo PDCAâ€¦":"Create PDCA Demo Plan"}),e.jsx(R,{href:`/clients/${a}/implementation/create`,children:e.jsxs(c,{className:"bg-blue-600 hover:bg-blue-700 shadow-lg shadow-blue-500/20",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Create New Plan"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ke,{}),a&&e.jsx(Pe,{clientId:a})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"Active Plans"}),f?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(t=>e.jsx("div",{className:"h-48 bg-slate-100 rounded-xl animate-pulse"},t))}):b&&b.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(t=>e.jsxs(y,{className:"group hover:border-blue-400 hover:shadow-xl transition-all duration-300 border-slate-200 cursor-pointer overflow-hidden relative",onClick:()=>n(`/clients/${a}/implementation/plan/${t.id}`),children:[e.jsxs("div",{className:"absolute top-0 right-0 p-4 flex gap-2",children:[e.jsx(A,{variant:"outline",className:"bg-white/80 backdrop-blur-sm text-[10px] uppercase",children:t.status.replace("_"," ")}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6 text-slate-400 hover:text-red-500 hover:bg-red-50 -mt-1 -mr-1 opacity-0 group-hover:opacity-100 transition-all",onClick:s=>x(s,t),children:e.jsx(fe,{className:"w-3.5 h-3.5"})})]}),e.jsxs(I,{className:"pb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center mb-3 group-hover:bg-blue-600 group-hover:text-white transition-colors duration-300",children:e.jsx(J,{className:"w-5 h-5 pointer-events-none"})}),e.jsx(L,{className:"text-xl line-clamp-1",children:t.title}),e.jsx(M,{className:"line-clamp-2 h-10 mt-2",children:t.description||"Project implementation and task management."})]}),e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-50 mt-2",children:[e.jsxs("div",{className:"flex items-center text-xs text-slate-500",children:[e.jsx(Ne,{className:"w-3.5 h-3.5 mr-1.5"}),t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"]}),e.jsxs("div",{className:"flex items-center text-blue-600 text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:["Manage Phase Plan ",e.jsx($,{className:"ml-1.5 w-4 h-4"})]})]})})]},t.id))}):e.jsxs("div",{className:"text-center py-20 bg-slate-50 rounded-2xl border-2 border-dashed border-slate-200",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ve,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"No Implementation Plans"}),e.jsx("p",{className:"text-slate-500 mt-2 max-w-sm mx-auto",children:"Kickstart your security journey by creating a plan manually or from a strategic roadmap."}),e.jsx(R,{href:`/clients/${a}/implementation/create`,children:e.jsx(c,{variant:"outline",className:"mt-6 bg-white",children:"Get Started"})})]})]}),e.jsxs("div",{className:"pt-8 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-900",children:"Generate Reports"}),e.jsxs(c,{variant:"outline",size:"sm",className:"bg-blue-600/20 border-blue-500/30 text-blue-700 hover:bg-blue-600/30",onClick:()=>o(!0),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Generate New Report"]})]}),e.jsxs("p",{className:"text-sm text-slate-500 mb-4",children:["Generate implementation reports from this dashboard. All generated reports can be managed in the ",e.jsx("a",{href:`/clients/${a}/roadmap/reports`,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Report Management"})," page."]})]}),e.jsx(Ce,{open:r,onOpenChange:o,clientId:a}),e.jsx(de,{open:C,onOpenChange:j,children:e.jsxs(ce,{children:[e.jsxs(me,{children:[e.jsx(xe,{children:"Are you sure?"}),e.jsxs(pe,{children:["This will permanently delete the plan ",e.jsx("strong",{children:h==null?void 0:h.title})," and all associated tasks. This action cannot be undone."]})]}),e.jsxs(he,{children:[e.jsx(ue,{children:"Cancel"}),e.jsx(ge,{onClick:P,className:"bg-red-600 hover:bg-red-700",children:u.isPending?"Deleting...":"Delete Plan"})]})]})})]})})}export{Ns as default};
