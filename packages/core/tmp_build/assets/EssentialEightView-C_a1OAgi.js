import{ab as Q,b as q,r as u,t as A,j as e,S as D,c as g,C as w,m as E,k as j,i as F,d as _,e as G}from"./index-DOc7Nwb7.js";import{D as H}from"./DashboardLayout-aHnUqq57.js";import{B as V}from"./Breadcrumb-CRi3LAxS.js";import{P as W,a as J}from"./PageGuide-CPKKXXS6.js";import{B as K}from"./bar-chart-3-BCngNY6H.js";import{C as R}from"./clipboard-check-CQkJX5J0.js";import{T as Y}from"./trending-up-eUiO956o.js";import{T as B}from"./target-cfAj3L6j.js";import{I}from"./info-By5wLOUH.js";import{B as X}from"./book-open-BffBrdze.js";import{C as T}from"./circle-check-C5kiwRoG.js";import{A as Z}from"./arrow-right-M96iV-v9.js";import{E as ee}from"./external-link-C3PXjBR9.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";const te={"Application Control":{id:"Application Control",name:"Application Control",fullDescription:"Only approved applications may execute, to prevent untrusted or malicious code. Includes whitelisting, code signing enforcement, and control over script interpreters.",levels:[{level:0,description:"No effective application allow-listing. Users can run arbitrary software.",criteria:["Unrestricted execution of binaries and scripts","No centralized policy for application trust"],nextSteps:["Inventory business-required applications","Pilot allow-listing in a small cohort"],standardLinks:[{name:"Essential Eight",url:"https://www.cyber.gov.au/essential-eight"}]},{level:1,description:"Basic allow-listing for key systems. Exceptions handled ad hoc.",criteria:["Policy-based allow-list for high-risk endpoints","Controls on script interpreters (e.g., PowerShell, macros) for non-admins"],nextSteps:["Expand allow-listing coverage","Introduce code signing enforcement for enterprise binaries"]},{level:2,description:"Organization-wide allow-listing with signed binaries and controlled scripts.",criteria:["Code signing enforced for enterprise apps","Script execution restricted to approved, signed scripts"],nextSteps:["Automate exception workflows with audit logging","Periodic review of approved lists"]},{level:3,description:"Continuous improvement with centralized policy, monitoring and exception governance.",criteria:["Central policy with automated deployment","Exception registry with expiry and review"],nextSteps:["Integrate telemetry with SIEM","Quarterly validation of allow-list effectiveness"]}]},"Patch Applications":{id:"Patch Applications",name:"Patch Applications",fullDescription:"Rapidly patch and update applications to remediate known vulnerabilities. Includes asset discovery, vulnerability scanning, and time-bound patch SLAs.",levels:[{level:0,description:"Limited visibility of application vulnerabilities; patching is reactive.",criteria:["No automated asset discovery","Infrequent or manual vulnerability scanning"],nextSteps:["Deploy automated asset discovery (â‰¥ fortnightly)","Introduce a vulnerability scanner with up-to-date database"],standardLinks:[{name:"Essential Eight Maturity Model",url:"https://www.cyber.gov.au/business-government/asds-cyber-security-frameworks/essential-eight/essential-eight-maturity-model"}]},{level:1,description:"Foundational scanning and patching cadence for common applications.",criteria:["Weekly scanning for office productivity, browsers, email, PDF, security products","Fortnightly scanning for other applications"],nextSteps:["Daily scanning for online services","Define critical vs non-critical patch SLAs"]},{level:2,description:"Time-bound patch SLAs enforced, with priority based on exploitability.",criteria:["Critical online service vulnerabilities patched within 48 hours or vendor mitigations applied","Non-critical online service vulnerabilities patched within two weeks if no working exploits"],nextSteps:["Track SLA adherence and exceptions","Automate rollout with staged rings"]},{level:3,description:"Comprehensive coverage and continuous scanning with maturity tracking across all applications.",criteria:["48-hour SLA for critical office-app/browser/email/PDF/security product vulnerabilities","Two-week SLA for non-critical office-app/browser/email/PDF/security product vulnerabilities","Monthly patching for other applications"],nextSteps:["Integrate exploit intel to preemptively prioritize","Quarterly audit of asset discovery and coverage"]}]},"Configure Macro Settings":{id:"Configure Macro Settings",name:"Configure Macro Settings",fullDescription:"Reduce risk from malicious macros by configuring restrictive defaults and signed macro policies.",levels:[{level:0,description:"Macros allowed by default; weak controls on unsigned content.",criteria:["No enterprise macro policy","Users can enable macros freely"],nextSteps:["Disable macros by default","Block unsigned or internet-origin macros"]},{level:1,description:"Default-disabled macros with limited exceptions.",criteria:["Macros disabled by default","Trusted locations and signed macros allowed"],nextSteps:["Centralize policy deployment","Audit macro usage"]},{level:2,description:"Enterprise-wide signed macro enforcement.",criteria:["Only signed macros allowed","Exception workflow for business need"],nextSteps:["Periodic review of signatures and issuers","User training on macro risks"]},{level:3,description:"Continuous improvement and monitoring of macro execution.",criteria:["SIEM telemetry on macro events","Exception expiry and review"],nextSteps:["Quarterly attestation of macro policy adherence"]}]},"User Application Hardening":{id:"User Application Hardening",name:"User Application Hardening",fullDescription:"Disable risky features and enforce secure configurations in user applications (browsers, email clients, PDF readers).",levels:[{level:0,description:"Risky defaults enabled; limited policy enforcement.",criteria:["Default-permit risky features","No baseline hardening standard"],nextSteps:["Define baseline config","Disable high-risk features and plugins"]},{level:1,description:"Baseline hardening applied to common apps.",criteria:["Harden browsers and email clients","Restrict plugins and helpers"],nextSteps:["Automate policy deployment","Document exception handling"]},{level:2,description:"Organization-wide hardening with compliance checks.",criteria:["SCAP/benchmark checks for compliance","Periodic enforcement scans"],nextSteps:["Central metrics dashboards","Integrate with vulnerability management"]},{level:3,description:"Continuous improvement with telemetry-driven adjustments.",criteria:["SIEM telemetry on risky features","Regular review against updated benchmarks"],nextSteps:["Quarterly updates to hardening standards"]}]},"Restrict Admin Privileges":{id:"Restrict Admin Privileges",name:"Restrict Admin Privileges",fullDescription:"Limit administrative privileges and use just-in-time elevation to reduce attack surface.",levels:[{level:0,description:"Broad admin rights; shared accounts; weak approval.",criteria:["Users retain standing admin privileges","No formal approval or logging"],nextSteps:["Remove standing admin rights","Implement role-based access controls"]},{level:1,description:"Approval-based admin actions with basic logging.",criteria:["Admin actions require approval","Logging of elevated sessions"],nextSteps:["Implement JIT/PAM","Tie elevation to tickets"]},{level:2,description:"JIT elevation with MFA and session recording.",criteria:["MFA required for elevation","PAM with session capture"],nextSteps:["Periodic review of admin roles","Automated expiry of elevated access"]},{level:3,description:"Continuous monitoring and attestation of admin access.",criteria:["Behavior analytics on admin actions","Quarterly access recertification"],nextSteps:["Automated anomaly response hooks"]}]},"Patch Operating Systems":{id:"Patch Operating Systems",name:"Patch Operating Systems",fullDescription:"Keep operating systems up to date, prioritizing critical vulnerabilities and exploit-based risk.",levels:[{level:0,description:"Irregular OS patching; low visibility.",criteria:["No centralized patching","Unmanaged OS versions"],nextSteps:["Establish baselines","Deploy patch management tooling"]},{level:1,description:"Regular OS patching for common platforms.",criteria:["Monthly OS patches","Emergency patch workflow exists"],nextSteps:["Define SLAs for critical vulnerabilities","Automate reporting"]},{level:2,description:"Enforced SLAs and compliance measurement.",criteria:["48-hour SLA for critical vulnerabilities in exposed systems","Two-week SLA for non-critical patches"],nextSteps:["Ring-based deployment","Exception governance"]},{level:3,description:"Continuous scanning and remediation with metrics.",criteria:["Automated compliance dashboards","Exploit intel informs prioritization"],nextSteps:["Quarterly audits of patch coverage"]}]},"Multi-factor Authentication":{id:"Multi-factor Authentication",name:"Multi-factor Authentication",fullDescription:"Require MFA for remote access, privileged actions, and high-risk systems to mitigate credential compromise.",levels:[{level:0,description:"MFA is optional or inconsistently applied.",criteria:["No enforced MFA policy","Legacy protocols bypass MFA"],nextSteps:["Enable MFA for remote access","Identify and block bypass paths"]},{level:1,description:"MFA for remote access and admin accounts.",criteria:["MFA for admin roles","MFA for VPN/SSO/external portals"],nextSteps:["Expand MFA to sensitive applications","Introduce phishing-resistant factors where possible"]},{level:2,description:"Broad MFA coverage across critical applications.",criteria:["MFA for all users on critical apps","Conditional access policies"],nextSteps:["Adopt phishing-resistant MFA for privileged roles","Continuous monitoring of MFA health"]},{level:3,description:"Phishing-resistant MFA and adaptive policies.",criteria:["FIDO/WebAuthn for admins","Risk-based prompts and device trust"],nextSteps:["Quarterly posture reviews"]}]},"Regular Backups":{id:"Regular Backups",name:"Regular Backups",fullDescription:"Perform regular, tested backups with offline/immutable copies to enable rapid recovery from incidents such as ransomware.",levels:[{level:0,description:"Inconsistent backups; limited testing.",criteria:["No formal backup cadence","No offline or immutable copies"],nextSteps:["Define backup policy","Introduce offline/immutable storage"]},{level:1,description:"Regular backups with basic testing.",criteria:["Weekly backups for critical systems","Monthly restore tests"],nextSteps:["Automate backup verification","Define RPO/RTO targets"]},{level:2,description:"Resilient backups with recovery validation.",criteria:["Immutable/offline backups for crown jewels","Quarterly end-to-end recovery tests"],nextSteps:["Documented runbooks and roles","Drill exercises with stakeholders"]},{level:3,description:"Mature backup program with metrics and continuous improvement.",criteria:["Automated recovery validation","Telemetry on backup success and drift"],nextSteps:["Quarterly metrics review and tuning"]}]},"Essential Logging and Monitoring":{id:"Essential Logging and Monitoring",name:"Essential Logging and Monitoring",fullDescription:"Collect and monitor security-relevant logs from endpoints, servers, applications, and identity providers to detect and respond to threats.",levels:[{level:0,description:"Minimal logging; poor visibility.",criteria:["No centralized log collection","Inconsistent retention"],nextSteps:["Deploy SIEM or central log platform","Define retention and coverage"]},{level:1,description:"Baseline logging and alerting for key systems.",criteria:["Collect auth and admin activity logs","Basic alerting for high-risk events"],nextSteps:["Expand coverage to endpoints and apps","Tune alerts to reduce noise"]},{level:2,description:"Comprehensive coverage and detection content.",criteria:["Correlated detections across identity, endpoint, and network","Playbooks for common incidents"],nextSteps:["Automate response hooks for critical detections","Periodic control efficacy reviews"]},{level:3,description:"Advanced analytics and continuous improvement.",criteria:["Behavior analytics for privileged activity","Threat intel integrated to detections"],nextSteps:["Quarterly content tuning and purple-team exercises"]}]}},M=["Application Control","Patch Applications","Configure Macro Settings","User Application Hardening","Restrict Admin Privileges","Patch Operating Systems","Multi-factor Authentication","Regular Backups","Essential Logging and Monitoring"],ie=[{level:0,label:"Level 0",description:"Control not implemented."},{level:1,label:"Level 1",description:"Basic implementation."},{level:2,label:"Level 2",description:"Mature and enforced organization-wide."},{level:3,label:"Level 3",description:"Optimized and continuously improving."}];function Ge(){var b;const{id:h}=Q(),[,C]=q(),t=parseInt(h||"0"),[p,m]=u.useState(M[0]),{data:s,refetch:y}=A.essentialEight.listAssessments.useQuery({clientId:t}),{data:l}=A.essentialEight.calculateOverallScore.useQuery({clientId:t}),f=A.essentialEight.generateImprovementPlan.useMutation(),N=u.useMemo(()=>s==null?void 0:s.find(a=>a.controlId===p),[s,p]);return e.jsx(H,{children:e.jsxs("div",{className:"flex flex-col space-y-6 pb-12",children:[e.jsx(V,{items:[{label:"Assurance",href:`/clients/${t}/assurance`},{label:"Essential Eight",active:!0}]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-4xl font-black tracking-tight text-slate-900 flex items-center gap-3",children:[e.jsx(D,{className:"w-10 h-10 text-emerald-600"}),"Essential Eight"]}),e.jsx("p",{className:"text-slate-500 font-medium max-w-2xl",children:"Assess maturity across eight prioritized mitigation strategies and generate improvement plans."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(W,{title:"Essential Eight Guide",description:"Perform Essential Eight assessments with level-based criteria, targets, and evidence.",rationale:"Align to proven controls that reduce the impact of common cyber threats.",howToUse:[{step:"Select Control",description:"Pick a control from the sidebar."},{step:"Assess Levels",description:"Mark achieved levels and criteria; add notes and evidence."},{step:"Set Target",description:"Choose a target level and build a roadmap from gaps."}]}),e.jsxs(g,{variant:"outline",className:"gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"View Benchmarks"]}),e.jsxs(g,{className:"gap-2 bg-emerald-600 hover:bg-emerald-700 shadow-lg shadow-emerald-600/20",children:[e.jsx(R,{className:"w-4 h-4"}),"Export Report"]})]})]}),e.jsxs(w,{className:"border-none bg-gradient-to-br from-[#0f172a] to-[#1e293b] text-white overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10",children:e.jsx(Y,{className:"w-48 h-48"})}),e.jsxs(E,{className:"p-8 flex flex-col md:flex-row items-center gap-12 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"rgba(255,255,255,0.1)",strokeWidth:"12",fill:"transparent"}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"#10b981",strokeWidth:"12",fill:"transparent",strokeDasharray:440,strokeDashoffset:440-440*((l==null?void 0:l.overallScore)||0)/3,strokeLinecap:"round",className:"transition-all duration-1000 ease-out"})]}),e.jsxs("div",{className:"absolute flex flex-col items-center",children:[e.jsx("span",{className:"text-5xl font-black text-white",children:((l==null?void 0:l.overallScore)||0).toFixed(1)}),e.jsx("span",{className:"text-xs uppercase tracking-widest text-slate-400 font-bold",children:"Maturity Level"})]})]}),e.jsxs(j,{variant:"outline",className:"bg-white/10 text-emerald-300 border-white/20 px-3 py-1",children:["Target: ",((b=l==null?void 0:l.overallTarget)==null?void 0:b.toFixed(1))||"1.5"]})]}),e.jsx("div",{className:"flex-1 grid grid-cols-2 lg:grid-cols-4 gap-6 w-full",children:M.map(a=>{const r=s==null?void 0:s.find(x=>x.controlId===a);return e.jsxs("div",{className:"space-y-2 group cursor-pointer",onClick:()=>m(a),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${p===a?"text-white":"text-slate-400"}`,children:a}),e.jsx("span",{className:"text-lg font-bold",children:((r==null?void 0:r.maturityLevel)||0).toFixed(1)})]}),e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-emerald-500 transition-all duration-700 ${p===a?"opacity-100 shadow-[0_0_8px_rgba(16,185,129,0.5)]":"opacity-40"}`,style:{width:`${((r==null?void 0:r.maturityLevel)||0)/3*100}%`}})}),e.jsx("div",{className:"flex justify-between items-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Target: ",((r==null?void 0:r.targetLevel)||1).toFixed(1)]})})]},a)})})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-8",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-4 xl:col-span-3 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden p-2",children:e.jsx("div",{className:"space-y-1",children:M.map(a=>{const r=p===a,x=s==null?void 0:s.find(k=>k.controlId===a);return e.jsx("button",{onClick:()=>m(a),className:`w-full text-left p-4 rounded-2xl transition-all flex items-center justify-between group ${r?"bg-slate-900 text-white shadow-xl":"hover:bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center font-black text-sm ${r?"bg-emerald-600 text-white":"bg-slate-100 text-slate-500 group-hover:bg-slate-200"}`,children:a.slice(0,3).toUpperCase()}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold truncate max-w-[180px]",children:a}),e.jsxs("span",{className:"text-[10px] uppercase tracking-widest font-bold text-slate-400",children:["Target ",(x==null?void 0:x.targetLevel)??1]})]})]})},a)})})}),e.jsx(w,{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 border-none shadow-none p-6 rounded-3xl",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-emerald-500 text-white flex items-center justify-center shadow-lg shadow-emerald-500/20",children:e.jsx(B,{className:"w-6 h-6"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-bold text-emerald-900",children:"Need an action plan?"}),e.jsx("p",{className:"text-xs text-emerald-700/80 leading-relaxed font-medium",children:"Generate a customized implementation plan based on your current gaps."})]}),e.jsx(g,{className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl shadow-md shadow-emerald-600/20 py-6 font-black",disabled:f.isLoading,onClick:()=>{F.promise(f.mutateAsync({clientId:t}),{loading:"Building your security roadmap...",success:a=>(C(`/clients/${t}/implementation/kanban/${a.planId}`),`Generated plan with ${a.taskCount} tasks!`),error:a=>`Failed to generate plan: ${a.message}`})},children:f.isLoading?"Building...":"Build Roadmap"})]})})]}),e.jsx("div",{className:"col-span-12 lg:col-span-8 xl:col-span-9",children:p?e.jsx(ae,{controlId:p,clientId:t,assessment:N,onUpdate:y}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center space-y-4 p-12 bg-slate-50 rounded-3xl border border-dashed border-slate-300",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-200 flex items-center justify-center animate-pulse",children:e.jsx(I,{className:"w-8 h-8 text-slate-400"})}),e.jsx("p",{className:"text-slate-400 font-medium",children:"Select a control to begin assessment"})]})})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{className:"bg-slate-900 text-white shadow-xl overflow-hidden border-0",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(D,{className:"w-24 h-24"})}),e.jsxs(E,{className:"p-8 space-y-6 relative z-10",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(X,{className:"w-6 h-6 text-emerald-400"}),"AI Advisor Guidance"]}),e.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Select a control to receive AI-powered recommendations based on your current security posture and evidence library."}),e.jsx("div",{className:"bg-white/10 p-6 rounded-2xl border border-white/10 italic text-slate-400 text-sm",children:'"To reach Level 2 in Patch Applications, define SLAs for critical vs non-critical vulnerabilities and automate staged deployments."'}),e.jsx(g,{className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-6 rounded-xl font-bold",children:"Generate Full Roadmap"})]})]}),e.jsxs(w,{children:[e.jsx(_,{children:e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-emerald-700"}),"Maturity Guidelines"]})}),e.jsx(E,{className:"space-y-4",children:ie.map(a=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"min-w-[40px] h-10 rounded-lg bg-slate-100 flex items-center justify-center font-bold text-slate-600",children:["L",a.level]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:a.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.description})]})]},a.level))})]})]})]})]})})}function ae({controlId:h,clientId:C,assessment:t,onUpdate:p}){const m=te[h],[s,y]=u.useState((t==null?void 0:t.assessmentAnswers)||{}),[l,f]=u.useState((t==null?void 0:t.qualityCriteria)||{}),[N,b]=u.useState((t==null?void 0:t.levelNotes)||{}),[a,r]=u.useState((t==null?void 0:t.notes)||""),[x,k]=u.useState((t==null?void 0:t.targetLevel)||1);u.useEffect(()=>{y((t==null?void 0:t.assessmentAnswers)||{}),f((t==null?void 0:t.qualityCriteria)||{}),b((t==null?void 0:t.levelNotes)||{}),r((t==null?void 0:t.notes)||""),k((t==null?void 0:t.targetLevel)||1)},[t,h]);const L=A.essentialEight.updateMaturity.useMutation({onSuccess:()=>{p(),F.success(`${h} updated`)}}),v=u.useMemo(()=>{let i=0;if(s[1]||s[1])i=1;else return 0;if(s[2]||s[2])i=2;else return 1;if(s[3]||s[3])i=3;else return 2;return i},[s]),O=(i,n)=>{const c=String(i);y(o=>({...o,[c]:n}))},$=(i,n,c)=>{const o=String(i);f(d=>({...d,[o]:{...d[o]||{},[String(n)]:c}}))},z=()=>{L.mutate({clientId:C,controlId:h,maturityLevel:v,targetLevel:x,assessmentAnswers:s,qualityCriteria:l,levelNotes:N,notes:a})},U=v===3?"Optimized":v>=2?"Managed":v>=1?"Defined":"Initial";return e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 pb-6 border-b border-slate-100",children:[e.jsxs("div",{className:"space-y-2 max-w-2xl",children:[e.jsx(j,{className:"bg-emerald-600/10 text-emerald-700 border-emerald-600/20 font-black px-3 py-1",children:"Essential Eight"}),e.jsx("h2",{className:"text-4xl font-black text-slate-900 tracking-tight",children:h}),e.jsx("p",{className:"text-slate-500 font-medium leading-relaxed",children:m==null?void 0:m.fullDescription})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm flex items-center gap-8 px-10",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-xs uppercase tracking-widest font-black text-slate-400 mb-1",children:"Maturity"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-4xl font-black text-emerald-700",children:v.toFixed(1)}),e.jsx("span",{className:"text-sm text-slate-400 font-bold",children:"/ 3.0"})]})]}),e.jsx("div",{className:"h-10 w-px bg-slate-100"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-xs uppercase tracking-widest font-black text-slate-400 mb-1",children:"Status"}),e.jsx(j,{variant:v>1.5?"success":v>.5?"warning":"default",className:"font-bold text-sm px-3 py-1",children:U})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Target Level"}),e.jsx("div",{className:"flex bg-slate-100 p-1 rounded-xl",children:[1,2,3].map(i=>e.jsxs("button",{onClick:()=>k(i),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${x===i?"bg-white shadow-sm text-emerald-700":"text-slate-400 hover:text-slate-600"}`,children:["L",i]},i))})]}),e.jsx("div",{className:"grid gap-8",children:[1,2,3].map(i=>{const n=m==null?void 0:m.levels.find(o=>o.level===i),c=s[String(i)];return e.jsx(w,{className:`border-none shadow-none overflow-hidden rounded-3xl transition-all ${c?"bg-white ring-2 ring-emerald-200":"bg-white border border-slate-100"}`,children:e.jsxs("div",{className:"grid md:grid-cols-12",children:[e.jsxs("div",{className:`md:col-span-1 p-4 flex flex-col items-center justify-center border-r border-slate-50 transition-colors ${c?"bg-emerald-600 text-white":"bg-slate-50 text-slate-400"}`,children:[e.jsx("span",{className:"text-sm font-black italic",children:"LVL"}),e.jsx("span",{className:"text-3xl font-black",children:i})]}),e.jsxs("div",{className:"md:col-span-11 p-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-6 mb-8",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(j,{variant:"outline",className:`${c?"border-emerald-300 text-emerald-700 bg-emerald-50":"text-slate-400"}`,children:["Level ",i]}),i===x&&e.jsxs(j,{className:"bg-emerald-500 text-white border-none gap-1 font-bold",children:[e.jsx(B,{className:"w-3 h-3"})," Target"]})]}),e.jsx("h4",{className:"text-xl font-bold text-slate-900 leading-tight",children:n==null?void 0:n.description})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(g,{variant:c?"default":"outline",className:`rounded-2xl h-20 px-10 transition-all font-black text-lg ${c?"bg-emerald-600 hover:bg-emerald-700 scale-105 shadow-xl shadow-emerald-600/20":"hover:border-emerald-600 hover:text-emerald-700"}`,onClick:()=>O(i,!c),children:c?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(T,{className:"w-6 h-6 mb-1"}),e.jsx("span",{children:"Achieved"})]}):"Mark Achieved"})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h5",{className:"text-[10px] font-black uppercase tracking-widest text-emerald-700 flex items-center gap-2",children:[e.jsx(J,{className:"w-3.5 h-3.5"}),"Activity & Criteria"]}),e.jsx("div",{className:"space-y-3",children:n==null?void 0:n.criteria.map((o,d)=>{var P;const S=(P=l[String(i)])==null?void 0:P[String(d)];return e.jsxs("div",{onClick:()=>$(i,d,!S),className:`flex gap-4 items-start p-4 rounded-2xl transition-all cursor-pointer border ${S?"bg-emerald-50/50 border-emerald-100":"bg-white border-slate-100 hover:border-slate-200"}`,children:[e.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center shrink-0 mt-0.5 transition-all ${S?"bg-emerald-600 text-white shadow-md shadow-emerald-600/20":"bg-slate-100 text-slate-300"}`,children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx("span",{className:`text-sm font-medium leading-relaxed ${S?"text-slate-800":"text-slate-500"}`,children:o})]},d)})})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-slate-50 p-6 rounded-3xl space-y-4",children:[e.jsxs("h5",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 flex items-center gap-2",children:[e.jsx(Z,{className:"w-3.5 h-3.5 text-emerald-600"}),"Next Steps"]}),e.jsx("div",{className:"space-y-2",children:n==null?void 0:n.nextSteps.map((o,d)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsxs("span",{className:"text-xs font-black text-emerald-700",children:["#",d+1]}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:o})]},d))})]})})]}),e.jsxs("div",{className:"mt-10 -mx-8 -mb-8",children:[e.jsx("div",{className:"px-8 py-3 bg-slate-50 border-t border-b border-slate-100 flex items-center justify-between",children:e.jsxs("h5",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 flex items-center gap-2",children:[e.jsx(R,{className:"w-3.5 h-3.5"}),"Implementation Findings & Evidence (Level ",i,")"]})}),e.jsx("textarea",{value:N[String(i)]||"",onChange:o=>b(d=>({...d,[String(i)]:o.target.value})),placeholder:`Document how your organization satisfies the requirements for Level ${i}...`,className:"w-full min-h-[100px] p-8 bg-white text-sm text-slate-600 placeholder:text-slate-300 transition-all outline-none resize-none"})]})]})]})},`${h}-L${i}`)})}),e.jsxs(w,{className:"rounded-3xl border-none bg-white p-8 space-y-6 shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-emerald-700"}),"Assessment Notes & Evidence"]}),e.jsxs(g,{variant:"ghost",size:"sm",className:"gap-2 text-emerald-700 font-bold",onClick:()=>window.open("https://www.cyber.gov.au/essential-eight","_blank"),children:[e.jsx(ee,{className:"w-4 h-4"}),"Essential Eight Docs"]})]}),e.jsx("textarea",{value:a,onChange:i=>r(i.target.value),placeholder:"Add supporting evidence, notes on gaps, or internal discussions here...",className:"w-full min-h-[150px] p-6 rounded-2xl bg-slate-50 border border-slate-100 text-slate-700 placeholder:text-slate-400 focus:ring-2 focus:ring-emerald-600/20 transition-all outline-none font-medium"}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-50",children:[e.jsx(g,{variant:"outline",className:"px-8 rounded-xl font-bold h-12",onClick:()=>{y((t==null?void 0:t.assessmentAnswers)||{}),f((t==null?void 0:t.qualityCriteria)||{}),b((t==null?void 0:t.levelNotes)||{}),r((t==null?void 0:t.notes)||"")},children:"Reset Changes"}),e.jsx(g,{className:"px-10 rounded-xl font-black h-12 bg-emerald-600 hover:bg-emerald-700 shadow-lg shadow-emerald-600/20",onClick:z,disabled:L.isLoading,children:L.isLoading?"Saving...":"Save Assessment"})]})]})]})}export{Ge as default};
