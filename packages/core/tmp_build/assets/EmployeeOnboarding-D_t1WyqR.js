import{r as m,t as h,i as I,j as e,c as f,k as N,F as ne,l as Ye,aa as We,z as xs,L as Ke,I as hs,u as ps,ac as us,b as gs,S as le,C as U,d as B,e as G,n as H,f as Y,m as $,D as Je,o as Xe,p as Ze,q as es,w as fs,bx as bs,x as cs}from"./index-DOc7Nwb7.js";import{D as js,G as ss}from"./DashboardLayout-aHnUqq57.js";import{B as vs}from"./Breadcrumb-CRi3LAxS.js";import{P as ys}from"./progress-B-1k4ZZX.js";import{S as ds}from"./scroll-area-DPaNxEJD.js";import{d as ms}from"./marked.esm-DajSjiQI.js";import{c as ee}from"./utils-BC5CVi_C.js";import{T as Ns}from"./trophy-BQCkJfBy.js";import{S as se}from"./sparkles-CoQ80pK2.js";import{V as ts}from"./video-D4zuDHk0.js";import{R as ws}from"./rotate-ccw-C6dHuDj9.js";import{C as as}from"./clock-osbacZli.js";import{m as is}from"./proxy-DIbepYjM.js";import{A as ks}from"./index-B9D6dsvY.js";import{C as ls}from"./chevron-left-DZH-lUm7.js";import{E as Cs}from"./enhanced-dialog-CeRPsI16.js";import{T as _s}from"./textarea-BtxBxzdY.js";import{A as Is,b as Es}from"./alert-BudCfM-X.js";import{P as As}from"./PageGuide-CPKKXXS6.js";import{C as R}from"./circle-check-C5kiwRoG.js";import{C as rs}from"./circle-play-B4Nb1F90.js";import{A as Ps}from"./arrow-right-M96iV-v9.js";import{L as Ts}from"./lock-czWF3qbC.js";import{L as Ms}from"./laptop-CVZplMDc.js";import{E as Rs}from"./eye-CIq9q9s6.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./send-FW7-3cjH.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";function Ls({clientId:p,employeeId:n,initialModuleId:g}){var S;const[a,j]=m.useState(g||null);m.useRef(null);const[E,x]=m.useState(!1),[w,k]=m.useState(1),[F,A]=m.useState(0),[V,W]=m.useState(0),[v,oe]=m.useState(!1),[K,te]=m.useState(!1),[ae,ie]=m.useState(!1),{data:r,isLoading:P,refetch:c}=h.training.list.useQuery({clientId:p,employeeId:n},{enabled:p>0&&!!n}),{data:d,isLoading:i,refetch:q}=h.training.get.useQuery({clientId:p,moduleId:a,employeeId:n},{enabled:!!a}),s=h.training.complete.useMutation({onSuccess:()=>{I.custom(o=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 border-2 border-green-500 rounded-lg p-4 shadow-2xl flex items-center gap-4 animate-in fade-in slide-in-from-bottom-5",children:[e.jsx("div",{className:"bg-green-100 dark:bg-green-900/30 p-2 rounded-full",children:e.jsx(Ns,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white",children:"Module Completed!"}),e.jsx("p",{className:"text-sm text-slate-500",children:"You're one step closer to compliance mastery."})]})]}),{duration:4e3}),c(),q()}});m.useEffect(()=>{r&&r.length>0&&!a&&j(r[0].id)},[r,a]),m.useEffect(()=>{ie(!1),x(!1),A(0),te(!1)},[a]);const T=()=>{a&&s.mutate({clientId:p,employeeId:n,moduleId:a})},z=()=>{if(!r||!a)return;const o=r.findIndex(O=>O.id===a);o<r.length-1&&j(r[o+1].id)},y=()=>{if(!r||!a)return;const o=r.findIndex(O=>O.id===a);o>0&&j(r[o-1].id)};if(P)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-[700px] bg-slate-50/50 rounded-xl border-2 border-dashed",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-12 w-12 rounded-full border-4 border-primary/20 border-t-primary animate-spin"}),e.jsx(se,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-4 w-4 text-primary"})]}),e.jsx("p",{className:"mt-4 text-sm font-medium text-slate-600",children:"Preparing your training environment..."})]});if(!r||r.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-[700px] p-12 text-center bg-white rounded-xl border",children:[e.jsx("div",{className:"bg-slate-100 p-6 rounded-full mb-6",children:e.jsx(ts,{className:"h-12 w-12 text-slate-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"No training modules assigned"}),e.jsx("p",{className:"text-slate-500 max-w-sm mt-2",children:"It looks like you don't have any training sessions scheduled at the moment."}),e.jsxs(f,{variant:"outline",className:"mt-8",onClick:()=>c(),children:[e.jsx(ws,{className:"mr-2 h-4 w-4"})," Refresh"]})]});const l=r.find(o=>o.id===a),M=r.findIndex(o=>o.id===a),L=M===r.length-1,C=M===0;return e.jsxs("div",{className:"flex h-full bg-white rounded-2xl overflow-hidden shadow-2xl border border-slate-200",children:[e.jsxs("div",{className:"w-80 border-r flex flex-col bg-slate-50",children:[e.jsxs("div",{className:"p-6 border-b bg-white",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"p-1.5 bg-indigo-100 rounded-lg text-indigo-600",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx("h3",{className:"font-bold text-slate-900 uppercase tracking-tight text-sm",children:"Course Navigator"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-slate-500",children:[r.length," specialized modules"]}),e.jsx(N,{variant:"secondary",className:"text-[10px] font-bold bg-indigo-50 text-indigo-700 hover:bg-indigo-50",children:"PRO TRAINING"})]})]}),e.jsx(ds,{className:"flex-1",children:e.jsx("div",{className:"p-3 space-y-2",children:r.map((o,O)=>{var Q;const _=o.id===a,J=o.id===a?((Q=d==null?void 0:d.assignment)==null?void 0:Q.status)==="completed":!1;return e.jsxs("button",{onClick:()=>j(o.id),className:ee("w-full text-left p-3.5 rounded-xl transition-all duration-300 flex items-start gap-3 group relative",_?"bg-white shadow-md border-l-4 border-indigo-600 ring-1 ring-slate-200":"hover:bg-white/50 text-slate-600 border-l-4 border-transparent"),children:[e.jsxs("div",{className:ee("mt-1 p-1.5 rounded-lg transition-colors relative",_?"bg-indigo-600 text-white":"bg-slate-200 text-slate-500 group-hover:bg-slate-300"),children:[o.type==="video"?e.jsx(ts,{className:"h-3.5 w-3.5"}):e.jsx(ne,{className:"h-3.5 w-3.5"}),J&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-green-500 rounded-full border-2 border-white",children:e.jsx(Ye,{className:"h-2 w-2 text-white stroke-[4px]"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:ee("text-[10px] font-bold uppercase tracking-wider mb-0.5",_?"text-indigo-600":"text-slate-400"),children:["Module ",String(O+1).padStart(2,"0")]}),e.jsx("div",{className:ee("text-sm font-semibold leading-tight line-clamp-2",_?"text-slate-900":"text-slate-600"),children:o.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-400 font-medium",children:[e.jsx(as,{className:"h-2.5 w-2.5"})," ",o.durationMinutes,"m"]}),J&&e.jsx("div",{className:"flex items-center gap-1 text-[10px] text-green-600 font-bold uppercase tracking-tighter",children:"Completed"})]})]}),_&&e.jsx(is.div,{layoutId:"active-indicator",className:"absolute right-3 top-1/2 -translate-y-1/2 h-1.5 w-1.5 rounded-full bg-indigo-600"})]},o.id)})})}),e.jsxs("div",{className:"p-4 border-t bg-indigo-600 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] uppercase font-bold tracking-widest mb-2 opacity-80",children:[e.jsx("span",{children:"Course Progress"}),e.jsxs("span",{children:[Math.round(r.filter(o=>!1).length/r.length*100),"%"]})]}),e.jsx("div",{className:"h-1.5 bg-white/20 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-white transition-all duration-1000",style:{width:`${Math.round(r.filter(o=>!1).length/r.length*100)}%`}})})]})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-slate-50 relative",children:e.jsx(ks,{mode:"wait",children:e.jsxs(is.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex-1 flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"h-16 bg-white border-b px-8 flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{variant:"ghost",size:"sm",onClick:y,disabled:C,className:"text-slate-400",children:e.jsx(ls,{className:"h-4 w-4"})}),e.jsx("div",{className:"h-4 w-px bg-slate-200"}),e.jsx("span",{className:"text-sm font-bold text-slate-900 line-clamp-1",children:l==null?void 0:l.title}),e.jsx("div",{className:"h-4 w-px bg-slate-200"}),e.jsx(f,{variant:"ghost",size:"sm",onClick:z,disabled:L,className:"text-slate-400",children:e.jsx(We,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex items-center gap-3",children:((S=d==null?void 0:d.assignment)==null?void 0:S.status)==="completed"?e.jsxs(N,{className:"bg-green-100 text-green-700 hover:bg-green-100 border-none px-3 py-1 font-bold",children:[e.jsx(Ye,{className:"h-3 w-3 mr-1.5 stroke-[3px]"})," COMPLETED"]}):e.jsx(f,{size:"sm",onClick:T,disabled:s.isPending,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold px-6",children:"Mark as Finished"})})]}),e.jsx("div",{className:"flex-1 overflow-auto bg-slate-50",children:e.jsxs("div",{className:"p-8 max-w-5xl mx-auto space-y-8",children:[e.jsx("div",{className:"aspect-video bg-slate-900 rounded-3xl overflow-hidden shadow-2xl relative group ring-8 ring-white",children:(l==null?void 0:l.type)==="video"&&l.videoUrl?e.jsx("div",{className:"w-full h-full bg-black",children:l.videoUrl.includes("youtube.com")||l.videoUrl.includes("youtu.be")?e.jsx("iframe",{src:l.videoUrl.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"),className:"w-full h-full border-0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0}):e.jsx("video",{src:l.videoUrl,controls:!0,className:"w-full h-full"})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-gradient-to-br from-indigo-900 to-slate-900 p-12 text-center text-white",children:[e.jsx("div",{className:"p-6 bg-white/10 rounded-3xl backdrop-blur-xl border border-white/20 mb-6",children:e.jsx(ne,{className:"h-16 w-16 text-indigo-300"})}),e.jsx("h2",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400",children:l==null?void 0:l.title}),e.jsx("p",{className:"text-indigo-200 max-w-sm mt-4 text-lg",children:"This module focuses on essential documentation and reading materials."}),e.jsxs("div",{className:"inline-flex items-center gap-2 mt-8 px-6 py-3 bg-white/5 rounded-full border border-white/10 text-sm font-medium",children:[e.jsx(as,{className:"h-4 w-4"})," Estimated reading: ",(l==null?void 0:l.durationMinutes)||5," minutes"]})]})}),e.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-sm border border-slate-100",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-6 mb-10 pb-10 border-b border-slate-100",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"bg-indigo-50 text-indigo-600 hover:bg-indigo-50 border-none font-bold text-[10px] tracking-widest px-2",children:(l==null?void 0:l.type)==="video"?"VIDEO TRAINING":"READING MATERIAL"}),ae&&e.jsx(N,{className:"bg-emerald-50 text-emerald-600 border-none font-bold text-[10px]",children:"VERIFIED"})]}),e.jsx("h1",{className:"text-4xl font-extrabold text-slate-900 tracking-tight leading-tight",children:l==null?void 0:l.title}),(l==null?void 0:l.description)&&e.jsx("p",{className:"text-lg text-slate-500 max-w-2xl leading-relaxed mt-4",children:l.description})]})}),e.jsx("div",{className:"prose prose-slate max-w-none dark:prose-invert",children:l!=null&&l.content?e.jsx("div",{className:"[&_h1]:text-3xl [&_h1]:font-black [&_h1]:mb-8 [&_h1]:text-slate-900 [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-12 [&_h2]:mb-6 [&_h2]:text-slate-800 [&_h2]:border-l-4 [&_h2]:border-indigo-500 [&_h2]:pl-4 [&_h3]:text-xl [&_h3]:font-semibold [&_h3]:mt-10 [&_h3]:mb-4 [&_h3]:text-slate-800 [&_p]:text-lg [&_p]:mb-6 [&_p]:leading-relaxed [&_p]:text-slate-600 [&_ul]:list-disc [&_ul]:pl-6 [&_ul]:mb-8 [&_li]:mb-3 [&_li]:text-lg [&_li]:text-slate-600 [&_strong]:text-slate-900 [&_blockquote]:italic [&_blockquote]:border-l-4 [&_blockquote]:border-slate-200 [&_blockquote]:pl-6 [&_blockquote]:my-8 [&_blockquote]:text-slate-500 whitespace-normal",dangerouslySetInnerHTML:{__html:ms.parse(l.content)}}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-slate-50/50 rounded-3xl border border-dashed border-slate-200",children:[e.jsx(se,{className:"h-12 w-12 text-slate-300 mb-4"}),e.jsx("p",{className:"text-slate-400 font-medium",children:"Use the player above to complete this session."})]})}),e.jsxs("div",{className:"mt-20 pt-10 border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm font-medium text-slate-500",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-400",children:M+1}),e.jsxs("span",{children:["Module ",M+1," of ",r.length]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs(f,{variant:"outline",size:"lg",onClick:y,disabled:C,className:"flex-1 sm:flex-none h-14 px-8 rounded-2xl border-slate-200 text-slate-600 font-bold hover:bg-slate-50",children:[e.jsx(ls,{className:"mr-2 h-5 w-5"})," Previous"]}),e.jsxs(f,{variant:"default",size:"lg",onClick:L?T:z,className:"flex-1 sm:flex-none h-14 px-10 rounded-2xl bg-slate-900 hover:bg-black text-white font-bold shadow-xl shadow-slate-200 transition-all hover:scale-[1.02] active:scale-[0.98]",children:[L?"Finish Training":"Continue"," ",e.jsx(We,{className:"ml-2 h-5 w-5"})]})]})]})]})]})})]},a)})})]})}function Ss({policyId:p,requirementId:n,policyType:g="policy",employeeId:a,open:j,onOpenChange:E}){const[x,w]=m.useState(""),[k,F]=m.useState(""),A=h.useUtils(),V=h.policyManagement.requestException.useMutation({onSuccess:()=>{var v;I.success("Exception request submittted"),E(!1),w(""),F(""),A.policyManagement.getMyPolicies.invalidate(),p&&A.policyManagement.getExceptions.invalidate({policyId:p}),(v=A.onboarding.getOnboardingStatus)==null||v.invalidate()},onError:v=>I.error(v.message)}),W=()=>{x.trim()&&V.mutate({policyId:p,requirementId:n,policyType:g,employeeId:a,reason:x,expirationDate:k||void 0})};return e.jsx(Cs,{open:j,onOpenChange:E,title:"Request Policy Exception",description:"Require an exception to this policy? Submit a request for approval.",trigger:null,footer:e.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[e.jsx(f,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),e.jsx(f,{variant:"destructive",onClick:W,disabled:!x.trim()||V.isPending,children:V.isPending?"Submitting...":"Submit Request"})]}),children:e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs(Is,{variant:"destructive",children:[e.jsx(xs,{className:"h-4 w-4"}),e.jsx(Es,{children:"Exceptions are tracked and reviewed by auditors. Only request if absolutely necessary."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Ke,{children:"Reason for Exception"}),e.jsx(_s,{placeholder:"Explain why you cannot comply with this policy...",value:x,onChange:v=>w(v.target.value),className:"min-h-[100px]"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Ke,{children:"Expected Duration (Optional)"}),e.jsx(hs,{type:"date",value:k,onChange:v=>F(v.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave blank if permanent (not recommended)"})]})]})})}const ns={code_of_conduct:{title:"Code of Conduct",content:`
            <h3>1. Professional Integrity</h3>
            <p>All employees are expected to maintain the highest standards of professional integrity...</p>
            <h3>2. Workplace Respect</h3>
            <p>We are committed to providing a workplace free from discrimination and harassment...</p>
            <h3>3. Conflict of Interest</h3>
            <p>Employees must avoid situations where personal interests conflict with company duties...</p>
        `},aup:{title:"Acceptable Use Policy",content:`
            <h3>1. System Usage</h3>
            <p>Company systems are for business use. Incidental personal use is permitted if it does not interfere with work...</p>
            <h3>2. Security</h3>
            <p>Users must not disable or circumvent security controls...</p>
        `},data_protection:{title:"Data Protection Agreement",content:`
            <h3>1. Data Handling</h3>
            <p>You agree to handle all personal and sensitive data in accordance with GDPR and company policy...</p>
            <h3>2. Confidentiality</h3>
            <p>Data must not be shared with unauthorized parties...</p>
        `},confidentiality:{title:"Confidentiality Agreement",content:`
            <h3>1. Confidential Information</h3>
            <p>Includes trade secrets, customer lists, and proprietary technology...</p>
            <h3>2. Obligations</h3>
            <p>You agree to keep all such information strictly confidential during and after employment...</p>
        `}};function os(p){if(!p)return null;const n=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,g=p.match(n);return g&&g[2].length===11?`https://img.youtube.com/vi/${g[2]}/maxresdefault.jpg`:null}function qt(){var Q,ce,de,me,xe,he,pe,ue,ge,fe,be,je,ve,ye,Ne,we,ke,Ce,_e,Ie,Ee,Ae,Pe,Te,Me,Re,Le,Se,Oe,De,qe,ze,Ue,$e,Fe,Ve;const{user:p}=ps(),[n,g]=m.useState(new Set),[a,j]=m.useState(null),[E,x]=m.useState(!1),[w,k]=m.useState(null),[F,A]=m.useState(!1),[V,W]=m.useState(null),[v,oe]=m.useState(null),[K,te]=m.useState("document"),ae=t=>{g(u=>new Set(u).add(t)),j(null)},{selectedClientId:ie}=us(),r=h.useUtils();gs();const{data:P}=h.clients.list.useQuery(),c=ie||(P&&P.length>0?P[0].id:0),{data:d}=h.users.me.useQuery(),{data:i}=(Q=h.employees.getByEmail)==null?void 0:Q.useQuery({email:(d==null?void 0:d.email)||"",clientId:c||0},{enabled:!!(d!=null&&d.email)&&!!c}),q=(ce=h.employees.ensureSelf)==null?void 0:ce.useMutation({onSuccess:()=>{r.employees.getByEmail.invalidate()}});m.useEffect(()=>{c&&(d!=null&&d.email)&&i===null&&!q.isLoading&&!q.isSuccess&&q.mutate({clientId:c})},[c,d,i,q]);const{data:s,refetch:T}=(de=h.onboarding.getOnboardingStatus)==null?void 0:de.useQuery({clientId:c||0,employeeId:(i==null?void 0:i.id)||0},{enabled:!!c&&!!(i!=null&&i.id)}),{data:z}=(me=h.onboarding.getTrainingProgress)==null?void 0:me.useQuery({clientId:c||0,employeeId:(i==null?void 0:i.id)||0},{enabled:!!c&&!!(i!=null&&i.id)}),{data:y}=h.training.list.useQuery({clientId:c||0,employeeId:(i==null?void 0:i.id)||0},{enabled:!!c&&!!(i!=null&&i.id)}),{data:l}=(xe=h.policyManagement.getMyPolicies)==null?void 0:xe.useQuery({clientId:c||0,employeeId:(i==null?void 0:i.id)||0},{enabled:!!c&&!!(i!=null&&i.id)});(he=h.onboarding.attestTraining)==null||he.useMutation({onSuccess:()=>{var t;(t=r.onboarding.getOnboardingStatus)==null||t.invalidate(),T()}});const M=(pe=h.onboarding.submitAcknowledgment)==null?void 0:pe.useMutation({onSuccess:()=>{var t;(t=r.onboarding.getOnboardingStatus)==null||t.invalidate(),T(),I.success("Document accepted")}}),L=(ue=h.policyManagement.attestPolicy)==null?void 0:ue.useMutation({onSuccess:()=>{var t;(t=r.onboarding.getOnboardingStatus)==null||t.invalidate(),T(),I.success("Policy accepted")}}),C=(ge=h.onboarding.updateSecuritySetup)==null?void 0:ge.useMutation({onSuccess:()=>{var t;(t=r.onboarding.getOnboardingStatus)==null||t.invalidate(),T(),I.success("Security setup updated")},onError:t=>{I.error("Failed to update security setup: "+t.message)}}),S=(fe=h.onboarding.confirmAssetReceipt)==null?void 0:fe.useMutation({onSuccess:()=>{var t;(t=r.onboarding.getOnboardingStatus)==null||t.invalidate(),T(),I.success("Asset receipt confirmed")},onError:t=>{I.error("Failed to confirm asset receipt: "+t.message)}}),o=m.useMemo(()=>{if(!s)return{tasks:{training:!1,acknowledgments:!1,security:!1,assets:!1},completed:0,total:4,percentage:0};const t={training:s.tasks.training.complete,acknowledgments:s.tasks.acknowledgments.complete,security:s.tasks.security.complete,assets:s.tasks.assets.complete},u=Object.values(t).filter(Boolean).length,D=4,b=Math.round(u/D*100);return{tasks:t,completed:u,total:D,percentage:b}},[s]);return(be=l==null?void 0:l.assignments)!=null&&be.filter(t=>t.status==="pending"||t.status==="viewed").length,e.jsx(js,{children:e.jsxs("div",{className:"space-y-8 pb-12",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(vs,{items:[{label:"Dashboard",href:"/dashboard"},{label:"Employee Onboarding"}]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[(()=>{var b;const t=(d==null?void 0:d.role)==="admin"||(d==null?void 0:d.role)==="owner"||(d==null?void 0:d.role)==="super_admin",u=(b=P==null?void 0:P.find(X=>X.id===c))==null?void 0:b.role;return t||(u==="admin"||u==="owner")?e.jsx(f,{variant:"outline",size:"sm",asChild:!0,className:"gap-2 border-primary/20 hover:border-primary/50 bg-primary/5",children:e.jsxs("a",{href:`/clients/${c}/personnel-compliance`,children:[e.jsx(le,{className:"h-4 w-4 text-primary"}),"Configure Onboarding Checklist"]})}):null})(),e.jsx(As,{title:"Employee Security Onboarding",description:"Your personal checklist for completing security and compliance requirements.",rationale:"Security is a shared responsibility. This onboarding process ensures that every team member understands their role in protecting the organization's data and assets from day one. Completing these steps is mandatory for access to production systems.",howToUse:[{step:"Security Training",description:"Watch required training modules to understand key security concepts."},{step:"Policy Acceptance",description:"Read and acknowledge core security policies (e.g., Code of Conduct)."},{step:"Account Setup",description:"Configure MFA and password manager to secure your identity."},{step:"Asset Verification",description:"Confirm receipt of your assigned laptop and devices."}],integrations:[{name:"HR System",description:"Employee records are synced from the HRIS."},{name:"Device Management",description:"Asset confirmation updates the central inventory."},{name:"Audit Logs",description:"All acknowledgments are time-stamped for compliance audits."}]})]})]}),e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-[#002a40] via-[#004d70] to-[#0284c7] p-8 text-white shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-white/10 [mask-image:linear-gradient(0deg,transparent,black)]"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-white/10 backdrop-blur-md rounded-xl border border-white/20",children:e.jsx(se,{className:"h-8 w-8 text-sky-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Welcome to GRCompliance"}),e.jsx("p",{className:"text-sky-100/80 text-lg font-medium",children:"Complete your onboarding to get started"})]})]}),e.jsxs("div",{className:"mt-8 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overall Progress"}),e.jsxs("span",{className:"text-2xl font-bold",children:[o.percentage,"%"]})]}),e.jsx(ys,{value:o.percentage,className:"h-3 bg-white/10"}),e.jsxs("p",{className:"text-sm text-sky-100/70",children:[o.completed," of ",o.total," tasks completed"]})]})]})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(U,{className:"border-2 hover:border-primary/50 transition-all duration-300 hover:shadow-lg",children:[e.jsx(B,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${o.tasks.training?"bg-green-100 text-green-600":"bg-purple-100 text-purple-600"}`,children:e.jsx(ss,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"text-xl",children:"Task 1: Security Awareness Training"}),o.tasks.training?e.jsx(R,{className:"h-5 w-5 text-green-600"}):e.jsx(H,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(Y,{className:"mt-1",children:o.tasks.training?"Training modules completed":e.jsxs("span",{children:[(z==null?void 0:z.totalCompleted)||0," sections completed",y&&y.length>0&&e.jsxs("span",{children:[" â€¢ ",y.length," custom modules"]})]})})]})]})})}),e.jsxs($,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Learn about key compliance frameworks and security best practices."}),y&&y.length>0&&e.jsx("div",{className:"mb-6",children:e.jsxs(f,{onClick:()=>x(!0),className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white shadow-md hover:shadow-lg transition-all",children:[e.jsx(rs,{className:"mr-2 h-5 w-5"}),"Launch Training Center",e.jsx(Ps,{className:"ml-2 h-4 w-4"})]})}),e.jsx("div",{className:"space-y-3",children:y&&y.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:y.map(t=>e.jsxs("div",{className:"group relative flex flex-col overflow-hidden rounded-lg border bg-background shadow-sm hover:shadow-md transition-all cursor-pointer h-full",onClick:()=>{k(t.id),x(!0)},children:[e.jsxs("div",{className:"aspect-video bg-slate-100 relative flex items-center justify-center group-hover:bg-slate-200 transition-colors",children:[(t.thumbnailUrl||os(t.videoUrl))&&e.jsx("img",{src:t.thumbnailUrl||os(t.videoUrl)||"",alt:t.title,className:"absolute inset-0 w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),t.type==="video"?e.jsx("div",{className:"z-10 w-12 h-12 rounded-full bg-white/90 flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:e.jsx(rs,{className:"h-6 w-6 text-indigo-600 ml-0.5"})}):e.jsx(ne,{className:"h-10 w-10 text-slate-400 z-10"}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsxs(N,{variant:"secondary",className:"bg-white/90 backdrop-blur-sm text-xs font-normal",children:[t.durationMinutes," min"]})})]}),e.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm line-clamp-2 mb-1 group-hover:text-indigo-600 transition-colors",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-3 flex-1",children:t.description||"No description provided."}),e.jsx(f,{size:"sm",className:"w-full mt-auto",variant:"outline",children:"Start Learning"})]})]},t.id))}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground bg-muted/20 rounded-lg border border-dashed",children:[e.jsx(ss,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No training modules assigned."})]})})]})]}),e.jsxs(U,{id:"compliance-acknowledgments",className:"border-2 hover:border-primary/50 transition-all duration-300 hover:shadow-lg",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${(je=s==null?void 0:s.tasks.acknowledgments)!=null&&je.complete?"bg-green-100 text-green-600":"bg-amber-100 text-amber-600"}`,children:e.jsx(le,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"text-xl",children:"Task 2: Compliance Acknowledgments"}),(ve=s==null?void 0:s.tasks.acknowledgments)!=null&&ve.complete?e.jsx(R,{className:"h-5 w-5 text-green-600"}):e.jsx(H,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(Y,{className:"mt-1",children:(ye=s==null?void 0:s.tasks.acknowledgments)!=null&&ye.complete?"All agreements acknowledged":"Review and acknowledge required agreements"})]})]}),!((Ne=s==null?void 0:s.tasks.acknowledgments)!=null&&Ne.complete)&&e.jsx(N,{variant:"default",className:"bg-orange-500 hover:bg-orange-600",children:"Action Required"})]})}),e.jsx($,{children:e.jsx("div",{className:"space-y-3",children:(we=s==null?void 0:s.tasks.acknowledgments)!=null&&we.requirements?s.tasks.acknowledgments.requirements.map(t=>{var u;return e.jsx(Os,{label:t.title,checked:s.tasks.acknowledgments.items[t.key]||!1,onCheck:()=>{s.tasks.acknowledgments.items[t.key]||j(t.key)},onView:()=>{j(t.key)},onException:()=>{oe(t.id),W(t.key),te(t.isPolicy?"policy":"document"),A(!0)},viewed:n.has(t.key),exceptionStatus:(u=t.exception)==null?void 0:u.status},t.key)}):e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading requirements..."})})})]}),e.jsx(Je,{open:!!a,onOpenChange:t=>!t&&j(null),children:e.jsxs(Xe,{className:"max-w-3xl h-[80vh] flex flex-col",children:[e.jsx(Ze,{children:e.jsx(es,{children:a&&(((_e=(Ce=(ke=s==null?void 0:s.tasks.acknowledgments)==null?void 0:ke.requirements)==null?void 0:Ce.find(t=>t.key===a))==null?void 0:_e.title)||((Ie=ns[a])==null?void 0:Ie.title))})}),e.jsx(ds,{className:"flex-1 p-6 bg-slate-50/50",children:e.jsx("div",{className:"mx-auto max-w-2xl bg-white p-8 md:p-12 shadow-sm border rounded-sm min-h-full prose prose-slate dark:prose-invert [&_h1]:text-3xl [&_h1]:font-bold [&_h1]:mb-8 [&_h1]:text-slate-900 [&_h1]:border-b [&_h1]:pb-4 [&_h2]:text-xl [&_h2]:font-bold [&_h2]:mt-10 [&_h2]:mb-4 [&_h2]:text-slate-800 [&_h3]:text-lg [&_h3]:font-semibold [&_h3]:mt-8 [&_h3]:mb-3 [&_p]:mb-6 [&_p]:leading-relaxed [&_p]:text-slate-700 [&_p]:text-justify [&_ul]:list-disc [&_ul]:pl-6 [&_ul]:mb-6 [&_li]:mb-3 [&_li]:text-slate-700 whitespace-normal",dangerouslySetInnerHTML:{__html:a?(()=>{var Qe,Be,Ge;const t=(Be=(Qe=s==null?void 0:s.tasks.acknowledgments)==null?void 0:Qe.requirements)==null?void 0:Be.find(Z=>Z.key===a),u=(t==null?void 0:t.description)||((Ge=ns[a])==null?void 0:Ge.content)||"<p>No content available.</p>",b=(Z=>{if(typeof document>"u")return Z;const He=document.createElement("textarea");return He.innerHTML=Z,He.value})(u).trim();return!b.includes("<")&&b.includes("#")?ms.parse(b,{async:!1}):b})():""}})}),e.jsxs(fs,{className:"flex justify-between items-center sm:justify-between border-t pt-4 mt-auto",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Please read the document carefully."}),e.jsx(f,{onClick:()=>{a&&(O(a),ae(a))},disabled:!!(a&&((Ae=(Ee=s==null?void 0:s.tasks.acknowledgments)==null?void 0:Ee.items)!=null&&Ae[a])),children:a&&((Te=(Pe=s==null?void 0:s.tasks.acknowledgments)==null?void 0:Pe.items)!=null&&Te[a])?"Accepted":"I have read and understood"})]})]})}),e.jsx(Je,{open:E,onOpenChange:x,children:e.jsxs(Xe,{className:"max-w-[90vw] h-[90vh] flex flex-col p-0 gap-0",children:[e.jsx(Ze,{className:"px-6 py-4 border-b",children:e.jsx(es,{children:"Security Training Center"})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-slate-50 p-4",children:c&&(i==null?void 0:i.id)&&e.jsx(Ls,{clientId:c,employeeId:i.id,initialModuleId:w})})]})}),e.jsxs(U,{className:"border-2 hover:border-primary/50 transition-all duration-300 hover:shadow-lg",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${(Me=s==null?void 0:s.tasks.security)!=null&&Me.complete?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:e.jsx(Ts,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"text-xl",children:"Task 3: Account Security Setup"}),(Re=s==null?void 0:s.tasks.security)!=null&&Re.complete?e.jsx(R,{className:"h-5 w-5 text-green-600"}):e.jsx(H,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(Y,{className:"mt-1",children:(Le=s==null?void 0:s.tasks.security)!=null&&Le.complete?"Security configuration complete":"Complete your account security setup"})]})]}),!((Se=s==null?void 0:s.tasks.security)!=null&&Se.complete)&&e.jsx(N,{variant:"default",className:"bg-orange-500 hover:bg-orange-600",children:"Action Required"})]})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(re,{label:"Multi-Factor Authentication (MFA) Enrolled",checked:((Oe=s==null?void 0:s.tasks.security)==null?void 0:Oe.mfaEnrolled)||!1,onCheck:t=>_("mfaEnrolled",t),isLoading:C.isLoading}),e.jsx(re,{label:"Password Manager Setup Complete",checked:((De=s==null?void 0:s.tasks.security)==null?void 0:De.passwordManagerSetup)||!1,onCheck:t=>_("passwordManagerSetup",t),isLoading:C.isLoading}),e.jsx(re,{label:"Security Questions Configured",checked:((qe=s==null?void 0:s.tasks.security)==null?void 0:qe.securityQuestionsSet)||!1,onCheck:t=>_("securityQuestionsSet",t),isLoading:C.isLoading})]})})]}),e.jsxs(U,{className:"border-2 hover:border-primary/50 transition-all duration-300 hover:shadow-lg",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${(ze=s==null?void 0:s.tasks.assets)!=null&&ze.complete?"bg-green-100 text-green-600":"bg-indigo-100 text-indigo-600"}`,children:e.jsx(bs,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"text-xl",children:"Task 4: Asset Receipt Confirmation"}),(Ue=s==null?void 0:s.tasks.assets)!=null&&Ue.complete?e.jsx(R,{className:"h-5 w-5 text-green-600"}):e.jsx(H,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(Y,{className:"mt-1",children:($e=s==null?void 0:s.tasks.assets)!=null&&$e.complete?"All assets confirmed":"Confirm receipt of assigned equipment"})]})]}),!((Fe=s==null?void 0:s.tasks.assets)!=null&&Fe.complete)&&e.jsx(N,{variant:"default",className:"bg-orange-500 hover:bg-orange-600",children:"Action Required"})]})}),e.jsx($,{children:e.jsx("div",{className:"space-y-3",children:(Ve=s==null?void 0:s.tasks.assets)!=null&&Ve.items&&s.tasks.assets.items.length>0?s.tasks.assets.items.map(t=>e.jsx(Ds,{label:`${t.type.charAt(0).toUpperCase()+t.type.slice(1).replace("_"," ")} Received`,checked:t.status==="confirmed",onCheck:()=>J(t.type),isLoading:S.isLoading},t.type)):e.jsx("div",{className:"text-center py-4 text-muted-foreground bg-gray-50 rounded-lg border border-dashed",children:e.jsx("p",{children:"No assets assigned to you yet."})})})})]}),e.jsxs(U,{className:"border-2 border-dashed opacity-75",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gray-100 text-gray-600",children:e.jsx(Ms,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"text-xl",children:"Task 5: Install Security Agent"}),e.jsx(H,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(Y,{className:"mt-1",children:"Coming soon"})]})]}),e.jsx(N,{variant:"secondary",children:"Coming Soon"})]})}),e.jsxs($,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Install our device security agent to ensure your workstation meets our security standards."}),e.jsxs(f,{variant:"outline",disabled:!0,className:"w-full sm:w-auto",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Install Agent"]})]})]})]}),o.percentage===100&&e.jsx(U,{className:"border-2 border-green-500 bg-green-50/50",children:e.jsx($,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(R,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-green-900",children:"Onboarding Complete!"}),e.jsx("p",{className:"text-sm text-green-700",children:"You're all set. Welcome to the team!"})]})]})})}),v&&e.jsx(Ss,{open:F,onOpenChange:A,policyId:K==="policy"?v:void 0,requirementId:K==="document"?v:void 0,policyType:K,employeeId:(i==null?void 0:i.id)||0})]})});function O(t){var u,D;if(!(!i||!c)&&!((D=(u=s==null?void 0:s.tasks.acknowledgments)==null?void 0:u.items)!=null&&D[t]))if(t.startsWith("policy_")){const b=s.tasks.acknowledgments.requirements.find(X=>X.key===t);b!=null&&b.isPolicy&&(L==null||L.mutate({assignmentId:b.assignmentId}))}else M==null||M.mutate({clientId:c,employeeId:i.id,acknowledgmentType:t,version:"1.0"})}function _(t,u){!i||!c||C==null||C.mutate({clientId:c,employeeId:i.id,field:t,value:u})}function J(t){!i||!c||S==null||S.mutate({clientId:c,employeeId:i.id,assetType:t})}}function Os({label:p,checked:n,onCheck:g,onView:a,onException:j,viewed:E,exceptionStatus:x}){const w=n||E;return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:g,disabled:!w&&!n,className:`flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${n?"bg-green-500 border-green-500":w?"border-gray-500 hover:border-green-500 cursor-pointer":"border-gray-200 bg-gray-100 cursor-not-allowed"}`,children:n&&e.jsx(R,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-sm ${n?"text-gray-500 line-through":"text-gray-900"}`,children:p}),n?e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"Read & Accepted"}):w?null:e.jsx("span",{className:"text-xs text-orange-600",children:"Must view document first"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!n&&(!x||x==="rejected")&&e.jsx(f,{variant:"ghost",size:"sm",onClick:k=>{k.stopPropagation(),j()},className:"text-xs text-muted-foreground hover:text-destructive h-8 px-2",children:x==="rejected"?"Appeal / Retry":"Request Exception"}),x&&e.jsx(N,{variant:x==="approved"?"default":x==="rejected"?"destructive":"secondary",className:"text-xs h-6",children:x==="approved"?"Exception Granted":x==="rejected"?"Exception Rejected":"Exception Pending"}),e.jsxs(f,{variant:"outline",size:"sm",onClick:k=>{k.stopPropagation(),a()},className:"gap-2 h-8",children:[e.jsx(Rs,{className:"h-3 w-3"}),"View"]})]})]})}function re({label:p,checked:n,onCheck:g,isLoading:a}){return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-gray-50 transition-colors",children:[e.jsx("button",{onClick:()=>g(!n),disabled:a,className:`flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${n?"bg-blue-500 border-blue-500":"border-gray-300 hover:border-blue-500"} ${a?"opacity-50 cursor-not-allowed":""}`,children:a?e.jsx(cs,{className:"h-3 w-3 animate-spin text-gray-400"}):n?e.jsx(R,{className:"h-4 w-4 text-white"}):null}),e.jsx("span",{className:`text-sm ${n?"text-gray-500":"text-gray-900"}`,children:p})]})}function Ds({label:p,checked:n,onCheck:g,isLoading:a}){return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-gray-50 transition-colors",children:[e.jsx("button",{onClick:g,disabled:n||a,className:`flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${n?"bg-indigo-500 border-indigo-500":"border-gray-300 hover:border-indigo-500"} ${n||a?"opacity-50 cursor-not-allowed":""}`,children:a?e.jsx(cs,{className:"h-3 w-3 animate-spin text-gray-400"}):n?e.jsx(R,{className:"h-4 w-4 text-white"}):null}),e.jsx("span",{className:`text-sm ${n?"text-gray-500 line-through":"text-gray-900"}`,children:p})]})}export{qt as default};
