import{ac as $,r as p,t as r,i as l,j as e,c as n,C as z,d as H,k as B,S as R,e as q,f as A,m as K,ay as Q,D as v,o as N,p as C,q as k,s as T,I as y,w}from"./index-DOc7Nwb7.js";import{D as U}from"./DashboardLayout-aHnUqq57.js";import{T as x}from"./textarea-BtxBxzdY.js";import{P as V}from"./plus-BaQ35Jcx.js";import{L as W}from"./layout-template-CfpBjxAB.js";import{P as G}from"./pencil-Bud7U1sU.js";import{C as J}from"./clock-osbacZli.js";import{C as X}from"./copy-CXVMffmd.js";import{T as Y}from"./trash-2-CFEfisbM.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function He(){const{selectedClientId:o}=$(),[S,c]=p.useState(!1),[D,d]=p.useState(!1),[f,b]=p.useState(null),[i,a]=p.useState({title:"",description:"",tasksText:""}),m=r.useContext(),{data:u,isLoading:P}=r.implementation.listTemplates.useQuery({clientId:o||0},{enabled:!!o}),h=r.implementation.createTemplate.useMutation({onSuccess:()=>{l.success("Template created successfully"),c(!1),a({title:"",description:"",tasksText:""}),m.implementation.listTemplates.invalidate()},onError:s=>l.error(`Failed to create: ${s.message}`)}),j=r.implementation.updateTemplate.useMutation({onSuccess:()=>{l.success("Template updated successfully"),d(!1),b(null),a({title:"",description:"",tasksText:""}),m.implementation.listTemplates.invalidate()},onError:s=>l.error(`Failed to update: ${s.message}`)}),g=r.implementation.cloneTemplate.useMutation({onSuccess:()=>{l.success("Template cloned successfully"),m.implementation.listTemplates.invalidate()},onError:s=>l.error(`Failed to clone: ${s.message}`)}),I=r.implementation.deleteTemplate.useMutation({onSuccess:()=>{l.success("Template deleted"),m.implementation.listTemplates.invalidate()}}),M=()=>{const s=i.tasksText.split(`
`).filter(t=>t.trim()).map(t=>({title:t,priority:"medium"}));h.mutate({clientId:o||0,title:i.title,description:i.description,tasks:s,isSystem:!1})},E=()=>{if(!f)return;const s=i.tasksText.split(`
`).filter(t=>t.trim()).map(t=>({title:t,priority:"medium"}));j.mutate({templateId:f,title:i.title,description:i.description,tasks:s})},O=s=>{if(s.isSystem){l.info("System templates cannot be edited. Clone it first!");return}b(s.id),a({title:s.title,description:s.description||"",tasksText:s.tasks.map(t=>t.title).join(`
`)}),d(!0)},F=s=>{o&&g.mutate({templateId:s,clientId:o})};return e.jsx(U,{children:e.jsxs("div",{className:"p-8 max-w-[1600px] mx-auto animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Template Manager"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Standardize your implementation workflows with reusable templates."})]}),e.jsxs(n,{onClick:()=>c(!0),className:"bg-blue-600 hover:bg-blue-700 shadow-lg shadow-blue-500/20",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"New Template"]})]}),P&&e.jsx("div",{className:"text-center py-12",children:"Loading templates..."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u==null?void 0:u.map(s=>e.jsxs(z,{className:"group hover:shadow-md transition-all border-slate-200 flex flex-col",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:`p-2 rounded-lg mb-4 inline-block ${s.isSystem?"bg-slate-100 text-slate-600":"bg-blue-50 text-blue-600"}`,children:e.jsx(W,{className:"w-6 h-6"})}),s.isSystem&&e.jsxs(B,{variant:"secondary",className:"bg-slate-100 text-slate-600 border-slate-200",children:[e.jsx(R,{className:"w-3 h-3 mr-1"})," System"]})]}),e.jsxs(q,{className:"text-xl flex items-center justify-between",children:[s.title,!s.isSystem&&e.jsx(n,{variant:"ghost",size:"icon",className:"h-8 w-8 ml-2",onClick:()=>O(s),children:e.jsx(G,{className:"w-4 h-4 text-slate-400 hover:text-blue-600"})})]}),e.jsx(A,{className:"line-clamp-2 h-10",children:s.description||"No description provided."})]}),e.jsx(K,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-slate-500",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:s.estimatedHours?`${s.estimatedHours}h estimated`:"Variable duration"})]}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg text-xs text-slate-600",children:[e.jsx("strong",{children:"Key Tasks:"}),e.jsxs("ul",{className:"mt-1 list-disc list-inside space-y-1",children:[s.tasks.slice(0,3).map((t,L)=>e.jsx("li",{className:"truncate",children:t.title},L)),s.tasks.length>3&&e.jsxs("li",{className:"text-slate-400 italic",children:["... +",s.tasks.length-3," more"]})]})]})]})}),e.jsxs(Q,{className:"pt-2 border-t border-slate-50 flex justify-between mt-auto",children:[e.jsxs(n,{variant:"ghost",size:"sm",className:"text-slate-500",onClick:()=>F(s.id),disabled:g.isPending,children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),g.isPending?"Cloning...":"Clone"]}),!s.isSystem&&e.jsx(n,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-600 hover:bg-red-50",onClick:()=>{confirm("Are you sure you want to delete this template?")&&I.mutate({templateId:s.id})},children:e.jsx(Y,{className:"w-4 h-4"})})]})]},s.id))}),e.jsx(v,{open:S,onOpenChange:c,children:e.jsxs(N,{children:[e.jsxs(C,{children:[e.jsx(k,{children:"Create New Template"}),e.jsx(T,{children:"Define a standard set of tasks for future projects."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Template Name"}),e.jsx(y,{value:i.title,onChange:s=>a(t=>({...t,title:s.target.value})),placeholder:"e.g. ISO 27001 Foundation"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Description"}),e.jsx(x,{value:i.description,onChange:s=>a(t=>({...t,description:s.target.value})),placeholder:"What is this template for?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Tasks (One per line)"}),e.jsx(x,{className:"h-32 font-mono text-sm",value:i.tasksText,onChange:s=>a(t=>({...t,tasksText:s.target.value})),placeholder:`Draft Policy
Review with Stakeholders
Publish to Portal`}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Simple editor: Enter each task title on a new line."})]})]}),e.jsxs(w,{children:[e.jsx(n,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(n,{onClick:M,disabled:!i.title||h.isPending,children:h.isPending?"Creating...":"Create Template"})]})]})}),e.jsx(v,{open:D,onOpenChange:d,children:e.jsxs(N,{children:[e.jsxs(C,{children:[e.jsx(k,{children:"Edit Template"}),e.jsx(T,{children:"Modify your custom template."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Template Name"}),e.jsx(y,{value:i.title,onChange:s=>a(t=>({...t,title:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Description"}),e.jsx(x,{value:i.description,onChange:s=>a(t=>({...t,description:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Tasks (One per line)"}),e.jsx(x,{className:"h-32 font-mono text-sm",value:i.tasksText,onChange:s=>a(t=>({...t,tasksText:s.target.value}))})]})]}),e.jsxs(w,{children:[e.jsx(n,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(n,{onClick:E,disabled:j.isPending,children:j.isPending?"Saving...":"Save Changes"})]})]})})]})})}export{He as default};
