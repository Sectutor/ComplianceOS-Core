import{ab as B,b as F,r as g,t as f,i as N,R as T,j as e,S as H,k as m,C as y,d as q,e as $,m as S,z,E as U,G as W,H as _,J as K,K as p,c as b,x as w,D as Y,o as J,p as Q,q as X,s as Z,w as ee}from"./index-DOc7Nwb7.js";import{D as C}from"./DashboardLayout-aHnUqq57.js";import{B as te}from"./Breadcrumb-CRi3LAxS.js";import{S as se}from"./scroll-area-DPaNxEJD.js";import{P as ae,a as ie}from"./PageGuide-CPKKXXS6.js";import{A}from"./activity-B1F2IRm3.js";import{A as re}from"./arrow-right-M96iV-v9.js";import{B as ne}from"./book-open-BffBrdze.js";import{C as le}from"./circle-check-C5kiwRoG.js";import{C as oe}from"./clock-osbacZli.js";import{E as ce}from"./external-link-C3PXjBR9.js";import{S as k}from"./sparkles-CoQ80pK2.js";import{I as de}from"./info-By5wLOUH.js";import{M as me}from"./index-utl_XIpZ.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./send-FW7-3cjH.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";const pe={SCVS:[{id:"SCVS-V1",framework:"OWASP SCVS",name:"Build Pipeline Integrity",description:"Establishing a verifiable and protected software build process.",impact:"Prevents code injection during the build phase, protecting against SolarWinds-style attacks.",guidance:["Ensure build servers are isolated and have no direct internet access during compilation.","Implement build-time Software Bill of Materials (SBOM) generation using tools like Syft or CycloneDX.","Digitally sign build artifacts (binaries, containers) immediately upon completion."],nextSteps:["Configure ephemeral build runners that are destroyed after each job.","Enforce multi-party approval for changes to the build environment configuration.","Verify signatures of all upstream dependencies before ingestion."],relatedAuditCode:"SCVS-1.1"},{id:"SCVS-V2",framework:"OWASP SCVS",name:"Dependency Management",description:"Controlled ingestion and lifecycle management of third-party assets.",impact:"Reduces exposure to vulnerable or malicious open-source packages.",guidance:["Establish a private artifact repository (Nexus, Artifactory) as the single source of truth.","Enable automated vulnerability scanning (SCA) for all tracked dependencies.","Pin dependencies to specific hashes (not just versions) to prevent supply chain poisoning."],nextSteps:["Implement a 'Break the Build' policy for dependencies with known Critical vulnerabilities.","Perform quarterly reviews of the 'Allow List' for new dependencies.","Monitor for 'typosquatting' and dependency confusion attacks."],relatedAuditCode:"SCVS-2.1"}],OPENSSF:[{id:"OSPS-HY",framework:"OpenSSF",name:"Repository Hygiene",description:"Foundational security settings for project repositories.",impact:"Ensures baseline protection across all development assets, preventing trivial unauthorized changes.",guidance:["Required 2-Factor Authentication (2FA) for all repository contributors.","Enforce Branch Protection rules on all 'main' or production branches.","Require signature verification (GPG/SSH) for all commits."],nextSteps:["Audit contributor list to ensure offboarded employees are removed.","Automate secret scanning (e.g., GitHub Secret Scanning) to prevent credential leakage.","Include a SECURITY.md file with a clear vulnerability disclosure policy."],relatedAuditCode:"OSPS-AC-01"}],ASVS:[{id:"ASVS-V1",framework:"OWASP ASVS",name:"Architecture & Design",description:"High-level security requirements for application architecture.",impact:"Ensures the system is secure by design, reducing the need for expensive late-stage refactors.",guidance:["Verify that all application components are identified and their trust boundaries defined.","Implement a centralized authentication and authorization service.","Ensure data is classified by sensitivity and encrypted appropriately at rest."],nextSteps:["Perform a formal Threat Model of the core application architecture.","Review API designs for sensitive data exposure (OWASP API #3).","Validate that security headers are enforced globally across the frontend."],relatedAuditCode:"ASVS-1.1"}],MASVS:[{id:"MASVS-V1",framework:"OWASP MASVS",name:"Architecture, Design and Threat Modeling",description:"Security requirements for mobile application architecture and design.",impact:"Ensures mobile apps are built on a secure foundation, specialized for mobile-specific threats.",guidance:["Verify that the mobile app has a clear security architecture and design.","Implement secure data storage and communication practices.","Ensure protection against reverse engineering and tampering."],nextSteps:["Conduct a mobile-specific threat model.","Audit third-party SDKs used in the mobile app.","Implement code obfuscation and integrity checks."],relatedAuditCode:"MASVS-1.1"}]},tt=()=>{const{id:l,frameworkId:i}=B(),[,I]=F(),[V,D]=g.useState(null),[s,x]=g.useState(null),[P,j]=g.useState(""),o=f.advisor.getImplementationGuidance.useMutation({onSuccess:t=>{j(t.guidance)},onError:t=>{N.error("Failed to generate guidance"),console.error(t)}}),E=t=>{x(t),j(""),o.mutate({clientId:Number(l),controlId:t.controlId,controlTitle:t.name,controlDescription:t.description})},{data:d,isLoading:G,refetch:O}=f.frameworks.getWorkProcessData.useQuery({clientId:Number(l),frameworkId:i||""}),M=f.clientControls.update.useMutation({onSuccess:()=>{N.success("Control status updated"),O()}}),u=T.useMemo(()=>!d||!Array.isArray(d)?{}:d.reduce((t,a)=>{const r=(a==null?void 0:a.category)||"General";return t[r]||(t[r]=[]),t[r].push(a),t},{}),[d]),h=Object.keys(u),n=V||(h.length>0?h[0]:null),v=n?u[n]||[]:[],c=(t=>{if(!t)return null;const a=pe[(i==null?void 0:i.toUpperCase())||""]||[],r=t.match(/V(\d+):/);if(r){const R=r[1];return a.find(L=>L.id.includes(`-V${R}`))}return null})(n);return G?e.jsx(C,{children:e.jsx("div",{className:"p-8 flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(A,{className:"w-12 h-12 text-[#0284c7] animate-pulse"}),e.jsx("p",{className:"text-slate-400 font-bold animate-pulse",children:"Loading Implementation Data..."})]})})}):e.jsx(C,{children:e.jsxs("div",{className:"p-8 space-y-8 max-w-7xl mx-auto",children:[e.jsx(te,{items:[{label:"Assurance",href:`/clients/${l}/assurance`},{label:(i==null?void 0:i.toUpperCase())||"Standard"}]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 bg-white p-8 rounded-3xl border border-slate-200 shadow-sm overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[#0284c7]/5 rounded-full -mr-32 -mt-32 blur-3xl"}),e.jsx("div",{className:"space-y-4 relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-[#0284c7] to-[#0369a1] rounded-2xl shadow-lg shadow-[#0284c7]/20",children:e.jsx(H,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-black text-slate-900 tracking-tight",children:[i==null?void 0:i.toUpperCase()," ",e.jsx("span",{className:"text-[#0284c7]",children:"Work Process"})]}),e.jsx("p",{className:"text-slate-500 font-medium text-lg",children:"Dynamic Technical Implementation & Verification"})]})]})}),e.jsx("div",{className:"relative z-10 p-2",children:e.jsx(ae,{title:"Framework Implementation",description:"Interactive guide to implementing technical controls.",rationale:"Bridge the gap between requirements and technical reality with step-by-step verification.",howToUse:[{step:"Select Domain",description:"Choose a category from the sidebar to focus your efforts."},{step:"Review Control",description:"Read the requirements and description."},{step:"AI Guidance",description:"Click 'AI Implementation Guide' for tailored advice."},{step:"Verify & Update",description:"Check status in Audit Hub and update the state here."}],integrations:[{name:"Audit Hub",description:"Direct link to evidence collection."},{name:"Advisor",description:"Real-time AI consultation."}]})})]}),e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest px-2",children:"Domains & Categories"}),e.jsx(se,{className:"h-[calc(100vh-350px)] pr-4",children:e.jsx("div",{className:"space-y-3",children:h.map(t=>e.jsx("button",{onClick:()=>D(t),className:`w-full text-left p-5 rounded-2xl transition-all duration-300 border shadow-sm group ${n===t?"bg-[#0284c7] border-[#0284c7] text-white shadow-lg shadow-[#0284c7]/20 translate-x-1":"bg-white border-slate-100 text-slate-600 hover:border-[#0284c7]/30 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-bold leading-tight line-clamp-2",children:t}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(m,{className:`text-[10px] py-0 px-2 ${n===t?"bg-white/20 text-white":"bg-slate-100 text-slate-500"}`,children:[u[t].length," Controls"]})})]}),e.jsx(re,{className:`w-5 h-5 shrink-0 mt-1 transition-transform ${n===t?"translate-x-1":"group-hover:translate-x-1 opacity-20"}`})]})},t))})})]}),e.jsx("div",{className:"lg:col-span-8",children:n?e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[c&&e.jsxs(y,{className:"border-none shadow-xl shadow-slate-200/50 rounded-3xl overflow-hidden bg-gradient-to-br from-white to-slate-50",children:[e.jsxs(q,{className:"p-8 pb-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx(m,{variant:"outline",className:"bg-white text-[#0284c7] border-[#0284c7]/20 font-bold px-3 py-1",children:"Strategic Guidance"})}),e.jsx($,{className:"text-2xl font-black text-slate-900",children:c.name})]}),e.jsxs(S,{className:"p-8 pt-0 space-y-6",children:[e.jsxs("div",{className:"bg-emerald-50 rounded-2xl p-6 border border-emerald-100 flex gap-5 items-start",children:[e.jsx(A,{className:"w-6 h-6 text-emerald-600 shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-emerald-900 mb-1",children:"Business Impact"}),e.jsxs("p",{className:"text-emerald-800/80 font-medium leading-relaxed italic",children:['"',c.impact,'"']})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"})," Implementation Focus"]}),e.jsx("ul",{className:"space-y-2",children:c.guidance.map((t,a)=>e.jsxs("li",{className:"text-sm text-slate-600 font-medium flex gap-2",children:[e.jsx("span",{className:"text-[#0284c7]",children:"â€¢"})," ",t]},a))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"})," Roadmap"]}),e.jsx("ul",{className:"space-y-2",children:c.nextSteps.map((t,a)=>e.jsxs("li",{className:"text-sm text-slate-600 font-medium flex gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-emerald-500 shrink-0"})," ",t]},a))})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-xl font-black text-slate-900 px-2 flex items-center justify-between",children:["Requirement Verification",e.jsxs("span",{className:"text-sm font-bold text-slate-400",children:[v.length," Found"]})]}),v.map(t=>{var a;return e.jsx(y,{className:"border-slate-100 shadow-sm hover:shadow-md transition-all rounded-2xl",children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{className:"bg-slate-100 text-slate-600 font-mono text-[10px] rounded-md",children:t.controlId}),e.jsx("h4",{className:"font-bold text-slate-900",children:t.name})]}),e.jsx("p",{className:"text-sm text-slate-500 font-medium leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-bold text-slate-400",children:[e.jsx(oe,{className:"w-3.5 h-3.5"}),"Status:",e.jsx(m,{className:`ml-1 text-[10px] ${t.status==="implemented"?"bg-emerald-50 text-emerald-600 border-emerald-200":t.status==="in_progress"?"bg-amber-50 text-amber-600 border-amber-200":"bg-slate-50 text-slate-400"}`,variant:"outline",children:(a=t.status)==null?void 0:a.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-bold text-slate-400",children:[e.jsx(z,{className:"w-3.5 h-3.5"}),"Evidence:",e.jsxs("span",{className:(t.evidenceCount||0)>0?"text-emerald-600":"text-amber-500",children:[t.evidenceCount||0," Linked"]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[e.jsxs(U,{value:t.status,onValueChange:r=>M.mutate({id:t.id,clientId:Number(l),status:r}),children:[e.jsx(W,{className:"w-full rounded-xl font-bold text-xs h-10",children:e.jsx(_,{placeholder:"Update Status"})}),e.jsxs(K,{children:[e.jsx(p,{value:"not_implemented",children:"Not Implemented"}),e.jsx(p,{value:"in_progress",children:"In Progress"}),e.jsx(p,{value:"implemented",children:"Implemented"}),e.jsx(p,{value:"not_applicable",children:"Not Applicable"})]})]}),e.jsxs(b,{variant:"outline",className:"w-full rounded-xl border-slate-200 text-[#0284c7] font-bold text-xs h-10 hover:bg-[#0284c7]/5",onClick:()=>I(`/clients/${l}/audit-hub?search=${t.controlId}`),children:["Verify in Audit Hub",e.jsx(ce,{className:"w-3.5 h-3.5 ml-2"})]}),e.jsx(b,{variant:"ghost",className:`w-full rounded-xl font-bold text-xs h-10 border border-purple-100 transition-all duration-300
                                                                ${o.isLoading&&(s==null?void 0:s.id)===t.id?"bg-purple-50 text-purple-400 cursor-wait":"text-purple-600 hover:bg-purple-50"}`,onClick:()=>E(t),disabled:o.isLoading,children:o.isLoading&&(s==null?void 0:s.id)===t.id?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-3.5 h-3.5 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-3.5 h-3.5 mr-2"}),"AI Implementation Guide"]})})]})]})})},t.id)})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-12 text-center space-y-4 bg-slate-50 rounded-3xl border-2 border-dashed border-slate-200",children:[e.jsx(de,{className:"w-12 h-12 text-slate-300"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-slate-400",children:"Select a category to begin"}),e.jsx("p",{className:"text-slate-400",children:"Select a technical domain from the sidebar to start implementation."})]})]})})]}),e.jsx(Y,{open:!!s,onOpenChange:t=>!t&&x(null),children:e.jsxs(J,{className:"max-w-3xl max-h-[85vh] overflow-y-auto",children:[e.jsxs(Q,{children:[e.jsxs(X,{className:"flex items-center gap-2 text-xl",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(k,{className:"w-5 h-5 text-purple-600"})}),"Implementation Guide"]}),e.jsx(Z,{children:"AI-generated guidance tailored to your organization's context."})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-100",children:[e.jsx("h4",{className:"font-bold text-slate-900 mb-1",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-sm text-slate-500",children:s==null?void 0:s.description})]}),o.isLoading?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(w,{className:"w-8 h-8 text-purple-600 animate-spin"})}):e.jsx("div",{className:"prose prose-sm prose-slate max-w-none",children:e.jsx(me,{children:P})})]}),e.jsx(ee,{children:e.jsx(b,{variant:"outline",onClick:()=>x(null),children:"Close"})})]})})]})})};export{tt as default};
