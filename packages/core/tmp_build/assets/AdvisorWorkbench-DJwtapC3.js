import{M as ae,b as re,ac as te,t as i,i as q,r as j,j as e,k as y,C as f,d as A,e as D,f as L,c as o,m as I,N as X,O as Z,P as C,Q as h,V as ee,W as m,h as ie,F as le,U as ne,D as $,o as O,p as R,q as Q,L as p,I as B,w as E,ap as oe,v as Y}from"./index-DOc7Nwb7.js";import{D as de}from"./DashboardLayout-aHnUqq57.js";import{T as ce,a as me,b as _,c as J}from"./tabs-CBDTXbEn.js";import{T as xe}from"./textarea-BtxBxzdY.js";import{P as he}from"./PremiumSlot-CUXhxIKF.js";import{S as z}from"./sparkles-CoQ80pK2.js";import{S as pe}from"./search-CwuIBBPE.js";import{A as K}from"./arrow-up-right-BLuFLpps.js";import{P as ue}from"./palette-BSVFoiqZ.js";import{P as je}from"./plus-BaQ35Jcx.js";import{G as ge}from"./globe-BMGZmoaJ.js";import{L as be}from"./lock-czWF3qbC.js";import{T as fe}from"./trash-2-CFEfisbM.js";import"./index--2vFva6Y.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./alert-dialog-V7xGXdVc.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=ae("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);function ms(){var T,t,k,M,H,U,V,G;const[,d]=re(),{selectedClientId:v,planTier:g}=te(),{data:r,isLoading:w}=i.intake.listAll.useQuery(),{data:u,refetch:W}=i.clients.list.useQuery(),P=i.useUtils(),c=g==="pro"||g==="enterprise",b=i.clients.updateContactInfo.useMutation(),S=i.clients.update.useMutation({onSuccess:()=>{n(null),W(),P.clients.get.invalidate(),q.success("Branding updated successfully")},onError:s=>{q.error("Failed to update branding: "+s.message)}}),[l,n]=j.useState(null),[a,x]=j.useState({brandPrimaryColor:"",brandSecondaryColor:"",portalTitle:""}),N=s=>{n(s),x({brandPrimaryColor:s.brandPrimaryColor||"#4f46e5",brandSecondaryColor:s.brandSecondaryColor||"#eef2ff",portalTitle:s.portalTitle||s.name})},F=()=>{l&&S.mutate({id:l.id,...a})};return e.jsxs(de,{children:[e.jsx("div",{className:"space-y-8",children:e.jsx(he,{featureId:"advisor_workbench",title:"Advisor Workbench",description:"AI-powered centralized triage, multi-client branding, and proactive compliance suggestions.",isPremiumEnabled:c,children:e.jsxs(ce,{defaultValue:"dashboard",className:"w-full",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(z,{className:"h-8 w-8 text-indigo-600"}),"Advisor Workbench",e.jsx(y,{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white border-none px-3 py-1 text-[10px] font-bold tracking-widest shadow-lg shadow-indigo-200 uppercase",children:"Premium"})]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-lg",children:"Centralized Evidence Triage. Manage intake items across all managed clients."})]}),e.jsxs(me,{children:[e.jsx(_,{value:"dashboard",children:"Dashboard"}),e.jsx(_,{value:"library",children:"My Library"})]})]}),e.jsxs(J,{value:"dashboard",className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsxs(f,{className:"px-6 py-2 bg-slate-50 border-slate-200",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase font-bold tracking-wider",children:"Active Clients"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:"12"})]}),e.jsxs(f,{className:"px-6 py-2 bg-indigo-50 border-indigo-100",children:[e.jsx("div",{className:"text-xs text-indigo-500 uppercase font-bold tracking-wider",children:"Pending Triage"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-700",children:(r==null?void 0:r.filter(s=>s.status==="pending").length)||0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(f,{className:"shadow-lg border-slate-200 lg:col-span-2",children:[e.jsxs(A,{className:"border-b bg-slate-50/50 flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(D,{children:"Global Intake Queue"}),e.jsx(L,{children:"Review and map evidence for all clients."})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"})," Search"]})})]}),e.jsx(I,{className:"p-0",children:e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(C,{className:"bg-slate-50/30",children:[e.jsx(h,{className:"w-[150px]",children:"Client"}),e.jsx(h,{children:"File Name"}),e.jsx(h,{children:"Status"}),e.jsx(h,{children:"AI Suggestion"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsx(ee,{children:w?e.jsx(C,{children:e.jsx(m,{colSpan:5,className:"text-center py-20 text-slate-400 italic",children:"Loading global queue..."})}):r==null?void 0:r.map(s=>e.jsxs(C,{className:"hover:bg-slate-50/50 transition-colors group",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"font-semibold text-slate-700 truncate max-w-[120px]",children:s.clientName})]})}),e.jsx(m,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"truncate max-w-[150px]",children:s.filename})]})}),e.jsx(m,{children:e.jsx(y,{variant:s.status==="mapped"?"success":s.status==="classified"?"secondary":"outline",className:"capitalize",children:s.status})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600",children:[e.jsx(z,{className:"h-3 w-3 text-amber-500"}),s.classification||"Pending AI"]})}),e.jsx(m,{className:"text-right",children:e.jsxs(o,{variant:"ghost",size:"sm",className:"h-8 text-indigo-600 hover:bg-indigo-50",onClick:()=>d(`/clients/${s.clientId}/intake`),children:["Triage ",e.jsx(K,{className:"h-3 w-3 ml-1"})]})})]},s.id))})]})})]}),e.jsxs(f,{className:"shadow-lg border-indigo-100 bg-indigo-50/10",children:[e.jsxs(A,{className:"bg-white/50 border-b border-indigo-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-indigo-600"}),e.jsx(D,{className:"text-indigo-900",children:"Proactive AI Suggestions"})]}),e.jsx(L,{children:"Automated drift detection & optimizations"})]}),e.jsx(I,{className:"p-4 space-y-4",children:e.jsx(ve,{})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ne,{className:"h-6 w-6 text-indigo-600"}),"Client Portfolio Management"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u==null?void 0:u.filter(s=>s.serviceModel!=="subscription").map(s=>e.jsxs(f,{className:"border-slate-200 hover:shadow-md transition-shadow",children:[e.jsx(A,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-lg",children:s.name}),e.jsx(L,{children:s.industry})]}),e.jsx(y,{variant:s.serviceModel==="managed"?"success":"secondary",children:s.serviceModel})]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Weekly Focus"}),e.jsx("textarea",{className:"w-full min-h-[80px] text-sm p-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-indigo-500 bg-slate-50/50",placeholder:"Set the goal for this week...",defaultValue:s.weeklyFocus||"",onBlur:se=>{b.mutate({clientId:s.id,weeklyFocus:se.target.value})}})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-500",children:"Compliance Score"}),e.jsxs("span",{className:"font-bold text-indigo-600",children:[s.targetComplianceScore||0,"%"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",className:"flex-1 text-slate-600",onClick:()=>N(s),size:"sm",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"})," Branding"]}),e.jsxs(o,{className:"flex-1 bg-indigo-600 hover:bg-indigo-700 text-white",size:"sm",onClick:()=>d(`/clients/${s.id}`),children:["Workspace ",e.jsx(K,{className:"ml-2 h-4 w-4"})]})]})]})]},s.id))})]})]}),e.jsx(J,{value:"library",children:e.jsx(Ne,{})})]})})}),e.jsx($,{open:!!l,onOpenChange:s=>!s&&n(null),children:e.jsxs(O,{children:[e.jsx(R,{children:e.jsxs(Q,{children:["Client Branding: ",l==null?void 0:l.name]})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Portal Title"}),e.jsx(B,{value:a.portalTitle,onChange:s=>x({...a,portalTitle:s.target.value}),placeholder:"Compliance Portal"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Primary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",className:"h-9 w-12 rounded-lg border-2 border-slate-200 p-0.5 cursor-pointer bg-white transition-all hover:scale-105",value:(T=a.brandPrimaryColor)!=null&&T.startsWith("#")?a.brandPrimaryColor:`#${a.brandPrimaryColor||"4f46e5"}`,onChange:s=>x({...a,brandPrimaryColor:s.target.value})}),e.jsx(B,{value:a.brandPrimaryColor,onChange:s=>x({...a,brandPrimaryColor:s.target.value}),placeholder:"#4f46e5",className:"font-mono text-xs"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Secondary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",className:"h-9 w-12 rounded-lg border-2 border-slate-200 p-0.5 cursor-pointer bg-white transition-all hover:scale-105",value:(t=a.brandSecondaryColor)!=null&&t.startsWith("#")?a.brandSecondaryColor:`#${a.brandSecondaryColor||"eef2ff"}`,onChange:s=>x({...a,brandSecondaryColor:s.target.value})}),e.jsx(B,{value:a.brandSecondaryColor,onChange:s=>x({...a,brandSecondaryColor:s.target.value}),placeholder:"#eef2ff",className:"font-mono text-xs"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl border-2 border-dashed border-slate-200 bg-slate-50/50",children:[e.jsx(p,{className:"text-[10px] uppercase font-bold tracking-widest text-slate-500 mb-3 block",children:"Live Preview"}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"w-24 rounded-lg overflow-hidden shadow-lg border border-slate-200 transition-all duration-300",style:{backgroundColor:(k=a.brandPrimaryColor)!=null&&k.startsWith("#")?a.brandPrimaryColor:`#${a.brandPrimaryColor||"4f46e5"}`},children:[e.jsxs("div",{className:"p-2 border-b border-white/10",children:[e.jsx("div",{className:"h-1.5 w-12 bg-white/20 rounded mb-1"}),e.jsx("div",{className:"h-3 w-16 bg-white rounded-sm",style:{backgroundColor:(M=a.brandSecondaryColor)!=null&&M.startsWith("#")?a.brandSecondaryColor:`#${a.brandSecondaryColor||"ffffff"}`}})]}),e.jsxs("div",{className:"p-2 space-y-1.5",children:[e.jsx("div",{className:"h-2 w-full bg-white/10 rounded"}),e.jsx("div",{className:"h-2 w-[80%] bg-white/10 rounded"}),e.jsx("div",{className:"h-2 w-[90%] bg-white/20 rounded"}),e.jsx("div",{className:"h-2 w-[70%] bg-white/10 rounded"})]})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"text-sm font-bold truncate",children:a.portalTitle||(l==null?void 0:l.name)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 w-16 rounded text-[8px] flex items-center justify-center font-bold text-white shadow-sm",style:{backgroundColor:(H=a.brandPrimaryColor)!=null&&H.startsWith("#")?a.brandPrimaryColor:`#${a.brandPrimaryColor||"4f46e5"}`},children:"PRIMARY"}),e.jsx("div",{className:"h-6 w-16 rounded text-[8px] flex items-center justify-center font-bold border",style:{backgroundColor:(U=a.brandSecondaryColor)!=null&&U.startsWith("#")?a.brandSecondaryColor:`#${a.brandSecondaryColor||"eef2ff"}`,color:(V=a.brandPrimaryColor)!=null&&V.startsWith("#")?a.brandPrimaryColor:`#${a.brandPrimaryColor||"4f46e5"}`,borderColor:(G=a.brandPrimaryColor)!=null&&G.startsWith("#")?a.brandPrimaryColor:`#${a.brandPrimaryColor||"4f46e5"}`},children:"SECONDARY"})]})]})]})]})]}),e.jsx(E,{children:e.jsx(o,{onClick:F,children:"Save Branding"})})]})})]})}function ve(){const{data:d,isLoading:v}=i.proactiveAdvisor.listAllSuggestions.useQuery(),g=i.proactiveAdvisor.applyRecommendation.useMutation();return v?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(r=>e.jsx("div",{className:"h-24 bg-slate-100 animate-pulse rounded-lg"},r))}):!d||d.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No active suggestions. System is healthy."}):e.jsx("div",{className:"space-y-4",children:d.map(r=>e.jsxs("div",{className:"p-3 bg-white rounded-lg border border-indigo-100 shadow-sm space-y-2 hover:border-indigo-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(y,{variant:r.severity==="high"?"destructive":r.severity==="medium"?"warning":"secondary",className:"text-[10px] uppercase font-bold px-1.5 py-0",children:r.severity}),e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:r.clientName})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm text-slate-900",children:r.title}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:r.description})]}),e.jsx(o,{variant:"ghost",size:"sm",className:"w-full h-8 text-xs text-indigo-600 hover:bg-indigo-50 border border-indigo-50",onClick:()=>{g.mutate({clientId:r.clientId||0,suggestionId:r.id,action:r.recommendedAction})},children:"Apply Fix"})]},r.id))})}function Ne(){const{data:d,refetch:v}=i.policyTemplates.list.useQuery(),g=i.policyTemplates.create.useMutation({onSuccess:()=>v()}),r=i.policyTemplates.delete.useMutation({onSuccess:()=>v()}),w=i.policyTemplates.deploy.useMutation(),{data:u}=i.clients.list.useQuery(),[W,P]=j.useState(!1),[c,b]=j.useState({name:"",content:"",isPublic:!1}),[S,l]=j.useState(null),[n,a]=j.useState([]),[x,N]=j.useState(!1),F=()=>{g.mutate(c),P(!1),b({name:"",content:"",isPublic:!1})},T=()=>{!S||n.length===0||(w.mutate({templateId:S,clientIds:n}),N(!1),a([]))};return e.jsxs(f,{children:[e.jsxs(A,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(D,{children:"Consultant Template Library"}),e.jsx(L,{children:"Manage your private policy templates and deploys them to clients."})]}),e.jsxs($,{open:W,onOpenChange:P,children:[e.jsx(oe,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(je,{className:"mr-2 h-4 w-4"})," New Template"]})}),e.jsxs(O,{children:[e.jsx(R,{children:e.jsx(Q,{children:"Create New Template"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Template Name"}),e.jsx(B,{value:c.name,onChange:t=>b({...c,name:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Default Content (Markdown)"}),e.jsx(xe,{className:"min-h-[200px]",value:c.content,onChange:t=>b({...c,content:t.target.value})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{id:"public",checked:c.isPublic,onCheckedChange:t=>b({...c,isPublic:!!t})}),e.jsx(p,{htmlFor:"public",children:"Make Public (Share with other consultants)"})]})]}),e.jsx(E,{children:e.jsx(o,{onClick:F,children:"Create Template"})})]})]})]}),e.jsxs(I,{children:[e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(C,{children:[e.jsx(h,{children:"Template Name"}),e.jsx(h,{children:"Visibility"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsx(ee,{children:d==null?void 0:d.map(t=>e.jsxs(C,{children:[e.jsx(m,{className:"font-medium",children:t.name}),e.jsx(m,{children:t.isPublic?e.jsxs(y,{variant:"secondary",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"})," Public"]}):e.jsxs(y,{variant:"outline",children:[e.jsx(be,{className:"w-3 h-3 mr-1"})," Private"]})}),e.jsxs(m,{className:"text-right space-x-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{l(t.templateId),N(!0)},children:[e.jsx(ye,{className:"w-3 h-3 mr-1"})," Deploy"]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>r.mutate({id:t.id}),children:e.jsx(fe,{className:"w-3 h-3 text-red-500"})})]})]},t.id))})]}),e.jsx($,{open:x,onOpenChange:N,children:e.jsxs(O,{children:[e.jsx(R,{children:e.jsx(Q,{children:"Deploy Template to Clients"})}),e.jsxs("div",{className:"py-4 space-y-2 max-h-[60vh] overflow-y-auto",children:[e.jsx(p,{children:"Select Target Clients"}),u==null?void 0:u.map(t=>e.jsxs("div",{className:"flex items-center space-x-2 border p-2 rounded hover:bg-slate-50",children:[e.jsx(Y,{checked:n.includes(t.id),onCheckedChange:k=>{a(k?[...n,t.id]:n.filter(M=>M!==t.id))}}),e.jsx("span",{children:t.name})]},t.id))]}),e.jsx(E,{children:e.jsx(o,{onClick:T,disabled:n.length===0,children:w.isLoading?"Deploying...":`Deploy to ${n.length} Clients`})})]})})]})]})}export{ms as default};
