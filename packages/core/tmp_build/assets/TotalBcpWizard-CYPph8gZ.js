import{ab as v,b as w,r as b,j as e,c as l,S as C,T as S,C as z,d as B,R as P,e as A,f as I,m as k,ay as D,t as c,k as u,i as j,x as N}from"./index-DOc7Nwb7.js";import{D as L}from"./DashboardLayout-aHnUqq57.js";import{c as x}from"./utils-BC5CVi_C.js";import{A as f}from"./activity-B1F2IRm3.js";import{L as y}from"./layers-ZuBPQb1T.js";import{C as p}from"./circle-check-big-BSqJVrgh.js";import{A as R}from"./arrow-left-CpuUojG-.js";import{A as T}from"./arrow-right-M96iV-v9.js";import{I as G}from"./info-By5wLOUH.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function Be(){const n=v(),s=parseInt(n.id||"0"),[i,d]=w(),[t,m]=b.useState(1),r=[{id:1,title:"Governance",icon:C,color:"text-blue-500",bg:"bg-blue-50"},{id:2,title:"Inventory",icon:f,color:"text-emerald-500",bg:"bg-emerald-50"},{id:3,title:"Impact",icon:S,color:"text-amber-500",bg:"bg-amber-50"},{id:4,title:"Strategies",icon:y,color:"text-purple-500",bg:"bg-purple-50"},{id:5,title:"Finalize",icon:p,color:"text-green-500",bg:"bg-green-50"}],o=()=>m(a=>Math.min(a+1,r.length)),h=()=>m(a=>Math.max(a-1,1));return e.jsx(L,{children:e.jsxs("div",{className:"max-w-6xl mx-auto py-8 px-4 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Business Continuity Wizard"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Step-by-step guidance to build your organization's resilience profile."})]}),e.jsx(l,{variant:"outline",onClick:()=>d(`/clients/${s}/business-continuity`),children:"Exit Wizard"})]}),e.jsxs("div",{className:"flex items-center justify-between relative px-2",children:[e.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-0.5 bg-slate-200 -z-10 -translate-y-1/2 mx-12"}),r.map(a=>e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:x("w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 border-2",t===a.id?"bg-white border-primary shadow-md scale-110":t>a.id?"bg-primary border-primary text-white":"bg-slate-100 border-slate-200 text-slate-500"),children:t>a.id?e.jsx(p,{className:"w-6 h-6"}):e.jsx(a.icon,{className:"w-5 h-5"})}),e.jsx("span",{className:x("text-xs font-semibold uppercase tracking-wider",t===a.id?"text-primary":"text-slate-500"),children:a.title})]},a.id))]}),e.jsxs(z,{className:"min-h-[500px] flex flex-col shadow-xl border-slate-200",children:[e.jsx(B,{className:"border-b bg-slate-50/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:x("p-2 rounded-lg",r[t-1].bg),children:P.createElement(r[t-1].icon,{className:x("w-6 h-6",r[t-1].color)})}),e.jsxs("div",{children:[e.jsxs(A,{children:["Step ",t,": ",r[t-1].title]}),e.jsx(I,{children:"Complete this section to advance your business continuity readiness."})]})]})}),e.jsxs(k,{className:"flex-1 p-8",children:[t===1&&e.jsx(M,{clientId:s}),t===2&&e.jsx(E,{clientId:s}),t===3&&e.jsx(F,{clientId:s}),t===4&&e.jsx(O,{clientId:s}),t===5&&e.jsx(Q,{clientId:s})]}),e.jsxs(D,{className:"border-t bg-slate-50/50 py-4 flex justify-between",children:[e.jsxs(l,{variant:"ghost",onClick:h,disabled:t===1,children:[e.jsx(R,{className:"w-4 h-4 mr-2"})," Back"]}),e.jsxs(l,{onClick:o,disabled:t===r.length,children:[t===r.length?"Complete Wizard":"Next Step"," ",e.jsx(T,{className:"w-4 h-4 ml-2"})]})]})]})]})})}function M({clientId:n}){const{data:s}=c.businessContinuity.getProgram.useQuery({clientId:n});return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Program Policy & Charter"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Every resilient organization starts with a clear policy. Define your continuity program scope and commitment."}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-100 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Current Status"}),s?e.jsxs(u,{className:"bg-emerald-500",children:["Active: ",s.programName]}):e.jsx(u,{variant:"secondary",children:"Not Initialized"})]})]}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-dashed border-slate-300 flex flex-col items-center justify-center text-center",children:[e.jsx(G,{className:"w-12 h-12 text-blue-400 mb-4"}),e.jsx("h4",{className:"font-semibold",children:"Need help defining scope?"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 max-w-[250px]",children:"The Governance module helps you set up teams, budgets, and compliance frameworks."}),e.jsx(l,{variant:"link",size:"sm",className:"mt-2",children:"Go to Governance Module"})]})]})})}function E({clientId:n}){const{data:s,refetch:i}=c.businessContinuity.processes.getProcessesWithBiaStatus.useQuery({clientId:n}),d=c.businessContinuity.generateBiaDraft.useMutation({onSuccess:()=>{j.success("BIA Assessment initialized"),i()}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Process Registry"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Register all core business functions and trigger impact assessments."})]}),e.jsxs(u,{variant:"outline",children:[(s==null?void 0:s.length)||0," Processes"]})]}),e.jsxs("div",{className:"grid gap-3 mt-4",children:[s==null?void 0:s.map(t=>{var m,r,o;return e.jsxs("div",{className:"p-4 border rounded-lg flex items-center justify-between bg-white hover:border-blue-200 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:x("w-10 h-10 rounded-full flex items-center justify-center font-bold text-xs",(m=t.criticalityTier)!=null&&m.includes("1")?"bg-red-100 text-red-600":(r=t.criticalityTier)!=null&&r.includes("2")?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"),children:((o=t.criticalityTier)==null?void 0:o.split(" ")[0])||"T?"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900",children:t.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.department||"General"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:t.hasBia?e.jsxs(u,{className:"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100 px-3 py-1",children:[e.jsx(p,{className:"w-3 h-3 mr-1.5"})," BIA ",t.biaStatus]}):e.jsxs(l,{size:"sm",variant:"outline",className:"opacity-0 group-hover:opacity-100 transition-opacity bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100",onClick:()=>d.mutate({processId:t.id,clientId:n}),disabled:d.isLoading,children:[d.isLoading?e.jsx(N,{className:"w-3 h-3 animate-spin mr-1.5"}):e.jsx(f,{className:"w-3 h-3 mr-1.5"}),"Assess BIA"]})})]},t.id)}),(!s||s.length===0)&&e.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg bg-slate-50/50",children:[e.jsx("p",{className:"text-muted-foreground italic",children:"No processes found in the registry."}),e.jsx(l,{variant:"outline",size:"sm",className:"mt-4",children:"Go to Process Registry"})]})]})]})}function F({clientId:n}){const{data:s}=c.businessContinuity.bia.list.useQuery({clientId:n});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Business Impact Analysis (BIA)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Determine MTPD and RTO/RPOs for each critical process."})]}),e.jsxs(u,{variant:"outline",children:[(s==null?void 0:s.filter(i=>i.status==="approved").length)||0," / ",(s==null?void 0:s.length)||0," Approved"]})]}),e.jsx("div",{className:"grid gap-3 mt-4",children:s==null?void 0:s.map(i=>e.jsxs("div",{className:"p-4 border rounded-lg flex items-center justify-between bg-white hover:border-amber-200 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-5 h-5 text-amber-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:i.title}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Process: ",i.processName]})]})]}),e.jsx(u,{className:x("px-3 py-1",i.status==="approved"?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"),children:i.status})]},i.id))})]})}function O({clientId:n}){const{data:s}=c.businessContinuity.strategies.list.useQuery({clientId:n});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recovery Strategies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"How will you recover? Define technology, people, and facility strategies to meet your RTO targets."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:s==null?void 0:s.slice(0,4).map(i=>e.jsxs("div",{className:"p-4 border rounded-lg hover:border-purple-200 hover:bg-purple-50/10 transition-colors",children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4 text-purple-500"})," ",i.title]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:i.description})]},i.id))})]})}function Q({clientId:n}){const{data:s}=c.businessContinuity.getDashboardMetrics.useQuery({clientId:n}),[i,d]=b.useState(null),[t,m]=b.useState(!1),r=c.businessContinuity.plans.create.useMutation({onSuccess:a=>{d(a[0].id),j.success("Recovery Plan finalized!")}}),o=c.businessContinuity.plans.exportDocx.useMutation({onSuccess:a=>{const g=document.createElement("a");g.href=`data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,${a.base64}`,g.download=a.filename,g.click(),j.success("Document exported successfully")}}),h=()=>{m(!0),r.mutate({clientId:n,title:`Comprehensive BCP - ${new Date().toLocaleDateString()}`,version:"1.0",status:"approved",content:"{}"})};return e.jsxs("div",{className:"space-y-8 text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto text-green-600 shadow-inner",children:r.isLoading?e.jsx(N,{className:"w-12 h-12 animate-spin"}):e.jsx(p,{className:"w-12 h-12"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Resilience Score: ",(s==null?void 0:s.readinessScore)||0,"%"]}),e.jsx("p",{className:"text-muted-foreground max-w-[500px] mx-auto",children:s!=null&&s.readinessScore&&s.readinessScore>70?"Your organization has a highly mature continuity profile. You are ready to generate your official BCP.":"Your continuity profile is still developing. You can generate a draft BCP now or continue refining your BIAs."})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-center mt-8",children:[i?e.jsx(l,{size:"lg",className:"bg-blue-600 hover:bg-blue-700",onClick:()=>o.mutate({id:i}),disabled:o.isLoading,children:o.isLoading?"Exporting...":"Download Official BCP (DOCX)"}):e.jsx(l,{size:"lg",className:"bg-green-600 hover:bg-green-700",onClick:h,disabled:r.isLoading,children:r.isLoading?"Finalizing...":"Finalize & Approve Plan"}),e.jsx(l,{size:"lg",variant:"outline",children:"View Plan Analytics"})]})]})}export{Be as default};
