import{M as q,j as e,h as se,L as x,v as K,U as H,I as F,F as L,S as Y,l as U,C as ne,m as re,r as I,k as V,c as _,x as oe,ax as ae,i as D,au as de,b as ce,t as B}from"./index-DOc7Nwb7.js";import{W as le}from"./WizardLayout--gDD5DNT.js";import{T as C}from"./textarea-BtxBxzdY.js";import{c as b}from"./utils-BC5CVi_C.js";import{R as M,a as P}from"./radio-group-BhirXgcC.js";import{I as J}from"./info-By5wLOUH.js";import{A as pe}from"./activity-B1F2IRm3.js";import{G as Z}from"./globe-BMGZmoaJ.js";import{S as me}from"./server-Dvm2PAz3.js";import{B as ue}from"./ban-TJUJ_p7U.js";import{U as ge}from"./user-check-gMd5S2aU.js";import{T as he}from"./terminal-DNh7vxOm.js";import{S as X}from"./scale-BCebIfgE.js";import{F as xe}from"./file-check-De1wUTh7.js";import{S as fe}from"./scroll-text-CmmtRUs3.js";import{N as be}from"./network-CgrL7DP_.js";import{C as $}from"./circle-play-B4Nb1F90.js";import{L as ye}from"./lock-czWF3qbC.js";import{B as ve}from"./building-C0cheRWa.js";import{B as we}from"./briefcase-BxorFA78.js";import{T as ee}from"./target-cfAj3L6j.js";import{T as je}from"./trophy-BQCkJfBy.js";import{S as Ae}from"./scroll-area-DPaNxEJD.js";import{C as Ne}from"./cpu-Dyg_8Jsq.js";import{S as R}from"./sparkles-CoQ80pK2.js";import{C as Se}from"./circle-check-C5kiwRoG.js";import{M as Ie}from"./index-utl_XIpZ.js";import{D as Q}from"./DashboardLayout-aHnUqq57.js";import{P as ke}from"./PageGuide-CPKKXXS6.js";import"./arrow-left-CpuUojG-.js";import"./shield-check-ETs8j4-d.js";import"./proxy-DIbepYjM.js";import"./save-CvVmWchr.js";import"./index-B9D6dsvY.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./send-FW7-3cjH.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./database-Bjtecw5f.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=q("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=q("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=q("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=q("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=q("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),j={ISO27001:{id:"ISO27001",name:"ISO 27001",description:"Information Security Management System",steps:{scope:{title:"Define ISMS Scope",subtitle:"Determine the boundaries of your Information Security Management System.",hints:{orgBoundaries:"Which business units, subsidiaries, or departments are included in the ISMS?",locations:"Physical locations where sensitive information is processed or stored.",technologies:"Key IT assets, cloud services, and networks within the ISMS boundary."}},stakeholders:{title:"ISMS Roles & Responsibilities",subtitle:"Identify the Security Committee and key ISMS owners."}},questionnaire:[{id:"section1",title:"Section 1: Context of the Organization (Clause 4)",description:"This section evaluates understanding of internal/external issues, interested parties, and the scope of the ISMS.",questions:[{id:"1.1",text:"Has the organization identified and documented internal and external issues that could affect the ISMS (e.g., business environment, technology trends, regulatory changes)?"},{id:"1.2",text:"Has the organization identified interested parties (e.g., customers, regulators, suppliers) and their information security requirements?"},{id:"1.3",text:"Is the scope of the ISMS clearly defined, documented, and considering interfaces/boundaries with external parties?"},{id:"1.4",text:"Has the ISMS been established in alignment with the organization's context and scope?"}]},{id:"section2",title:"Section 2: Leadership (Clause 5)",description:"This section checks top management's commitment and roles.",questions:[{id:"2.1",text:"Has top management demonstrated leadership by establishing an information security policy?"},{id:"2.2",text:"Is the policy communicated within the organization and available to interested parties?"},{id:"2.3",text:"Have roles, responsibilities, and authorities for information security been assigned and communicated?"},{id:"2.4",text:"Does top management ensure the ISMS is integrated into business processes and supports its objectives?"}]},{id:"section3",title:"Section 3: Planning (Clause 6)",description:"This covers risk assessment, treatment, and objectives.",questions:[{id:"3.1",text:"Has a process for information security risk assessment been defined and implemented?"},{id:"3.2",text:"Have information security risks been identified, analyzed, and evaluated (e.g., using a risk register)?"},{id:"3.3",text:"Is there a risk treatment plan, including selection of controls from Annex A or others?"},{id:"3.4",text:"Have measurable information security objectives been established, documented, and aligned with the policy?"},{id:"3.5",text:"Are changes to the ISMS planned and controlled?"}]},{id:"section4",title:"Section 4: Support (Clause 7)",description:"This assesses resources, competence, awareness, communication, and documentation.",questions:[{id:"4.1",text:"Are sufficient resources (e.g., personnel, budget, tools) provided for the ISMS?"},{id:"4.2",text:"Have competencies for ISMS roles been determined, and is there evidence of training/qualifications?"},{id:"4.3",text:"Is there an awareness program ensuring all personnel understand the policy, risks, and their contributions?"},{id:"4.4",text:"Are internal and external communication processes defined for information security?"},{id:"4.5",text:"Is ISMS documentation controlled (e.g., creation, review, access), including the Statement of Applicability (SoA)?"}]},{id:"section5",title:"Section 5: Operation (Clause 8)",description:"This evaluates operational planning and control, including risk treatment.",questions:[{id:"5.1",text:"Are operational processes planned and controlled to meet ISMS requirements?"},{id:"5.2",text:"Has the risk treatment plan been implemented, with controls in place?"},{id:"5.3",text:"Are outsourced processes (e.g., cloud services) controlled for information security?"}]},{id:"section6",title:"Section 6: Performance Evaluation (Clause 9)",description:"This covers monitoring, measurement, analysis, internal audit, and management review.",questions:[{id:"6.1",text:"Are processes in place to monitor, measure, analyze, and evaluate ISMS performance (e.g., KPIs, metrics)?"},{id:"6.2",text:"Is an internal audit program established, with audits conducted at planned intervals?"},{id:"6.3",text:"Does top management conduct regular reviews of the ISMS, with documented outputs?"}]},{id:"section7",title:"Section 7: Improvement (Clause 10)",description:"This assesses nonconformity handling and continual improvement.",questions:[{id:"7.1",text:"Are processes defined for managing nonconformities and corrective actions?"},{id:"7.2",text:"Is the ISMS continually improved based on performance evaluation and changes?"}]},{id:"section8.1",title:"Section 8.1: Organizational Controls (A.5)",description:"Annex A Organizational Controls.",questions:[{id:"8.1.1",text:"Is there a set of information security policies approved by management and reviewed regularly?"},{id:"8.1.2",text:"Are responsibilities for information security segregated (e.g., no conflicts of interest)?"},{id:"8.1.3",text:"Are contacts with authorities and special interest groups maintained?"},{id:"8.1.4",text:"Is information security addressed in project management?"},{id:"8.1.5",text:"Are mobile device and teleworking policies in place?"}]},{id:"section8.2",title:"Section 8.2: People Controls (A.6-A.8, partial)",description:"Annex A People Controls.",questions:[{id:"8.2.1",text:"Are background checks performed during recruitment?"},{id:"8.2.2",text:"Are terms of employment including confidentiality agreements?"},{id:"8.2.3",text:"Is there ongoing information security awareness, education, and training?"},{id:"8.2.4",text:"Is there a disciplinary process for security breaches?"},{id:"8.2.5",text:"Are responsibilities defined for termination or change of employment?"},{id:"8.2.6",text:"Are confidentiality or non-disclosure agreements in place where needed?"},{id:"8.2.7",text:"Is remote working secured (e.g., VPN, secure connections)?"},{id:"8.2.8",text:"Is there a process for reporting information security events?"}]},{id:"section8.3",title:"Section 8.3: Physical Controls (A.7)",description:"Annex A Physical Controls.",questions:[{id:"8.3.1",text:"Are physical perimeters secured (e.g., fences, locks)?"},{id:"8.3.2",text:"Is physical entry controlled (e.g., badges, logs)?"},{id:"8.3.3",text:"Are offices, rooms, and facilities protected?"},{id:"8.3.4",text:"Is equipment protected from physical and environmental threats?"},{id:"8.3.5",text:"Are utilities and cabling secured?"},{id:"8.3.6",text:"Is equipment maintained regularly?"},{id:"8.3.7",text:"Is removal of assets controlled?"},{id:"8.3.8",text:"Is secure disposal or reuse of equipment ensured?"},{id:"8.3.9",text:"Are unattended user equipment policies enforced (e.g., screen locks)?"},{id:"8.3.10",text:"Is there a clear desk and clear screen policy?"}]},{id:"section8.4",title:"Section 8.4: Technological Controls (A.8, partial)",description:"Annex A Technological Controls.",questions:[{id:"8.4.1",text:"Is information classified based on sensitivity?"},{id:"8.4.2",text:"Are media handling procedures in place (e.g., labeling, transport)?"},{id:"8.4.3",text:"Are access controls implemented (e.g., user IDs, least privilege)?"},{id:"8.4.4",text:"Is user registration and de-registration managed?"},{id:"8.4.5",text:"Are user access rights reviewed regularly?"},{id:"8.4.6",text:"Is privileged access restricted and monitored?"},{id:"8.4.7",text:"Is access to source code controlled?"},{id:"8.4.8",text:"Is authentication information managed securely (e.g., passwords)?"},{id:"8.4.9",text:"Is cryptography used where necessary (e.g., encryption policies)?"},{id:"8.4.10",text:"Are networks segregated and secured (e.g., firewalls, DMZs)?"},{id:"8.4.11",text:"Is malware protection in place (e.g., antivirus)?"},{id:"8.4.12",text:"Are vulnerabilities managed (e.g., scanning, patching)?"},{id:"8.4.13",text:"Is logging and monitoring implemented for security events?"},{id:"8.4.14",text:"Is clock synchronization ensured for logs?"},{id:"8.4.15",text:"Are installation of software on operational systems controlled?"},{id:"8.4.16",text:"Is information backup performed regularly and tested?"},{id:"8.4.17",text:"Is event logging protected from tampering?"},{id:"8.4.18",text:"Are administrator and operator logs reviewed?"},{id:"8.4.19",text:"Are systems protected during testing?"},{id:"8.4.20",text:"Is change management controlled?"},{id:"8.4.21",text:"Is capacity managed to ensure availability?"},{id:"8.4.22",text:"Are development, test, and production environments separated?"}]},{id:"section8.5",title:"Section 8.5: Supplier Relationships (A.5, partial)",description:"Annex A Supplier Relationship Controls.",questions:[{id:"8.5.1",text:"Are supplier agreements including security requirements?"},{id:"8.5.2",text:"Is supplier service delivery monitored?"},{id:"8.5.3",text:"Are changes to supplier services managed?"}]},{id:"section8.6",title:"Section 8.6: Incident Management (A.16)",description:"Annex A Incident Management Controls.",questions:[{id:"8.6.1",text:"Are responsibilities for incident management defined?"},{id:"8.6.2",text:"Is there a process for reporting incidents and weaknesses?"},{id:"8.6.3",text:"Are incidents assessed and responded to?"},{id:"8.6.4",text:"Is evidence collected for incidents?"},{id:"8.6.5",text:"Are lessons learned from incidents?"}]},{id:"section8.7",title:"Section 8.7: Business Continuity (A.17)",description:"Annex A Business Continuity Controls.",questions:[{id:"8.7.1",text:"Is information security continuity planned?"},{id:"8.7.2",text:"Are redundancy measures implemented?"},{id:"8.7.3",text:"Are continuity plans verified and reviewed?"}]},{id:"section8.8",title:"Section 8.8: Compliance (A.18)",description:"Annex A Compliance Controls.",questions:[{id:"8.8.1",text:"Are legal, regulatory, and contractual requirements identified?"},{id:"8.8.2",text:"Is intellectual property protected?"},{id:"8.8.3",text:"Are records protected?"},{id:"8.8.4",text:"Is privacy and personal data protected?"},{id:"8.8.5",text:"Are independent reviews of information security conducted?"},{id:"8.8.6",text:"Is compliance with policies and standards checked?"},{id:"8.8.7",text:"Are technical compliance reviews performed?"}]}]},SOC2:{id:"SOC2",name:"SOC 2",description:"Service Organization Control",steps:{scope:{title:"Define Service Description",subtitle:"Outline the services provided to user entities and the systems supporting them.",hints:{orgBoundaries:"Describe the 'System' (services provided) that will be audited.",locations:"Locations hosting the infrastructure supporting the service.",technologies:"Infrastructure, software, people, data, and procedures."},extraFields:[{type:"soc2_tsc",label:"Trust Services Criteria",options:[{value:"security",label:"Security (Common Criteria)",description:"Required for all SOC 2 reports. Protection against unauthorized access."},{value:"availability",label:"Availability",description:"System is available for operation and use as committed or agreed."},{value:"confidentiality",label:"Confidentiality",description:"Information designated as confidential is protected."},{value:"integrity",label:"Processing Integrity",description:"System processing is complete, valid, accurate, timely, and authorized."},{value:"privacy",label:"Privacy",description:"Personal information is collected, used, retained, disclosed, and disposed of appropriately."}]}]},stakeholders:{title:"Control Owners",subtitle:"Who is responsible for the design and operation of controls?"}},questionnaire:[{id:"cc1",title:"Section 1: Control Environment (CC1.0)",description:"This section evaluates commitment to integrity, ethics, board oversight, and accountability.",questions:[{id:"1.1",text:"Does the organization demonstrate a commitment to integrity and ethical values through policies and practices?"},{id:"1.2",text:"Is there independent oversight from a board or equivalent body?"},{id:"1.3",text:"Has management established structures, reporting lines, and authorities to achieve objectives?"},{id:"1.4",text:"Does the organization hold individuals accountable for their internal control responsibilities?"},{id:"1.5",text:"Are competencies for roles defined, and is there evidence of attracting, developing, and retaining competent personnel?"}]},{id:"cc2",title:"Section 2: Communication and Information (CC2.0)",description:"This covers internal/external communication and quality of information.",questions:[{id:"2.1",text:"Is relevant, quality information identified, captured, and used to support internal controls?"},{id:"2.2",text:"Are internal communications effective in enabling personnel to carry out responsibilities?"},{id:"2.3",text:"Are external communications with stakeholders (e.g., customers, regulators) effective and timely?"}]},{id:"cc3",title:"Section 3: Risk Assessment (CC3.0)",description:"This assesses risk identification, analysis, and response.",questions:[{id:"3.1",text:"Are objectives specified with sufficient clarity to enable risk identification?"},{id:"3.2",text:"Does the organization identify risks to achieving objectives, including fraud risks?"},{id:"3.3",text:"Are risks analyzed for potential impact on objectives?"},{id:"3.4",text:"Does the organization assess and respond to changes that could affect the control system?"}]},{id:"cc4",title:"Section 4: Monitoring Activities (CC4.0)",description:"This evaluates ongoing evaluations and deficiency remediation.",questions:[{id:"4.1",text:"Are ongoing and/or separate evaluations conducted to ascertain control effectiveness?"},{id:"4.2",text:"Are internal control deficiencies evaluated and communicated timely to responsible parties?"}]},{id:"cc5",title:"Section 5: Control Activities (CC5.0)",description:"This covers selection, development, and deployment of controls.",questions:[{id:"5.1",text:"Are control activities selected and developed to mitigate risks?"},{id:"5.2",text:"Are general IT controls over technology deployed and effective?"},{id:"5.3",text:"Are control activities implemented through policies and procedures?"}]},{id:"cc6",title:"Section 6: Logical and Physical Access Controls (CC6.0)",description:"This focuses on access to systems and data.",questions:[{id:"6.1",text:"Are logical access controls implemented to protect systems and data (e.g., authentication, authorization)?"},{id:"6.2",text:"Is user access provisioned, modified, and revoked appropriately?"},{id:"6.3",text:"Are privileged access rights restricted and monitored?"},{id:"6.4",text:"Is physical access to facilities and assets controlled (e.g., badges, logs)?"},{id:"6.5",text:"Are assets protected from environmental threats and unauthorized removal?"},{id:"6.6",text:"Is data-at-rest and in-transit protected (e.g., encryption)?"},{id:"6.7",text:"Are endpoints and removable media secured?"},{id:"6.8",text:"Are networks configured to prevent and detect unauthorized access?"}]},{id:"cc7",title:"Section 7: System Operations (CC7.0)",description:"This addresses operational management and incident response.",questions:[{id:"7.1",text:"Are anomalies and potential security events detected and analyzed?"},{id:"7.2",text:"Is there an incident response process, including assessment and mitigation?"},{id:"7.3",text:"Is system continuity managed through backups, recovery plans, and testing?"},{id:"7.4",text:"Are capacity and performance monitored to ensure availability?"},{id:"7.5",text:"Are environmental protections and maintenance in place for infrastructure?"}]},{id:"cc8",title:"Section 8: Change Management (CC8.0)",description:"This covers controlled changes to systems.",questions:[{id:"8.1",text:"Are changes authorized, designed, developed, tested, and deployed in a controlled manner?"}]},{id:"cc9",title:"Section 9: Risk Mitigation (CC9.0)",description:"This evaluates vendor and business partner risks.",questions:[{id:"9.1",text:"Are risks from vendors and partners identified, assessed, and mitigated?"},{id:"9.2",text:"Are vendor performance and compliance monitored?"}]},{id:"a1",title:"Section 10: Additional Criteria for Availability (A1.0)",description:"Apply if Availability TSC is in scope.",questions:[{id:"10.1",text:"Is current processing capacity monitored and projected?"},{id:"10.2",text:"Are recovery plans in place and tested for system failures?"},{id:"10.3",text:"Are environmental protections implemented for availability?"}]},{id:"pi1",title:"Section 11: Additional Criteria for Processing Integrity (PI1.0)",description:"Apply if Processing Integrity TSC is in scope.",questions:[{id:"11.1",text:"Are system inputs complete, accurate, and timely?"},{id:"11.2",text:"Is data processed completely, accurately, and timely?"},{id:"11.3",text:"Are system outputs complete, accurate, and distributed appropriately?"},{id:"11.4",text:"Are modifications to data controlled to maintain integrity?"},{id:"11.5",text:"Is system processing monitored for integrity?"}]},{id:"c1",title:"Section 12: Additional Criteria for Confidentiality (C1.0)",description:"Apply if Confidentiality TSC is in scope.",questions:[{id:"12.1",text:"Is confidential information identified and protected during its lifecycle?"},{id:"12.2",text:"Is confidential information disposed of securely when no longer needed?"}]},{id:"p1",title:"Section 13: Additional Criteria for Privacy (P1.0 - P8.0)",description:"Apply if Privacy TSC is in scope. This is more extensive; summarized here.",questions:[{id:"13.1",text:"Is personal information collected with notice and consent? (P2.0)"},{id:"13.2",text:"Are choices provided for collection, use, and disclosure of personal info? (P3.0)"},{id:"13.3",text:"Is personal information used consistent with commitments? (P4.0)"},{id:"13.4",text:"Is collection of personal information limited to what's necessary? (P5.0)"},{id:"13.5",text:"Are quality and accuracy of personal information maintained? (P6.0)"},{id:"13.6",text:"Is access to personal information provided for review/correction? (P7.0)"},{id:"13.7",text:"Is personal information secured and its integrity protected? (P8.0)"}]}]},HIPAA:{id:"HIPAA",name:"HIPAA",description:"Health Insurance Portability and Accountability Act",steps:{scope:{title:"ePHI Environment Scope",subtitle:"Identify where Electronic Protected Health Information (ePHI) resides.",hints:{orgBoundaries:"Are you a Covered Entity or a Business Associate?",locations:"Facilities where patient data is accessed or stored.",technologies:"EHR systems, medical devices, workstations, and transmission networks."},extraFields:[{type:"hipaa_entity_type",label:"Organization Type",options:[{value:"covered_entity",label:"Covered Entity",description:"Healthcare providers, plans, and clearinghouses."},{value:"business_associate",label:"Business Associate",description:"Vendors handling PHI on behalf of a covered entity."}]}]},stakeholders:{title:"HIPAA Privacy & Security Officers",subtitle:"Designate your required Privacy Officer and Security Officer."},documentation:{title:"HIPAA Compliance Documentation",subtitle:"Identify core administrative, physical, and technical safeguards documentation.",items:[{id:"SRA",label:"Security Risk Analysis (SRA)",description:"Mandatory enterprise-wide assessment of ePHI risks (§164.308(a)(1))."},{id:"NPP",label:"Notice of Privacy Practices (NPP)",description:"Public disclosure of how health information is used and shared."},{id:"BAA_Register",label:"Business Associate Agreements (BAAs)",description:"Contracts with vendors handling PHI/ePHI."},{id:"Risk_Management_Plan",label:"Risk Management Plan",description:"Formal plan to mitigate risks identified in the SRA."},{id:"Sanctions_Policy",label:"Workforce Sanctions Policy",description:"Disciplinary procedures for HIPAA violations."},{id:"Contingency_Plan",label:"Contingency & DR Plan",description:"Data backup and emergency recovery procedures (§164.308(a)(7))."},{id:"Breach_Notification",label:"Breach Notification Procedures",description:"Workflow for identifying and reporting breaches of unsecured PHI."}]}},questionnaire:[{id:"hipaa_gen",title:"Section 1: General Organizational Requirements",description:"This section evaluates general HIPAA compliance readiness, including roles and training.",questions:[{id:"1.1",text:"Has your organization determined if it is a Covered Entity (health plan, clearinghouse, provider transmitting ePHI) or Business Associate?"},{id:"1.2",text:"Has a HIPAA Privacy Officer and Security Officer been designated with clear responsibilities?"},{id:"1.3",text:"Are workforce members (employees, contractors) trained annually on HIPAA policies, PHI handling, and breach reporting?"},{id:"1.4",text:"Is there a sanctions policy for workforce violations of HIPAA?"},{id:"1.5",text:"Are Business Associate Agreements (BAAs) in place with all vendors handling PHI/ePHI, including required provisions?"}]},{id:"hipaa_privacy",title:"Section 2: Privacy Rule Requirements (Uses and Disclosures of PHI)",description:"This covers the core Privacy Rule requirements for handling PHI.",questions:[{id:"2.1",text:"Is PHI used/disclosed only for treatment, payment, healthcare operations (TPO), or other permitted purposes without authorization?"},{id:"2.2",text:"Is the Minimum Necessary standard applied to all uses, disclosures, and requests for PHI?"},{id:"2.3",text:"Is a Notice of Privacy Practices (NPP) provided to individuals, posted, and updated (including any 2026 changes for SUD records or other)?"},{id:"2.4",text:"Are individuals' rights supported: access to PHI, amendment, accounting of disclosures, restrictions, confidential communications?"},{id:"2.5",text:"Are authorizations obtained for non-permitted uses/disclosures (e.g., marketing, sale of PHI)?"},{id:"2.6",text:"Are uses/disclosures for public health, research, law enforcement, etc., handled per permitted exceptions?"},{id:"2.7",text:"Is PHI de-identified when possible for non-regulated uses?"}]},{id:"hipaa_admin",title:"Section 3: Security Rule – Administrative Safeguards (§164.308)",description:"This assesses the administrative side of the Security Rule.",questions:[{id:"3.1",text:"Has a comprehensive, documented Security Risk Analysis (SRA) been conducted (enterprise-wide, updated periodically, e.g., annually)?"},{id:"3.2",text:"Is there a risk management process to address identified risks/vulnerabilities (e.g., prioritized remediation plan)?"},{id:"3.3",text:"Are workforce security measures in place (e.g., clearance procedures, termination processes)?"},{id:"3.4",text:"Is information access management implemented (e.g., access authorization, establishment/modification)?"},{id:"3.5",text:"Is security awareness and training provided (e.g., reminders, malicious software protection, log-in monitoring, password management)?"},{id:"3.6",text:"Are security incident procedures defined (response, reporting)?"},{id:"3.7",text:"Is a contingency plan in place (data backup, disaster recovery, emergency mode, testing/revision)?"},{id:"3.8",text:"Is periodic technical/operational evaluation of security measures performed?"}]},{id:"hipaa_physical",title:"Section 4: Security Rule – Physical Safeguards (§164.310)",description:"This evaluates physical protections for systems and facilities.",questions:[{id:"4.1",text:"Are facility access controls implemented (e.g., contingency operations, security plan, access validation, maintenance records)?"},{id:"4.2",text:"Are workstation use policies enforced (e.g., appropriate locations for viewing PHI)?"},{id:"4.3",text:"Is workstation security in place (e.g., physical protections against unauthorized access)?"},{id:"4.4",text:"Are device/media controls implemented (disposal, re-use, accountability, backup/storage)?"}]},{id:"hipaa_technical",title:"Section 5: Security Rule – Technical Safeguards (§164.312)",description:"This assesses technical controls for ePHI.",questions:[{id:"5.1",text:"Are access controls in place (unique user ID, emergency access, automatic logoff, encryption/decryption where appropriate)?"},{id:"5.2",text:"Is audit control implemented (logging/monitoring system activity)?"},{id:"5.3",text:"Are integrity mechanisms for ePHI in place (e.g., authentication of records)?"},{id:"5.4",text:"Is person/entity authentication required (e.g., passwords, MFA as best practice/proposed requirement)?"},{id:"5.5",text:"Is transmission security ensured (integrity controls, encryption for data in transit)?"}]},{id:"hipaa_breach",title:"Section 6: Breach Notification Rule (§164.400–414)",description:"This evaluates readiness for detecting and reporting breaches.",questions:[{id:"6.1",text:"Is there a process to detect, respond to, and investigate potential breaches of unsecured PHI?"},{id:"6.2",text:"Are breaches analyzed for risk of harm (including to determine if notification required)?"},{id:"6.3",text:"Are notifications made to affected individuals, HHS (via portal if >500), and media (if applicable) within required timelines (60 days max)?"},{id:"6.4",text:"Do Business Associates report breaches to the Covered Entity without unreasonable delay?"}]},{id:"hipaa_2026",title:"Section 7: Additional/ Emerging Requirements (2026 Considerations)",description:"This covers new and updated requirements for 2026.",questions:[{id:"7.1",text:"Are policies/procedures written, reviewed, tested, and updated regularly (per proposed Security Rule updates)?"},{id:"7.2",text:"Is encryption at rest and in transit implemented for ePHI (addressable but strongly recommended)?"},{id:"7.3",text:"Is multi-factor authentication (MFA) required for systems accessing ePHI?"},{id:"7.4",text:"Are special considerations in place for sensitive data (e.g., reproductive health, SUD records under aligned Part 2 rules)?"},{id:"7.5",text:"Is vendor/third-party risk monitored, including BAAs and periodic assessments?"}]}]},GDPR:{id:"GDPR",name:"GDPR",description:"General Data Protection Regulation",steps:{scope:{title:"Data Processing Scope",subtitle:"Map the flow of personal data of EU residents.",hints:{orgBoundaries:"Which entities process personal data of EU subjects?",locations:"Data processing locations (within and outside EEA).",technologies:"Systems used for collection, storage, and processing of personal data."},extraFields:[{type:"gdpr_role",label:"Data Processing Role",options:[{value:"controller",label:"Data Controller",description:"Determines purposes and means of processing."},{value:"processor",label:"Data Processor",description:"Processes data on behalf of a controller."},{value:"joint",label:"Joint Controller",description:"Determines purpose/means jointly with others."}]}]},stakeholders:{title:"DPO & Representatives",subtitle:"Appoint a Data Protection Officer (if required) and EU Representative.",roles:[{id:"dpo",label:"Data Protection Officer (DPO)",description:"Mandatory for large-scale processing of special categories or public bodies."},{id:"eu_rep",label:"EU Representative",description:"Required for non-EU entities targeting EU subjects (Art. 27)."},{id:"uk_rep",label:"UK Representative",description:"Required for non-UK entities targeting UK subjects post-Brexit."},{id:"security_lead",label:"IT Security Lead",description:"Responsible for implementing technical security measures (Art. 32)."},{id:"legal_lead",label:"Privacy/Legal Counsel",description:"Manages privacy notices, DPAs, and Art. 30 records."}]},documentation:{title:"GDPR Compliance Documentation",subtitle:"Collect mandatory privacy artifacts required for Art. 30 and transparency.",items:[{id:"ROPA",label:"Records of Processing Activities (ROPA)",description:"Mandatory log of all data processing per Art. 30."},{id:"Privacy Notice",label:"External Privacy Notice",description:"Public-facing document detailing data subject rights."},{id:"Cookie Policy",label:"Cookie Policy & Notice",description:"Notice for tracking technologies and legal basis."},{id:"DPIA Methodology",label:"DPIA Methodology/Reports",description:"Framework for assessing high-risk processing (Art. 35)."},{id:"DPA Templates",label:"DPA/Vendor Templates",description:"Standard templates for Art. 28 processor agreements."},{id:"Subject Rights Procedure",label:"Subject Access Request (SAR) Procedure",description:"Internal workflow for handling Art. 12-22 requests."},{id:"Data Retention Policy",label:"Data Retention Schedule",description:"Specific timelines for data deletion per Art. 5(1)(e)."}]}},questionnaire:[{id:"gdpr_gen",title:"Section 1: General & Accountability Requirements",description:"This section evaluates general GDPR readiness, roles, and governance.",questions:[{id:"1.1",text:"Has your organization determined its role (controller, joint controller, processor) and that of third parties for all personal data processing?"},{id:"1.2",text:"Has a Data Protection Officer (DPO) been appointed if required (e.g., large-scale processing of special categories, public authority, systematic monitoring)? If not required, is privacy accountability assigned?"},{id:"1.3",text:"Is there a documented privacy governance framework (policies, procedures, training program) with regular reviews?"},{id:"1.4",text:"Are workforce members trained on GDPR obligations, data protection principles, and handling personal data (initial + annual refreshers)?"},{id:"1.5",text:"Is there a process for maintaining and updating Records of Processing Activities (ROPA/Art. 30) – including purposes, categories of data/subjects, recipients, transfers, retention, security measures?"}]},{id:"gdpr_principles",title:"Section 2: Data Protection Principles (Art. 5)",description:"This covers the core principles of data protection under GDPR.",questions:[{id:"2.1",text:"Is personal data processed lawfully, fairly, and transparently?"},{id:"2.2",text:"Is processing limited to specified, explicit, legitimate purposes (purpose limitation)?"},{id:"2.3",text:"Is only adequate, relevant, and limited personal data collected (data minimisation)?"},{id:"2.4",text:"Is personal data accurate and kept up to date where necessary?"},{id:"2.5",text:"Is personal data retained only as long as necessary for the purposes (storage limitation), with defined retention schedules and deletion processes?"},{id:"2.6",text:"Are appropriate technical and organisational measures implemented to ensure integrity and confidentiality (security principle), including pseudonymisation/encryption where appropriate?"},{id:"2.7",text:"Is accountability demonstrated through documentation, audits, and evidence of compliance efforts?"}]},{id:"gdpr_lawful",title:"Section 3: Lawful Basis, Consent & Transparency",description:"This evaluates identify and documenting lawful bases for processing.",questions:[{id:"3.1",text:"Has a lawful basis (Art. 6) been identified and documented for each processing activity (e.g., consent, contract, legitimate interests)?"},{id:"3.2",text:"If consent is relied upon, is it freely given, specific, informed, unambiguous, easy to withdraw, and granular (with proof of consent)?"},{id:"3.3",text:"For special category data (Art. 9) or criminal convictions, is an additional condition met and documented?"},{id:"3.4",text:"Are privacy notices provided at collection (or soon after), containing required information (identity, purposes, basis, rights, recipients, transfers, etc.) in clear, concise language?"},{id:"3.5",text:"For legitimate interests basis, has a Legitimate Interests Assessment (LIA) been conducted and balancing test documented?"}]},{id:"gdpr_rights",title:"Section 4: Data Subject Rights (Arts. 12–23)",description:"This addresses the handling of data subject requests.",questions:[{id:"4.1",text:"Is there a process to handle data subject requests (access, rectification, erasure, restriction, portability, objection, automated decision-making) within one month (extendable)?"},{id:"4.2",text:"Are verification mechanisms in place for requester identity, and are requests logged/tracked?"},{id:"4.3",text:'For right to erasure ("right to be forgotten"), is there a process to identify and delete data (including backups, third parties)?'},{id:"4.4",text:"Is automated individual decision-making (including profiling) restricted, with safeguards (human intervention, right to contest)?"}]},{id:"gdpr_design",title:"Section 5: Data Protection by Design & Default + DPIA (Arts. 25, 35)",description:"This evaluates proactive privacy measures and impact assessments.",questions:[{id:"5.1",text:"Is privacy by design and by default embedded in processes, products, and services (e.g., minimal data collection, default privacy settings)?"},{id:"5.2",text:"Are Data Protection Impact Assessments (DPIAs) conducted for high-risk processing (systematic monitoring, large-scale special data, innovative tech, etc.)?"},{id:"5.3",text:"Are prior consultations with supervisory authority conducted if residual high risk remains after DPIA?"}]},{id:"gdpr_sec_breach",title:"Section 6: Security & Breach Notification (Arts. 32–34)",description:"This assesses technical/organisational security and breach handling.",questions:[{id:"6.1",text:"Are appropriate technical/organisational measures implemented (risk-based: pseudonymisation, encryption, resilience, restore capability, testing)?"},{id:"6.2",text:"Is there a process to detect, report, and document personal data breaches (72-hour notification to supervisory authority if risk to rights/freedoms, unless low risk)?"},{id:"6.3",text:"Are data subjects notified of breaches when high risk exists (without undue delay)?"}]},{id:"gdpr_third_party",title:"Section 7: Processor & Third-Party Management (Arts. 28–29)",description:"This evaluates management of processors and third parties.",questions:[{id:"7.1",text:"Are Data Processing Agreements (DPAs) in place with all processors, containing mandatory clauses (instructions, security, sub-processing approval, audits, etc.)?"},{id:"7.2",text:"Are processors selected based on GDPR compliance guarantees, with ongoing monitoring?"}]},{id:"gdpr_transfers",title:"Section 8: International Data Transfers (Chapter V)",description:"This assesses safeguards for cross-border data transfers.",questions:[{id:"8.1",text:"For transfers outside EEA (or adequate countries), are safeguards in place (e.g., adequacy decision, SCCs 2021, BCRs, TIA for US tools post-Schrems II)?"},{id:"8.2",text:"Are supplementary measures documented for transfers to assess and mitigate risks (e.g., encryption, pseudonymisation)?"}]},{id:"gdpr_accountability",title:"Section 9: Additional/ Accountability Tools",description:"This covers additional tools for demonstrating GDR compliance.",questions:[{id:"9.1",text:"Are codes of conduct or certifications used where appropriate to demonstrate compliance?"},{id:"9.2",text:"Is there a process for regular internal/ external audits or reviews of GDPR compliance?"},{id:"9.3",text:"Are data flows mapped (including vendors, tools, cloud services) and risks from emerging tech (e.g., AI) assessed?"}]}]},NISTCSF:{id:"NISTCSF",name:"NIST CSF",description:"NIST Cybersecurity Framework",steps:{scope:{title:"Organizational Profile Scope",subtitle:"Define the critical infrastructure and business objectives.",hints:{orgBoundaries:"Critical services and assets to be protected.",locations:"Physical and logical asset locations.",technologies:"IT and OT (Operational Technology) systems."},extraFields:[{type:"nist_tier",label:"Target Implementation Tier",options:[{value:"tier1",label:"Tier 1: Partial",description:"Ad-hoc risk management."},{value:"tier2",label:"Tier 2: Risk Informed",description:"Approved but informal practices."},{value:"tier3",label:"Tier 3: Repeatable",description:"Formal, updated policies."},{value:"tier4",label:"Tier 4: Adaptive",description:"Continuous improvement and adaptation."}]}]},stakeholders:{title:"Risk Management Team",subtitle:"Identify owners for Identify, Protect, Detect, Respond, Recover functions."}},questionnaire:[{id:"nist_gv",title:"Section 1: GOVERN (GV)",description:"This section addresses organizational context, risk management strategy, policies, and oversight.",questions:[{id:"1.1",text:"Does the organization's cybersecurity strategy align with its overall business goals and objectives?"},{id:"1.2",text:"Is an executive or specific individual formally designated and accountable for managing cyber risk?"},{id:"1.3",text:"Are cybersecurity policies and procedures formally documented, approved, and communicated?"},{id:"1.4",text:"Are roles, responsibilities, and authorities for cybersecurity clearly defined and assigned?"},{id:"1.5",text:"Is there a process for managing cybersecurity supply chain risks associated with third parties?"},{id:"1.6",text:"Does the organization have a method to measure and report on the performance of its cybersecurity program?"}]},{id:"nist_id",title:"Section 2: IDENTIFY (ID)",description:"This focuses on understanding assets, risks, and impact on business objectives.",questions:[{id:"2.1",text:"Does the organization maintain an up-to-date inventory of all hardware, software, and data assets?"},{id:"2.2",text:"Is the criticality of each asset documented based on its importance to business operations?"},{id:"2.3",text:"Are potential threats and vulnerabilities associated with assets regularly identified and documented?"},{id:"2.4",text:"Has the organization conducted a Business Impact Analysis (BIA) to identify critical systems?"},{id:"2.5",text:"Are cybersecurity risk assessments conducted regularly using a consistent methodology?"}]},{id:"nist_pr",title:"Section 3: PROTECT (PR)",description:"This outlines safeguards implemented to limit the impact of potential cybersecurity events.",questions:[{id:"3.1",text:"Are robust access controls, including Multi-Factor Authentication (MFA), implemented for critical systems?"},{id:"3.2",text:"Does the organization provide regular security awareness training to all personnel?"},{id:"3.3",text:"Are data encryption and Data Loss Prevention (DLP) measures effectively deployed?"},{id:"3.4",text:"Are all systems and software regularly patched to address known vulnerabilities?"},{id:"3.5",text:"Are protective technologies like firewalls and EDR solutions utilized and monitored?"},{id:"3.6",text:"Are backups performed regularly and stored securely (offsite/immutable)?"}]},{id:"nist_de",title:"Section 4: DETECT (DE)",description:"This focuses on discovering possible cybersecurity attacks and compromises timely.",questions:[{id:"4.1",text:"Are there established processes for the timely detection of anomalies and security events?"},{id:"4.2",text:"Does the organization use continuous monitoring and automated detection tools?"},{id:"4.3",text:"Are detection processes regularly tested and evaluated for effectiveness?"},{id:"4.4",text:"Is information about detected events promptly communicated to the response team?"}]},{id:"nist_rs",title:"Section 5: RESPOND (RS)",description:"This details actions taken once an incident is detected to contain its effects.",questions:[{id:"5.1",text:"Does the organization have a documented and regularly updated Incident Response Plan (IRP)?"},{id:"5.2",text:"Are incidents formally tracked, documented, and analyzed (root cause analysis)?"},{id:"5.3",text:"Are lessons learned from past incidents incorporated into procedures and training?"},{id:"5.4",text:"Are clear communication protocols in place for internal and external stakeholders during an incident?"}]},{id:"nist_rc",title:"Section 6: RECOVER (RC)",description:"This supports restoration of assets and operations affected by a cybersecurity event.",questions:[{id:"6.1",text:"Are recovery processes established to ensure timely restoration of affected systems?"},{id:"6.2",text:"Are the integrity and reliability of backups verified before restoration efforts begin?"},{id:"6.3",text:"Are clear criteria established for when operations are considered fully restored?"},{id:"6.4",text:"Is there a plan for communicating recovery status to stakeholders?"}]}]}};function Te({data:t,onChange:o,standardId:u}){const m=j[u]||j.ISO27001,{hints:p,extraFields:c}=m.steps.scope,h=(i,s)=>{o({...t,[i]:s})};return e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500 fade-in",children:[e.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-lg p-4 flex gap-3 text-indigo-900 mb-6",children:[e.jsx(J,{className:"h-5 w-5 shrink-0 text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Why this matters"}),e.jsxs("p",{className:"opacity-90 leading-relaxed",children:['Defining your scope accurately prevents "scope creep" during the audit. Be specific about what is ',e.jsx("span",{className:"font-semibold",children:"in"})," and what is ",e.jsx("span",{className:"font-semibold",children:"out"}),"."]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg group-hover:bg-indigo-100 transition-colors",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx(x,{className:"text-base font-semibold text-slate-800 cursor-pointer",children:"Organizational Boundaries"})]}),e.jsx(C,{placeholder:"e.g., Entire Organization, Product Engineering Unit...",value:(t==null?void 0:t.orgBoundaries)||"",onChange:i=>o({...t,orgBoundaries:i.target.value}),className:"min-h-[100px] bg-slate-50 border-slate-200 focus-visible:ring-indigo-500 resize-none text-sm"}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-2 font-medium",children:p.orgBoundaries})]}),c==null?void 0:c.map((i,s)=>{var n,l,a;return e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow group md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-emerald-50 text-emerald-600 rounded-lg",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(x,{className:"text-base font-semibold text-slate-800",children:i.label})]}),e.jsxs("div",{className:"pl-1",children:[i.type==="soc2_tsc"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(n=i.options)==null?void 0:n.map(r=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg border border-slate-100 bg-slate-50/50 hover:bg-white hover:border-indigo-200 transition-all cursor-pointer",onClick:()=>{const w=t.soc2_tsc||[],A=w.includes(r.value)?w.filter(y=>y!==r.value):[...w,r.value];h("soc2_tsc",A)},children:[e.jsx(K,{checked:(t.soc2_tsc||[]).includes(r.value),onCheckedChange:()=>{},className:"mt-0.5"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-sm font-semibold text-slate-700 cursor-pointer",children:r.label}),e.jsx("p",{className:"text-xs text-slate-500 leading-snug",children:r.description})]})]},r.value))}),i.type==="hipaa_entity_type"&&e.jsx(M,{value:t.hipaa_entity_type,onValueChange:r=>h("hipaa_entity_type",r),className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:(l=i.options)==null?void 0:l.map(r=>e.jsxs("div",{className:b("flex items-center gap-3 p-4 rounded-xl border cursor-pointer transition-all",t.hipaa_entity_type===r.value?"bg-indigo-50 border-indigo-200 shadow-sm":"bg-white border-slate-200 hover:border-slate-300"),children:[e.jsx(P,{value:r.value,id:r.value}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:r.value,className:"font-semibold text-slate-700 cursor-pointer",children:r.label}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:r.description})]})]},r.value))}),(i.type==="nist_tier"||i.type==="gdpr_role")&&e.jsx(M,{value:t[i.type],onValueChange:r=>h(i.type,r),className:"space-y-3",children:(a=i.options)==null?void 0:a.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{value:r.value,id:r.value}),e.jsxs(x,{htmlFor:r.value,className:"font-medium text-slate-700",children:[r.label," ",e.jsxs("span",{className:"text-slate-400 text-xs font-normal",children:["- ",r.description]})]})]},r.value))})]})]},s)}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg group-hover:bg-indigo-100 transition-colors",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(x,{className:"text-base font-semibold text-slate-800 cursor-pointer",children:"Physical Locations"})]}),e.jsx(C,{placeholder:"e.g., HQ in London, Data Center in Dublin...",value:(t==null?void 0:t.locations)||"",onChange:i=>o({...t,locations:i.target.value}),className:"min-h-[100px] bg-slate-50 border-slate-200 focus-visible:ring-indigo-500 resize-none text-sm"}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-2 font-medium",children:p.locations})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow group md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg group-hover:bg-indigo-100 transition-colors",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(x,{className:"text-base font-semibold text-slate-800 cursor-pointer",children:"Key Technologies / Cloud Environments"})]}),e.jsx(C,{placeholder:"e.g., AWS Production Account (123456789), Azure AD, Google Workspace...",value:(t==null?void 0:t.technologies)||"",onChange:i=>o({...t,technologies:i.target.value}),className:"min-h-[80px] bg-slate-50 border-slate-200 focus-visible:ring-indigo-500 resize-none text-sm"}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-2 font-medium",children:p.technologies})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow group md:col-span-2 opacity-90",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-rose-50 text-rose-600 rounded-lg group-hover:bg-rose-100 transition-colors",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(x,{className:"text-base font-semibold text-slate-800 cursor-pointer",children:"Out of Scope"})]}),e.jsx(C,{placeholder:"e.g., Marketing Website, Guest Wi-Fi, Test Environments...",value:(t==null?void 0:t.outOfScope)||"",onChange:i=>o({...t,outOfScope:i.target.value}),className:"min-h-[80px] bg-slate-50 border-slate-200 focus-visible:ring-indigo-500 resize-none text-sm"}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-2 font-medium",children:"Clearly list what is excluded to avoid auditor confusion."})]})]})]})}function ze({data:t,onChange:o,standardId:u}){const m=u?j[u]:null,p=m==null?void 0:m.steps.stakeholders.roles,h=p?p.map(s=>({...s,icon:ge,color:"text-indigo-600",bg:"bg-indigo-50"})):[{id:"Leadership / Sponsor",label:"Leadership / Sponsor",icon:Pe,description:"Sign-off authority for budget & risk acceptance.",color:"text-amber-600",bg:"bg-amber-50"},{id:"IT / Engineering",label:"IT / Engineering",icon:he,description:"Implements technical controls & manages infrastructure.",color:"text-blue-600",bg:"bg-blue-50"},{id:"HR",label:"Human Resources",icon:H,description:"Manages onboarding, background checks & training.",color:"text-rose-600",bg:"bg-rose-50"},{id:"Legal / Compliance",label:"Legal / Compliance",icon:X,description:"Reviews contracts, policies & regulatory obligations.",color:"text-indigo-600",bg:"bg-indigo-50"},{id:"Procurement",label:"Procurement",icon:De,description:"Manages vendor risk & software supply chain.",color:"text-emerald-600",bg:"bg-emerald-50"}],i=(s,n)=>{o({...t,[s]:n})};return e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500 fade-in",children:[e.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4 flex gap-3 text-slate-600 mb-6",children:[e.jsx(Ce,{className:"h-5 w-5 shrink-0 text-slate-500 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-slate-800 mb-1",children:"Audit Team Assembly"}),e.jsx("p",{className:"opacity-90 leading-relaxed",children:"Auditors will want to speak with these specific owners. Assigning them early ensures accountability."})]})]}),e.jsx("div",{className:"grid gap-4",children:h.map(s=>{const n=s.icon;return e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:border-indigo-200 hover:shadow-md transition-all group flex items-start sm:items-center gap-4 flex-col sm:flex-row",children:[e.jsx("div",{className:b("p-3 rounded-lg shrink-0 transition-colors group-hover:scale-110 duration-300",s.bg,s.color),children:e.jsx(n,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 w-full grid gap-1.5",children:[e.jsx(x,{className:"text-base font-semibold text-slate-800",children:s.label}),e.jsx("p",{className:"text-xs text-slate-400 font-medium",children:s.description})]}),e.jsx("div",{className:"w-full sm:w-[50%]",children:e.jsx(F,{placeholder:"Name or email...",value:(t==null?void 0:t[s.id])||"",onChange:l=>i(s.id,l.target.value),className:"bg-slate-50 border-slate-200 focus-visible:ring-indigo-500"})})]},s.id)})})]})}const _e=[{id:"Information Security Policy",label:"InfoSec Policy",icon:Y,desc:"High-level security rules."},{id:"Asset Inventory / Register",label:"Asset Inventory",icon:fe,desc:"List of devices & software."},{id:"Risk Methodology / Register",label:"Risk Register",icon:L,desc:"Identified threats & risks."},{id:"Network Diagrams",label:"Network Diagrams",icon:be,desc:"Visual map of architecture."},{id:"HR Onboarding Process",label:"HR Onboarding",icon:H,desc:"New hire checklists."},{id:"Incident Response Plan",label:"Incident Response",icon:$,desc:"Steps for handling breaches."},{id:"Business Continuity Plan",label:"Business Continuity",icon:$,desc:"Disaster recovery plans."},{id:"Vendor / Supplier List",label:"Vendor List",icon:H,desc:"Third-party service providers."},{id:"Access Control Policy",label:"Access Control",icon:ye,desc:"Rules for system access."}];function He({data:t,onChange:o,standardId:u}){var i;const m=u?j[u]:null,p=(i=m==null?void 0:m.steps.documentation)==null?void 0:i.items,c=p?p.map(s=>({...s,icon:xe})):_e,h=s=>{const n=(t==null?void 0:t.existingDocs)||[],l=n.includes(s)?n.filter(a=>a!==s):[...n,s];o({...t,existingDocs:l})};return e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500 fade-in",children:[e.jsxs("div",{className:"bg-emerald-50 border border-emerald-100 rounded-lg p-4 flex gap-3 text-emerald-900 mb-6",children:[e.jsx(L,{className:"h-5 w-5 shrink-0 text-emerald-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Don't start from scratch"}),e.jsx("p",{className:"opacity-90 leading-relaxed",children:"Check off what you already have. We'll help you organize it later. Even drafts or partial documents count."})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(s=>{var a;const n=s.icon,l=(a=t==null?void 0:t.existingDocs)==null?void 0:a.includes(s.id);return e.jsxs("div",{onClick:()=>h(s.id),className:b("cursor-pointer relative p-4 rounded-xl border transition-all duration-200 group flex flex-col gap-3 hover:shadow-md",l?"bg-indigo-50/50 border-indigo-200 ring-1 ring-indigo-500/20":"bg-white border-slate-200 hover:border-indigo-300"),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:b("p-2 rounded-lg transition-colors",l?"bg-indigo-100 text-indigo-700":"bg-slate-50 text-slate-500 group-hover:bg-slate-100"),children:e.jsx(n,{className:"h-5 w-5"})}),e.jsx(K,{id:s.id,checked:l,onCheckedChange:()=>h(s.id),className:b("data-[state=checked]:bg-indigo-600 data-[state=checked]:border-indigo-600")})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:s.id,className:"cursor-pointer font-semibold text-slate-800 block mb-1",children:s.label}),e.jsx("p",{className:"text-xs text-slate-500 leading-snug",children:s.desc})]})]},s.id)})})]})}function Me({data:t,onChange:o}){return e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500 fade-in",children:[e.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-lg p-4 flex gap-3 text-amber-900 mb-6",children:[e.jsx(ve,{className:"h-5 w-5 shrink-0 text-amber-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Business Context Matters"}),e.jsx("p",{className:"opacity-90 leading-relaxed",children:"Security isn't one-size-fits-all. A fintech company needs different controls than a marketing agency. Help us tailor the roadmap."})]})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"group relative bg-white p-1 transition-all rounded-xl focus-within:ring-2 focus-within:ring-indigo-100",children:[e.jsx("div",{className:"absolute top-4 left-4 p-2 bg-indigo-50 text-indigo-600 rounded-lg",children:e.jsx(we,{className:"h-5 w-5"})}),e.jsxs("div",{className:"pl-16 pt-2 pr-4 pb-4",children:[e.jsx(x,{className:"text-base font-semibold text-slate-800",children:"Business Model Description"}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"How do you make money? What data is critical to your success?"}),e.jsx(C,{placeholder:"e.g. B2B SaaS platform for HR management. We process sensitive employee data and host it on AWS...",value:(t==null?void 0:t.businessModel)||"",onChange:u=>o({...t,businessModel:u.target.value}),className:"min-h-[100px] resize-none border-slate-200 bg-slate-50/50 focus:bg-white transition-colors"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"group relative bg-white p-1 transition-all rounded-xl focus-within:ring-2 focus-within:ring-indigo-100",children:[e.jsx("div",{className:"absolute top-4 left-4 p-2 bg-rose-50 text-rose-600 rounded-lg",children:e.jsx(X,{className:"h-5 w-5"})}),e.jsxs("div",{className:"pl-16 pt-2 pr-4 pb-4",children:[e.jsx(x,{className:"text-base font-semibold text-slate-800",children:"Key Regulations"}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Any specific laws you must follow?"}),e.jsx(F,{placeholder:"e.g. GDPR, HIPAA, CCPA...",value:(t==null?void 0:t.regulations)||"",onChange:u=>o({...t,regulations:u.target.value}),className:"border-slate-200 bg-slate-50/50 focus:bg-white transition-colors"})]})]}),e.jsxs("div",{className:"group relative bg-white p-1 transition-all rounded-xl focus-within:ring-2 focus-within:ring-indigo-100",children:[e.jsx("div",{className:"absolute top-4 left-4 p-2 bg-emerald-50 text-emerald-600 rounded-lg",children:e.jsx(qe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"pl-16 pt-2 pr-4 pb-4",children:[e.jsx(x,{className:"text-base font-semibold text-slate-800",children:"Interested Parties"}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Who is asking for this security?"}),e.jsx(F,{placeholder:"e.g. Enterprise Customers, Investors...",value:(t==null?void 0:t.parties)||"",onChange:u=>o({...t,parties:u.target.value}),className:"border-slate-200 bg-slate-50/50 focus:bg-white transition-colors"})]})]})]})]})]})}function Oe({data:t,onChange:o}){return e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500 fade-in",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-indigo-50 text-indigo-600 rounded-full mb-4",children:e.jsx(ee,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"What is your primary goal?"}),e.jsx("p",{className:"text-slate-500 mt-2 max-w-lg mx-auto",children:"This helps us calibrate the strictness of our recommendations."})]}),e.jsxs(M,{value:(t==null?void 0:t.goal)||"gap_scan",onValueChange:u=>o({...t,goal:u}),className:"grid gap-4",children:[e.jsxs("label",{className:b("relative flex items-start gap-4 p-6 rounded-xl border-2 transition-all cursor-pointer hover:shadow-md",(t==null?void 0:t.goal)==="gap_scan"?"border-indigo-600 bg-indigo-50/30 ring-1 ring-indigo-600/20":"border-slate-200 bg-white hover:border-indigo-200"),children:[e.jsx("div",{className:b("p-3 rounded-lg shrink-0 transition-colors",(t==null?void 0:t.goal)==="gap_scan"?"bg-indigo-100 text-indigo-700":"bg-slate-100 text-slate-500"),children:e.jsx(Re,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(x,{className:"text-lg font-bold text-slate-900 cursor-pointer",children:"Gap Scan Only"}),(t==null?void 0:t.goal)==="gap_scan"&&e.jsx(U,{className:"h-5 w-5 text-indigo-600"})]}),e.jsx("p",{className:"text-sm text-slate-500 leading-relaxed mb-3",children:'"We just want to know where we stand."'}),e.jsxs("ul",{className:"text-xs text-slate-600 space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400"}),"Quick identification of missing controls"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400"}),"No evidence collection required"]})]})]}),e.jsx(P,{value:"gap_scan",id:"gap_scan",className:"sr-only"})]}),e.jsxs("label",{className:b("relative flex items-start gap-4 p-6 rounded-xl border-2 transition-all cursor-pointer hover:shadow-md",(t==null?void 0:t.goal)==="audit_ready"?"border-indigo-600 bg-indigo-50/30 ring-1 ring-indigo-600/20":"border-slate-200 bg-white hover:border-indigo-200"),children:[e.jsx("div",{className:b("p-3 rounded-lg shrink-0 transition-colors",(t==null?void 0:t.goal)==="audit_ready"?"bg-indigo-100 text-indigo-700":"bg-slate-100 text-slate-500"),children:e.jsx(je,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(x,{className:"text-lg font-bold text-slate-900 cursor-pointer",children:"Audit Ready (6 Months)"}),(t==null?void 0:t.goal)==="audit_ready"&&e.jsx(U,{className:"h-5 w-5 text-indigo-600"})]}),e.jsx("p",{className:"text-sm text-slate-500 leading-relaxed mb-3",children:'"We want to pass an audit."'}),e.jsxs("ul",{className:"text-xs text-slate-600 space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400"}),"Detailed remediation roadmap"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-400"}),"Full evidence collection & review"]})]})]}),e.jsx(P,{value:"audit_ready",id:"audit_ready",className:"sr-only"})]})]})]})}function Ee({data:t,onChange:o,standardId:u}){const m=j[u]||j.ISO27001,p=m.questionnaire||[],c=(s,n)=>{const l=t||{},a=l.questions||{};o({...l,questions:{...a,[s]:{...a[s]||{},answer:n}}})},h=(s,n)=>{const l=t||{},a=l.questions||{};o({...l,questions:{...a,[s]:{...a[s]||{},comment:n}}})},i=()=>{if(!(t!=null&&t.questions))return 0;const s=p.reduce((l,a)=>l+a.questions.length,0),n=Object.values(t.questions).filter(l=>!!l.answer).length;return Math.round(n/s*100)};return e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500 fade-in",children:[e.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-lg p-4 flex gap-3 text-indigo-900 mb-6",children:[e.jsx(J,{className:"h-5 w-5 shrink-0 text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Self-Assessment Questionnaire"}),e.jsxs("p",{className:"opacity-90 leading-relaxed",children:["This questionnaire assesses your preparedness for ",m.name,' certification. Answer "Yes" if fully implemented, or "No" if not or only partially. Provide comments/evidence for each.']}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-32 bg-indigo-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-600 transition-all duration-500",style:{width:`${i()}%`}})}),e.jsxs("span",{className:"text-xs font-semibold text-indigo-700",children:[i(),"% Complete"]})]})]})]}),e.jsx(Ae,{className:"h-[600px] pr-4",children:e.jsx("div",{className:"space-y-12",children:p.map(s=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-l-4 border-indigo-500 pl-4 py-1",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:s.title}),e.jsx("p",{className:"text-sm text-slate-500",children:s.description})]}),e.jsx("div",{className:"space-y-6",children:s.questions.map(n=>{var a;const l=((a=t==null?void 0:t.questions)==null?void 0:a[n.id])||{};return e.jsx(ne,{className:"border-slate-200 overflow-hidden shadow-sm hover:border-indigo-200 transition-colors",children:e.jsx(re,{className:"p-5",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"shrink-0 font-mono text-xs text-slate-400 bg-slate-100 px-2 py-1 rounded h-fit",children:n.id}),e.jsx("p",{className:"text-sm font-medium text-slate-700 leading-relaxed",children:n.text})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 mt-2",children:[e.jsxs(M,{value:l.answer||"",onValueChange:r=>c(n.id,r),className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{value:"yes",id:`q-${n.id}-yes`}),e.jsx(x,{htmlFor:`q-${n.id}-yes`,className:"text-sm cursor-pointer",children:"Yes"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{value:"no",id:`q-${n.id}-no`}),e.jsx(x,{htmlFor:`q-${n.id}-no`,className:"text-sm cursor-pointer",children:"No"})]})]}),e.jsx("div",{className:"flex-1",children:e.jsx(C,{placeholder:"Comments / Evidence...",value:l.comment||"",onChange:r=>h(n.id,r.target.value),className:"min-h-[60px] text-sm bg-slate-50 border-slate-200 focus-visible:ring-indigo-500"})})]})]})})},n.id)})})]},s.id))})})]})}function Be({data:t,standardId:o,onUpdate:u,onEditStep:m}){const{scope:p,stakeholders:c,existingPolicies:h,context:i,expectations:s,questionnaireData:n}=t,l=[{id:"scope",step:1,title:"Discovery Scope",icon:Z,color:"text-blue-600",bg:"bg-blue-50",content:[{label:"Organization Boundaries",value:p==null?void 0:p.orgBoundaries},{label:"Key Locations",value:p==null?void 0:p.locations},{label:"Technology Stack",value:p==null?void 0:p.technologies}]},{id:"stakeholders",step:2,title:"Project Stakeholders",icon:H,color:"text-emerald-600",bg:"bg-emerald-50",content:[{label:"Security Lead",value:c==null?void 0:c.securityLead},{label:"Executive Sponsor",value:c==null?void 0:c.executiveSponsor},{label:"IT / DevOps",value:c==null?void 0:c.itLead}]},{id:"context",step:4,title:"Business Environment",icon:Ne,color:"text-indigo-600",bg:"bg-indigo-50",content:[{label:"Critical Assets",value:i==null?void 0:i.criticalAssets},{label:"Legal Requirements",value:i==null?void 0:i.legalRequirements},{label:"Risk Appetite",value:i==null?void 0:i.riskAppetite}]},{id:"expectations",step:5,title:"Assessment Goals",icon:ee,color:"text-amber-600",bg:"bg-amber-50",content:[{label:"Target Maturity",value:s==null?void 0:s.targetMaturity},{label:"Primary Objective",value:s==null?void 0:s.primaryObjective},{label:"Timeline",value:s==null?void 0:s.timeline}]},{id:"questionnaire",step:6,title:"Readiness Assessment",icon:Y,color:"text-rose-600",bg:"bg-rose-50",content:[{label:"Questions Answered",value:`${Object.keys((n==null?void 0:n.questions)||{}).length} responses`},{label:"Affirmative Controls",value:`${Object.values((n==null?void 0:n.questions)||{}).filter(g=>g.answer==="yes").length} "Yes" answers`}]}],a=Object.entries(h||{}).filter(([g,f])=>f===!0).map(([g,f])=>g.replace(/([A-Z])/g," $1").replace(/^./,v=>v.toUpperCase())),[r,w]=I.useState(t.scopingReport||""),[A,y]=I.useState(!1),T=async()=>{var f;y(!0),w("");let g="";try{const{data:{session:v}}=await ae.auth.getSession(),N=v==null?void 0:v.access_token,k=await fetch("/api/ai/generate-stream",{method:"POST",headers:{"Content-Type":"application/json",...N?{Authorization:`Bearer ${N}`}:{}},body:JSON.stringify({feature:"scoping_report",standardId:o,data:t})});if(!k.ok){const S=await k.json().catch(()=>({}));throw new Error(S.error||`Failed to generate report (${k.status})`)}const z=(f=k.body)==null?void 0:f.getReader(),d=new TextDecoder;if(!z)return;for(;;){const{done:S,value:O}=await z.read();if(S)break;const te=d.decode(O).split(`
`);for(const G of te)if(G.startsWith("data: "))try{const E=JSON.parse(G.slice(6));if(E.text){const W=E.text;w(ie=>ie+W),g+=W}}catch{}}u({...t,scopingReport:g})}catch(v){D.error("Failed to generate AI report"),console.error(v)}finally{y(!1)}};return e.jsxs("div",{className:"space-y-10 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Readiness Blueprint"}),e.jsxs("p",{className:"text-slate-500 text-sm font-medium",children:["Comprehensive discovery summary for ",o]})]}),e.jsx(V,{variant:"outline",className:"px-3 py-1 bg-white border-indigo-100 text-indigo-700 font-bold uppercase tracking-wider text-[10px]",children:"Draft Proposal"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:l.map(g=>e.jsxs("div",{className:"group p-6 rounded-2xl border border-slate-100 bg-white shadow-sm hover:shadow-md transition-all duration-300 relative overflow-hidden",children:[e.jsx("div",{className:b("absolute top-0 right-0 w-24 h-24 blur-3xl opacity-20 -mr-8 -mt-8 rounded-full",g.bg)}),e.jsxs("div",{className:"flex items-start justify-between mb-6 relative z-10",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:b("p-3 rounded-xl",g.bg),children:e.jsx(g.icon,{className:b("h-5 w-5",g.color)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800",children:g.title}),e.jsx("p",{className:"text-[10px] uppercase tracking-widest font-bold text-slate-400",children:"Context Data"})]})]}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>m(g.step),className:"h-8 w-8 p-0 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-full",children:[e.jsx(R,{className:"h-4 w-4"})," "]})]}),e.jsx("div",{className:"space-y-4 relative z-10",children:g.content.map((f,v)=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-tighter",children:f.label}),e.jsx("span",{className:"text-sm font-medium text-slate-700 italic",children:f.value||e.jsx("span",{className:"text-slate-300",children:"Not specified"})})]},v))})]},g.id))}),e.jsxs("div",{className:"p-8 rounded-2xl border border-indigo-50 bg-indigo-50/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-600 rounded-lg shadow-lg shadow-indigo-200",children:e.jsx(L,{className:"h-5 w-5 text-white"})}),e.jsx("h4",{className:"font-bold text-slate-900",children:"Documentary Inventory"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(V,{className:"bg-emerald-500 hover:bg-emerald-600 text-white font-bold px-3",children:[a.length," Items Found"]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>m(3),className:"h-8 w-8 p-0 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-full",children:e.jsx(R,{className:"h-4 w-4"})})]})]}),a.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:a.map((g,f)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-xl border border-indigo-100/50 shadow-sm group hover:border-indigo-400 transition-colors",children:[e.jsx(Se,{className:"h-4 w-4 text-emerald-500 shrink-0"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 truncate",children:g})]},f))}):e.jsx("div",{className:"text-center py-8 border-2 border-dashed border-slate-200 rounded-2xl",children:e.jsx("p",{className:"text-slate-400 text-sm font-medium italic",children:"No existing documentation noted during discovery"})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-indigo-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-indigo-50 flex items-center justify-between bg-indigo-50/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-600 rounded-lg shadow-md shadow-indigo-200",children:e.jsx(R,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Executive Scoping Report"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"AI-generated summary for stakeholders"})]})]}),!r&&!A&&e.jsxs(_,{onClick:T,className:"bg-indigo-600 hover:bg-indigo-700 text-white shadow-md shadow-indigo-200 border-0",size:"sm",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Generate Report"]})]}),(r||A)&&e.jsxs("div",{className:"p-8 min-h-[200px] bg-slate-50/50",children:[r?e.jsx("div",{className:"prose prose-sm prose-indigo max-w-none bg-white p-8 rounded-xl border border-slate-200 shadow-sm",children:e.jsx(Ie,{children:r})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center h-full",children:[e.jsx(oe,{className:"h-8 w-8 text-indigo-600 animate-spin mb-3"}),e.jsx("p",{className:"text-slate-600 font-medium",children:"Analyzing discovery data..."}),e.jsxs("p",{className:"text-xs text-slate-400",children:["Drafting executive summary for ",o]})]}),!A&&r&&e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(_,{onClick:T,variant:"outline",size:"sm",className:"text-slate-500 hover:text-slate-700 hover:bg-white",children:[e.jsx(R,{className:"h-3 w-3 mr-2"}),"Regenerate"]})})]})]}),e.jsxs("div",{className:"bg-slate-900 rounded-2xl p-8 text-white relative overflow-hidden shadow-2xl shadow-slate-200",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-600/20 blur-3xl opacity-50 -mr-32 -mt-32 rounded-full"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"space-y-2 text-center md:text-left",children:[e.jsx("h4",{className:"text-xl font-bold tracking-tight",children:"Ready to baseline?"}),e.jsxs("p",{className:"text-slate-400 text-sm font-medium max-w-md",children:["Confirming this setup will initialize the ",o," control framework and auto-map your existing evidence."]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Status"}),e.jsxs("span",{className:"text-xs font-bold text-emerald-400 flex items-center justify-end gap-1",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400 animate-pulse"}),"Ready for Implementation"]})]})})]})]})]})}function Wt(){const[t,o]=de("/clients/:clientId/readiness/wizard/:standardId?"),[,u]=ce(),m=parseInt((o==null?void 0:o.clientId)||"0"),p=(o==null?void 0:o.standardId)||"ISO27001",[c,h]=I.useState(1),[i,s]=I.useState({scope:{},stakeholders:{},existingPolicies:{},context:{},expectations:{},questionnaireData:{},scopingReport:""}),[n,l]=I.useState(p);I.useEffect(()=>{o!=null&&o.standardId&&o.standardId!==n&&l(o.standardId)},[o==null?void 0:o.standardId]);const{data:a,isLoading:r}=B.readiness.getState.useQuery({clientId:m,standardId:p},{enabled:!!m});I.useEffect(()=>{a&&(h(a.currentStep||1),s({scope:a.scopeDetails||{},stakeholders:a.stakeholders||{},existingPolicies:a.existingPolicies||{},context:a.businessContext||{},expectations:a.maturityExpectations||{},questionnaireData:a.questionnaireData||{},scopingReport:a.scopingReport||""}))},[a]);const w=B.readiness.createOrUpdate.useMutation({onSuccess:()=>{},onError:d=>{D.error("Error saving progress",{description:d.message})}}),A=B.readiness.baseline.useMutation({onSuccess:d=>{D.success(`${d.framework} Framework Initialized!`,{description:"Discovery setup is now mapped to your workspace."})},onError:d=>{D.error("Failed to initialize framework",{description:d.message})}}),y=(d,S)=>{s(O=>({...O,[d]:S}))},T=async()=>{if(await w.mutateAsync({clientId:m,standardId:n,step:c===7?7:c+1,data:{scope:i.scope,stakeholders:i.stakeholders,existingPolicies:i.existingPolicies,context:i.context,expectations:i.expectations,questionnaireData:i.questionnaireData,scopingReport:i.scopingReport}}),c<7)h(d=>d+1),window.scrollTo({top:0,behavior:"smooth"});else try{await A.mutateAsync({clientId:m,standardId:n}),D.success("Discovery Setup Complete!",{description:"Redirecting to Dashboard..."}),u(`/clients/${m}/compliance`)}catch{}},g=()=>{c>1&&h(d=>d-1)},f=d=>{r||(h(d),window.scrollTo({top:0,behavior:"smooth"}))},v=()=>{switch(c){case 1:return e.jsx(Te,{data:i.scope,onChange:d=>y("scope",d),standardId:n});case 2:return e.jsx(ze,{data:i.stakeholders,onChange:d=>y("stakeholders",d),standardId:n});case 3:return e.jsx(He,{data:i.existingPolicies,onChange:d=>y("existingPolicies",d),standardId:n});case 4:return e.jsx(Me,{data:i.context,onChange:d=>y("context",d)});case 5:return e.jsx(Oe,{data:i.expectations,onChange:d=>y("expectations",d)});case 6:return e.jsx(Ee,{data:i.questionnaireData,onChange:d=>y("questionnaireData",d),standardId:n});case 7:return e.jsx(Be,{data:i,standardId:n,onEditStep:f,onUpdate:d=>{s(S=>({...S,scopingReport:d.scopingReport})),w.mutateAsync({clientId:m,standardId:n,step:7,data:{scope:i.scope,stakeholders:i.stakeholders,existingPolicies:i.existingPolicies,context:i.context,expectations:i.expectations,questionnaireData:i.questionnaireData,scopingReport:d.scopingReport}})}});default:return null}},N=j[n]||j.ISO27001,k=[N.steps.scope.title,N.steps.stakeholders.title,"Gather Existing Documentation","Understand Business Context","Clarify Maturity Expectations","Readiness Questionnaire","Discovery Summary & Review"],z=[N.steps.scope.subtitle,N.steps.stakeholders.subtitle,"Do you have existing policies or evidence? Collect what exists - don't aim for perfection yet.","Define the environment your security system operates in (Cloud, On-prem, Hybrid).","Set your goals for this discovery assessment. What is the target compliance level?","Answer the foundational requirements questions for this framework.","Review everything we've gathered. Confirm the scope and business context to finalize your setup."];return r?e.jsx(Q,{children:e.jsxs("div",{className:"h-screen w-full flex flex-col items-center justify-center bg-[#F8FAFC]",children:[e.jsx("div",{className:"h-10 w-10 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-slate-500 font-medium animate-pulse",children:"Loading assessment state..."})]})}):e.jsx(Q,{children:e.jsx(le,{currentStep:c,totalSteps:7,title:k[c-1],subtitle:z[c-1],onNext:T,onBack:g,onStepClick:f,isLoading:w.isPending,clientId:m,embedded:!0,standardName:n.replace("ISO","ISO ").replace("SOC","SOC ").replace("NIST","NIST "),pageGuide:e.jsx(ke,{title:"Compliance Readiness Wizard",description:"Step-by-step guide to assessing your compliance posture.",rationale:"A structured assessment helps identify gaps early, saving time and resources during the audit.",howToUse:[{step:"Define Scope",description:"Select the business units and systems to be assessed."},{step:"Assign Stakeholders",description:"Identify key personnel responsible for compliance."},{step:"Upload Evidence",description:"Provide existing policies and documentation."},{step:"Assess Controls",description:"Answer specific questions to determine maturity."},{step:"Generate Report",description:"Review findings and create a remediation plan."}],integrations:[{name:"Policy Center",description:"Links to your existing policy library."},{name:"Risk Register",description:"Automatically flags risks based on answers."}]}),children:v()})})}export{Wt as default};
