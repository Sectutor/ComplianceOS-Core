import{ac as f,b as v,t as b,j as e,c as d,C as a,d as l,e as n,m as o,I as y,N,O as w,P as c,Q as i,V as C,W as r,k as h}from"./index-DOc7Nwb7.js";import{C as I}from"./CyberLayout-B8x_G-rt.js";import{P as T}from"./PageGuide-CPKKXXS6.js";import{P as S}from"./plus-BaQ35Jcx.js";import{S as R}from"./search-CwuIBBPE.js";import{F as k}from"./filter-Ceo--4mb.js";import{E as L}from"./eye-CIq9q9s6.js";import{f as D}from"./format-H2tx8_vS.js";import"./DashboardLayout-aHnUqq57.js";import"./index--2vFva6Y.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./utils-BC5CVi_C.js";import"./bar-chart-3-BCngNY6H.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";import"./differenceInCalendarDays-nctqlg7V.js";function Ne(){const{selectedClientId:m}=f(),[P,x]=v(),{data:s,isLoading:j}=b.cyber.getIncidents.useQuery({clientId:m},{enabled:!!m}),u=t=>{switch(t){case"critical":return"destructive";case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"outline"}},g=t=>{switch(t){case"resolved":return"bg-green-100 text-green-800 hover:bg-green-100";case"mitigated":return"bg-blue-100 text-blue-800 hover:bg-blue-100";case"investigating":return"bg-yellow-100 text-yellow-800 hover:bg-yellow-100";default:return"bg-gray-100 text-gray-800 hover:bg-gray-100"}};return e.jsx(I,{children:e.jsxs("div",{className:"space-y-6 w-full max-w-none",children:[e.jsxs("div",{className:"flex justify-between items-start animate-slide-down",children:[e.jsx(T,{title:"Incident Management",description:"Track and manage cyber security incidents reported under NIS2.",rationale:"Centralized incident tracking ensures timely reporting (24h/72h) and effective response.",howToUse:[{step:"Report",description:"Log new incidents immediately upon detection."},{step:"Monitor",description:"Track status and severity of open incidents."},{step:"Resolve",description:"Document mitigation steps and close incidents."}]}),e.jsxs(d,{onClick:()=>x("/cyber/incidents/new"),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," Report New Incident"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(a,{children:[e.jsx(l,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium",children:"Open Incidents"})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.filter(t=>t.status==="open"||t.status==="investigating").length)||0})})]}),e.jsxs(a,{children:[e.jsx(l,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium",children:"Critical Incidents (72h)"})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:(s==null?void 0:s.filter(t=>t.severity==="critical"&&t.status!=="resolved").length)||0})})]}),e.jsxs(a,{children:[e.jsx(l,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium",children:"Resolved (Last 30d)"})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(s==null?void 0:s.filter(t=>t.status==="resolved").length)||0})})]})]}),e.jsxs(a,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(n,{children:"Recorded Incidents"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(y,{placeholder:"Search incidents...",className:"pl-8 w-[250px]"})]}),e.jsx(d,{variant:"outline",size:"icon",children:e.jsx(k,{className:"h-4 w-4"})})]})]})}),e.jsx(o,{children:e.jsxs(N,{children:[e.jsx(w,{children:e.jsxs(c,{children:[e.jsx(i,{children:"Severity"}),e.jsx(i,{children:"Title / ID"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Detected At"}),e.jsx(i,{children:"Reporter"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsx(C,{children:j?e.jsx(c,{children:e.jsx(r,{colSpan:6,className:"text-center py-8",children:"Loading incidents..."})}):(s==null?void 0:s.length)===0?e.jsx(c,{children:e.jsx(r,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No incidents recorded."})}):s==null?void 0:s.map(t=>{var p;return e.jsxs(c,{children:[e.jsx(r,{children:e.jsx(h,{variant:u(t.severity||"low"),className:"capitalize",children:t.severity})}),e.jsxs(r,{className:"font-medium",children:[e.jsx("div",{children:t.title}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: #",t.id]})]}),e.jsx(r,{children:e.jsx(h,{variant:"secondary",className:`capitalize ${g(t.status||"open")}`,children:(p=t.status)==null?void 0:p.replace("_"," ")})}),e.jsx(r,{children:t.detectedAt&&D(new Date(t.detectedAt),"MMM d, yyyy HH:mm")}),e.jsx(r,{children:t.reporterName||"Unknown"}),e.jsx(r,{className:"text-right",children:e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>x(`/cyber/incidents/${t.id}`),children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Details"]})})]},t.id)})})]})})]})]})})}export{Ne as default};
