import{ab as R,b as z,t as d,i as N,r as C,j as e,x as U,c as x,k as F,C as u,d as h,e as g,F as G,f as y,m as j,L as l,I as v,U as Q,N as $,O as H,P as S,Q as b,V as O,W as o}from"./index-DOc7Nwb7.js";import{T as V,a as W,b as I,c as w}from"./tabs-CBDTXbEn.js";import{T as M}from"./textarea-BtxBxzdY.js";import{D as _}from"./DashboardLayout-aHnUqq57.js";import{B as q}from"./Breadcrumb-CRi3LAxS.js";import{A as J}from"./arrow-left-CpuUojG-.js";import{S as K}from"./save-CvVmWchr.js";import{T as X}from"./trash-2-CFEfisbM.js";import{P as Y}from"./plus-BaQ35Jcx.js";import{D as Z}from"./dollar-sign-M9UCfTjq.js";import{C as ee}from"./circle-check-big-BSqJVrgh.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function Oe(){const T=R(),c=parseInt(T.clientId||"0"),[se,P]=z(),{data:a,isLoading:D,refetch:B}=d.businessContinuity.program.get.useQuery({clientId:c},{enabled:!!c}),{data:f}=d.businessContinuity.program.committee.list.useQuery({programId:(a==null?void 0:a.id)||0},{enabled:!!(a!=null&&a.id)}),{data:i}=d.users.list.useQuery(),k=d.businessContinuity.program.upsert.useMutation({onSuccess:()=>{N.success("Program details saved."),B()}}),A=d.businessContinuity.program.committee.add.useMutation({onSuccess:()=>{N.success("Member added."),B(),p({userId:"",role:"",responsibilities:""})}}),L=d.businessContinuity.program.committee.remove.useMutation({onSuccess:()=>N.success("Member removed.")}),[r,n]=C.useState({programName:"",scopeDescription:"",policyStatement:"",budgetAllocated:"",status:"draft",programManagerId:"",executiveSponsorId:""}),[t,p]=C.useState({userId:"",role:"",responsibilities:""});C.useEffect(()=>{var s,m;a&&n({programName:a.programName||"",scopeDescription:a.scopeDescription||"",policyStatement:a.policyStatement||"",budgetAllocated:a.budgetAllocated||"",status:a.status||"draft",programManagerId:((s=a.programManagerId)==null?void 0:s.toString())||"",executiveSponsorId:((m=a.executiveSponsorId)==null?void 0:m.toString())||""})},[a]);const E=()=>{k.mutate({...r,clientId:c,id:a==null?void 0:a.id,programManagerId:r.programManagerId?parseInt(r.programManagerId):void 0,executiveSponsorId:r.executiveSponsorId?parseInt(r.executiveSponsorId):void 0,status:r.status})};return D?e.jsx("div",{className:"p-10 flex justify-center",children:e.jsx(U,{className:"animate-spin w-8 h-8"})}):e.jsx(_,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx(q,{items:[{label:"Clients",href:"/clients"},{label:"Business Continuity",href:`/clients/${c}/business-continuity`},{label:"Governance & Scope",href:`/clients/${c}/business-continuity/governance`}]}),e.jsxs(x,{variant:"ghost",size:"sm",className:"mt-2 -ml-3 text-muted-foreground hover:text-foreground",onClick:()=>P(`/clients/${c}/business-continuity`),children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Back to BC Dashboard"]})]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"BCM Governance & Scope"}),e.jsx("p",{className:"text-muted-foreground",children:"Establish the framework, scope, and leadership for the Business Continuity Program."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:r.status==="active"?"default":"secondary",className:"capitalize text-sm h-8 px-3",children:r.status}),e.jsxs(x,{onClick:E,children:[e.jsx(K,{className:"w-4 h-4 mr-2"})," Save Changes"]})]})]}),e.jsxs(V,{defaultValue:"charter",className:"w-full",children:[e.jsxs(W,{className:"grid w-full grid-cols-3 lg:w-[600px]",children:[e.jsx(I,{value:"charter",children:"1. Charter & Scope"}),e.jsx(I,{value:"committee",children:"2. BCP Committee"}),e.jsx(I,{value:"approval",children:"3. Approval & Budget"})]}),e.jsx(w,{value:"charter",className:"mt-6 space-y-6",children:e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"})," Program Definition"]}),e.jsx(y,{children:"Define the boundaries and objectives of the BCM program."})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Program Name"}),e.jsx(v,{value:r.programName,onChange:s=>n({...r,programName:s.target.value}),placeholder:"e.g. 2024 Global BCM Program"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Scope Statement"}),e.jsx(M,{className:"min-h-[150px]",value:r.scopeDescription,onChange:s=>n({...r,scopeDescription:s.target.value}),placeholder:"Identify business units, locations, and assets covered by this program. Explicitly list exclusions."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tip: Align this with ISO 22301 Context of Organization."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"BC Policy Statement"}),e.jsx(M,{className:"min-h-[200px]",value:r.policyStatement,onChange:s=>n({...r,policyStatement:s.target.value}),placeholder:"Statement of intent and direction by top management..."})]})]})]})}),e.jsx(w,{value:"committee",className:"mt-6 space-y-6",children:e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"})," BCP Committee / Team"]}),e.jsx(y,{children:"Assignable roles for program oversight and execution."})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Program Manager"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:r.programManagerId,onChange:s=>n({...r,programManagerId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select User..."}),i==null?void 0:i.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Executive Sponsor"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:r.executiveSponsorId,onChange:s=>n({...r,executiveSponsorId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select User..."}),i==null?void 0:i.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx(l,{className:"mb-2 block",children:"Committee Members"}),e.jsxs($,{children:[e.jsx(H,{children:e.jsxs(S,{children:[e.jsx(b,{children:"Name"}),e.jsx(b,{children:"Role"}),e.jsx(b,{children:"Responsibilities"}),e.jsx(b,{className:"w-[50px]"})]})}),e.jsxs(O,{children:[f==null?void 0:f.map(s=>{var m;return e.jsxs(S,{children:[e.jsx(o,{children:(m=s.user)==null?void 0:m.name}),e.jsx(o,{children:s.role}),e.jsx(o,{children:s.responsibilities}),e.jsx(o,{children:e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>L.mutate({id:s.id}),children:e.jsx(X,{className:"w-4 h-4 text-red-500"})})})]},s.id)}),e.jsxs(S,{children:[e.jsx(o,{children:e.jsxs("select",{className:"w-full bg-transparent p-1 text-sm border-b",value:t.userId,onChange:s=>p({...t,userId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select User..."}),i==null?void 0:i.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})}),e.jsx(o,{children:e.jsx(v,{className:"h-8",placeholder:"e.g. IT Rep",value:t.role,onChange:s=>p({...t,role:s.target.value})})}),e.jsx(o,{children:e.jsx(v,{className:"h-8",placeholder:"Tasks...",value:t.responsibilities,onChange:s=>p({...t,responsibilities:s.target.value})})}),e.jsx(o,{children:e.jsx(x,{size:"sm",onClick:()=>{!t.userId||!t.role||A.mutate({programId:a.id,userId:parseInt(t.userId),role:t.role,responsibilities:t.responsibilities})},disabled:!(a!=null&&a.id)||!t.userId,children:e.jsx(Y,{className:"w-4 h-4"})})})]})]})]}),!(a!=null&&a.id)&&e.jsx("p",{className:"text-sm text-yellow-600 mt-2",children:"Save the program first to add committee members."})]})]})]})}),e.jsxs(w,{value:"approval",className:"mt-6 space-y-6",children:[e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"})," Budget & Resources"]})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Allocated Budget"}),e.jsx(v,{value:r.budgetAllocated,onChange:s=>n({...r,budgetAllocated:s.target.value}),placeholder:"e.g. $50,000 / year"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Include personnel time, software licenses, and training costs."})]})})]}),e.jsxs(u,{className:"border-green-600 border-2",children:[e.jsxs(h,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-green-600"})," Executive Sign-off"]}),e.jsx(y,{children:"Formal approval to initiate or renew the BCN Program."})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm",children:["By setting the status to ",e.jsx("strong",{children:"Active"}),", the Executive Sponsor confirms that resources are allocated and the Scope/Policy is approved."]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(l,{children:"Program Status:"}),e.jsxs("select",{className:"flex h-10 w-[200px] rounded-md border border-input bg-background px-3 py-2 text-sm font-medium",value:r.status,onChange:s=>n({...r,status:s.target.value}),children:[e.jsx("option",{value:"draft",children:"Draft (Planning)"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"active",children:"Active (Live)"})]})]})]})]})]})]})]})})}export{Oe as default};
