import{M as J,b as W,au as X,r as p,R as Y,t as f,i as u,j as e,x as U,c as b,T as ee,a3 as te,I as d,k as H,F as ae,S as ie,C as N,d as w,e as D,f as C,m as A,L as n,E as x,G as g,H as j,J as v,K as s}from"./index-DOc7Nwb7.js";import{T as $}from"./textarea-BtxBxzdY.js";import{D as se,P as re,g as ne,h as le}from"./DashboardLayout-aHnUqq57.js";import{B as ce}from"./Breadcrumb-CRi3LAxS.js";import{P as oe}from"./PageGuide-CPKKXXS6.js";import{A as de}from"./arrow-left-CpuUojG-.js";import{S as me}from"./save-CvVmWchr.js";import{T as he}from"./target-cfAj3L6j.js";import{Z as pe}from"./zap-B01fFOkT.js";import{C as ue}from"./calendar-BlLJlGbj.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=J("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]),F=[{name:"Ransomware Attack",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Likely",description:"Malicious software that encrypts data and demands payment for decryption keys.",potentialImpact:"Business disruption, data loss, financial damage, reputational harm",mitreId:"T1486",mitreTactic:"Impact"},{name:"Phishing / Spear Phishing",category:"Human",source:"External",intent:"Deliberate",likelihood:"Almost Certain",description:"Deceptive emails designed to steal credentials or install malware.",potentialImpact:"Credential theft, unauthorized access, malware infection",mitreId:"T1566",mitreTactic:"Initial Access"},{name:"Business Email Compromise (BEC)",category:"Human",source:"External",intent:"Deliberate",likelihood:"Likely",description:"Fraudulent emails impersonating executives to authorize wire transfers.",potentialImpact:"Financial loss, wire fraud, reputational damage",mitreId:"T1598",mitreTactic:"Reconnaissance"},{name:"Denial of Service (DDoS)",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Likely",description:"Overwhelming systems with traffic to make services unavailable.",potentialImpact:"Service outage, revenue loss, customer dissatisfaction",mitreId:"T1498",mitreTactic:"Impact"},{name:"Zero-Day Exploitation",category:"Technical",source:"Hacker",intent:"Deliberate",likelihood:"Possible",description:"Exploitation of unknown vulnerabilities before patches exist.",potentialImpact:"Full system compromise, data breach, persistent access",mitreId:"T1211",mitreTactic:"Exploitation"},{name:"Advanced Persistent Threat (APT)",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Possible",description:"Prolonged targeted attacks by nation-states or organized groups.",potentialImpact:"Intellectual property theft, espionage, long-term compromise"},{name:"SQL Injection",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Likely",description:"Injection of malicious SQL code to access or modify databases.",potentialImpact:"Data breach, data manipulation, unauthorized access",mitreId:"T1190",mitreTactic:"Initial Access"},{name:"Cross-Site Scripting (XSS)",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Likely",description:"Injecting scripts into web pages viewed by other users.",potentialImpact:"Session hijacking, credential theft, defacement",mitreId:"T1190",mitreTactic:"Initial Access"},{name:"Man-in-the-Middle Attack",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Possible",description:"Intercepting communications between two parties.",potentialImpact:"Data interception, credential theft, session hijacking",mitreId:"T1557",mitreTactic:"Credential Access"},{name:"Credential Stuffing",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Almost Certain",description:"Using leaked credentials to gain unauthorized access.",potentialImpact:"Account takeover, unauthorized access, data breach",mitreId:"T1110",mitreTactic:"Credential Access"},{name:"Cryptojacking",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Possible",description:"Unauthorized use of computing resources to mine cryptocurrency.",potentialImpact:"Performance degradation, increased costs, resource abuse",mitreId:"T1496",mitreTactic:"Impact"},{name:"Supply Chain Compromise",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Possible",description:"Attacks targeting software/hardware supply chain.",potentialImpact:"Widespread compromise, third-party risk, hard to detect",mitreId:"T1195",mitreTactic:"Initial Access"},{name:"Third-Party Data Breach",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Likely",description:"Data exposure through compromised vendor or partner.",potentialImpact:"Data breach, regulatory penalties, reputational damage"},{name:"Cloud Service Failure",category:"Technical",source:"External",intent:"Accidental",likelihood:"Possible",description:"Outage or security incident at cloud provider.",potentialImpact:"Service disruption, data unavailability, SLA breach"},{name:"Insider Threat - Data Theft",category:"Human",source:"Insider",intent:"Deliberate",likelihood:"Possible",description:"Intentional data exfiltration by employees or contractors.",potentialImpact:"Data breach, IP theft, competitive disadvantage",mitreId:"T1048",mitreTactic:"Exfiltration"},{name:"Insider Threat - Sabotage",category:"Human",source:"Insider",intent:"Deliberate",likelihood:"Unlikely",description:"Disgruntled employees intentionally damaging systems.",potentialImpact:"System damage, data destruction, operational disruption"},{name:"Privilege Misuse",category:"Human",source:"Internal",intent:"Deliberate",likelihood:"Possible",description:"Abuse of legitimate access rights for unauthorized purposes.",potentialImpact:"Unauthorized access, data theft, fraud"},{name:"Accidental Data Exposure",category:"Human",source:"Internal",intent:"Accidental",likelihood:"Likely",description:"Unintentional disclosure via misconfiguration or email errors.",potentialImpact:"Data breach, regulatory fines, reputational damage"},{name:"Misconfiguration",category:"Human",source:"Internal",intent:"Accidental",likelihood:"Likely",description:"Improper system or security configuration.",potentialImpact:"Unauthorized access, data exposure, security gaps"},{name:"Lost/Stolen Device",category:"Human",source:"Internal",intent:"Accidental",likelihood:"Likely",description:"Loss or theft of laptops, phones, or storage devices.",potentialImpact:"Data breach, unauthorized access, compliance violation"},{name:"Improper Data Disposal",category:"Human",source:"Internal",intent:"Accidental",likelihood:"Possible",description:"Failure to properly destroy sensitive data or media.",potentialImpact:"Data recovery by adversaries, compliance violation"},{name:"Natural Disaster",category:"Natural",source:"Nature",intent:"Accidental",likelihood:"Unlikely",description:"Earthquakes, floods, hurricanes, or fires damaging infrastructure.",potentialImpact:"Physical damage, business continuity impact, data center outage"},{name:"Power Outage",category:"Environmental",source:"External",intent:"Accidental",likelihood:"Possible",description:"Loss of electrical power affecting operations.",potentialImpact:"Service disruption, data corruption, equipment damage"},{name:"Physical Intrusion",category:"Human",source:"External",intent:"Deliberate",likelihood:"Unlikely",description:"Unauthorized physical access to facilities or assets.",potentialImpact:"Theft, hardware tampering, data exfiltration"},{name:"Hardware Failure",category:"Technical",source:"Internal",intent:"Accidental",likelihood:"Possible",description:"Failure of servers, storage, or network equipment.",potentialImpact:"Service disruption, data loss, recovery costs"},{name:"Regulatory Non-Compliance",category:"Human",source:"Internal",intent:"Accidental",likelihood:"Possible",description:"Failure to meet GDPR, HIPAA, or other regulatory requirements.",potentialImpact:"Fines, legal action, operational restrictions"},{name:"Privacy Violation",category:"Human",source:"Internal",intent:"Accidental",likelihood:"Possible",description:"Unauthorized collection, use, or disclosure of personal data.",potentialImpact:"Regulatory fines, lawsuits, reputational harm"}];function st(){const[ge,I]=W(),[je,m]=X("/clients/:clientId/risks/threats/:threatId"),l=m!=null&&m.clientId?parseInt(m.clientId):0,S=m==null?void 0:m.threatId,h=S==="new",k=!h&&S?parseInt(S):null,[V,z]=p.useState(!1),[o,B]=p.useState("identification"),[y,O]=p.useState(""),[T,q]=p.useState("All"),E=Y.useMemo(()=>F.filter(t=>{const c=!y||t.name.toLowerCase().includes(y.toLowerCase())||t.description.toLowerCase().includes(y.toLowerCase()),M=T==="All"||t.category===T;return c&&M}),[y,T]),[a,r]=p.useState({threatId:`THREAT-${new Date().getFullYear()}-${Math.floor(Math.random()*1e3)}`,name:"",description:"",category:"Technical",source:"External",intent:"Deliberate",likelihood:"Possible",potentialImpact:"",affectedAssets:"",relatedVulnerabilities:"",associatedRisks:"",scenario:"",detectionMethod:"",status:"active",owner:"",lastReviewDate:""}),{data:P}=f.clients.get.useQuery({id:l},{enabled:!!l}),{data:R}=f.clients.getUsers.useQuery({clientId:l},{enabled:!!l}),{data:L,isLoading:Q}=f.risks.getThreats.useQuery({clientId:l},{enabled:!!k&&!!l}),i=L==null?void 0:L.find(t=>t.id===k);p.useEffect(()=>{i&&r({threatId:i.threatId||"",name:i.name||"",description:i.description||"",category:i.category||"Technical",source:i.source||"External",intent:i.intent||"Deliberate",likelihood:i.likelihood||"Possible",potentialImpact:i.potentialImpact||"",affectedAssets:Array.isArray(i.affectedAssets)?i.affectedAssets.join(", "):i.affectedAssets||"",relatedVulnerabilities:Array.isArray(i.relatedVulnerabilities)?i.relatedVulnerabilities.join(", "):i.relatedVulnerabilities||"",associatedRisks:Array.isArray(i.associatedRisks)?i.associatedRisks.join(", "):i.associatedRisks||"",scenario:i.scenario||"",detectionMethod:i.detectionMethod||"",status:i.status||"active",owner:i.owner||"",lastReviewDate:i.lastReviewDate?new Date(i.lastReviewDate).toISOString().split("T")[0]:""})},[i]);const G=f.risks.createThreat.useMutation({onSuccess:()=>{u.success("Threat recorded successfully"),I(`/clients/${l}/risks/threats`)},onError:t=>u.error(`Failed to record: ${t.message}`)}),K=f.risks.updateThreat.useMutation({onSuccess:()=>{u.success("Threat updated successfully"),I(`/clients/${l}/risks/threats`)},onError:t=>u.error(`Failed to update: ${t.message}`)}),Z=t=>{const c=t.mitreId?`

MITRE ATT&CK: ${t.mitreId} (${t.mitreTactic})`:"";r(M=>({...M,name:t.name,description:t.description+c,category:t.category,source:t.source,intent:t.intent,likelihood:t.likelihood,potentialImpact:t.potentialImpact})),u.success(`Imported "${t.name}" template`)},_=async()=>{if(!a.name){u.error("Threat name is required");return}z(!0);try{const t={name:a.name,description:a.description,category:a.category,source:a.source,intent:a.intent,likelihood:a.likelihood,potentialImpact:a.potentialImpact,affectedAssets:a.affectedAssets?a.affectedAssets.split(",").map(c=>c.trim()):[],relatedVulnerabilities:a.relatedVulnerabilities?a.relatedVulnerabilities.split(",").map(c=>c.trim()):[],associatedRisks:a.associatedRisks?a.associatedRisks.split(",").map(c=>c.trim()):[],scenario:a.scenario,detectionMethod:a.detectionMethod,status:a.status,owner:a.owner,lastReviewDate:a.lastReviewDate||void 0};k?await K.mutateAsync({id:k,...t}):await G.mutateAsync({clientId:l,threatId:a.threatId,...t})}catch(t){console.error(t)}finally{z(!1)}};return Q&&!h?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(U,{className:"animate-spin"})}):e.jsx(se,{children:e.jsxs("div",{className:"w-full px-6 py-8 pb-20",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ce,{items:[{label:"Clients",href:"/clients"},{label:(P==null?void 0:P.name)||"Client",href:`/clients/${l}`},{label:"Threat Library",href:`/clients/${l}/risks/threats`},{label:h?"Record Threat":a.threatId}]})}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>I(`/clients/${l}/risks/threats`),children:e.jsx(de,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ee,{className:"w-6 h-6 text-[#1C4D8D]"}),h?"Record Threat":"Edit Threat"]}),e.jsx("p",{className:"text-muted-foreground",children:a.threatId})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(re,{children:[e.jsx(ne,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Import Template",e.jsx(te,{className:"w-4 h-4"})]})}),e.jsxs(le,{className:"w-96 p-0",align:"end",children:[e.jsxs("div",{className:"p-3 border-b space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Common Threat Templates"}),e.jsx(d,{placeholder:"Search threats...",value:y,onChange:t=>O(t.target.value),className:"h-8"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:["All","Technical","Human","Natural","Environmental"].map(t=>e.jsx(b,{variant:T===t?"default":"outline",size:"sm",className:"h-6 text-xs px-2",onClick:()=>q(t),children:t},t))})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:E.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No threats match your search"}):E.map((t,c)=>e.jsxs("button",{onClick:()=>Z(t),className:"w-full text-left px-3 py-2 hover:bg-slate-50 dark:hover:bg-slate-800 border-b last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:t.name}),e.jsx(H,{variant:"outline",className:"text-xs",children:t.category}),t.mitreId&&e.jsx(H,{variant:"secondary",className:"text-xs font-mono bg-blue-50 text-[#1C4D8D] dark:bg-blue-900/30 dark:text-blue-300",children:t.mitreId}),t.likelihood==="Almost Certain"&&e.jsx(H,{variant:"destructive",className:"text-xs",children:"High Risk"})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 mt-0.5",children:t.description})]},c))}),e.jsxs("div",{className:"p-2 border-t text-xs text-muted-foreground text-center",children:[E.length," of ",F.length," templates"]})]})]}),e.jsx(b,{variant:"outline",onClick:()=>I(`/clients/${l}/risks/threats`),children:"Cancel"}),e.jsxs(b,{onClick:_,disabled:V,className:"bg-[#1C4D8D] hover:bg-[#1C4D8D]/90",children:[V&&e.jsx(U,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(me,{className:"w-4 h-4 mr-2"}),h?"Record Threat":"Save Changes"]}),e.jsx(oe,{title:h?"Record New Threat":"Edit Threat",description:"Define a threat scenario, its origin, and potential impact.",rationale:"Detailed threat definitions help risk owners understand 'what could go wrong' and prioritize controls effectively.",howToUse:[{step:"Import Template",description:"Use 'Import Template' to auto-fill common scenarios like 'Phishing' or 'Ransomware'."},{step:"Classify",description:"Set the Category, Source, and Intent to filter threats in reports."},{step:"Estimate Impact",description:"Describe the 'worst-case scenario' if this threat materializes."}],integrations:[{name:"MITRE ATT&CK",description:"Templates are pre-mapped to MITRE tactics (e.g., Initial Access)."},{name:"Vulnerabilities",description:"Link known vulnerabilities (CVEs) that this threat exploits."}]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1 space-y-1",children:e.jsx("nav",{className:"flex flex-col space-y-1 sticky top-8",children:[{id:"identification",label:"Identification",icon:ae,desc:"Basic Details"},{id:"classification",label:"Classification",icon:he,desc:"Source & Intent"},{id:"impact",label:"Impact & Scenario",icon:pe,desc:"Consequences"},{id:"management",label:"Management",icon:ie,desc:"Ownership"}].map(t=>e.jsxs("button",{onClick:()=>B(t.id),className:`group flex items-center gap-3 w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 ${o===t.id?"bg-[#1C4D8D] text-white shadow-md ring-1 ring-[#1C4D8D]":"text-slate-600 hover:bg-slate-100 hover:text-slate-900 bg-transparent"}`,children:[e.jsx("div",{className:`p-2 rounded-md transition-colors ${o===t.id?"bg-white/20":"bg-slate-100 group-hover:bg-white border border-slate-200 group-hover:border-slate-300"}`,children:e.jsx(t.icon,{className:`w-4 h-4 ${o===t.id?"text-white":"text-slate-500 group-hover:text-slate-700"}`})}),e.jsxs("div",{children:[e.jsx("span",{className:"block",children:t.label}),e.jsx("span",{className:`text-[10px] font-normal ${o===t.id?"text-blue-100":"text-slate-400 group-hover:text-slate-500"}`,children:t.desc})]}),o===t.id&&e.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-white animate-pulse"})]},t.id))})}),e.jsxs("div",{className:"lg:col-span-3 space-y-8",children:[e.jsx("div",{className:o==="identification"?"block":"hidden",children:e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsx(D,{children:"Threat Identification"}),e.jsx(C,{children:"Basic information about the threat."})]}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Threat Name *"}),e.jsx(d,{value:a.name,onChange:t=>r({...a,name:t.target.value}),placeholder:"e.g. Ransomware Attack, Insider Data Theft"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Threat ID"}),e.jsx(d,{value:a.threatId,disabled:!h,onChange:t=>r({...a,threatId:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Category"}),e.jsxs(x,{value:a.category,onValueChange:t=>r({...a,category:t}),children:[e.jsx(g,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(s,{value:"Natural",children:"Natural"}),e.jsx(s,{value:"Human",children:"Human"}),e.jsx(s,{value:"Environmental",children:"Environmental"}),e.jsx(s,{value:"Technical",children:"Technical"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx($,{value:a.description,onChange:t=>r({...a,description:t.target.value}),placeholder:"Detailed description of the threat...",className:"min-h-[120px]"})]})]})]})}),e.jsx("div",{className:o==="classification"?"block":"hidden",children:e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsx(D,{children:"Threat Classification"}),e.jsx(C,{children:"Categorize the source, intent, and likelihood of the threat."})]}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Source / Actor"}),e.jsxs(x,{value:a.source,onValueChange:t=>r({...a,source:t}),children:[e.jsx(g,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(s,{value:"Internal",children:"Internal"}),e.jsx(s,{value:"External",children:"External"}),e.jsx(s,{value:"Hacker",children:"Hacker"}),e.jsx(s,{value:"Insider",children:"Insider"}),e.jsx(s,{value:"Nature",children:"Nature"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Intent"}),e.jsxs(x,{value:a.intent,onValueChange:t=>r({...a,intent:t}),children:[e.jsx(g,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(s,{value:"Accidental",children:"Accidental"}),e.jsx(s,{value:"Deliberate",children:"Deliberate"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Likelihood"}),e.jsxs(x,{value:a.likelihood,onValueChange:t=>r({...a,likelihood:t}),children:[e.jsx(g,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(s,{value:"Rare",children:"Rare"}),e.jsx(s,{value:"Unlikely",children:"Unlikely"}),e.jsx(s,{value:"Possible",children:"Possible"}),e.jsx(s,{value:"Likely",children:"Likely"}),e.jsx(s,{value:"Almost Certain",children:"Almost Certain"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Detection Method"}),e.jsx(d,{value:a.detectionMethod,onChange:t=>r({...a,detectionMethod:t.target.value}),placeholder:"e.g. SIEM alerts, user reports, log analysis"})]})]})]})}),e.jsx("div",{className:o==="impact"?"block":"hidden",children:e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsx(D,{children:"Impact & Scenario"}),e.jsx(C,{children:"Describe the potential impact and how the threat might manifest."})]}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Threat Scenario / Example"}),e.jsx($,{value:a.scenario,onChange:t=>r({...a,scenario:t.target.value}),placeholder:"Describe how this threat might manifest in your environment...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Potential Business Impact"}),e.jsx(d,{value:a.potentialImpact,onChange:t=>r({...a,potentialImpact:t.target.value}),placeholder:"e.g. Data breach, operational downtime, reputational damage"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Affected Assets (comma separated)"}),e.jsx(d,{value:a.affectedAssets,onChange:t=>r({...a,affectedAssets:t.target.value}),placeholder:"e.g. Customer DB, Payment Gateway, Email Server"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Related Vulnerabilities (comma separated)"}),e.jsx(d,{value:a.relatedVulnerabilities,onChange:t=>r({...a,relatedVulnerabilities:t.target.value}),placeholder:"e.g. VULN-2024-001, VULN-2024-002"})]})]})]})}),e.jsx("div",{className:o==="management"?"block":"hidden",children:e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsx(D,{children:"Threat Management"}),e.jsx(C,{children:"Track ownership and review status."})]}),e.jsx(A,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Status"}),e.jsxs(x,{value:a.status,onValueChange:t=>r({...a,status:t}),children:[e.jsx(g,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(s,{value:"active",children:"Active"}),e.jsx(s,{value:"dormant",children:"Dormant"}),e.jsx(s,{value:"monitored",children:"Monitored"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Threat Owner"}),e.jsxs(x,{value:a.owner,onValueChange:t=>r({...a,owner:t}),children:[e.jsx(g,{children:e.jsx(j,{placeholder:"Select Owner"})}),e.jsx(v,{children:R==null?void 0:R.map(t=>e.jsx(s,{value:t.name||t.email,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Last Review Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(d,{type:"date",className:"pl-9",value:a.lastReviewDate,onChange:t=>r({...a,lastReviewDate:t.target.value})})]})]})]})})]})})]})]})]})})}export{st as default};
