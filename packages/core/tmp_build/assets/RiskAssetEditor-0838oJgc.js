import{M as J,r as A,t as v,i as p,j as e,C as E,d as L,S as $,e as T,c as y,x as P,f as M,m as R,z as X,k as z,a4 as Y,a3 as ee,b as se,au as ae,T as te,L as l,I as x,E as Q,G as _,H as U,J as G,K as I}from"./index-DOc7Nwb7.js";import{T as ie}from"./textarea-BtxBxzdY.js";import{D as re}from"./DashboardLayout-aHnUqq57.js";import{B as ne}from"./Breadcrumb-CRi3LAxS.js";import{R as le}from"./refresh-cw-Cjym1DSW.js";import{Z as W}from"./zap-B01fFOkT.js";import{E as F}from"./external-link-C3PXjBR9.js";import{P as ce}from"./PageGuide-CPKKXXS6.js";import{A as oe}from"./arrow-left-CpuUojG-.js";import{D as de}from"./database-Bjtecw5f.js";import{S as me}from"./save-CvVmWchr.js";import{I as Z}from"./info-By5wLOUH.js";import{C as K}from"./calendar-BlLJlGbj.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=J("Import",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]]);function he({clientId:q,assetId:h,assetName:O,assetVendor:m,assetProduct:n,onVulnerabilityImported:g}){const[o,u]=A.useState(!1),{data:f,refetch:N,isLoading:d}=v.threatIntel.getAssetSuggestions.useQuery({assetId:h},{enabled:!!h}),w=v.threatIntel.scanAsset.useMutation({onSuccess:t=>{p.success(`Found ${t.suggestions.length} potential vulnerabilities`),N()},onError:t=>p.error(`Scan failed: ${t.message}`)}),a=v.threatIntel.updateMatchStatus.useMutation({onSuccess:()=>{N()}}),r=v.threatIntel.importCveAsVulnerability.useMutation({onSuccess:t=>{p.success(`Imported ${t.vulnerability.vulnId} as vulnerability`),N(),g==null||g()},onError:t=>p.error(`Import failed: ${t.message}`)}),C=async()=>{u(!0);try{await w.mutateAsync({clientId:q,assetId:h})}finally{u(!1)}},S=t=>{const j=parseFloat(t||"0");return j>=9?{color:"bg-red-600 text-white",label:"Critical",textColor:"text-red-600"}:j>=7?{color:"bg-orange-500 text-white",label:"High",textColor:"text-orange-600"}:j>=4?{color:"bg-yellow-500 text-black",label:"Medium",textColor:"text-yellow-600"}:{color:"bg-green-500 text-white",label:"Low",textColor:"text-green-600"}},H=!!(m&&n),i=(f==null?void 0:f.filter(t=>t.status==="suggested"))||[],D=i.filter(t=>t.isKev).length;return e.jsxs(E,{className:"border-orange-200 dark:border-orange-900/30",children:[e.jsxs(L,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-orange-600"}),e.jsx(T,{className:"text-lg",children:"Threat Intelligence"})]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:C,disabled:o||w.isPending,children:[o||w.isPending?e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(le,{className:"w-4 h-4 mr-2"}),"Scan NVD"]})]}),e.jsxs(M,{children:['AI-powered vulnerability discovery for "',O,'"']})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(X,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:i.length}),e.jsx("span",{className:"text-muted-foreground",children:"Suggestions"})]}),D>0&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(W,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"font-medium text-red-600",children:D}),e.jsx("span",{className:"text-muted-foreground",children:"KEV (Critical)"})]})]}),d?e.jsxs("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:[e.jsx(P,{className:"w-5 h-5 animate-spin mr-2"}),"Loading suggestions..."]}):i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx($,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground/30"}),H?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium text-foreground",children:"No vulnerabilities found"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:['No CVEs match "',m," ",n,'" in the NVD database.']}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:'Click "Scan NVD" to check for new vulnerabilities.'})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Configure Technical Identifiers"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 max-w-sm mx-auto",children:["Add ",e.jsx("span",{className:"font-medium",children:"Vendor"})," and ",e.jsx("span",{className:"font-medium",children:"Product Name"})," in the Basic Info tab for accurate CVE matching."]}),e.jsx("div",{className:"mt-3 p-2 bg-muted/50 rounded-md inline-block",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Example: ",e.jsx("span",{className:"font-mono",children:"Apache â†’ Tomcat"})]})})]})]}):e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2",children:i.map((t,j)=>{var s,b,k,V;return e.jsxs("div",{className:`p-3 rounded-lg border ${t.isKev?"border-red-300 bg-red-50 dark:border-red-900/50 dark:bg-red-950/20":"border-border bg-card"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("a",{href:`https://nvd.nist.gov/vuln/detail/${t.cveId}`,target:"_blank",rel:"noopener noreferrer",className:"font-mono text-sm font-medium text-blue-600 hover:underline flex items-center gap-1",children:[t.cveId,e.jsx(F,{className:"w-3 h-3"})]}),t.cvssScore&&(()=>{const c=S(t.cvssScore);return e.jsxs(z,{className:`text-xs ${c.color}`,children:[c.label," (",t.cvssScore,")"]})})(),t.isKev&&e.jsxs(z,{variant:"destructive",className:"text-xs flex items-center gap-1",children:[e.jsx(W,{className:"w-3 h-3"}),"KEV"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:t.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 italic",children:t.matchReason})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(y,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-600 hover:text-green-700 hover:bg-green-100",onClick:()=>r.mutate({clientId:q,assetId:h,cveId:t.cveId,matchId:t.matchId}),disabled:r.isPending,title:"Import as Vulnerability",children:e.jsx(xe,{className:"w-4 h-4"})}),e.jsx(y,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-100",onClick:()=>{const c=t.matchId;c&&a.mutate({matchId:c,status:"dismissed"})},disabled:a.isPending,title:"Dismiss",children:e.jsx(Y,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"mt-2 text-xs flex flex-wrap gap-2",children:(s=t.cweIds)==null?void 0:s.map(c=>e.jsx(z,{variant:"secondary",className:"text-[10px] px-1 h-5 text-muted-foreground",children:c},c))}),e.jsxs("details",{className:"group mt-2",children:[e.jsxs("summary",{className:"cursor-pointer flex items-center gap-1 hover:text-foreground list-none font-medium text-xs",children:[e.jsx(ee,{className:"w-3 h-3 group-open:rotate-180 transition-transform"}),"Details & References"]}),e.jsxs("div",{className:"mt-2 pl-4 space-y-2 border-l-2 border-muted/50 ml-1.5",children:[((b=t.affectedProducts)==null?void 0:b.length)>0&&e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-[10px] uppercase text-muted-foreground mb-1",children:"Affected Versions"}),e.jsxs("ul",{className:"list-disc pl-3",children:[[...new Set(t.affectedProducts)].slice(0,3).map((c,B)=>e.jsx("li",{children:c},B)),t.affectedProducts.length>3&&e.jsxs("li",{children:["+ ",t.affectedProducts.length-3," more"]})]})]}),((k=t.references)==null?void 0:k.length)>0&&e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-[10px] uppercase text-muted-foreground mb-1",children:"References"}),e.jsx("ul",{className:"space-y-1",children:(V=t.references)==null?void 0:V.slice(0,3).map((c,B)=>e.jsx("li",{children:e.jsxs("a",{href:c.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline flex items-center gap-1 text-blue-600 break-all",children:[e.jsx(F,{className:"w-2.5 h-2.5 shrink-0"}),new URL(c.url).hostname]})},B))})]})]})]})]},`${t.cveId}-${j}`)})}),e.jsxs("div",{className:"pt-3 border-t text-xs text-muted-foreground flex items-center justify-between",children:[e.jsx("span",{children:"Data from NVD & CISA KEV"}),e.jsxs("a",{href:"https://nvd.nist.gov/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["NVD Database ",e.jsx(F,{className:"w-3 h-3"})]})]})]})]})}const ue=["Hardware","Software","Information / Data","People / Roles","Service","Intangible / Reputation","Site / Facility"];function ts(){const[q,h]=se(),[O,m]=ae("/clients/:clientId/risks/assets/:assetId"),n=m!=null&&m.clientId?parseInt(m.clientId):0,g=m==null?void 0:m.assetId,o=g==="new",u=!o&&g?parseInt(g):null,[f,N]=A.useState(!1),[d,w]=A.useState("basic"),[a,r]=A.useState({name:"",type:"Hardware",owner:"",location:"",status:"active",acquisitionDate:"",lastReviewDate:"",valuationC:3,valuationI:3,valuationA:3,description:"",vendor:"",productName:"",version:"",technologies:[]}),{data:C}=v.clients.get.useQuery({id:n},{enabled:!!n}),{data:S,isLoading:H}=v.risks.getAssets.useQuery({clientId:n},{enabled:!!u&&!!n}),i=S==null?void 0:S.find(s=>s.id===u);A.useEffect(()=>{i&&r({name:i.name||"",type:i.type||"Hardware",owner:i.owner||"",location:i.location||"",status:i.status||"active",acquisitionDate:i.acquisitionDate?new Date(i.acquisitionDate).toISOString().split("T")[0]:"",lastReviewDate:i.lastReviewDate?new Date(i.lastReviewDate).toISOString().split("T")[0]:"",valuationC:i.valuationC||3,valuationI:i.valuationI||3,valuationA:i.valuationA||3,description:i.description||"",vendor:i.vendor||"",productName:i.productName||"",version:i.version||"",technologies:i.technologies||[]})},[i]);const D=v.risks.createAsset.useMutation({onSuccess:()=>{p.success("Asset added successfully"),h(`/clients/${n}/risks/assets`)},onError:s=>p.error(`Failed to add: ${s.message}`)}),t=v.risks.updateAsset.useMutation({onSuccess:()=>{p.success("Asset updated successfully"),h(`/clients/${n}/risks/assets`)},onError:s=>p.error(`Failed to update: ${s.message}`)}),j=async()=>{if(!a.name){p.error("Asset name is required");return}N(!0);try{const s={name:a.name,type:a.type,owner:a.owner,location:a.location,status:a.status,acquisitionDate:a.acquisitionDate||void 0,lastReviewDate:a.lastReviewDate||void 0,valuationC:a.valuationC,valuationI:a.valuationI,valuationA:a.valuationA,description:a.description,vendor:a.vendor||void 0,productName:a.productName||void 0,version:a.version||void 0,technologies:a.technologies.length>0?a.technologies:void 0};u?await t.mutateAsync({id:u,...s}):await D.mutateAsync({clientId:n,...s})}catch(s){console.error(s)}finally{N(!1)}};return H&&!o?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(P,{className:"animate-spin"})}):e.jsx(re,{children:e.jsxs("div",{className:"w-full max-w-full px-8 py-8 pb-20",children:[e.jsx("div",{className:"mb-6",children:e.jsx(ne,{items:[{label:"Clients",href:"/clients"},{label:(C==null?void 0:C.name)||"Client",href:`/clients/${n}`},{label:"Asset Inventory",href:`/clients/${n}/risks/assets`},{label:o?"Add Asset":a.name||"Edit Asset"}]})}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>h(`/clients/${n}/risks/assets`),children:e.jsx(oe,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(de,{className:"w-6 h-6 text-[#1C4D8D]"}),o?"Add to Asset Inventory":"Edit Asset"]}),e.jsx("p",{className:"text-muted-foreground",children:o?"Define a new organization asset":`Managing asset: ${a.name}`})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"outline",onClick:()=>h(`/clients/${n}/risks/assets`),children:"Cancel"}),e.jsxs(y,{onClick:j,disabled:f,className:"bg-[#1C4D8D] hover:bg-[#1C4D8D]/90",children:[f&&e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(me,{className:"w-4 h-4 mr-2"}),o?"Add Asset":"Save Changes"]}),e.jsx(ce,{title:o?"Add New Asset":"Edit Asset Details",description:"Document the attributes, ownership, and value of this asset.",rationale:"Accurate asset records allow for better threat modeling. Knowing the 'technology stack' (e.g. Apache, Windows) allows us to auto-match known vulnerabilities.",howToUse:[{step:"Define Basics",description:"Name, owner, and type are mandatory for identification."},{step:"Set Valuation",description:"Use the CIA Valuation tab to score importance from 1 (Low) to 5 (Critical)."},{step:"Add Tech Stack",description:"List technologies (e.g., 'nginx', 'postgres') to enable automated threat intelligence scanning."},{step:"Monitor Lifecycle",description:"Set review dates to ensure the asset record stays current."}],integrations:[{name:"NVD Scanning",description:"Vendor and Product fields are used to search the National Vulnerability Database."},{name:"Business Impact",description:"The CIA score directly influences the Impact calculation in risk assessments."}]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1 space-y-1",children:e.jsx("nav",{className:"flex flex-col space-y-1 sticky top-8",children:[{id:"basic",label:"Basic Info",icon:Z,desc:"Core Details"},{id:"valuation",label:"CIA Valuation",icon:$,desc:"Security Rating"},{id:"lifecycle",label:"Lifecycle & Status",icon:K,desc:"Operations"},...!o&&["Software","Hardware"].includes(a.type)?[{id:"threatIntel",label:"Threat Intel",icon:te,desc:"Vulnerabilities"}]:[]].map(s=>e.jsxs("button",{onClick:()=>w(s.id),className:`group flex items-center gap-3 w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 ${d===s.id?"bg-[#1C4D8D] text-white shadow-md ring-1 ring-[#1C4D8D]":"text-slate-600 hover:bg-slate-100 hover:text-slate-900 bg-transparent"}`,children:[e.jsx("div",{className:`p-2 rounded-md transition-colors ${d===s.id?"bg-white/20":"bg-slate-100 group-hover:bg-white border border-slate-200 group-hover:border-slate-300"}`,children:e.jsx(s.icon,{className:`w-4 h-4 ${d===s.id?"text-white":"text-slate-500 group-hover:text-slate-700"}`})}),e.jsxs("div",{children:[e.jsx("span",{className:"block",children:s.label}),e.jsx("span",{className:`text-[10px] font-normal ${d===s.id?"text-blue-100":"text-slate-400 group-hover:text-slate-500"}`,children:s.desc})]}),d===s.id&&e.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-white animate-pulse"})]},s.id))})}),e.jsxs("div",{className:"lg:col-span-3 space-y-8",children:[e.jsx("div",{className:d==="basic"?"block":"hidden",children:e.jsxs(E,{children:[e.jsxs(L,{children:[e.jsx(T,{children:"Asset Identification"}),e.jsx(M,{children:"Enter the core details of the asset."})]}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Asset Name *"}),e.jsx(x,{value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"e.g. Primary Customer DB"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Asset Type"}),e.jsxs(Q,{value:a.type,onValueChange:s=>r({...a,type:s}),children:[e.jsx(_,{children:e.jsx(U,{})}),e.jsx(G,{children:ue.map(s=>e.jsx(I,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Owner / Department"}),e.jsx(x,{value:a.owner,onChange:s=>r({...a,owner:s.target.value}),placeholder:"e.g. Engineering, HR"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Location / Environment"}),e.jsx(x,{value:a.location,onChange:s=>r({...a,location:s.target.value}),placeholder:"e.g. AWS us-east-1, Office HQ"})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs(l,{className:"text-base font-semibold flex items-center gap-2 mb-3",children:[e.jsx($,{className:"w-4 h-4"}),"Technical Identifiers (for NVD Scanning)"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Adding vendor and product details enables more accurate vulnerability matching."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Vendor"}),e.jsx(x,{value:a.vendor,onChange:s=>r({...a,vendor:s.target.value}),placeholder:"e.g. Microsoft, Apache, Oracle"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Product Name"}),e.jsx(x,{value:a.productName,onChange:s=>r({...a,productName:s.target.value}),placeholder:"e.g. SQL Server, Tomcat, MySQL"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Version"}),e.jsx(x,{value:a.version,onChange:s=>r({...a,version:s.target.value}),placeholder:"e.g. 2019, 9.0.50, 8.0"})]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(l,{children:"Technologies (comma-separated)"}),e.jsx(x,{value:a.technologies.join(", "),onChange:s=>r({...a,technologies:s.target.value.split(",").map(b=>b.trim()).filter(Boolean)}),placeholder:"e.g. nodejs, postgresql, docker, react"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Description"}),e.jsx(ie,{value:a.description,onChange:s=>r({...a,description:s.target.value}),placeholder:"Purpose and scope of this asset...",className:"min-h-[120px]"})]})]})]})}),e.jsx("div",{className:d==="valuation"?"block":"hidden",children:e.jsxs(E,{children:[e.jsxs(L,{children:[e.jsx(T,{children:"CIA Security Valuation"}),e.jsx(M,{children:"Rate the importance of Confidentiality, Integrity, and Availability (1-5)."})]}),e.jsxs(R,{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{id:"valuationC",label:"Confidentiality",color:"text-red-600",desc:"Protection against unauthorized access."},{id:"valuationI",label:"Integrity",color:"text-green-600",desc:"Protection against unauthorized changes."},{id:"valuationA",label:"Availability",color:"text-blue-600",desc:"Accessibility when required."}].map(s=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(l,{className:`font-bold text-base ${s.color}`,children:s.label}),e.jsx("p",{className:"text-xs text-muted-foreground leading-tight",children:s.desc})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{type:"number",min:"1",max:"5",className:"w-20 text-center font-bold text-lg",value:a[s.id],onChange:b=>{const k=parseInt(b.target.value)||1,V=Math.max(1,Math.min(5,k));r({...a,[s.id]:V})}}),e.jsx("span",{className:"text-sm font-medium text-slate-400",children:"/ 5"})]})]},s.id))}),e.jsx("div",{className:"bg-white border border-gray-300 rounded-lg p-5 shadow-sm dark:bg-gray-950 dark:border-gray-700",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Z,{className:"w-5 h-5 text-gray-900 shrink-0 dark:text-gray-100"}),e.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:[e.jsx("p",{className:"font-bold mb-2",children:"Scoring Guide (1-5)"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-semibold",children:"1 - Minimal:"})," Negligible impact."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-semibold",children:"2 - Low:"})," Minor impact."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-semibold",children:"3 - Moderate:"})," Serious impact."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-semibold",children:"4 - High:"})," Significant impact."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-semibold",children:"5 - Critical:"})," Catastrophic impact."]})]})]})]})})]})]})}),e.jsx("div",{className:d==="lifecycle"?"block":"hidden",children:e.jsxs(E,{children:[e.jsxs(L,{children:[e.jsx(T,{children:"Lifecycle & Compliance"}),e.jsx(M,{children:"Track the operational status and review schedule."})]}),e.jsx(R,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Operational Status"}),e.jsxs(Q,{value:a.status,onValueChange:s=>r({...a,status:s}),children:[e.jsx(_,{children:e.jsx(U,{})}),e.jsxs(G,{children:[e.jsx(I,{value:"active",children:"Active"}),e.jsx(I,{value:"archived",children:"Archived"}),e.jsx(I,{value:"disposed",children:"Disposed"}),e.jsx(I,{value:"under review",children:"Under Review"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Acquisition Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(x,{type:"date",className:"pl-9",value:a.acquisitionDate,onChange:s=>r({...a,acquisitionDate:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Next Review Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(x,{type:"date",className:"pl-9",value:a.lastReviewDate,onChange:s=>r({...a,lastReviewDate:s.target.value})})]})]})]})})]})}),!o&&u&&e.jsx("div",{className:d==="threatIntel"?"block":"hidden",children:e.jsx(he,{clientId:n,assetId:u,assetName:a.name,assetVendor:a.vendor,assetProduct:a.productName})})]})]})]})})}export{ts as default};
