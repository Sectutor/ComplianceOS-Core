import{r as o,b as H,j as e,aq as O,z as S,c as Q,I as W,E as A,G as R,H as M,J as D,K as f,ab as J,t as P,x as K,S as X,F as Y,C as Z,d as ee,e as se,m as te,k as F}from"./index-DOc7Nwb7.js";import{D as U}from"./DashboardLayout-aHnUqq57.js";import{B as le}from"./Breadcrumb-CRi3LAxS.js";import{D as _}from"./download-ByfWg1Mi.js";import{T as re,a as ae,b as q}from"./tabs-CBDTXbEn.js";import{P as ie}from"./PageGuide-CPKKXXS6.js";import{C as ne}from"./circle-check-big-BSqJVrgh.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./info-By5wLOUH.js";function de({employees:y,items:c,assignments:h,unassignedItems:V=[],onExport:I,clientId:v}){const[u,E]=o.useState(""),[g,L]=o.useState("all"),[j,$]=o.useState("all"),[m,G]=o.useState(null);H();const z=o.useMemo(()=>{const t=new Set(y.map(s=>s.department).filter(Boolean));return Array.from(t).sort()},[y]),l=o.useMemo(()=>{const t=new Set(c.map(s=>s.type));return Array.from(t).sort()},[c]),x=o.useMemo(()=>y.filter(t=>{var a;const s=t.employeeName.toLowerCase().includes(u.toLowerCase())||((a=t.department)==null?void 0:a.toLowerCase().includes(u.toLowerCase())),r=g==="all"||t.department===g;return s&&r}),[y,u,g]),p=o.useMemo(()=>c.filter(t=>j==="all"||t.type===j),[c,j]),C=(t,s,r)=>{const a=h.find(n=>n.employeeId===t&&n.taskId===s&&(n.taskType?n.taskType===r:!0));return a==null?void 0:a.raciRole},b=o.useMemo(()=>{const t=x.length*p.length,s=h.filter(n=>x.some(i=>i.employeeId===n.employeeId)&&p.some(i=>i.id===n.taskId&&(n.taskType?n.taskType===i.type:!0))).length,r=t-s,a=t>0?Math.round(s/t*100):0;return{totalCells:t,assignedCells:s,unassignedCells:r,coveragePercent:a}},[x,p,h]),w=o.useMemo(()=>p.filter(t=>!h.some(s=>s.taskId===t.id)),[p,h]),N=o.useMemo(()=>x.filter(t=>!h.some(s=>s.employeeId===t.employeeId)),[x,h]),k=x.length>0&&p.length>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Assignments"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:b.assignedCells}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["of ",b.totalCells," cells"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Coverage"}),e.jsxs("p",{className:"text-2xl font-bold mt-1",children:[b.coveragePercent,"%"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[b.unassignedCells," gaps"]})]}),e.jsx(O,{href:`/clients/${v}/raci-matrix/unassigned`,children:e.jsxs("div",{className:"bg-white p-4 rounded-lg border hover:bg-gray-50 cursor-pointer transition-all hover:shadow-md h-full relative z-10",children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Unassigned Items"}),e.jsx("p",{className:"text-2xl font-bold mt-1 text-orange-600",children:w.length}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[p.length," total items"]})]})}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Unassigned Employees"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:N.length}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[x.length," total employees"]})]})]}),(w.length>0||N.length>0)&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-yellow-900",children:"Coverage Gaps Detected"}),e.jsxs("p",{className:"text-sm text-yellow-800 mt-1",children:[w.length>0&&e.jsxs("span",{children:[w.length," item",w.length!==1?"s":""," without assignments. "]}),N.length>0&&e.jsxs("span",{children:[N.length," employee",N.length!==1?"s":""," without assignments."]})]})]})]})}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"Matrix Filters"}),I&&e.jsxs(Q,{variant:"outline",size:"sm",onClick:I,className:"gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Export"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Search"}),e.jsx(W,{placeholder:"Search employees...",value:u,onChange:t=>E(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Department"}),e.jsxs(A,{value:g,onValueChange:L,children:[e.jsx(R,{children:e.jsx(M,{placeholder:"All Departments"})}),e.jsxs(D,{children:[e.jsx(f,{value:"all",children:"All Departments"}),z.map(t=>e.jsx(f,{value:t||"",children:t},t))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Item Type"}),e.jsxs(A,{value:j,onValueChange:$,children:[e.jsx(R,{children:e.jsx(M,{placeholder:"All Types"})}),e.jsxs(D,{children:[e.jsx(f,{value:"all",children:"All Types"}),l.map(t=>e.jsxs(f,{value:t,children:[t.charAt(0).toUpperCase()+t.slice(1),"s"]},t))]})]})]})]})]}),k?e.jsx("div",{className:"bg-white shadow-sm overflow-hidden rounded-xl border-none",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"inline-block min-w-full",children:e.jsxs("table",{className:"w-full text-sm border-separate border-spacing-1",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white p-2 text-left font-bold text-slate-800 text-sm border-b-2 border-slate-100 min-w-48",children:"RACI CHART"}),x.map(t=>e.jsxs("th",{className:"p-2 text-center bg-slate-600 text-white font-medium min-w-20 rounded-lg shadow-sm",title:t.department||"",children:[e.jsx("div",{className:"text-xs font-semibold truncate max-w-[80px] mx-auto",children:t.employeeName}),e.jsx("div",{className:"text-[9px] uppercase tracking-wider opacity-80 mt-0.5 truncate max-w-[80px] mx-auto",children:t.jobTitle||"Team Member"})]},t.employeeId))]})}),e.jsx("tbody",{className:"space-y-0.5",children:p.map((t,s)=>e.jsxs("tr",{className:"group",children:[e.jsxs("td",{className:"sticky left-0 z-10 p-2 font-medium text-slate-700 bg-indigo-50/50 border-r border-indigo-100 rounded-lg group-hover:bg-indigo-100 transition-colors",children:[e.jsx("div",{className:"font-semibold text-xs truncate max-w-[200px]",title:t.name,children:t.name}),e.jsxs("div",{className:"text-[10px] text-slate-500 mt-0.5 uppercase tracking-wide flex items-center gap-1",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${t.type==="control"?"bg-blue-400":t.type==="policy"?"bg-purple-400":"bg-emerald-400"}`}),t.type]})]}),x.map(r=>{const a=C(r.employeeId,t.id,t.type);let n="bg-slate-50";return a==="R"&&(n="bg-red-300"),a==="A"&&(n="bg-indigo-300"),a==="C"&&(n="bg-teal-300"),a==="I"&&(n="bg-amber-300"),e.jsx("td",{className:"p-0.5 text-center align-middle transition-all duration-200 h-10",children:e.jsx("div",{className:`w-full h-full flex items-center justify-center rounded-md ${n} transition-transform hover:scale-[1.02] cursor-default`,title:a?`${r.employeeName} is ${a==="R"?"Responsible":a==="A"?"Accountable":a==="C"?"Consulted":"Informed"}`:"No assignment",children:a&&e.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-white rounded-full font-bold text-slate-800 shadow-sm text-xs",children:a})})},`${t.id}-${r.employeeId}`)})]},t.id))})]})})})}):e.jsx("div",{className:"bg-white rounded-lg border p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No data to display. Adjust filters to see the matrix."})}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 flex flex-wrap justify-center gap-6",children:[{role:"R",label:"Responsible",color:"bg-red-300"},{role:"A",label:"Accountable",color:"bg-indigo-300"},{role:"C",label:"Consulted",color:"bg-teal-300"},{role:"I",label:"Informed",color:"bg-amber-300"}].map(t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 ${t.color} rounded-lg flex items-center justify-center shadow-sm`,children:e.jsx("span",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center font-bold text-[10px]",children:t.role})}),e.jsx("span",{className:"font-medium text-slate-700 text-sm",children:t.label})]},t.role))})]})}const T={R:{bg:"bg-red-100",text:"text-red-800",label:"Responsible"},A:{bg:"bg-blue-100",text:"text-blue-800",label:"Accountable"},C:{bg:"bg-green-100",text:"text-green-800",label:"Consulted"},I:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Informed"}};function Je(){var N,k,t;const{id:y}=J(),c=parseInt(y||"0",10),[h,V]=o.useState("table"),[,I]=H(),{data:v}=P.clients.get.useQuery({id:c},{enabled:c>0}),[u,E]=o.useState(""),[g,L]=o.useState("all"),[j,$]=o.useState("name"),{data:m,isLoading:G,error:z}=P.employees.getRACIMatrix.useQuery({clientId:c},{enabled:c>0}),{data:l,isLoading:x}=P.employees.getRACIGapAnalysis.useQuery({clientId:c},{enabled:c>0}),p=o.useMemo(()=>{if(!m)return[];const s=new Set(m.map(r=>r.department).filter(Boolean));return Array.from(s)},[m]),C=o.useMemo(()=>{if(!m)return[];let s=m.filter(r=>{const a=(r.employeeName||"").toLowerCase().includes(u.toLowerCase())||(r.department||"").toLowerCase().includes(u.toLowerCase()),n=g==="all"||r.department===g;return a&&n});return s.sort((r,a)=>j==="name"?(r.employeeName||"").localeCompare(a.employeeName||""):j==="department"?(r.department||"").localeCompare(a.department||""):a.totalAssignments-r.totalAssignments),s},[m,u,g,j]),b=o.useMemo(()=>l?{controls:l.totalControls>0?Math.round(l.assignedControls/l.totalControls*100):0,policies:l.totalPolicies>0?Math.round(l.assignedPolicies/l.totalPolicies*100):0,evidence:l.totalEvidence>0?Math.round(l.assignedEvidence/l.totalEvidence*100):0}:{controls:0,policies:0,evidence:0},[l]);return G||x?e.jsx(U,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(K,{className:"w-8 h-8 animate-spin text-blue-600"})})}):e.jsx(U,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(le,{items:[{label:"Clients",href:"/clients"},{label:(v==null?void 0:v.name)||"Client",href:`/clients/${c}`},{label:"RACI Matrix"}]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"RACI Matrix"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Visualize employee roles and responsibilities across compliance tasks"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(re,{value:h,onValueChange:s=>V(s),className:"w-auto",children:e.jsxs(ae,{className:"grid w-full grid-cols-2",children:[e.jsx(q,{value:"table",children:"Table View"}),e.jsx(q,{value:"grid",children:"Grid View"})]})}),e.jsxs(Q,{variant:"outline",className:"gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Export"]}),e.jsx(ie,{title:"RACI Matrix",description:"Visualize and manage role responsibilities across your compliance program.",rationale:"A clear RACI matrix prevents ambiguity about who is doing what. It ensures that for every critical control or policy, there is someone Responsible for doing the work and someone Accountable for ensuring it gets done.",howToUse:[{step:"Analyze Gaps",description:"Use the top cards to identify unassigned Controls, Policies, or Evidence tasks."},{step:"Switch Views",description:"Toggle between 'Table View' for a list of employees and 'Grid View' for a classic matrix layout."},{step:"Assign Roles",description:"Click on intersection points in the Grid View to toggle R, A, C, or I roles."},{step:"Filter",description:"Use department and search filters to focus on specific teams or individuals."}],integrations:[{name:"Task Management",description:"Assigning 'Responsible' will automatically create tasks for the user."},{name:"Notifications",description:"'Informed' users receive updates when item status changes."},{name:"Audit Trail",description:"Auditors use this matrix to verify organizational oversight."}]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl border-none shadow-lg shadow-blue-200 dark:shadow-none bg-blue-600 text-white flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/80 font-medium",children:"Control Coverage"}),e.jsxs("p",{className:"text-3xl font-bold mt-1 text-white",children:[b.controls,"%"]}),e.jsxs("p",{className:"text-xs text-white/60 mt-1",children:[l==null?void 0:l.assignedControls,"/",l==null?void 0:l.totalControls," assigned"]})]}),e.jsx("div",{className:"p-3 rounded-lg bg-white/20 backdrop-blur-md",children:e.jsx(X,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"p-4 rounded-xl border-none shadow-lg shadow-indigo-200 dark:shadow-none bg-indigo-600 text-white flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/80 font-medium",children:"Policy Coverage"}),e.jsxs("p",{className:"text-3xl font-bold mt-1 text-white",children:[b.policies,"%"]}),e.jsxs("p",{className:"text-xs text-white/60 mt-1",children:[l==null?void 0:l.assignedPolicies,"/",l==null?void 0:l.totalPolicies," assigned"]})]}),e.jsx("div",{className:"p-3 rounded-lg bg-white/20 backdrop-blur-md",children:e.jsx(Y,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"p-4 rounded-xl border-none shadow-lg shadow-emerald-200 dark:shadow-none bg-emerald-600 text-white flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/80 font-medium",children:"Evidence Coverage"}),e.jsxs("p",{className:"text-3xl font-bold mt-1 text-white",children:[b.evidence,"%"]}),e.jsxs("p",{className:"text-xs text-white/60 mt-1",children:[l==null?void 0:l.assignedEvidence,"/",l==null?void 0:l.totalEvidence," assigned"]})]}),e.jsx("div",{className:"p-3 rounded-lg bg-white/20 backdrop-blur-md",children:e.jsx(ne,{className:"w-6 h-6 text-white"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl border border-yellow-200 bg-yellow-50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"Unassigned Controls"}),e.jsx("p",{className:"text-3xl font-bold mt-1 text-yellow-900",children:((N=l==null?void 0:l.unassignedControls)==null?void 0:N.length)||0}),e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Require owner assignment"})]}),e.jsx("div",{className:"p-3 rounded-lg bg-yellow-100",children:e.jsx(S,{className:"w-6 h-6 text-yellow-700"})})]}),e.jsxs("div",{className:"p-4 rounded-xl border border-orange-200 bg-orange-50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-orange-800 font-medium",children:"Unassigned Policies"}),e.jsx("p",{className:"text-3xl font-bold mt-1 text-orange-900",children:((k=l==null?void 0:l.unassignedPolicies)==null?void 0:k.length)||0}),e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Require owner assignment"})]}),e.jsx("div",{className:"p-3 rounded-lg bg-orange-100",children:e.jsx(S,{className:"w-6 h-6 text-orange-700"})})]}),e.jsxs("div",{className:"p-4 rounded-xl border border-rose-200 bg-rose-50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-rose-800 font-medium",children:"Unassigned Evidence"}),e.jsx("p",{className:"text-3xl font-bold mt-1 text-rose-900",children:((t=l==null?void 0:l.unassignedEvidence)==null?void 0:t.length)||0}),e.jsx("p",{className:"text-xs text-rose-600 mt-1",children:"Require owner assignment"})]}),e.jsx("div",{className:"p-3 rounded-lg bg-rose-100",children:e.jsx(S,{className:"w-6 h-6 text-rose-700"})})]})]}),h==="grid"?e.jsx(de,{employees:C.map(s=>({employeeId:s.employeeId,employeeName:s.employeeName,department:s.department,jobTitle:s.jobTitle})),items:(()=>{var r,a,n;if(!m)return[];const s=new Map;return m.forEach(i=>{i.assignments.forEach(d=>{const B=`${d.taskType}-${d.id}`;s.has(B)||s.set(B,{id:d.id,name:d.taskName,identifier:d.taskIdentifier,type:d.taskType,status:d.taskStatus})})}),l&&((r=l.unassignedControls)==null||r.forEach(i=>{const d=`control-${i.id}`;s.has(d)||s.set(d,{id:i.id,name:i.name,type:"control",identifier:i.identifier||i.id})}),(a=l.unassignedPolicies)==null||a.forEach(i=>{const d=`policy-${i.id}`;s.has(d)||s.set(d,{id:i.id,name:i.name,type:"policy",identifier:i.identifier||i.id})}),(n=l.unassignedEvidence)==null||n.forEach(i=>{const d=`evidence-${i.id}`;s.has(d)||s.set(d,{id:i.id,name:i.name,type:"evidence",identifier:i.identifier||i.id})})),Array.from(s.values())})(),assignments:(()=>{if(!m)return[];const s=[];return m.forEach(r=>{r.assignments.forEach(a=>{s.push({employeeId:r.employeeId,itemId:a.id,itemType:a.taskType,role:a.raciRole})})}),s})(),unassignedItems:[...(l==null?void 0:l.unassignedControls)||[],...(l==null?void 0:l.unassignedPolicies)||[]],clientId:c}):e.jsx(e.Fragment,{children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsx(se,{className:"text-lg",children:"Employee Assignments"})}),e.jsxs(te,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("div",{className:"flex-1 min-w-64",children:e.jsx(W,{placeholder:"Search by name or department...",value:u,onChange:s=>E(s.target.value)})}),e.jsxs(A,{value:g,onValueChange:L,children:[e.jsx(R,{className:"w-48",children:e.jsx(M,{placeholder:"All Departments"})}),e.jsxs(D,{children:[e.jsx(f,{value:"all",children:"All Departments"}),p.map(s=>e.jsx(f,{value:s,children:s},s))]})]}),e.jsxs(A,{value:j,onValueChange:s=>$(s),children:[e.jsx(R,{className:"w-48",children:e.jsx(M,{placeholder:"Sort by..."})}),e.jsxs(D,{children:[e.jsx(f,{value:"name",children:"Sort by Name"}),e.jsx(f,{value:"department",children:"Sort by Department"}),e.jsx(f,{value:"assignments",children:"Sort by Assignments"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Employee"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Department"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium",children:"Assignments"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Task Details"})]})}),e.jsx("tbody",{children:C.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-8 text-gray-500",children:"No employees found"})}):C.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsxs("td",{className:"py-3 px-4",children:[e.jsx(O,{href:`/clients/${c}/employees/${s.employeeId}`,className:"hover:underline cursor-pointer",children:e.jsx("div",{className:"font-medium text-blue-600",children:s.employeeName})}),e.jsx("div",{className:"text-xs text-gray-500",children:s.jobTitle||"-"})]}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.department||"-"}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx(F,{variant:"secondary",children:s.totalAssignments})}),e.jsx("td",{className:"py-3 px-4",children:s.assignments.length===0?e.jsx("span",{className:"text-gray-400 text-xs",children:"No assignments"}):e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:s.assignments.map(r=>{var a,n,i,d;return e.jsxs("div",{className:"flex items-center gap-2 text-xs border rounded p-2 bg-gray-50",children:[e.jsx("div",{className:`px-2 py-1 rounded font-bold cursor-pointer ${(a=T[r.role])==null?void 0:a.bg} ${(n=T[r.role])==null?void 0:n.text}`,title:`${(i=T[r.role])==null?void 0:i.label} (Double-click to view mappings)`,onDoubleClick:()=>I(`/clients/${c}/mappings`),children:r.role}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium truncate",title:r.taskName,children:[r.taskIdentifier&&e.jsx("span",{className:"text-gray-400 mr-1",children:r.taskIdentifier}),r.taskName]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx("span",{className:"capitalize",children:r.taskType}),e.jsx("span",{children:"•"}),e.jsx(F,{variant:"outline",className:"text-[10px] h-4",children:(d=r.taskStatus)==null?void 0:d.replace("_"," ")}),r.dueDate&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:new Date(r.dueDate)<new Date?"text-red-600":"",children:["Due: ",new Date(r.dueDate).toLocaleDateString()]})]})]})]})]},`${r.assignmentId||r.id}-${r.role}`)})})})]},s.employeeId))})]})}),e.jsxs("div",{className:"mt-6 pt-4 border-t",children:[e.jsx("p",{className:"text-sm font-medium mb-3",children:"RACI Legend"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(T).map(([s,r])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-6 h-6 rounded ${r.bg} ${r.text} flex items-center justify-center text-xs font-bold`,children:s}),e.jsx("span",{className:"text-sm",children:r.label})]},s))})]})]})]})})]})})}export{Je as default};
