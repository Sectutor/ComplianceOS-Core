import{j as e,c as k,b as Ie,C as w,m as C,e as D,f as R,d as I,n as at,u as Ze,t as _,r as E,i as V,D as rt,o as it,p as nt,q as lt,s as ot,k as ct,L as ue,I as Je,S as q,v as dt,w as mt,x as pt,R as T,y as Re,F as ee,z as $e,A as O,U as Be,T as ut,h as xt}from"./index-DOc7Nwb7.js";import{D as ze}from"./DashboardLayout-aHnUqq57.js";import{P as Pe}from"./progress-B-1k4ZZX.js";import{E as ht}from"./enhanced-dialog-CeRPsI16.js";import{B as ft}from"./Breadcrumb-CRi3LAxS.js";import{S as ae}from"./sparkles-CoQ80pK2.js";import{C as X}from"./circle-check-C5kiwRoG.js";import{A as ye}from"./arrow-right-M96iV-v9.js";import{W as gt}from"./wand-sparkles-BtekNLFr.js";import{R as We}from"./rocket-C2MuHhsn.js";import{A as ce}from"./activity-B1F2IRm3.js";import{F as jt}from"./folder-open-G4YXLyIS.js";import{P as Ke}from"./plus-BaQ35Jcx.js";import{C as Ue}from"./clock-osbacZli.js";import{T as ge}from"./trending-up-eUiO956o.js";import{D as vt,f as bt,E as yt,L as ke,a as je,C as Nt,A as wt,i as de,b as Oe,h as Ct,c as kt,g as et,u as At,G as St,d as Ge,e as Pt,j as Ot,R as me,T as pe,k as ve,l as be,B as Lt}from"./generateCategoricalChart-KNLgM3hn.js";import{i as Dt,a as Et}from"./isEqual-D_xcZLCn.js";import{X as Le,Y as De}from"./YAxis-DC4HJ4F3.js";import{P as Tt}from"./pie-chart-74fe97t2.js";import{P as Ae,a as Se}from"./PieChart-Lpe3cWE7.js";import{B as It}from"./bar-chart-3-BCngNY6H.js";import{B as _t}from"./BarChart-KWJ05I0m.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";import"./PolarAngleAxis-BO8F-h7c.js";const te=({icon:t,title:s,description:r,action:a,className:n})=>e.jsxs("div",{className:`flex flex-col items-center justify-center text-center p-8 bg-slate-50/50 rounded-xl border-2 border-dashed border-slate-200 transition-all hover:bg-slate-50 ${n}`,children:[e.jsx("div",{className:"p-4 rounded-full bg-white shadow-md mb-4 animate-in zoom-in duration-500",children:e.jsx(t,{className:"w-10 h-10 text-slate-400"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 leading-tight",children:s}),e.jsx("p",{className:"text-sm text-slate-500 mt-2 max-w-[240px] mx-auto lining-nums",children:r}),a&&e.jsx(k,{variant:"outline",className:"mt-6 bg-white hover:bg-slate-50 border-slate-200 shadow-sm transition-all hover:scale-105 active:scale-95 px-6",onClick:a.onClick,children:a.label})]});function Ve({stats:t,role:s}){var g,p,v,h,j,S,P,L;const[,r]=Ie(),a=s==="admin"||s==="owner"||s==="super_admin",n=[{id:"org",title:"Create your first Organization",description:"Setup your company workspace to start tracking compliance.",isComplete:(((g=t==null?void 0:t.overview)==null?void 0:g.totalClients)||0)>0,action:()=>r("/clients/new"),actionLabel:"Create Organization"},{id:"framework",title:"Select Compliance Frameworks",description:"Choose ISO 27001 or SOC 2 to populate your control library.",isComplete:(((p=t==null?void 0:t.overview)==null?void 0:p.totalControls)||0)>0,action:()=>{var y,m;(((y=t==null?void 0:t.overview)==null?void 0:y.totalClients)||0)>0&&((m=t==null?void 0:t.clientsOverview)!=null&&m[0])?r(`/clients/${t.clientsOverview[0].id}`):r("/clients/new")},actionLabel:"Configure Frameworks"},{id:"policy",title:"Generate AI Policies",description:"Use our LLM engine to create audit-ready security policies.",isComplete:(((v=t==null?void 0:t.overview)==null?void 0:v.totalPolicies)||0)>0,action:()=>r("/policy-templates"),actionLabel:"Explore Policies"},{id:"evidence",title:"Link Evidence to Controls",description:"Start collecting proof of compliance for your audits.",isComplete:(((h=t==null?void 0:t.overview)==null?void 0:h.totalEvidence)||0)>0,action:()=>r("/evidence"),actionLabel:"Track Evidence"}],u=[{id:"llm",title:"Configure AI Assistant (LLM Keys)",description:"Provide API keys for OpenAI or Anthropic to power AI features.",isComplete:(((j=t==null?void 0:t.overview)==null?void 0:j.totalLLMProviders)||0)>0,action:()=>r("/settings/llm"),actionLabel:"System Settings"},{id:"master_controls",title:"Initialize Master Control Library",description:"Verify that ISO 27001 and SOC 2 frameworks are loaded.",isComplete:(((S=t==null?void 0:t.overview)==null?void 0:S.totalControls)||0)>0,action:()=>r("/controls"),actionLabel:"Control Library"},{id:"first_client",title:"Setup Your First Client Workspace",description:"Create a managed workspace for an organization.",isComplete:(((P=t==null?void 0:t.overview)==null?void 0:P.totalClients)||0)>0,action:()=>r("/clients/new"),actionLabel:"Onboard Client"},{id:"users",title:"Invite Your Security Team",description:"Grant access to other admins or client collaborators.",isComplete:(((L=t==null?void 0:t.overview)==null?void 0:L.totalUsers)||0)>1,action:()=>r("/admin/users"),actionLabel:"Team Management"}],l=a?u:n,c=l.filter(y=>y.isComplete).length,d=l.length,o=c/d*100;return c===d?e.jsx(w,{className:"border-green-200 bg-green-50/50 shadow-md",children:e.jsxs(C,{className:"pt-6 pb-6 text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ae,{className:"h-6 w-6 text-green-600"})}),e.jsx(D,{className:"text-xl text-green-900 mb-2",children:"Onboarding Complete!"}),e.jsx(R,{className:"text-green-700",children:"You've completed the initial setup. Your dashboard is now active with live compliance data."}),e.jsx(k,{className:"mt-4 bg-green-600 hover:bg-green-700 text-white border-none",onClick:()=>r("/dashboard"),children:"View Full Dashboard"})]})}):e.jsxs(w,{className:"border-primary/20 shadow-lg bg-gradient-to-br from-white to-primary/5",children:[e.jsxs(I,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(D,{className:"text-xl flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5 text-primary"}),"Quick Start Guide"]}),e.jsx(R,{children:"Follow these steps to launch your compliance program."})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"text-2xl font-bold text-primary",children:[Math.round(o),"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c," of ",d," done"]})]})]}),e.jsx(Pe,{value:o,className:"h-2 mt-4 bg-primary/10"})]}),e.jsx(C,{className:"space-y-4",children:l.map(y=>e.jsxs("div",{className:`flex items-start gap-4 p-4 rounded-xl border transition-all ${y.isComplete?"bg-green-50/50 border-green-100/50 opacity-80":"bg-white border-slate-100 hover:border-primary/30 hover:shadow-md group cursor-pointer"}`,onClick:()=>!y.isComplete&&y.action(),children:[e.jsx("div",{className:"mt-1",children:y.isComplete?e.jsx(X,{className:"h-6 w-6 text-green-600"}):e.jsx(at,{className:"h-6 w-6 text-slate-300 group-hover:text-primary transition-colors"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-semibold transition-colors ${y.isComplete?"text-green-900 line-through opacity-60":"text-slate-900 group-hover:text-primary"}`,children:y.title}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:y.description}),!y.isComplete&&e.jsxs("div",{className:"mt-3 flex items-center text-xs font-bold text-primary uppercase tracking-wider",children:["Go to ",y.actionLabel.split(" ")[0],e.jsx(ye,{className:"h-3 w-3 ml-1 transition-transform group-hover:translate-x-1"})]})]})]},y.id))})]})}function Qe(){const{user:t}=Ze(),{data:s,isLoading:r}=_.clients.list.useQuery(),{data:a,isLoading:n}=_.frameworks.getOnboardingFrameworks.useQuery(),{data:u}=_.dashboard.enhanced.useQuery(),[l,c]=E.useState(!1),[d,o]=E.useState(1),[,x]=Ie(),g=_.useUtils();(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="owner"||(t==null||t.role);const[p,v]=E.useState({name:"",industry:"Technology",frameworks:[],generatePolicies:!0,useSampleData:!1}),h=_.clients.autoSetup.useMutation({onSuccess:async m=>{V.success("Workspace configured successfully!"),await Promise.all([g.clients.list.invalidate(),g.dashboard.enhanced.invalidate()]),await new Promise(f=>setTimeout(f,300)),c(!1),x(`/clients/${m.id}?onboarding=complete`)},onError:m=>{V.error(`Auto-setup failed: ${m.message}`)}}),j=_.clients.createSampleData.useMutation({onSuccess:async m=>{V.success("Magic Sample Data workspace created!"),await Promise.all([g.clients.list.invalidate(),g.dashboard.enhanced.invalidate()]),await new Promise(f=>setTimeout(f,300)),c(!1),x(`/clients/${m.id}?onboarding=complete`)},onError:m=>{V.error(`Sample data creation failed: ${m.message}`)}});E.useEffect(()=>{!r&&s&&s.length===0&&c(!0)},[s,r]);const S=m=>{v(f=>({...f,frameworks:f.frameworks.includes(m)?f.frameworks.filter(Q=>Q!==m):[...f.frameworks,m]}))},P=()=>{if(d===1&&!p.name){V.error("Please enter your company name");return}o(m=>m+1)},L=()=>o(m=>m-1),y=()=>{h.mutate({name:p.name,industry:p.industry,frameworks:p.frameworks,generatePolicies:p.generatePolicies,includeSampleData:p.useSampleData})};return e.jsx(rt,{open:l,onOpenChange:c,children:e.jsxs(it,{className:"sm:max-w-[500px] p-0 overflow-hidden border-none shadow-2xl bg-white",children:[e.jsxs(nt,{className:"sr-only",children:[e.jsx(lt,{children:"Welcome to GRCompliance"}),e.jsx(ot,{children:"Configure your security foundation and compliance frameworks."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 via-primary to-indigo-800 p-8 text-white relative",children:[e.jsx(gt,{className:"absolute top-4 right-4 h-24 w-24 text-white/10 rotate-12"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs(ct,{variant:"secondary",className:"bg-white/20 text-white border-none mb-4 backdrop-blur-md",children:[e.jsx(ae,{className:"h-3 w-3 mr-1 text-yellow-300"}),"AI Setup Assistant"]}),e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Welcome to GRCompliance"}),e.jsx("p",{className:"text-white/70 mt-2",children:"Let's build your security foundation in 60 seconds."})]})]}),e.jsxs("div",{className:"p-8 space-y-6",children:[d===1&&e.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"name",className:"text-base font-semibold",children:"Company Name"}),e.jsx(Je,{id:"name",placeholder:"e.g. Acme Security Corp",value:p.name,onChange:m=>v(f=>({...f,name:m.target.value})),className:"h-12 border-slate-200 focus:border-primary/50 focus:ring-primary/20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"industry",className:"text-base font-semibold",children:"Industry"}),e.jsxs("select",{id:"industry",className:"flex h-12 w-full rounded-md border border-slate-200 bg-transparent px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/20 focus-visible:border-primary/50 disabled:cursor-not-allowed disabled:opacity-50",value:p.industry,onChange:m=>v(f=>({...f,industry:m.target.value})),children:[e.jsx("option",{value:"Technology",children:"Technology"}),e.jsx("option",{value:"Healthcare",children:"Healthcare"}),e.jsx("option",{value:"Finance",children:"Finance"}),e.jsx("option",{value:"Retail",children:"Retail"}),e.jsx("option",{value:"Manufacturing",children:"Manufacturing"}),e.jsx("option",{value:"Education",children:"Education"}),e.jsx("option",{value:"Government",children:"Government"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]})}),d===2&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{children:[e.jsx(ue,{className:"text-base font-semibold",children:"Which standards are you targeting?"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Select all that apply to your organization. (Total: ",(a==null?void 0:a.length)||0,")"]})]}),e.jsxs("div",{className:"grid gap-3 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:[n?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(m=>e.jsx("div",{className:"h-20 w-full bg-slate-50 animate-pulse rounded-xl"},m))}):a==null?void 0:a.map(m=>e.jsx(w,{className:`cursor-pointer transition-all border-2 ${p.frameworks.includes(m.shortCode)?"border-primary bg-primary/5 shadow-md":"border-slate-100 hover:border-slate-300"}`,onClick:()=>S(m.shortCode),children:e.jsxs(C,{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p.frameworks.includes(m.shortCode)?"bg-primary/20 text-primary":"bg-slate-100 text-slate-500"}`,children:e.jsx(q,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:m.name}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:m.description||m.shortCode})]})]}),e.jsx(dt,{checked:p.frameworks.includes(m.shortCode)})]})},m.id)),!n&&(!a||a.length===0)&&e.jsx("div",{className:"py-8 text-center border-2 border-dashed rounded-xl",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"No standards found in database."})})]})]}),d===3&&e.jsxs("div",{className:"text-center space-y-6 animate-in fade-in zoom-in duration-500",children:[e.jsx("div",{className:"mx-auto w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(We,{className:"h-10 w-10 text-primary animate-bounce"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Ready for Lift-off?"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Our AI will now create your workspace for ",e.jsx("span",{className:"font-bold text-slate-900",children:p.name}),"and a separate ",e.jsxs("span",{className:"font-bold text-slate-900",children:[p.name," DEMO"]})," environment populated with sample data."]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium border border-blue-100",children:[e.jsx(ae,{className:"h-4 w-4 text-blue-600"}),"Atomic One-click Magic Configuration"]})]})]}),e.jsxs(mt,{className:"p-8 bg-slate-50/50 border-t flex flex-row items-center justify-between space-x-2",children:[d>1?e.jsx(k,{variant:"ghost",onClick:L,disabled:h.isPending,className:"font-medium text-slate-600",children:"Go Back"}):e.jsx("div",{}),d<3?e.jsxs(k,{onClick:P,className:"h-12 px-8 font-bold shadow-lg shadow-primary/20 bg-primary rounded-xl",children:["Next Step",e.jsx(ye,{className:"h-4 w-4 ml-2"})]}):e.jsx(k,{onClick:y,className:"h-12 px-8 font-bold shadow-lg rounded-xl transition-all bg-primary hover:bg-primary/90 shadow-primary/20",disabled:h.isPending||j.isPending,children:h.isPending||j.isPending?e.jsxs(e.Fragment,{children:[e.jsx(pt,{className:"h-4 w-4 mr-2 animate-spin"}),"Building Workspaces..."]}):e.jsxs(e.Fragment,{children:["Launch Workspaces",e.jsx(We,{className:"h-4 w-4 ml-2"})]})})]})]})})}var Ft=["type","layout","connectNulls","ref"],Mt=["key"];function re(t){"@babel/helpers - typeof";return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},re(t)}function Ye(t,s){if(t==null)return{};var r=Rt(t,s),a,n;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(n=0;n<u.length;n++)a=u[n],!(s.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}function Rt(t,s){if(t==null)return{};var r={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){if(s.indexOf(a)>=0)continue;r[a]=t[a]}return r}function xe(){return xe=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},xe.apply(this,arguments)}function He(t,s){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,a)}return r}function M(t){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?He(Object(r),!0).forEach(function(a){W(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}function se(t){return Wt(t)||zt(t)||Bt(t)||$t()}function $t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bt(t,s){if(t){if(typeof t=="string")return Ee(t,s);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ee(t,s)}}function zt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wt(t){if(Array.isArray(t))return Ee(t)}function Ee(t,s){(s==null||s>t.length)&&(s=t.length);for(var r=0,a=new Array(s);r<s;r++)a[r]=t[r];return a}function Kt(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function qe(t,s){for(var r=0;r<s.length;r++){var a=s[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,st(a.key),a)}}function Ut(t,s,r){return s&&qe(t.prototype,s),r&&qe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gt(t,s,r){return s=Ne(s),Vt(t,tt()?Reflect.construct(s,r||[],Ne(t).constructor):s.apply(t,r))}function Vt(t,s){if(s&&(re(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qt(t)}function Qt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tt=function(){return!!t})()}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ne(t)}function Yt(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&Te(t,s)}function Te(t,s){return Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,n){return a.__proto__=n,a},Te(t,s)}function W(t,s,r){return s=st(s),s in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,t}function st(t){var s=Ht(t,"string");return re(s)=="symbol"?s:s+""}function Ht(t,s){if(re(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var a=r.call(t,s);if(re(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ie=function(t){function s(){var r;Kt(this,s);for(var a=arguments.length,n=new Array(a),u=0;u<a;u++)n[u]=arguments[u];return r=Gt(this,s,[].concat(n)),W(r,"state",{isAnimationFinished:!0,totalLength:0}),W(r,"generateSimpleStrokeDasharray",function(l,c){return"".concat(c,"px ").concat(l-c,"px")}),W(r,"getStrokeDasharray",function(l,c,d){var o=d.reduce(function(P,L){return P+L});if(!o)return r.generateSimpleStrokeDasharray(c,l);for(var x=Math.floor(l/o),g=l%o,p=c-l,v=[],h=0,j=0;h<d.length;j+=d[h],++h)if(j+d[h]>g){v=[].concat(se(d.slice(0,h)),[g-j]);break}var S=v.length%2===0?[0,p]:[p];return[].concat(se(s.repeat(d,x)),se(v),S).map(function(P){return"".concat(P,"px")}).join(", ")}),W(r,"id",At("recharts-line-")),W(r,"pathRef",function(l){r.mainCurve=l}),W(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),W(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Yt(s,t),Ut(s,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();this.setState({totalLength:a})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();a!==this.state.totalLength&&this.setState({totalLength:a})}}},{key:"getTotalLength",value:function(){var a=this.mainCurve;try{return a&&a.getTotalLength&&a.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(a,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var u=this.props,l=u.points,c=u.xAxis,d=u.yAxis,o=u.layout,x=u.children,g=bt(x,yt);if(!g)return null;var p=function(j,S){return{x:j.x,y:j.y,value:j.value,errorVal:et(j.payload,S)}},v={clipPath:a?"url(#clipPath-".concat(n,")"):null};return T.createElement(ke,v,g.map(function(h){return T.cloneElement(h,{key:"bar-".concat(h.props.dataKey),data:l,xAxis:c,yAxis:d,layout:o,dataPointFormatter:p})}))}},{key:"renderDots",value:function(a,n,u){var l=this.props.isAnimationActive;if(l&&!this.state.isAnimationFinished)return null;var c=this.props,d=c.dot,o=c.points,x=c.dataKey,g=je(this.props,!1),p=je(d,!0),v=o.map(function(j,S){var P=M(M(M({key:"dot-".concat(S),r:3},g),p),{},{index:S,cx:j.x,cy:j.y,value:j.value,dataKey:x,payload:j.payload,points:o});return s.renderDotItem(d,P)}),h={clipPath:a?"url(#clipPath-".concat(n?"":"dots-").concat(u,")"):null};return T.createElement(ke,xe({className:"recharts-line-dots",key:"dots"},h),v)}},{key:"renderCurveStatically",value:function(a,n,u,l){var c=this.props,d=c.type,o=c.layout,x=c.connectNulls;c.ref;var g=Ye(c,Ft),p=M(M(M({},je(g,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:n?"url(#clipPath-".concat(u,")"):null,points:a},l),{},{type:d,layout:o,connectNulls:x});return T.createElement(Nt,xe({},p,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(a,n){var u=this,l=this.props,c=l.points,d=l.strokeDasharray,o=l.isAnimationActive,x=l.animationBegin,g=l.animationDuration,p=l.animationEasing,v=l.animationId,h=l.animateNewValues,j=l.width,S=l.height,P=this.state,L=P.prevPoints,y=P.totalLength;return T.createElement(wt,{begin:x,duration:g,isActive:o,easing:p,from:{t:0},to:{t:1},key:"line-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var f=m.t;if(L){var Q=L.length/c.length,$=c.map(function(N,B){var z=Math.floor(B*Q);if(L[z]){var G=L[z],b=de(G.x,N.x),ne=de(G.y,N.y);return M(M({},N),{},{x:b(f),y:ne(f)})}if(h){var he=de(j*2,N.x),le=de(S/2,N.y);return M(M({},N),{},{x:he(f),y:le(f)})}return M(M({},N),{},{x:N.x,y:N.y})});return u.renderCurveStatically($,a,n)}var H=de(0,y),K=H(f),U;if(d){var Z="".concat(d).split(/[,\s]+/gim).map(function(N){return parseFloat(N)});U=u.getStrokeDasharray(K,y,Z)}else U=u.generateSimpleStrokeDasharray(y,K);return u.renderCurveStatically(c,a,n,{strokeDasharray:U})})}},{key:"renderCurve",value:function(a,n){var u=this.props,l=u.points,c=u.isAnimationActive,d=this.state,o=d.prevPoints,x=d.totalLength;return c&&l&&l.length&&(!o&&x>0||!Et(o,l))?this.renderCurveWithAnimation(a,n):this.renderCurveStatically(l,a,n)}},{key:"render",value:function(){var a,n=this.props,u=n.hide,l=n.dot,c=n.points,d=n.className,o=n.xAxis,x=n.yAxis,g=n.top,p=n.left,v=n.width,h=n.height,j=n.isAnimationActive,S=n.id;if(u||!c||!c.length)return null;var P=this.state.isAnimationFinished,L=c.length===1,y=Re("recharts-line",d),m=o&&o.allowDataOverflow,f=x&&x.allowDataOverflow,Q=m||f,$=Oe(S)?this.id:S,H=(a=je(l,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},K=H.r,U=K===void 0?3:K,Z=H.strokeWidth,N=Z===void 0?2:Z,B=Ct(l)?l:{},z=B.clipDot,G=z===void 0?!0:z,b=U*2+N;return T.createElement(ke,{className:y},m||f?T.createElement("defs",null,T.createElement("clipPath",{id:"clipPath-".concat($)},T.createElement("rect",{x:m?p:p-v/2,y:f?g:g-h/2,width:m?v:v*2,height:f?h:h*2})),!G&&T.createElement("clipPath",{id:"clipPath-dots-".concat($)},T.createElement("rect",{x:p-b/2,y:g-b/2,width:v+b,height:h+b}))):null,!L&&this.renderCurve(Q,$),this.renderErrorBar(Q,$),(L||l)&&this.renderDots(Q,G,$),(!j||P)&&kt.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(a,n){return a.animationId!==n.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:n.curPoints}:a.points!==n.curPoints?{curPoints:a.points}:null}},{key:"repeat",value:function(a,n){for(var u=a.length%2!==0?[].concat(se(a),[0]):a,l=[],c=0;c<n;++c)l=[].concat(se(l),se(u));return l}},{key:"renderDotItem",value:function(a,n){var u;if(T.isValidElement(a))u=T.cloneElement(a,n);else if(Dt(a))u=a(n);else{var l=n.key,c=Ye(n,Mt),d=Re("recharts-line-dot",typeof a!="boolean"?a.className:"");u=T.createElement(vt,xe({key:l},c,{className:d}))}return u}}])}(E.PureComponent);W(ie,"displayName","Line");W(ie,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!St.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});W(ie,"getComposedData",function(t){var s=t.props,r=t.xAxis,a=t.yAxis,n=t.xAxisTicks,u=t.yAxisTicks,l=t.dataKey,c=t.bandSize,d=t.displayedData,o=t.offset,x=s.layout,g=d.map(function(p,v){var h=et(p,l);return x==="horizontal"?{x:Ge({axis:r,ticks:n,bandSize:c,entry:p,index:v}),y:Oe(h)?null:a.scale(h),value:h,payload:p}:{x:Oe(h)?null:r.scale(h),y:Ge({axis:a,ticks:u,bandSize:c,entry:p,index:v}),value:h,payload:p}});return M({points:g,layout:x},o)});var qt=Pt({chartName:"LineChart",GraphicalChild:ie,axisComponents:[{axisType:"xAxis",AxisComp:Le},{axisType:"yAxis",AxisComp:De}],formatAxisMap:Ot});const F={implemented:"#22c55e",inProgress:"#3b82f6",notStarted:"#94a3b8",notApplicable:"#6b7280",approved:"#22c55e",review:"#f59e0b",draft:"#3b82f6",archived:"#6b7280",verified:"#22c55e",collected:"#3b82f6",pending:"#f59e0b",expired:"#ef4444"},Xe=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d","#a05195","#d45087","#f95d6a","#ff7c43","#ffa600"];function Qs(){const{user:t}=Ze(),[,s]=Ie(),[r,a]=E.useState(),[n,u]=E.useState(),[l,c]=E.useState(!1),d=_.useUtils();E.useEffect(()=>{if(new URLSearchParams(window.location.search).get("onboarding")==="complete"){d.clients.list.invalidate(),d.dashboard.enhanced.invalidate();const A=new URL(window.location.href);A.searchParams.delete("onboarding"),window.history.replaceState({},"",A.toString())}},[d]);const{data:o,isLoading:x}=_.dashboard.enhanced.useQuery({framework:r,clientId:n},{enabled:!!t}),{data:g,isLoading:p}=_.clients.list.useQuery(void 0,{enabled:!!t}),{data:v,isLoading:h}=_.dashboard.complianceScores.useQuery(void 0,{enabled:!!t}),{data:j,isLoading:S}=_.vendorAnalytics.getOverdueAssessments.useQuery(void 0,{enabled:!!t}),{data:P}=_.dashboard.getInsights.useQuery({clientId:n},{enabled:!!t}),L=Array.isArray(P)?P:[],[y,m]=E.useState(!1),[f,Q]=E.useState(null),[$,H]=E.useState(80),K=_.clients.setTargetScore.useMutation({onSuccess:()=>{V.success(`Target score updated for ${f==null?void 0:f.name}`),d.dashboard.complianceScores.invalidate(),m(!1)},onError:i=>{V.error(`Failed to update target: ${i.message}`)}}),U=_.clients.createSampleData.useMutation({onSuccess:i=>{V.success("Magic Sample Data workspace created!"),d.clients.list.invalidate(),d.dashboard.enhanced.invalidate(),s(`/clients/${i.id}`)},onError:i=>{V.error(`Sample data creation failed: ${i.message}`)}}),Z=()=>{f&&K.mutate({clientId:f.id,targetScore:$})},N=(o==null?void 0:o.controlsByStatus)||{implemented:0,inProgress:0,notStarted:0,notApplicable:0},B=(o==null?void 0:o.policiesByStatus)||{approved:0,review:0,draft:0,archived:0},z=(o==null?void 0:o.evidenceByStatus)||{verified:0,collected:0,pending:0,expired:0,notApplicable:0},G=(o==null?void 0:o.controlsByFramework)||{},b=(o==null?void 0:o.overview)||{totalClients:0,totalControls:0,totalPolicies:0,totalEvidence:0,totalLLMProviders:0,highRisks:0,maxClients:2,ownedClientsCount:0},ne=(o==null?void 0:o.clientsOverview)||[],he=(o==null?void 0:o.recentActivity)||[],le=[{name:"Implemented",value:Number(N.implemented),color:F.implemented},{name:"In Progress",value:Number(N.inProgress),color:F.inProgress},{name:"Not Started",value:Number(N.notStarted),color:F.notStarted},{name:"N/A",value:Number(N.notApplicable),color:F.notApplicable}].filter(i=>i.value>0),we=[{name:"Approved",value:Number(B.approved),color:F.approved},{name:"In Review",value:Number(B.review),color:F.review},{name:"Draft",value:Number(B.draft),color:F.draft},{name:"Archived",value:Number(B.archived),color:F.archived}].filter(i=>i.value>0),Ce=[{name:"Verified",value:Number(z.verified),color:F.verified},{name:"Collected",value:Number(z.collected),color:F.collected},{name:"Pending",value:Number(z.pending),color:F.pending},{name:"Expired",value:Number(z.expired),color:F.expired},{name:"N/A",value:Number(z.notApplicable),color:F.notApplicable}].filter(i=>i.value>0),_e=Object.entries(G).map(([i,A])=>({name:i,count:A})),Fe=(N.implemented||0)+(N.inProgress||0)+(N.notStarted||0),J=Fe>0?Math.round((N.implemented||0)/Fe*100):0,oe=!x&&!p&&g&&g.length===0&&!l,[fe,Me]=E.useState(!1);return E.useEffect(()=>{oe&&c(!0)},[oe]),E.useEffect(()=>{l&&p?Me(!0):fe&&!p&&Me(!1)},[l,p,fe]),oe||fe?e.jsxs(ze,{children:[oe&&e.jsx(Qe,{}),fe&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading your workspace..."})]})}),oe&&e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 mt-12 px-4",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-primary/10 mb-2",children:e.jsx(q,{className:"h-10 w-10 text-primary"})}),e.jsx("h1",{className:"text-4xl font-extrabold tracking-tight",children:"Set up your Compliance OS"}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Follow our guided path to get audit-ready in record time. Complete these steps to activate your live compliance reports."})]}),e.jsx(Ve,{stats:o}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pt-12",children:[e.jsxs(w,{className:"bg-white/50 border-none shadow-sm h-full",children:[e.jsx(I,{className:"pb-2",children:e.jsxs(D,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-blue-500"}),"Auto-Policies"]})}),e.jsx(C,{children:e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Get 20+ policies tailored to your industry instantly using our AI policy engine."})})]}),e.jsxs(w,{className:"bg-white/50 border-none shadow-sm h-full",children:[e.jsx(I,{className:"pb-2",children:e.jsxs(D,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-purple-500"}),"Unified Controls"]})}),e.jsx(C,{children:e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Map one master control to multiple frameworks like ISO 27001 and SOC 2 seamlessly."})})]}),e.jsxs(w,{className:"bg-white/50 border-none shadow-sm h-full",children:[e.jsx(I,{className:"pb-2",children:e.jsxs(D,{className:"text-sm font-bold flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-emerald-500"}),"Live Monitoring"]})}),e.jsx(C,{children:e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Connect your cloud stack to automate evidence collection and get real-time readiness scores."})})]})]}),e.jsxs("div",{className:"pt-8 flex flex-col items-center gap-4",children:[e.jsxs(k,{variant:"default",className:"bg-indigo-600 hover:bg-indigo-700 h-12 px-8 font-bold shadow-lg shadow-indigo-200 animate-pulse",onClick:()=>U.mutate({name:"DEMO Organization",industry:"Technology"}),disabled:U.isPending,children:[e.jsx(ae,{className:"mr-2 h-5 w-5"}),U.isPending?"Generating Magic...":"Explore with Demo Data"]}),e.jsxs(k,{variant:"ghost",className:"text-muted-foreground hover:text-primary",onClick:()=>s("/learning"),children:[e.jsx(jt,{className:"mr-2 h-4 w-4"}),"Not ready yet? Explore the Learning Zone"]})]})]})]}):e.jsxs(ze,{children:[e.jsx(Qe,{}),e.jsxs("div",{className:"space-y-8 page-transition",children:[e.jsx(ft,{items:[{label:"Dashboard"}]}),e.jsxs("div",{className:"flex items-start justify-between gap-8 animate-slide-down",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Compliance Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Overview of compliance status across all clients"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[g&&g.length>0&&e.jsxs("div",{className:"flex items-center gap-2 bg-background border rounded-md px-3 py-1 text-sm shadow-sm transition-all hover:border-primary/50",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"Client:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 cursor-pointer pr-8 font-semibold text-primary max-w-[150px] truncate",value:n||"",onChange:i=>u(i.target.value||void 0),children:[e.jsx("option",{value:"",children:"All Clients"}),g.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-background border rounded-md px-3 py-1 text-sm shadow-sm transition-all hover:border-primary/50",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"Standard:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 cursor-pointer pr-8 font-semibold text-primary",value:r||"",onChange:i=>a(i.target.value||void 0),children:[e.jsx("option",{value:"",children:"All Standards"}),e.jsx("option",{value:"ISO 27001",children:"ISO 27001"}),e.jsx("option",{value:"SOC 2",children:"SOC 2"})]})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin"||(t==null?void 0:t.role)==="owner")&&e.jsxs(k,{onClick:()=>s("/clients"),children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),"Add Client"]})]})]}),!x&&o&&(b.totalPolicies===0||b.totalEvidence===0||((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin"||(t==null?void 0:t.role)==="owner")&&b.totalLLMProviders===0)&&e.jsx(Ve,{stats:o,role:t==null?void 0:t.role}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:e.jsxs(w,{className:"lg:col-span-4 border-none bg-gradient-to-r from-blue-600/5 to-purple-600/5 backdrop-blur-sm border border-blue-100/20",children:[e.jsx(I,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-600/10",children:e.jsx(ce,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(D,{className:"text-lg",children:"Compliance Action Center"}),e.jsx(R,{children:"Live updates and required actions"})]})]}),e.jsx(k,{variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:()=>d.dashboard.getInsights.invalidate(),children:"Refresh Actions"})]})}),e.jsx(C,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:L.map(i=>e.jsxs("div",{className:"flex flex-col gap-3 p-4 rounded-xl border bg-white/50 backdrop-blur-md hover:shadow-md transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:`p-1.5 rounded-md ${i.type==="critical"?"bg-red-100 text-red-600":i.type==="warning"?"bg-amber-100 text-amber-600":i.type==="success"?"bg-emerald-100 text-emerald-600":"bg-blue-100 text-blue-600"}`,children:i.type==="critical"?e.jsx($e,{className:"h-4 w-4"}):i.type==="warning"?e.jsx(Ue,{className:"h-4 w-4"}):i.type==="success"?e.jsx(X,{className:"h-4 w-4"}):e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full ${i.type==="critical"?"bg-red-50 text-red-700":i.type==="warning"?"bg-amber-50 text-amber-700":i.type==="success"?"bg-emerald-50 text-emerald-700":"bg-blue-50 text-blue-700"}`,children:i.type})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm text-slate-900 mb-1",children:i.title}),e.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:i.description})]}),e.jsxs(k,{variant:"ghost",size:"sm",className:"w-full mt-1 h-8 text-xs border border-slate-100 hover:bg-slate-50 transition-colors justify-between group-hover:border-blue-200",onClick:()=>s(i.link),children:[i.action,e.jsx(ye,{className:"h-3 w-3 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all"})]})]},i.id))})})]})}),e.jsxs("div",{className:"dashboard-grid grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[e.jsx(w,{className:"hover-lift shadow-premium border-l-4 border-l-blue-500",children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clients"}),x?e.jsx(O,{className:"h-8 w-16 mt-2"}):e.jsx("h3",{className:"text-3xl font-bold mt-2 metric-value",children:(b==null?void 0:b.totalClients)||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:(t==null?void 0:t.role)==="super_admin"?"Unlimited Organizations":`${(b==null?void 0:b.ownedClientsCount)||0} / ${(b==null?void 0:b.maxClients)||2} used`})]}),e.jsx("div",{className:"p-3 rounded-lg bg-blue-100 text-blue-600",children:e.jsx(Be,{className:"w-6 h-6"})})]})})}),e.jsx(w,{className:"hover-lift shadow-premium border-l-4 border-l-purple-500",children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Master Controls"}),x?e.jsx(O,{className:"h-8 w-16 mt-2"}):e.jsx("h3",{className:"text-3xl font-bold mt-2 metric-value",children:(b==null?void 0:b.totalControls)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[G["ISO 27001"]||0," ISO Â· ",G["SOC 2"]||0," SOC 2"]})]}),e.jsx("div",{className:"p-3 rounded-lg bg-purple-100 text-purple-600",children:e.jsx(q,{className:"w-6 h-6"})})]})})}),e.jsx(w,{className:"hover-lift shadow-premium border-l-4 border-l-amber-500",children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Policy Templates"}),x?e.jsx(O,{className:"h-8 w-16 mt-2"}):e.jsx("h3",{className:"text-3xl font-bold mt-2 metric-value",children:(b==null?void 0:b.totalPolicies)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(B==null?void 0:B.approved)||0," approved"]})]}),e.jsx("div",{className:"p-3 rounded-lg bg-amber-100 text-amber-600",children:e.jsx(ee,{className:"w-6 h-6"})})]})})}),e.jsx(w,{className:"hover-lift shadow-premium border-l-4 border-l-red-500 cursor-pointer group",onClick:()=>s("/risk-register"),children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Flagged Risks"}),e.jsxs("span",{className:"flex h-2 w-2 relative",title:"Live Risk Monitoring",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})]})]}),x?e.jsx(O,{className:"h-8 w-16 mt-2"}):e.jsx("h3",{className:"text-3xl font-bold mt-2 metric-value group-hover:text-red-600 transition-colors",children:(b==null?void 0:b.highRisks)||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High & Critical severity"})]}),e.jsx("div",{className:"p-3 rounded-lg bg-red-100 text-red-600 group-hover:bg-red-200 transition-colors",children:e.jsx(ut,{className:"w-6 h-6"})})]})})}),e.jsx(w,{className:"hover-lift shadow-premium border-l-4 border-l-emerald-500",children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Overall Compliance"}),x?e.jsx(O,{className:"h-8 w-16 mt-2"}):e.jsxs("h3",{className:"text-3xl font-bold mt-2 metric-value",children:[J,"%"]}),e.jsx("div",{className:"mt-2",children:e.jsx(Pe,{value:J,className:"h-2",indicatorClassName:J>=100?"progress-success":J>=80?"progress-brand":J>=50?"progress-teal":J>=25?"progress-warning":"progress-error"})})]}),e.jsx("div",{className:"p-3 rounded-lg bg-emerald-100 text-emerald-600",children:e.jsx(ge,{className:"w-6 h-6"})})]})})})]}),e.jsxs(w,{className:"col-span-full border-none shadow-lg shadow-blue-50/50",children:[e.jsxs(I,{className:"pb-2",children:[e.jsxs(D,{className:"flex items-center gap-2 text-lg",children:[e.jsx(ge,{className:"h-5 w-5 text-blue-600"}),"Compliance Performance Trend"]}),e.jsx(R,{children:"Overall compliance improvement over the last 6 months"})]}),e.jsx(C,{children:h?e.jsx(O,{className:"h-64 w-full"}):v&&v.length>0?e.jsx("div",{className:"h-64 w-full mt-4",children:e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(qt,{data:v||[],children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorScore",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),e.jsx(Le,{dataKey:"date",stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1,dy:10}),e.jsx(De,{stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1,unit:"%",dx:-10}),e.jsx(pe,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e2e8f0",borderRadius:"12px",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},labelStyle:{fontWeight:"bold",color:"#1e293b"}}),e.jsx(ve,{verticalAlign:"top",height:36}),e.jsx(ie,{type:"monotone",dataKey:"score",name:"Compliance Score",stroke:"#3b82f6",strokeWidth:4,dot:{r:4,fill:"#3b82f6",strokeWidth:2,stroke:"#fff"},activeDot:{r:6,stroke:"#fff",strokeWidth:2}}),e.jsx(ie,{type:"stepAfter",dataKey:"target",name:"Target Goal",stroke:"#cbd5e1",strokeDasharray:"5 5",strokeWidth:2,dot:!1})]})})}):e.jsx("div",{className:"h-64 flex items-center justify-center border-2 border-dashed rounded-xl mt-4 bg-slate-50/50",children:e.jsx(te,{icon:ce,title:"No Trend Data",description:"Complete your first assessments to start seeing compliance trends.",className:"border-none bg-transparent"})})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(w,{children:[e.jsxs(I,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-4 w-4"}),"Control Status"]}),e.jsx(R,{children:"Implementation status across all clients"})]}),e.jsx(C,{children:x?e.jsx(O,{className:"h-48 w-full"}):le.length>0?e.jsx("div",{className:"h-48 w-full",children:e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(Ae,{children:[e.jsx(Se,{data:le,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",onClick:i=>{const Y={Implemented:"implemented","In Progress":"in_progress","Not Started":"not_implemented","N/A":"not_applicable"}[i.name];Y&&s(`/client-controls?status=${Y}`)},cursor:"pointer",children:le.map((i,A)=>e.jsx(be,{fill:i.color},`cell-${A}`))}),e.jsx(pe,{}),e.jsx(ve,{})]})})}):e.jsx(te,{icon:q,title:"No Controls Found",description:"Start by adding your first compliance control to track progress.",action:{label:"Add Control",onClick:()=>s("/client-controls")},className:"h-48"})})]}),e.jsxs(w,{children:[e.jsxs(I,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Policy Status"]}),e.jsx(R,{children:"Policy approval status"})]}),e.jsx(C,{children:x?e.jsx(O,{className:"h-48 w-full"}):we.length>0?e.jsx("div",{className:"h-48 w-full",children:e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(Ae,{children:[e.jsx(Se,{data:we,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",onClick:i=>{const Y={Approved:"approved","In Review":"review",Draft:"draft",Archived:"archived"}[i.name];Y&&s(`/client-policies?status=${Y}`)},cursor:"pointer",children:we.map((i,A)=>e.jsx(be,{fill:i.color},`cell-${A}`))}),e.jsx(pe,{}),e.jsx(ve,{})]})})}):e.jsx(te,{icon:ee,title:"No Policies Found",description:"Generate or upload policies to manage your compliance framework.",action:{label:"Add Policy",onClick:()=>s("/client-policies")},className:"h-48"})})]}),e.jsxs(w,{children:[e.jsxs(I,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Evidence Status"]}),e.jsx(R,{children:"Evidence verification status"})]}),e.jsx(C,{children:x?e.jsx(O,{className:"h-48 w-full"}):Ce.length>0?e.jsx("div",{className:"h-48 w-full",children:e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(Ae,{children:[e.jsx(Se,{data:Ce,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",onClick:i=>{const Y={Verified:"verified",Collected:"collected",Pending:"pending",Expired:"expired","N/A":"not_applicable"}[i.name];Y&&s(`/evidence?status=${Y}`)},cursor:"pointer",children:Ce.map((i,A)=>e.jsx(be,{fill:i.color},`cell-${A}`))}),e.jsx(pe,{}),e.jsx(ve,{})]})})}):e.jsx(te,{icon:X,title:"No Evidence Found",description:"Upload evidence files to demonstrate control implementation.",action:{label:"Add Evidence",onClick:()=>s("/evidence")},className:"h-48"})})]})]}),e.jsxs(w,{children:[e.jsxs(I,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-4 w-4"}),"Controls by Framework"]}),e.jsx(R,{children:"Distribution of controls in the master library"})]}),e.jsx(C,{children:x?e.jsx(O,{className:"h-32 w-full"}):e.jsx("div",{className:"h-32",children:e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(_t,{data:_e,layout:"vertical",children:[e.jsx(Le,{type:"number"}),e.jsx(De,{dataKey:"name",type:"category",width:150}),e.jsx(pe,{cursor:{fill:"transparent"}}),e.jsx(Lt,{dataKey:"count",radius:[0,4,4,0],children:_e.map((i,A)=>e.jsx(be,{fill:Xe[A%Xe.length]},`cell-${A}`))})]})})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(w,{className:"border-l-4 border-l-red-500",children:[e.jsxs(I,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4 text-red-500"}),"Overdue Assessments",j&&j.length>0&&e.jsx("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-0.5 rounded-full",children:j.length})]}),e.jsx(R,{children:"Pending vendor assessments past due"})]}),e.jsx(C,{children:S?e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{className:"h-16 w-full"}),e.jsx(O,{className:"h-16 w-full"})]}):j&&j.length>0?e.jsxs("div",{className:"space-y-3",children:[j.slice(0,5).map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-white shadow-sm",children:[e.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[e.jsx("p",{className:"font-medium truncate text-sm",children:i.vendorName}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:i.assessmentType})]}),e.jsxs("div",{className:"text-right flex flex-col items-end gap-1",children:[e.jsx("span",{className:"text-xs font-semibold text-red-600 bg-red-100 px-2 py-0.5 rounded-full whitespace-nowrap",children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"Overdue"}),e.jsx(k,{variant:"ghost",size:"sm",className:"h-6 text-xs px-2",onClick:()=>s(`/clients/${i.clientId}/vendors/${i.vendorId}?tab=assessments`),children:"View"})]})]},i.id)),j.length>5&&e.jsxs("p",{className:"text-xs text-center text-muted-foreground mt-2",children:["+ ",j.length-5," more overdue"]})]}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(X,{className:"h-10 w-10 mx-auto mb-3 text-green-500 opacity-50"}),e.jsx("p",{className:"text-sm",children:"All assessments on track"})]})})]}),e.jsxs(w,{className:"border-l-4 border-l-blue-500",children:[e.jsxs(I,{className:"pb-2",children:[e.jsxs(D,{className:"text-base flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4 text-blue-500"}),"Client Compliance Overview"]}),e.jsx(R,{children:"Compliance progress by client"})]}),e.jsx(C,{children:x?e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{className:"h-16 w-full"}),e.jsx(O,{className:"h-16 w-full"}),e.jsx(O,{className:"h-16 w-full"})]}):ne.length>0?e.jsxs("div",{className:"space-y-4",children:[ne.slice(0,5).map(i=>e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>s(`/clients/${i.id}`),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"font-medium truncate",children:i.name}),e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[i.compliancePercentage,"%"]})]}),e.jsx(Pe,{value:i.compliancePercentage,className:"h-2",indicatorClassName:i.compliancePercentage>=100?"progress-success":i.compliancePercentage>=80?"progress-brand":i.compliancePercentage>=50?"progress-teal":i.compliancePercentage>=25?"progress-warning":"progress-error"}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[i.controlsCount," controls"]}),e.jsxs("span",{children:[i.policiesCount," policies"]}),e.jsxs("span",{children:[i.evidenceCount," evidence"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-emerald-600 hover:bg-emerald-50",title:"View Strategic Roadmap",onClick:A=>{A.stopPropagation(),s(`/clients/${i.id}/readiness/roadmap`)},children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]})]},i.id)),(ne.length>5||g&&g.length>5)&&e.jsx(k,{variant:"ghost",className:"w-full",onClick:()=>s("/clients"),children:"View all clients"})]}):e.jsx(te,{icon:xt,title:"No Organizations Yet",description:"Create your first organization workspace to start managing compliance.",action:(t==null?void 0:t.role)==="admin"?{label:"Create Organization",onClick:()=>s("/clients")}:void 0,className:"py-12"})})]}),e.jsxs(w,{className:"border-l-4 border-l-purple-500",children:[e.jsxs(I,{className:"pb-2",children:[e.jsxs(D,{className:"text-base flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-purple-500"}),"Recent Activity"]}),e.jsx(R,{children:"Latest updates across all clients"})]}),e.jsx(C,{children:x?e.jsxs("div",{className:"space-y-3",children:[e.jsx(O,{className:"h-12 w-full"}),e.jsx(O,{className:"h-12 w-full"}),e.jsx(O,{className:"h-12 w-full"})]}):he.length>0?e.jsx("div",{className:"space-y-3",children:he.map((i,A)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsx("div",{className:`p-2 rounded-full ${i.type==="control"?"bg-blue-100 text-blue-600":i.type==="policy"?"bg-green-100 text-green-600":"bg-amber-100 text-amber-600"}`,children:i.type==="control"?e.jsx(q,{className:"h-3 w-3"}):i.type==="policy"?e.jsx(ee,{className:"h-3 w-3"}):e.jsx(X,{className:"h-3 w-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:i.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.type.charAt(0).toUpperCase()+i.type.slice(1)," updated"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),new Date(i.updatedAt).toLocaleDateString()]})]},A))}):e.jsx(te,{icon:ce,title:"No Recent Activity",description:"Latest updates will appear here once you start managing your workspace.",className:"py-12 border-none bg-transparent"})})]})]}),e.jsxs(w,{children:[e.jsxs(I,{children:[e.jsx(D,{children:"Quick Actions"}),e.jsx(R,{children:"Common tasks to manage compliance"})]}),e.jsx(C,{children:e.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[(t==null?void 0:t.role)==="admin"&&e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"outline",className:"justify-start h-auto py-4",onClick:()=>s("/clients"),children:e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Add Client"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Create new workspace"})]})}),e.jsx(k,{variant:"outline",className:"justify-start h-auto py-4",onClick:()=>s("/controls"),children:e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Control Library"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Manage master controls"})]})}),e.jsx(k,{variant:"outline",className:"justify-start h-auto py-4",onClick:()=>s("/policy-templates"),children:e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Policy Templates"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Create templates"})]})})]}),e.jsx(k,{variant:"outline",className:"justify-start h-auto py-4",onClick:()=>s("/evidence"),children:e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Evidence Tracking"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Track compliance evidence"})]})}),e.jsx(k,{variant:"outline",className:"justify-start h-auto py-4",onClick:()=>s("/clients"),children:e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-emerald-600"}),e.jsx("span",{className:"font-medium",children:"Strategic Planning"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Manage client roadmaps"})]})})]})})]})]}),e.jsx(ht,{open:y,onOpenChange:m,title:"Set Target Compliance Score",description:`Set a target compliance percentage for ${f==null?void 0:f.name}`,footer:e.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[e.jsx(k,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(k,{onClick:Z,disabled:K.isPending,children:K.isPending?"Saving...":"Save Target"})]}),children:e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"targetScore",children:"Target Score (%)"}),e.jsx(Je,{id:"targetScore",type:"number",min:0,max:100,value:$,onChange:i=>H(Math.min(100,Math.max(0,parseInt(i.target.value)||0)))}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Current score: ",f==null?void 0:f.currentTarget,"%"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{children:"Quick Select"}),e.jsx("div",{className:"flex gap-2",children:[50,70,80,90,100].map(i=>e.jsxs(k,{variant:$===i?"default":"outline",size:"sm",onClick:()=>H(i),children:[i,"%"]},i))})]})]})})]})}export{Qs as default};
