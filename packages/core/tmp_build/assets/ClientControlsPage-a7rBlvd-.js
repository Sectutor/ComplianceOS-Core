import{M as ke,t as j,j as e,k as A,F as Ae,r as m,i as x,C as X,l as Ie,d as De,e as Ee,S as O,f as Te,m as Y,c as n,x as Le,ab as Pe,u as Fe,b as Me,E as ie,G as ce,H as de,J as me,K as E,L as K,v as pe,I as Z,A as ue,N as ze,O as Be,P as xe,Q as C,V as Oe,W as N,az as Ue,aA as _e,aB as $e,z as Re,aC as He}from"./index-DOc7Nwb7.js";import{P as Ve,g as Ge,h as We,D as Je,l as Qe}from"./DashboardLayout-aHnUqq57.js";import{E as ee}from"./enhanced-dialog-CeRPsI16.js";import{c as se}from"./utils-BC5CVi_C.js";import{a as qe}from"./ControlDetailsDialog-C3wFd0o2.js";import{L as he,P as Ke}from"./PageGuide-CPKKXXS6.js";import{U as Ze}from"./upload-BBmUECj8.js";import{A as Xe,a as Ye,b as es,c as ss,d as ts,e as ls,f as rs,g as as}from"./alert-dialog-V7xGXdVc.js";import{L as ns}from"./layout-grid-CGqkIAJU.js";import{L as os}from"./list-BZOuFwEg.js";import{D as is}from"./download-ByfWg1Mi.js";import{P as ge}from"./plus-BaQ35Jcx.js";import{T as cs}from"./trash-2-CFEfisbM.js";import{S as ds}from"./square-pen-ClRv15cM.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./user-CqRnJLgW.js";import"./separator-BWuYil37.js";import"./textarea-BtxBxzdY.js";import"./tabs-CBDTXbEn.js";import"./info-By5wLOUH.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=ke("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);function ps({controlId:I,controlName:i,framework:T,category:f,children:c}){const{data:g=[],isLoading:v}=j.evidenceSuggestions.getSuggestions.useQuery({controlId:I,controlName:i,framework:T,category:f},{staleTime:6e4});if(v||g.length===0)return e.jsx(e.Fragment,{children:c});const b=l=>{switch(l){case"api":return e.jsx(ms,{className:"h-3 w-3 text-blue-500"});case"file":return e.jsx(Ze,{className:"h-3 w-3 text-green-500"});default:return e.jsx(Ae,{className:"h-3 w-3 text-gray-500"})}};return e.jsxs(Ve,{children:[e.jsx(Ge,{asChild:!0,children:e.jsxs("div",{className:"cursor-pointer inline-flex items-center gap-1.5",children:[c,e.jsxs(A,{variant:"outline",className:"text-[10px] px-1.5 py-0 bg-amber-50 border-amber-200 text-amber-700 hover:bg-amber-100 gap-0.5",children:[e.jsx(he,{className:"h-2.5 w-2.5"}),g.length]})]})}),e.jsx(We,{className:"w-80",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-amber-700",children:[e.jsx(he,{className:"h-4 w-4"}),"Evidence Suggestions"]}),e.jsx("div",{className:"space-y-2",children:g.slice(0,3).map(l=>{var L;return e.jsxs("div",{className:"border rounded-md p-2 bg-muted/30 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium",children:[b(l.integrationType),l.name]}),((L=l.suggestedSources)==null?void 0:L.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:l.suggestedSources.slice(0,3).map((P,d)=>e.jsx(A,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:P},d))}),l.sampleDescription&&e.jsx("p",{className:"text-[10px] text-muted-foreground line-clamp-2",children:l.sampleDescription})]},l.id)})}),g.length>3&&e.jsxs("p",{className:"text-[10px] text-muted-foreground text-center",children:["+",g.length-3," more suggestions"]})]})})]})}const us=[{id:"low",name:"Low Impact",description:"For systems where the loss of confidentiality, integrity, or availability has a limited adverse effect.",controlCount:"~120",color:"bg-green-50 border-green-200 hover:border-green-300"},{id:"moderate",name:"Moderate Impact",description:"For systems where the loss has a serious adverse effect. Includes all Low controls plus additional safeguards.",controlCount:"~260",color:"bg-blue-50 border-blue-200 hover:border-blue-300"},{id:"high",name:"High Impact",description:"For systems where the loss has a severe or catastrophic adverse effect. Includes Low & Moderate controls.",controlCount:"~350",color:"bg-orange-50 border-orange-200 hover:border-orange-300"}];function xs({open:I,onOpenChange:i,clientId:T,onSuccess:f}){const[c,g]=m.useState(null),v=j.clientControls.applyBaseline.useMutation({onSuccess:l=>{x.success(`Applied ${l.added} controls from NIST ${c==null?void 0:c.toUpperCase()} baseline.`),i(!1),f&&f()},onError:l=>{x.error("Failed to apply baseline: "+l.message)}}),b=()=>{c&&v.mutate({clientId:T,framework:"NIST SP 800-53 Rev 5",baseline:c})};return e.jsx(ee,{open:I,onOpenChange:i,title:"NIST SP 800-53 Baseline Selection",description:"Select a security control baseline based on your system's impact level (FIPS 199).",size:"lg",footer:e.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[e.jsx(n,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(n,{onClick:b,disabled:!c||v.isPending,className:"min-w-[100px]",children:[v.isPending?e.jsx(Le,{className:"w-4 h-4 animate-spin mr-2"}):null,"Apply Baseline"]})]}),children:e.jsxs("div",{className:"py-4 space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:us.map(l=>e.jsxs(X,{className:se("cursor-pointer transition-all border-2 relative",l.color,c===l.id?"ring-2 ring-primary border-primary":"border-transparent"),onClick:()=>g(l.id),children:[c===l.id&&e.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground rounded-full p-1",children:e.jsx(Ie,{className:"w-3 h-3"})}),e.jsxs(De,{className:"pb-2",children:[e.jsxs(Ee,{className:"text-base flex items-center gap-2",children:[e.jsx(O,{className:se("w-4 h-4",c===l.id?"fill-current":"")}),l.name]}),e.jsxs(Te,{className:"text-xs font-mono",children:[l.controlCount," Controls"]})]}),e.jsx(Y,{children:e.jsx("p",{className:"text-sm text-muted-foreground leading-snug",children:l.description})})]},l.id))}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded text-xs text-muted-foreground border",children:[e.jsx("span",{className:"font-semibold",children:"Note:"})," Applying a baseline is additive. It will add any missing controls from the selected baseline to your client profile. Existing controls will remain unchanged."]})]})})}function ct(){const{clientId:I}=Pe(),i=parseInt(I||"0"),{user:T}=Fe();Me();const{data:f,isLoading:c}=j.clients.get.useQuery({id:i},{enabled:i>0}),{data:g,isLoading:v,error:b,refetch:l}=j.clientControls.list.useQuery({clientId:i},{enabled:i>0}),{data:L}=j.controls.list.useQuery();b&&console.error("Error loading client controls:",b);const P=s=>s&&typeof s=="object"&&"json"in s&&Array.isArray(s.json)?s.json:s,d=P(g)||[],te=P(L)||[];m.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("openControlId");if(t&&d.length>0){const r=d.find(o=>o.clientControl.id===parseInt(t));r&&k(r)}},[d]);const[U,le]=m.useState("card"),[_,je]=m.useState("all"),[fe,w]=m.useState(!1),[be,re]=m.useState(!1),[$,R]=m.useState([]),[H,Ce]=m.useState(""),[S,V]=m.useState([]),[F,k]=m.useState(null),[G,W]=m.useState(null),[h,D]=m.useState(null),[hs,Ne]=m.useState(null),ae=Array.from(new Set((d==null?void 0:d.map(s=>{var t;return((t=s.control)==null?void 0:t.framework)||"Uncategorized"}))||[])).sort(),ne=["ISO 27001","SOC 2","GDPR","HIPAA","NIST CSF"],ve=(d||[]).filter(s=>{var t;return!(_!=="all"&&(((t=s.control)==null?void 0:t.framework)||"Uncategorized")!==_)}),J=j.clientControls.create.useMutation({onSuccess:()=>{x.success("Control assigned to client"),w(!1),l()},onError:s=>x.error(s.message)}),ye=j.clientControls.delete.useMutation({onSuccess:()=>{x.success("Control removed"),l(),W(null)},onError:s=>x.error(s.message)}),Q=j.clientControls.update.useMutation({onSuccess:()=>{x.success("Control updated"),l(),Ne(null)},onError:s=>{x.error(s.message),s.message.toLowerCase().includes("justification")}}),q=j.clientControls.bulkAssign.useMutation({onSuccess:s=>{x.success(s.message),l()},onError:s=>x.error(s.message)}),we=async()=>{if(S.length===0){x.error("Please select at least one framework");return}await q.mutateAsync({clientId:i,framework:S}),w(!1),V([])},Se=s=>{if(s.preventDefault(),$.length===0){x.error("Please select at least one control");return}$.forEach(t=>{J.mutate({clientId:i,controlId:parseInt(t),status:"not_implemented"})})};return e.jsx(Je,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Selected Controls"}),e.jsxs(A,{variant:"secondary",className:"rounded-full px-2.5 py-0.5 text-xs font-semibold bg-blue-50 text-blue-700 border-blue-200",children:[d.length," Controls"]}),e.jsx(Ke,{title:"Client Control Implementation",description:"Manage and validate the implementation of security controls for this client.",rationale:"Controls are the operational reality of compliance. This page allows you to track which controls are applicable, their implementation status, and link evidence to prove they are working.",howToUse:[{step:"Assign Controls",description:"Import controls from the Global Library or use the 'Select Baseline' wizard to bulk-add NIST controls."},{step:"Review Controls",description:"Use filters to find specific controls (e.g., 'Access Control')."},{step:"Determine Applicability",description:"Mark controls as 'Applicable' or 'Not Applicable' with justification."},{step:"Update Status",description:"Track progress from 'Not Implemented' to 'Implemented'."},{step:"Upload Evidence",description:"Click the 'Edit' icon to upload proof of compliance."}],integrations:[{name:"Frameworks",description:"Controls are automatically mapped to standards like SOC 2 and ISO 27001."},{name:"Evidence Library",description:"Uploaded files are securely stored in the client's evidence repository."},{name:"Readiness Score",description:"Completed controls directly increase your compliance readiness score."}]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex bg-muted rounded-md p-1 items-center",children:[e.jsx(n,{variant:U==="card"?"secondary":"ghost",size:"sm",onClick:()=>le("card"),className:"h-8 px-2",title:"Card View",children:e.jsx(ns,{className:"h-4 w-4"})}),e.jsx(n,{variant:U==="table"?"secondary":"ghost",size:"sm",onClick:()=>le("table"),className:"h-8 px-2",title:"Statement of Applicability (Table)",children:e.jsx(os,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"w-[200px]",children:e.jsxs(ie,{value:_,onValueChange:je,children:[e.jsx(ce,{className:"h-8",children:e.jsx(de,{placeholder:"Filter Framework"})}),e.jsxs(me,{children:[e.jsx(E,{value:"all",children:"All Frameworks"}),ae.map(s=>e.jsx(E,{value:s,children:s},s)),ne.filter(s=>!ae.includes(s)).map(s=>e.jsxs(E,{value:s,disabled:!0,className:"opacity-50",children:[s," (Not Assigned)"]},s))]})]})}),e.jsxs(n,{variant:"outline",onClick:()=>{window.location.assign(`/api/export/soa/${f==null?void 0:f.id}`)},title:"Export SoA to Word",children:[e.jsx(is,{className:"mr-2 h-4 w-4"}),"Export SoA"]}),e.jsxs(n,{className:"bg-green-600 hover:bg-green-700 text-white border-green-700",onClick:()=>re(!0),children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Select Baseline"]}),e.jsxs(n,{onClick:()=>w(!0),children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Assign Control"]})]})]}),e.jsx(xs,{open:be,onOpenChange:re,clientId:i,onSuccess:()=>l()}),e.jsx(ee,{open:fe,onOpenChange:w,title:"Assign Controls",description:"Select individual controls or bulk assign standard frameworks.",size:"xl",footer:e.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(n,{onClick:()=>{const s=document.getElementById("assign-control-form");s&&s.requestSubmit()},disabled:J.isPending,children:J.isPending?"Assigning...":"Assign Selected"})]}),children:e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg border",children:[e.jsx(K,{className:"text-base font-semibold mb-2 block",children:"Bulk Assignment"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select frameworks to automatically assign all their standard controls."}),e.jsx("div",{className:"flex flex-wrap gap-4 mb-4",children:ne.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{id:`bulk-${s}`,checked:S.includes(s),onCheckedChange:t=>{V(t?[...S,s]:S.filter(r=>r!==s))}}),e.jsx("label",{htmlFor:`bulk-${s}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s})]},s))}),e.jsx(n,{type:"button",size:"sm",variant:"secondary",onClick:we,disabled:q.isPending||S.length===0,children:q.isPending?"Assigning...":"Assign Selected Frameworks"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or select individually"})})]}),e.jsxs("form",{id:"assign-control-form",onSubmit:Se,className:"grid gap-2",children:[e.jsx(K,{htmlFor:"controlSearch",children:"Search Controls"}),e.jsx(Z,{id:"controlSearch",value:H,onChange:s=>Ce(s.target.value),placeholder:"Type to filter controls..."}),e.jsx("div",{className:"mt-2 max-h-[40vh] overflow-auto rounded border",children:Object.entries((te||[]).filter(s=>(s.controlId+" "+s.name+" "+(s.description||"")).toLowerCase().includes(H.toLowerCase())).reduce((s,t)=>{const r=t.framework||"Uncategorized",o=t.category||"General";return s[r]||(s[r]={}),s[r][o]||(s[r][o]=[]),s[r][o].push(t),s},{})).map(([s,t])=>e.jsxs("div",{className:"border-b last:border-b-0",children:[e.jsx("div",{className:"bg-muted/50 px-3 py-2 font-semibold text-sm sticky top-0 z-10",children:s}),Object.entries(t).map(([r,o])=>e.jsxs("div",{children:[e.jsx("div",{className:"bg-muted/20 px-3 py-1.5 text-xs font-medium text-muted-foreground sticky top-9 z-10 backdrop-blur-sm",children:r}),o.map(a=>{const p=a.id.toString(),y=$.includes(p);return e.jsxs("label",{className:"flex items-start gap-2 px-3 py-2 hover:bg-muted/30 cursor-pointer",children:[e.jsx(pe,{checked:y,onCheckedChange:M=>{const z=!!M;R(u=>z?[...u,p]:u.filter(B=>B!==p))}}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"font-medium text-sm text-foreground",children:[a.controlId," - ",a.name]})})]},a.id)})]},`${s}-${r}`))]},s))}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>{const s=(te||[]).filter(t=>(t.controlId+" "+t.name+" "+(t.description||"")).toLowerCase().includes(H.toLowerCase())).map(t=>t.id.toString());R(s)},children:"Select All Filtered"}),e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>R([]),children:"Clear Selection"})]})]})]})}),F&&e.jsx(qe,{open:!!F,onOpenChange:s=>!s&&k(null),clientControl:F.clientControl,control:F.control,clientId:i,onUpdate:()=>l()}),e.jsx(Xe,{open:!!G,onOpenChange:()=>W(null),children:e.jsxs(Ye,{children:[e.jsxs(es,{children:[e.jsx(ss,{children:"Remove Control?"}),e.jsx(ts,{children:"This will remove the control assignment from this client. Any associated evidence or justifications will also be removed."})]}),e.jsxs(ls,{children:[e.jsx(rs,{children:"Cancel"}),e.jsx(as,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:()=>G&&ye.mutate({id:G}),children:"Remove"})]})]})}),e.jsx(ee,{open:!!h,onOpenChange:s=>!s&&D(null),title:"Exclude Control",description:"Please provide a justification for marking this control as Not Applicable.",footer:e.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[e.jsx(n,{variant:"outline",onClick:()=>D(null),children:"Cancel"}),e.jsx(n,{onClick:()=>{h&&(Q.mutate({id:h.id,applicability:"not_applicable",justification:h.justification,status:"not_applicable"}),D(null))},disabled:!(h!=null&&h.justification)||h.justification.length<5,children:"Confirm Exclusion"})]}),children:e.jsxs("div",{className:"py-4",children:[e.jsx(K,{htmlFor:"exclusionJustification",children:"Justification"}),e.jsx(Z,{id:"exclusionJustification",value:(h==null?void 0:h.justification)||"",onChange:s=>D(t=>t?{...t,justification:s.target.value}:null),placeholder:"e.g., Use of cloud provider handles this control...",className:"mt-2"})]})}),b?e.jsxs("div",{className:"p-4 border border-red-200 bg-red-50 text-red-700 rounded-md",children:[e.jsx("h3",{className:"font-bold",children:"Error Loading Controls"}),e.jsx("p",{children:b.message}),e.jsx(n,{variant:"outline",className:"mt-2",onClick:()=>l(),children:"Retry"})]}):v?e.jsxs("div",{className:"space-y-3",children:[e.jsx(ue,{className:"h-16 w-full"}),e.jsx(ue,{className:"h-16 w-full"})]}):d&&d.length>0?U==="card"?e.jsx("div",{className:"space-y-6",children:Object.entries((ve||[]).reduce((s,t)=>{var a,p;const r=((a=t.control)==null?void 0:a.framework)||"Uncategorized",o=((p=t.control)==null?void 0:p.category)||"General";return s[r]||(s[r]={}),s[r][o]||(s[r][o]=[]),s[r][o].push(t),s},{})).map(([s,t])=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-primary"}),s]}),Object.entries(t).map(([r,o])=>e.jsxs("div",{className:"pl-2 border-l-2 border-muted",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground mb-3 pl-2",children:r}),e.jsx("div",{className:"space-y-3",children:o.map(a=>{var p,y;return e.jsx(X,{className:"cursor-pointer",onDoubleClick:()=>k(a),children:e.jsx(Y,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-sm text-muted-foreground",children:a.clientControl.clientControlId}),e.jsx("span",{className:"font-medium",children:(p=a.control)==null?void 0:p.name}),a.clientControl.applicability==="not_applicable"&&e.jsx(A,{variant:"outline",className:"text-muted-foreground border-dashed",children:"N/A"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a.clientControl.customDescription||((y=a.control)==null?void 0:y.description)}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.clientControl.owner&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-muted rounded",children:["Owner: ",a.clientControl.owner]})})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>k(a),title:"View details & add evidence",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>W(a.clientControl.id),children:e.jsx(cs,{className:"h-4 w-4"})})]})]})})},`${i}-${a.clientControl.id}`)})})]},`${s}-${r}`))]},s))}):e.jsx("div",{className:"rounded-xl border border-slate-200 shadow-xl overflow-hidden bg-white",children:e.jsxs(ze,{className:"table-fancy",children:[e.jsx(Be,{children:e.jsxs(xe,{className:"border-none hover:bg-transparent",children:[e.jsx(C,{className:"w-[100px] py-4",children:"ID"}),e.jsx(C,{className:"w-[200px] py-4",children:"Control Name"}),e.jsx(C,{className:"w-[150px] py-4",children:"Framework"}),e.jsx(C,{className:"w-[180px] py-4",children:"Applicability"}),e.jsx(C,{className:"w-[120px] py-4",children:"Monitoring"}),e.jsx(C,{className:"py-4",children:"Justification"}),e.jsx(C,{className:"w-[120px] py-4 text-center",children:"Status"}),e.jsx(C,{className:"w-[50px] py-4"})]})}),e.jsx(Oe,{children:d.map(s=>{var t,r,o,a,p,y,M,z;return e.jsxs(xe,{className:"bg-white border-b border-slate-200 transition-all duration-200 hover:bg-slate-50 hover:shadow-sm group cursor-pointer",onDoubleClick:()=>k(s),children:[e.jsx(N,{className:"font-mono text-xs font-medium text-black py-4",children:s.clientControl.clientControlId}),e.jsxs(N,{className:"font-medium text-sm text-black py-4",children:[e.jsx(ps,{controlId:s.clientControl.clientControlId,controlName:((t=s.control)==null?void 0:t.name)||"",framework:(r=s.control)==null?void 0:r.framework,category:(o=s.control)==null?void 0:o.category,children:(a=s.control)==null?void 0:a.name}),e.jsx("div",{className:"text-[10px] text-gray-500 line-clamp-1",title:((p=s.control)==null?void 0:p.description)||"",children:(y=s.control)==null?void 0:y.description})]}),e.jsx(N,{className:"text-xs text-gray-600 py-4",children:(M=s.control)==null?void 0:M.framework}),e.jsx(N,{className:"py-4",children:e.jsxs(ie,{value:s.clientControl.applicability||"applicable",onValueChange:u=>{if(u==="not_applicable"&&!s.clientControl.justification){D({id:s.clientControl.id,justification:""});return}Q.mutate({id:s.clientControl.id,applicability:u})},children:[e.jsx(ce,{className:`h-8 w-[140px] text-xs bg-white ${s.clientControl.applicability==="not_applicable"?"text-gray-500":"text-[#1C4D8D] font-medium"}`,children:e.jsx(de,{})}),e.jsxs(me,{children:[e.jsx(E,{value:"applicable",children:"Applicable"}),e.jsx(E,{value:"not_applicable",children:"Not Applicable"})]})]})}),e.jsx(N,{className:"py-4",children:(()=>{var B,oe;const u=((oe=(B=s.clientControl.implementationNotes)==null?void 0:B.match(/Monitoring Frequency: (.*)$/m))==null?void 0:oe[1])||"Manual";return e.jsx(A,{variant:"outline",className:se("text-[10px] font-medium whitespace-nowrap",u==="Continuous"?"bg-indigo-50 text-indigo-700 border-indigo-200":u==="Daily"?"bg-blue-50 text-blue-700 border-blue-200":"text-slate-500 bg-slate-50"),children:u})})()}),e.jsx(N,{className:"py-4",children:e.jsx(Z,{className:"h-8 text-xs bg-white text-black",placeholder:s.clientControl.applicability==="not_applicable"?"Why is this excluded?":"Why is this included?",defaultValue:s.clientControl.justification||"",onBlur:u=>{u.target.value!==s.clientControl.justification&&Q.mutate({id:s.clientControl.id,justification:u.target.value})}})}),e.jsx(N,{className:"py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(A,{variant:s.clientControl.status==="implemented"?"success":s.clientControl.status==="in_progress"?"info":s.clientControl.status==="not_applicable"?"secondary":"warning",className:"uppercase text-[10px] px-3 transition-all",children:(z=s.clientControl.status)==null?void 0:z.replace("_"," ")}),s.clientControl.status!=="not_implemented"&&s.clientControl.status!=="not_applicable"&&(!s.evidenceCount||s.evidenceCount===0)&&e.jsx(Ue,{children:e.jsxs(_e,{children:[e.jsx($e,{asChild:!0,children:e.jsx(Re,{className:"h-4 w-4 text-red-500 animate-pulse cursor-help"})}),e.jsx(He,{children:e.jsx("p",{children:"Missing Evidence!"})})]})})]})}),e.jsx(N,{className:"py-4",children:e.jsx(n,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-[#1C4D8D]/10 hover:text-[#1C4D8D] transition-colors duration-200",onClick:()=>k(s),children:e.jsx(ds,{className:"h-4 w-4"})})})]},s.clientControl.id)})})]})}):e.jsx(X,{className:"py-8",children:e.jsxs(Y,{className:"text-center",children:[e.jsx(O,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No controls assigned yet"}),e.jsxs(n,{onClick:()=>w(!0),children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Assign First Control"]})]})})]})})}export{ct as default};
