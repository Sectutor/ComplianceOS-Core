import{b as P,au as E,t as u,i as m,r as v,j as e,c as p,C as k,d as L,e as B,f as O,m as F,N as H,O as R,P as j,Q as d,V as Q,W as r,k as f,D as V,o as A,p as W,q as z,L as n,I as g,E as y,G as C,H as b,J as S,K as a,w as q}from"./index-DOc7Nwb7.js";import{D as G}from"./DashboardLayout-aHnUqq57.js";import{A as J}from"./arrow-left-CpuUojG-.js";import{P as K}from"./plus-BaQ35Jcx.js";import{F as M}from"./flask-conical-fbX9rPnC.js";import"./index--2vFva6Y.js";import"./search-CwuIBBPE.js";import"./filter-Ceo--4mb.js";import"./clipboard-check-CQkJX5J0.js";import"./sparkles-CoQ80pK2.js";import"./send-FW7-3cjH.js";import"./scroll-area-DPaNxEJD.js";import"./settings-CIu9FFiX.js";import"./circle-check-C5kiwRoG.js";import"./en-US-Bfz1jvxT.js";import"./getTimezoneOffsetInMilliseconds-em2BGgN1.js";import"./rocket-C2MuHhsn.js";import"./scale-BCebIfgE.js";import"./layout-grid-CGqkIAJU.js";import"./book-open-BffBrdze.js";import"./zap-B01fFOkT.js";import"./star-BTvaCCU4.js";import"./briefcase-BxorFA78.js";import"./target-cfAj3L6j.js";import"./database-Bjtecw5f.js";import"./activity-B1F2IRm3.js";import"./shield-check-ETs8j4-d.js";import"./shield-alert-iAruRy4W.js";import"./brain-C-Zi22rJ.js";import"./link-FmUqdGRG.js";import"./lock-czWF3qbC.js";import"./globe-BMGZmoaJ.js";import"./calendar-BlLJlGbj.js";import"./message-square-5hBo7zY3.js";import"./upload-BBmUECj8.js";import"./user-CqRnJLgW.js";function ke(){const[,N]=P(),[$,o]=E("/clients/:clientId/business-continuity/exercises"),i=o!=null&&o.clientId?parseInt(o.clientId):0,{data:c,refetch:T}=u.businessContinuity.exercises.listAll.useQuery({clientId:i},{enabled:!!i}),{data:x}=u.businessContinuity.plans.list.useQuery({clientId:i},{enabled:!!i}),D=u.businessContinuity.exercises.create.useMutation({onSuccess:()=>{m.success("Exercise scheduled/logged"),h(!1),T(),l({planId:"",title:"",type:"Tabletop",date:new Date().toISOString().split("T")[0],status:"Scheduled",notes:""})}}),[I,h]=v.useState(!1),[t,l]=v.useState({planId:"",title:"",type:"Tabletop",date:new Date().toISOString().split("T")[0],status:"Scheduled",notes:""}),w=()=>{if(!t.planId)return m.error("Select a plan to test");if(!t.title)return m.error("Enter a title");D.mutate({clientId:i,planId:parseInt(t.planId),title:t.title,type:t.type,date:t.date,status:t.status,notes:t.notes})};return e.jsx(G,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2 text-muted-foreground mb-1",children:e.jsxs(p,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent",onClick:()=>N(`/clients/${i}/business-continuity/dashboard`),children:[e.jsx(J,{className:"w-4 h-4 mr-1"})," Back to Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"BCP Exercises & Testing"}),e.jsx("p",{className:"text-muted-foreground",children:"Schedule and review exercises (drills, tabletops, simulations) to validate plans."})]}),e.jsxs(p,{onClick:()=>h(!0),children:[e.jsx(K,{className:"w-4 h-4 mr-2"})," Schedule Exercise"]})]}),e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(B,{children:"Exercise Log"}),e.jsx(O,{children:"History of all BCP exercises across different plans."})]}),e.jsx(F,{children:e.jsxs(H,{children:[e.jsx(R,{children:e.jsxs(j,{children:[e.jsx(d,{children:"Title"}),e.jsx(d,{children:"Target Plan"}),e.jsx(d,{children:"Type"}),e.jsx(d,{children:"Date"}),e.jsx(d,{children:"Status"})]})}),e.jsxs(Q,{children:[c==null?void 0:c.map(s=>e.jsxs(j,{children:[e.jsxs(r,{className:"font-medium flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-orange-500"}),s.title]}),e.jsx(r,{children:s.planTitle}),e.jsx(r,{children:e.jsx(f,{variant:"outline",children:s.type})}),e.jsx(r,{children:new Date(s.startDate).toLocaleDateString()}),e.jsx(r,{children:e.jsx(f,{variant:s.status==="Completed"?"default":"secondary",className:"capitalize",children:s.status})})]},s.id)),(!c||c.length===0)&&e.jsx(j,{children:e.jsx(r,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No exercises logged."})})]})]})})]}),e.jsx(V,{open:I,onOpenChange:h,children:e.jsxs(A,{children:[e.jsx(W,{children:e.jsx(z,{children:"Schedule New Exercise"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Target Plan"}),e.jsxs("select",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm",value:t.planId,onChange:s=>l({...t,planId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Plan..."}),x==null?void 0:x.map(s=>e.jsxs("option",{value:s.id,children:[s.title," (v",s.version,")"]},s.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Exercise Title"}),e.jsx(g,{value:t.title,onChange:s=>l({...t,title:s.target.value}),placeholder:"e.g. Q4 Ransomware Simulation"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(y,{value:t.type,onValueChange:s=>l({...t,type:s}),children:[e.jsx(C,{children:e.jsx(b,{})}),e.jsxs(S,{children:[e.jsx(a,{value:"Walkthrough",children:"Walkthrough"}),e.jsx(a,{value:"Tabletop",children:"Tabletop"}),e.jsx(a,{value:"Drill",children:"Drill"}),e.jsx(a,{value:"Full Scale",children:"Full Scale"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Date"}),e.jsx(g,{type:"date",value:t.date,onChange:s=>l({...t,date:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Status"}),e.jsxs(y,{value:t.status,onValueChange:s=>l({...t,status:s}),children:[e.jsx(C,{children:e.jsx(b,{})}),e.jsxs(S,{children:[e.jsx(a,{value:"Scheduled",children:"Scheduled"}),e.jsx(a,{value:"In Progress",children:"In Progress"}),e.jsx(a,{value:"Completed",children:"Completed"}),e.jsx(a,{value:"Review Pending",children:"Review Pending"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Notes"}),e.jsx(g,{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),placeholder:"Objectives..."})]})]}),e.jsxs(q,{children:[e.jsx(p,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(p,{onClick:w,children:"Schedule"})]})]})})]})})}export{ke as default};
